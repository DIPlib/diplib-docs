<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Filtering &raquo; Linear filters module | DIPlib | a library for quantitative image analysis</title>
  <link rel="stylesheet" href="m-dip+documentation.compiled.css" />
  <link rel="icon" href="DIPlib_logo_32.png" type="image/png" />
  <link rel="search" type="application/opensearchdescription+xml" href="opensearch.xml" title="Search DIPlib documentation" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#ffffff" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://diplib.org"><img src="DIPlib_logo.svg" alt="" />DIPlib</a><span class="m-breadcrumb">┃</span><a href="index.html" class="m-thin">a library for quantitative image analysis</a><span class="m-breadcrumb">┃</span><a href="https://github.com/DIPlib/diplib/releases/tag/3.5.2" class="m-thin">version 3.5.2</a>      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="modules.html">Modules</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="classes.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="filtering.html">Filtering</a> &raquo;</span>
          Linear filters <span class="m-thin">module</span>          <div class="m-doc-include m-code m-thin m-text-right">#include <a href="file--diplib--linear-h.html">"diplib/linear.h"</a></div>
        </h1>
        <p>Linear smoothing, sharpening and derivative filters.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#nested-classes">Classes</a></li>
                <li><a href="#alias-members">Aliases</a></li>
                <li><a href="#function-members">Functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
        <section id="nested-classes">
          <h2>Classes</h2>
          <dl class="m-doc">
                          <dt>
              struct <a href="#dip-OneDimensionalFilter" class="m-doc">dip::<wbr />OneDimensionalFilter</a>
            </dt>
            <dd>Describes a 1D filter <a href="#dip-OneDimensionalFilter">more...</a></dd>
          </dl>
        </section>
        <section id="alias-members">
            <h2>Aliases</h2>
            <dl class="m-doc">
                              <dt id="dip-OneDimensionalFilterArray">
              using <a href="#dip-OneDimensionalFilterArray" class="m-doc-self">dip::<wbr />OneDimensionalFilterArray</a> = std::vector&lt;OneDimensionalFilter&gt;

            </dt>
            <dd>An array of 1D filters</dd>
            </dl>
        </section>
        <section id="function-members">
          <h2>Functions</h2>
          <dl class="m-doc">
                          <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#dip-SeparateFilter-Image-CL" class="m-doc">dip::<wbr />SeparateFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; filter) -&gt; <a href="linear.html#dip-OneDimensionalFilterArray" class="m-doc">dip::OneDimensionalFilterArray</a></span>
            </dt>
            <dd>Separates a linear filter (convolution kernel) into a set of 1D filters that can be applied using
<a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a>. <a href="#dip-SeparateFilter-Image-CL">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-" class="m-doc">dip::<wbr />SeparableConvolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="linear.html#dip-OneDimensionalFilterArray" class="m-doc">dip::OneDimensionalFilterArray</a> const&amp; filterArray,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {})</span>
            </dt>
            <dd>Applies a convolution with a filter kernel (PSF) that is separable. <a href="#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL" class="m-doc">dip::<wbr />ConvolveFT</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; filter,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; inRepresentation = S::SPATIAL,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; filterRepresentation = S::SPATIAL,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; outRepresentation = S::SPATIAL,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies a convolution with a filter kernel (PSF) by multiplication in the Fourier domain. <a href="#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL" class="m-doc">dip::<wbr />GeneralConvolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; filter,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies a convolution with a filter kernel (PSF) by direct implementation of the convolution sum. <a href="#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Convolution-Image-CL-Image-CL-Image-L-String-CL-StringArray-CL" class="m-doc">dip::<wbr />Convolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; filter,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies a convolution with a filter kernel (PSF). <a href="#dip-Convolution-Image-CL-Image-CL-Image-L-String-CL-StringArray-CL">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL" class="m-doc">dip::<wbr />Uniform</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies a convolution with a kernel with uniform weights, leading to an average (mean) filter. <a href="#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-" class="m-doc">dip::<wbr />GaussFIR</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Finite impulse response implementation of the Gaussian filter and its derivatives <a href="#dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL" class="m-doc">dip::<wbr />GaussFT</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; inRepresentation = S::SPATIAL,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; outRepresentation = S::SPATIAL,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Fourier implementation of the Gaussian filter and its derivatives <a href="#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-" class="m-doc">dip::<wbr />GaussIIR</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> filterOrder = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; designMethod = S::DISCRETE_TIME_FIT,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Infinite impulse response implementation of the Gaussian filter and its derivatives <a href="#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-" class="m-doc">dip::<wbr />Gauss</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Convolution with a Gaussian kernel and its derivatives <a href="#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-" class="m-doc">dip::<wbr />FiniteDifference</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; smoothFlag = S::SMOOTH,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {})</span>
            </dt>
            <dd>Finite difference derivatives <a href="#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-SobelGradient-Image-CL-Image-L-dip-uint--StringArray-CL" class="m-doc">dip::<wbr />SobelGradient</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> dimension = 0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>The Sobel derivative filter <a href="#dip-SobelGradient-Image-CL-Image-L-dip-uint--StringArray-CL">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-" class="m-doc">dip::<wbr />Derivative</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes derivatives <a href="#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-">more...</a></dd>
                          <dt id="dip-Dx-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dx-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dx</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the first derivative along x, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt id="dip-Dy-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dy-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dy</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the first derivative along y, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt id="dip-Dz-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dz-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dz</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the first derivative along z, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt id="dip-Dxx-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dxx-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dxx</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the second derivative along x, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt id="dip-Dyy-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dyy-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dyy</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the second derivative along y, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt id="dip-Dzz-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dzz-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dzz</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the second derivative along z, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt id="dip-Dxy-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dxy-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dxy</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the first derivative along x and y, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt id="dip-Dxz-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dxz-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dxz</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the first derivative along x and z, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt id="dip-Dyz-Image-CL-Image-L-FloatArray-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dyz-Image-CL-Image-L-FloatArray-" class="m-doc-self">dip::<wbr />Dyz</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0})</span>
            </dt>
            <dd>Computes the first derivative along y and z, see <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>.</dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />Gradient</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the gradient of the image, resulting in an <em>N</em>-vector image, if the input was <em>N</em>-dimensional. <a href="#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GradientMagnitude-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />GradientMagnitude</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the gradient magnitude of the image, equivalent to <code>dip::Norm( dip::Gradient( in ))</code>. <a href="#dip-GradientMagnitude-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GradientDirection-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />GradientDirection</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the direction of the gradient of the image, equivalent to <code>dip::Angle( dip::Gradient( in ))</code>. <a href="#dip-GradientDirection-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Curl-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />Curl</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the curl (rotation) of the 2D or 3D vector field <code>in</code>. <a href="#dip-Curl-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Divergence-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />Divergence</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the divergence of the vector field <code>in</code>. <a href="#dip-Divergence-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Hessian-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />Hessian</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the Hessian of the image, resulting in a symmetric <em>NxN</em> tensor image, if the input
was <em>N</em>-dimensional. <a href="#dip-Hessian-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />Laplace</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the Laplacian of the image, equivalent to <code>dip::Trace( dip::Hessian( in ))</code>, but more efficient. <a href="#dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />Dgg</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the second derivative in the gradient direction. <a href="#dip-Dgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-LaplacePlusDgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />LaplacePlusDgg</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Adds the second derivative in the gradient direction to the Laplacian. <a href="#dip-LaplacePlusDgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-LaplaceMinusDgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />LaplaceMinusDgg</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Subtracts the second derivative in the gradient direction from the Laplacian. <a href="#dip-LaplaceMinusDgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Sharpen-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-" class="m-doc">dip::<wbr />Sharpen</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> weight = 1.0,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Sharpens <code>in</code> by subtracting the Laplacian of the image. <a href="#dip-Sharpen-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-UnsharpMask-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-" class="m-doc">dip::<wbr />UnsharpMask</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> weight = 1.0,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Sharpens <code>in</code> by subtracting the smoothed image. <a href="#dip-UnsharpMask-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GaborFIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc">dip::<wbr />GaborFIR</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; frequencies,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Finite impulse response implementation of the Gabor filter <a href="#dip-GaborFIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GaborIIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--IntegerArray-CL-dfloat-" class="m-doc">dip::<wbr />GaborIIR</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; frequencies,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},
              <a href="supporttypes.html#dip-IntegerArray" class="m-doc">dip::IntegerArray</a> const&amp; filterOrder = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Recursive infinite impulse response implementation of the Gabor filter <a href="#dip-GaborIIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--IntegerArray-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Gabor2D-Image-CL-Image-L-FloatArray--dfloat--dfloat--StringArray-CL-dfloat-" class="m-doc">dip::<wbr />Gabor2D</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {5.0,5.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> frequency = 0.1,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> direction = dip::pi,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>2D Gabor filter with direction parameter <a href="#dip-Gabor2D-Image-CL-Image-L-FloatArray--dfloat--dfloat--StringArray-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-LogGaborFilterBank-Image-CL-Image-L-FloatArray-CL-dfloat--dip-uint--String-CL-String-CL" class="m-doc">dip::<wbr />LogGaborFilterBank</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; wavelengths = {3.0,6.0,12.0,24.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> bandwidth = 0.75,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> nOrientations = 6,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; inRepresentation = S::SPATIAL,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; outRepresentation = S::SPATIAL)</span>
            </dt>
            <dd>Applies a log-Gabor filter bank <a href="#dip-LogGaborFilterBank-Image-CL-Image-L-FloatArray-CL-dfloat--dip-uint--String-CL-String-CL">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-NormalizedConvolution-Image-CL-Image-CL-Image-L-FloatArray-CL-String-CL-StringArray-CL-dfloat-" class="m-doc">dip::<wbr />NormalizedConvolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {S::ADD_ZEROS},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the normalized convolution with a Gaussian kernel: a Gaussian convolution for missing or
uncertain data. <a href="#dip-NormalizedConvolution-Image-CL-Image-CL-Image-L-FloatArray-CL-String-CL-StringArray-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-NormalizedDifferentialConvolution-Image-CL-Image-CL-Image-L-dip-uint--FloatArray-CL-String-CL-StringArray-CL-dfloat-" class="m-doc">dip::<wbr />NormalizedDifferentialConvolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> dimension = 0,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {S::ADD_ZEROS},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the normalized differential convolution with a Gaussian kernel: a derivative operator for missing
or uncertain data. <a href="#dip-NormalizedDifferentialConvolution-Image-CL-Image-CL-Image-L-dip-uint--FloatArray-CL-String-CL-StringArray-CL-dfloat-">more...</a></dd>
                          <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MeanShiftVector-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-dfloat-" class="m-doc">dip::<wbr />MeanShiftVector</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3)</span>
            </dt>
            <dd>Computes the mean shift vector for each pixel in the image <a href="#dip-MeanShiftVector-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-dfloat-">more...</a></dd>
          </dl>
        </section>
        <section>
            <h2>Class documentation</h2>
                          <section class="m-doc-details" id="dip-OneDimensionalFilter"><div>
            <h3>
              struct <span class="m-doc-name"><a href="#dip-OneDimensionalFilter" class="m-doc-self">dip::<wbr />OneDimensionalFilter</a></span>            </h3>
            <p>Describes a 1D filter</p>
<p>The weights are in <code>filter</code>. If <code>isComplex</code>, then the values in <code>filter</code> are interpreted as real/imaginary
pairs. In this case, <code>filter</code> must have an even length, with each two consecutive elements representing a
single filter weight. The <code>filter.data()</code> pointer can thus be cast to <a href="pixeltypes.html#dip-dcomplex"><code>dip::dcomplex</code></a>.</p>
<p>The origin is placed either at the index given by <code>origin</code> if it&rsquo;s non-negative, or at index
<code>filter.size() / 2</code> if <code>origin</code> is negative. Note that <code>filter.size() / 2</code> is either the middle pixel
if the filter is odd in length, or the pixel to the right of the center if it is even in length:</p>
<table class="m-table">
<thead>
<tr>
<th>size of <code>filter</code></th>
<th style="text-align: center;"><code>origin</code></th>
<th style="text-align: center;">origin location</th>
</tr>
</thead>
<tbody>
<tr>
<td>any</td>
<td style="text-align: center;"><code>1</code></td>
<td style="text-align: center;"><code>x 0 x x x x</code></td>
</tr>
<tr>
<td>any</td>
<td style="text-align: center;"><code>5</code></td>
<td style="text-align: center;"><code>x x x x x 0</code></td>
</tr>
<tr>
<td>any odd value</td>
<td style="text-align: center;"><code>-1</code></td>
<td style="text-align: center;"><code>x x 0 x x</code></td>
</tr>
<tr>
<td>any even value</td>
<td style="text-align: center;"><code>-1</code></td>
<td style="text-align: center;"><code>x x x 0 x x</code></td>
</tr>
</tbody>
</table>
<p>Note that, if positive, <code>origin</code> must be an index to one of the samples in the <code>filter</code> array:
<code>origin &lt; filter.size()</code>.</p>
<p><code>symmetry</code> indicates the filter shape: <code>"general"</code> (or an empty string) indicates no symmetry.
<code>"even"</code> indicates even symmetry, <code>"odd"</code> indicates odd symmetry, and <code>"conj"</code> indicates complex conjugate
symmetry. In these three cases, the filter represents the left half of the full filter,
with the rightmost element at the origin (and not repeated). The full filter is thus always odd in size.
<code>"d-even"</code>, <code>"d-odd"</code> and <code>"d-conj"</code> are similar, but duplicate the rightmost element, yielding
an even-sized filter. The origin for the symmetric filters is handled identically to the general filter case.</p>
<p>The following table summarizes the result of using various <code>symmetry</code> values. The <code>filter</code> array in all
cases has <em>n</em> elements represented in this example as [<em>a</em>,<em>b</em>,<em>c</em>].</p>
<table class="m-table">
<thead>
<tr>
<th><code>symmetry</code></th>
<th>resulting array</th>
<th>resulting array length</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>"general"</code></td>
<td>[<em>a</em>,<em>b</em>,<em>c</em>]</td>
<td><em>n</em></td>
</tr>
<tr>
<td><code>"even"</code></td>
<td>[<em>a</em>,<em>b</em>,<em>c</em>,<em>b</em>,<em>a</em>]</td>
<td>2<em>n</em> - 1</td>
</tr>
<tr>
<td><code>"odd"</code></td>
<td>[<em>a</em>,<em>b</em>,<em>c</em>,-<em>b</em>,-<em>a</em>]</td>
<td>2<em>n</em> - 1</td>
</tr>
<tr>
<td><code>"conj"</code></td>
<td>[<em>a</em>,<em>b</em>,<em>c</em>,<em>b</em><sup>*</sup>,<em>a</em><sup>*</sup>]</td>
<td>2<em>n</em> - 1</td>
</tr>
<tr>
<td><code>"d-even"</code></td>
<td>[<em>a</em>,<em>b</em>,<em>c</em>,<em>c</em>,<em>b</em>,<em>a</em>]</td>
<td>2<em>n</em></td>
</tr>
<tr>
<td><code>"d-odd"</code></td>
<td>[<em>a</em>,<em>b</em>,<em>c</em>,-<em>c</em>,-<em>b</em>,-<em>a</em>]</td>
<td>2<em>n</em></td>
</tr>
<tr>
<td><code>"d-conj"</code></td>
<td>[<em>a</em>,<em>b</em>,<em>c</em>,<em>c</em><sup>*</sup>,<em>b</em><sup>*</sup>,<em>a</em><sup>*</sup>]</td>
<td>2<em>n</em></td>
</tr>
</tbody>
</table>
<p>The convolution is applied to each tensor component separately, which is always the correct behavior for linear
filters.</p>
            <table class="m-table m-fullwidth m-first-tight m-flat m-doc">
              <thead><tr><th>Variables</th><th></th></tr></thead>
              <tbody>
                <tr>
                  <td>
                  std::vector&lt;dfloat&gt; <span class="m-doc-name"><a href="#dip-OneDimensionalFilter-filter" class="m-doc-self" id="dip-OneDimensionalFilter-filter">filter</a></span>                  </td>
                  <td>
                  Filter weights.
                  </td>
                </tr>
                <tr>
                  <td>
                  <a href="supporttypes.html#dip-sint" class="m-doc">dip::sint</a> <span class="m-doc-name"><a href="#dip-OneDimensionalFilter-origin" class="m-doc-self" id="dip-OneDimensionalFilter-origin">origin</a></span>                  </td>
                  <td>
                  Origin of the filter if non-negative.
                  </td>
                </tr>
                <tr>
                  <td>
                  <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> <span class="m-doc-name"><a href="#dip-OneDimensionalFilter-symmetry" class="m-doc-self" id="dip-OneDimensionalFilter-symmetry">symmetry</a></span>                  </td>
                  <td>
                  Filter shape: <code>""</code> == <code>"general"</code>, <code>"even"</code>, <code>"odd"</code>, <code>"conj"</code>, <code>"d-even"</code>, <code>"d-odd"</code> or <code>"d-conj"</code>.
                  </td>
                </tr>
                <tr>
                  <td>
                  bool <span class="m-doc-name"><a href="#dip-OneDimensionalFilter-isComplex" class="m-doc-self" id="dip-OneDimensionalFilter-isComplex">isComplex</a></span>                  </td>
                  <td>
                  If true, <code>filter</code> contains complex data.
                  </td>
                </tr>
              </tbody>
            </table>
          </div></section>
        </section>
        <section>
          <h2>Function documentation</h2>
                        <section class="m-doc-details" id="dip-SeparateFilter-Image-CL"><div>
            <h3>
              <span class="m-doc-return"><a href="linear.html#dip-OneDimensionalFilterArray" class="m-doc">dip::OneDimensionalFilterArray</a></span>
              <span class="m-doc-name"><a href="#dip-SeparateFilter-Image-CL" class="m-doc-self">dip::<wbr />SeparateFilter</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; filter</span>)            </h3>
            <p>Separates a linear filter (convolution kernel) into a set of 1D filters that can be applied using
<a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a>.</p>
<p>If <code>filter</code> does not represent a separable kernel, the output <a href="linear.html#dip-OneDimensionalFilterArray"><code>dip::OneDimensionalFilterArray</code></a> object is
empty (it&rsquo;s <code>empty</code> method returns true, and it&rsquo;s <code>size</code> method return 0).</p>
          </div></section>
                        <section class="m-doc-details" id="dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-" class="m-doc-self">dip::<wbr />SeparableConvolution</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="linear.html#dip-OneDimensionalFilterArray" class="m-doc">dip::OneDimensionalFilterArray</a> const&amp; filterArray,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {}</span>)            </h3>
            <p>Applies a convolution with a filter kernel (PSF) that is separable.</p>
<p><code>filter</code> is an array with exactly one <a href="linear.html#dip-OneDimensionalFilter"><code>dip::OneDimensionalFilter</code></a> element for each dimension of <code>in</code>.
Alternatively, it can have a single element, which will be used unchanged for each dimension.
For the dimensions that are not processed (<code>process</code> is <code>false</code> for those dimensions),
the <code>filter</code> array can have nonsensical data or a zero-length filter weights array.
Any <code>filter</code> array that is zero size or the equivalent of <code>{1}</code> will not be applied either.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p><code>process</code> indices which dimensions to process, and can be <code>{}</code> to indicate all dimensions are to be processed.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-SeparateFilter-Image-CL"><code>dip::SeparateFilter</code></a>, <a href="linear.html#dip-Convolution-Image-CL-Image-CL-Image-L-String-CL-StringArray-CL"><code>dip::Convolution</code></a>, <a href="linear.html#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL"><code>dip::GeneralConvolution</code></a>, <a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a>, <a href="frameworks.html#dip-Framework-Separable-Image-CL-Image-L-DataType--DataType--BooleanArray--UnsignedArray--BoundaryConditionArray--SeparableLineFilter-L-SeparableOptions-"><code>dip::Framework::Separable</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL" class="m-doc-self">dip::<wbr />ConvolveFT</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; filter,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; inRepresentation = S::SPATIAL,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; filterRepresentation = S::SPATIAL,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; outRepresentation = S::SPATIAL,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {}</span>)            </h3>
            <p>Applies a convolution with a filter kernel (PSF) by multiplication in the Fourier domain.</p>
<p><code>filter</code> is an image, and must be equal in size or smaller than <code>in</code>. If both <code>in</code> and <code>filter</code>
are real, <code>out</code> will be real too, otherwise it will have a complex type.</p>
<p>As elsewhere, the origin of <code>filter</code> is in the middle of the image, on the pixel to the right of
the center in case of an even-sized image.</p>
<p>If <code>in</code> or <code>filter</code> is already Fourier transformed, set <code>inRepresentation</code> or <code>filterRepresentation</code>
to <code>"frequency"</code>. Similarly, if <code>outRepresentation</code> is <code>"frequency"</code>, the output will not be
inverse-transformed, so will be in the frequency domain. These three values are <code>"spatial"</code> by default.
If any of these three values is <code>"frequency"</code>, then <code>out</code> will be complex, no checks are made to
see if the inputs in frequency domain have the complex conjugate symmetry required for the result
to be real-valued. Use <a href="dip-Image.html#dip-Image-Real-C"><code>dip::Image::Real</code></a> if you expect the output to be real-valued in this case.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension.
See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a> for a description of each option. It is ignored unless <code>inRepresentation</code>,
<code>filterRepresentation</code> and <code>outRepresentation</code> are all <code>"spatial"</code>. If the array is empty (the default),
then a periodic boundary condition is imposed. This is the natural boundary condition for the method,
the image will be Fourier transformed as-is. For other boundary conditions, the image will be padded before
the transform is applied. The padding will extend the image by at least half the size of <code>filter</code> in all
dimensions, and the padding will make the image size a multiple of small integers so that it is cheaper
to compute the Fourier transform (see <a href="transform.html#dip-OptimalFourierTransformSize-dip-uint--dip-String-CL-dip-String-CL"><code>dip::OptimalFourierTransformSize</code></a>).
The output image will be cropped to the size of the input.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Convolution-Image-CL-Image-CL-Image-L-String-CL-StringArray-CL"><code>dip::Convolution</code></a>, <a href="linear.html#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL"><code>dip::GeneralConvolution</code></a>, <a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a>, <a href="transform.html#dip-FourierTransform-Image-CL-Image-L-StringSet-CL-BooleanArray-"><code>dip::FourierTransform</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL" class="m-doc-self">dip::<wbr />GeneralConvolution</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; filter,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {}</span>)            </h3>
            <p>Applies a convolution with a filter kernel (PSF) by direct implementation of the convolution sum.</p>
<p><code>filter</code> is an image, and must be equal in size or smaller than <code>in</code>.</p>
<p>As elsewhere, the origin of <code>filter</code> is in the middle of the image, on the pixel to the right of
the center in case of an even-sized image.</p>
<p>Note that this is a really expensive way to compute the convolution for any <code>filter</code> that has more than a
small amount of non-zero values. It is always advantageous to try to separate your filter into a set of 1D
filters (see <a href="linear.html#dip-SeparateFilter-Image-CL"><code>dip::SeparateFilter</code></a> and <a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a>). If this is not possible, use
<a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a> with larger filters to compute the convolution in the Fourier domain.</p>
<p>Also, if all non-zero filter weights have the same value, <a href="linear.html#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><code>dip::Uniform</code></a> implements a more efficient
algorithm. If <code>filter</code> is a binary image, <a href="linear.html#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><code>dip::Uniform</code></a> is called.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Convolution-Image-CL-Image-CL-Image-L-String-CL-StringArray-CL"><code>dip::Convolution</code></a>, <a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a>, <a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a>, <a href="linear.html#dip-SeparateFilter-Image-CL"><code>dip::SeparateFilter</code></a>, <a href="linear.html#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><code>dip::Uniform</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Convolution-Image-CL-Image-CL-Image-L-String-CL-StringArray-CL"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Convolution-Image-CL-Image-CL-Image-L-String-CL-StringArray-CL" class="m-doc-self">dip::<wbr />Convolution</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; filter,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {}</span>)            </h3>
            <p>Applies a convolution with a filter kernel (PSF).</p>
<p>Calls either <a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a>, <a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a> or <a href="linear.html#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL"><code>dip::GeneralConvolution</code></a> depending on <code>method</code> and
the properties of <code>filter</code>. <code>method</code> can be one of:</p>
<ul>
<li><code>"separable"</code>: Attempts to separate <code>filter</code> into 1D kernels using <a href="linear.html#dip-SeparateFilter-Image-CL"><code>dip::SeparateFilter</code></a>, and applies
  <a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a> if successful. Throws an exception if the filter is not separable.</li>
<li><code>"fourier"</code>: Calls <a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a>.</li>
<li><code>"direct"</code>: Calls <a href="linear.html#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL"><code>dip::GeneralConvolution</code></a>.</li>
<li><code>"best"</code>: Uses the method that is most efficient given the sizes of <code>in</code> and <code>filter</code>, and whether <code>filter</code>
  is separable or not. It estimates the cost of each of the methods using simple models that have been fitted
  to timing data generated on one specific computer. These costs might not match actual costs on other machines,
  but form a suitable default. For applications where performance is critical, it is recommended to time the
  operations on the target machine, and explicitly select the best algorithm.</li>
</ul>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>When calling <a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a>, it never leaves <code>boundaryCondition</code> empty, to force the function to pad the
image and use the same boundary condition that other methods would use. This ensures that the function doesn&rsquo;t
produce different results for a different choice of method. To prevent padding, call <a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a> directly.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL"><code>dip::GeneralConvolution</code></a>, <a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a>, <a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a>, <a href="linear.html#dip-SeparateFilter-Image-CL"><code>dip::SeparateFilter</code></a>, <a href="linear.html#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><code>dip::Uniform</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL" class="m-doc-self">dip::<wbr />Uniform</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {}</span>)            </h3>
            <p>Applies a convolution with a kernel with uniform weights, leading to an average (mean) filter.</p>
<p>The size and shape of the kernel is given by <code>kernel</code>, which you can define through a default
shape with corresponding sizes, or through a binary image. See <a href="dip-Kernel.html"><code>dip::Kernel</code></a>.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-ConvolveFT-Image-CL-Image-CL-Image-L-String-CL-String-CL-String-CL-StringArray-CL"><code>dip::ConvolveFT</code></a>, <a href="linear.html#dip-SeparableConvolution-Image-CL-Image-L-OneDimensionalFilterArray-CL-StringArray-CL-BooleanArray-"><code>dip::SeparableConvolution</code></a>, <a href="linear.html#dip-GeneralConvolution-Image-CL-Image-CL-Image-L-StringArray-CL"><code>dip::GeneralConvolution</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />GaussFIR</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Finite impulse response implementation of the Gaussian filter and its derivatives</p>
<p>Convolves the image with a 1D Gaussian kernel along each dimension. For each dimension,
provide a value in <code>sigmas</code> and <code>derivativeOrder</code>. The zeroth-order derivative is a plain
smoothing, no derivative is computed. Derivatives with order up to 3 can be computed with
this function. For higher-order derivatives, use <a href="linear.html#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><code>dip::GaussFT</code></a>.</p>
<p>The value of sigma determines the smoothing effect. For values smaller than about 0.8, the
result is an increasingly poor approximation to the Gaussian filter. Use <a href="linear.html#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><code>dip::GaussFT</code></a> for
very small sigmas. Conversely, for very large sigmas it is more efficient to use <a href="linear.html#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-"><code>dip::GaussIIR</code></a>,
which runs in a constant time with respect to the sigma. Dimensions where sigma is 0 or
negative are not processed, even if the derivative order is non-zero.</p>
<p>For the smoothing filter (<code>derivativeOrder</code> is 0), the size of the kernel is given by
<code>2 * std::ceil( truncation * sigma ) + 1</code>. The default value for <code>truncation</code> is 3, which assures a good
approximation of the Gaussian kernel without unnecessary expense. It is possible to reduce
computation slightly by decreasing this parameter, but it is not recommended. For derivatives,
the value of <code>truncation</code> is increased by <code>0.5 * derivativeOrder</code>.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a>, <a href="linear.html#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-"><code>dip::GaussIIR</code></a>, <a href="linear.html#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><code>dip::GaussFT</code></a>, <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-"><code>dip::FiniteDifference</code></a>, <a href="linear.html#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><code>dip::Uniform</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL" class="m-doc-self">dip::<wbr />GaussFT</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; inRepresentation = S::SPATIAL,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; outRepresentation = S::SPATIAL,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {}</span>)            </h3>
            <p>Fourier implementation of the Gaussian filter and its derivatives</p>
<p>Convolves the image with a Gaussian kernel by multiplication in the Fourier domain.
For each dimension, provide a value in <code>sigmas</code> and <code>derivativeOrder</code>. The value of sigma determines
the smoothing effect. The zeroth-order derivative is a plain smoothing, no derivative is computed.</p>
<p>The values of <code>sigmas</code> are translated to the Fourier domain, and a Fourier-domain Gaussian is computed.
Frequencies above <code>std::ceil(( truncation + 0.5 * derivativeOrder ) * FDsigma )</code> are set to 0. It is a relatively
minute computational difference if <code>truncation</code> were to be infinity, so it is not worth while to try to
speed up the operation by decreasing <code>truncation</code>.</p>
<p>Dimensions where sigma is 0 or negative are not smoothed. Note that it is possible to compute a derivative
without smoothing in the Fourier domain.</p>
<p>If <code>in</code> is already Fourier transformed, set <code>inRepresentation</code> to <code>"frequency"</code>.
Similarly, if <code>outRepresentation</code> is <code>"frequency"</code>, the output will not be inverse-transformed,
and so will be in the frequency domain. These two values are <code>"spatial"</code> by default.
If any of these values is <code>"frequency"</code>, then <code>out</code> will be complex, no checks are made to
see if the inputs in frequency domain have the complex conjugate symmetry required for the result
to be real-valued. Use <a href="dip-Image.html#dip-Image-Real-C"><code>dip::Image::Real</code></a> if you expect the output to be real-valued in this case.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
The default empty boundary condition indicates no boundary extension is to be applied, the convolution will be
circular (periodic boundary condition) as is natural with the DFT convolution. Specifying a boundary condition
will cause the input image to be padded to a good DFT size (a product of small integers,
see <a href="transform.html#dip-OptimalFourierTransformSize-dip-uint--dip-String-CL-dip-String-CL"><code>dip::OptimalFourierTransformSize</code></a>) that is large enough to prevent visible effects of the circular
convolution. Thus, specifying <code>"periodic"</code> as the boundary condition could, depending on the sizes of the image,
speed up the operation compared to leaving the boundary condition empty.</p>
<p>If <code>inRepresentation</code> is <code>"frequency"</code>, then <code>boundaryCondition</code> is ignored.</p>
<p>If <code>outRepresentation</code> is <code>"frequency"</code>, then the padding caused by <code>boundaryCondition</code> will affect the output size.
Leave <code>boundaryCondition</code> empty in this case if a predictable output size is needed.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a>, <a href="linear.html#dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-"><code>dip::GaussFIR</code></a>, <a href="linear.html#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-"><code>dip::GaussIIR</code></a>, <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-"><code>dip::FiniteDifference</code></a>, <a href="linear.html#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><code>dip::Uniform</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-" class="m-doc-self">dip::<wbr />GaussIIR</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> filterOrder = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; designMethod = S::DISCRETE_TIME_FIT,</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Infinite impulse response implementation of the Gaussian filter and its derivatives</p>
<p>Convolves the image with an IIR 1D Gaussian kernel along each dimension. For each dimension,
provide a value in <code>sigmas</code> and <code>derivativeOrder</code>. The zeroth-order derivative is a plain
smoothing, no derivative is computed. Derivatives with order up to 4 can be computed with this
function. For higher-order derivatives, use <a href="linear.html#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><code>dip::GaussFT</code></a>.</p>
<p>The value of sigma determines the smoothing effect. For smaller values, the result is an
increasingly poor approximation to the Gaussian filter. This function is efficient only for
very large sigmas. Dimensions where sigma is 0 or negative are not processed, even if the
derivative order is non-zero.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>The <code>filterOrder</code> and <code>designMethod</code> determine how the filter is implemented. By default,
<code>designMethod</code> is &ldquo;discrete time fit&rdquo;. This is the method described in van Vliet et al. (1998).
<code>filterOrder</code> can be between 1 and 5, with 3 producing good results, and increasing order producing
better results. When computing derivatives, a higher <code>filterOrder</code> is necessary. By default,
<code>filterOrder</code> is <code>3 + derivativeOrder</code>, capped at 5. The alternative <code>designMethod</code> is &ldquo;forward backward&rdquo;.
This is the method described in Young and van Vliet (1995). Here <code>filterOrder</code> can be between 3 and 5.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a>, <a href="linear.html#dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-"><code>dip::GaussFIR</code></a>, <a href="linear.html#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><code>dip::GaussFT</code></a>, <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-"><code>dip::FiniteDifference</code></a>, <a href="linear.html#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><code>dip::Uniform</code></a></p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>I.T. Young and L.J. van Vliet, &ldquo;Recursive implementation of the Gaussian filter&rdquo;, Signal Processing,
  44(2):139-151, 1995.</li>
<li>L.J. van Vliet, I.T. Young and P.W. Verbeek, &ldquo;Recursive Gaussian Derivative Filters&rdquo;,
  in: Proc. 14<sup>th</sup> Int. Conference on Pattern Recognition, IEEE Computer Society Press, 1998, 509-514.</li>
</ul>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />Gauss</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Convolution with a Gaussian kernel and its derivatives</p>
<p>Convolves the image with a Gaussian kernel. For each dimension, provide a value in <code>sigmas</code> and
<code>derivativeOrder</code>. The value of sigma determines the smoothing effect. The zeroth-order derivative
is a plain smoothing, no derivative is computed. Dimensions where sigma is 0 or negative are not
smoothed. Only the &ldquo;FT&rdquo; method can compute the derivative along a dimension where sigma is zero or negative.</p>
<p>How the convolution is computed depends on the value of <code>method</code>:</p>
<ul>
<li><code>"FIR"</code>: Finite impulse response implementation, see <a href="linear.html#dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-"><code>dip::GaussFIR</code></a>.</li>
<li><code>"IIR"</code>: Infinite impulse response implementation, see <a href="linear.html#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-"><code>dip::GaussIIR</code></a>.</li>
<li><code>"FT"</code>: Fourier domain implementation, see <a href="linear.html#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><code>dip::GaussFT</code></a>.</li>
<li><code>"best"</code>: Picks the best method, according to the values of <code>sigmas</code> and <code>derivativeOrder</code>:<ul>
<li>if any <code>derivativeOrder</code> is larger than 3, use the FT method,</li>
<li>else if any <code>sigmas</code> is smaller than 0.8, use the FT method,</li>
<li>else if any <code>sigmas</code> is larger than 10, use the IIR method,</li>
<li>else use the FIR method.</li>
</ul>
</li>
</ul>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-"><code>dip::GaussFIR</code></a>, <a href="linear.html#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><code>dip::GaussFT</code></a>, <a href="linear.html#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-"><code>dip::GaussIIR</code></a>, <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-"><code>dip::FiniteDifference</code></a>, <a href="linear.html#dip-Uniform-Image-CL-Image-L-Kernel-CL-StringArray-CL"><code>dip::Uniform</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-" class="m-doc-self">dip::<wbr />FiniteDifference</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder = {0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; smoothFlag = S::SMOOTH,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {}</span>)            </h3>
            <p>Finite difference derivatives</p>
<p>Computes derivatives using the finite difference method. Set a <code>derivativeOrder</code> for each dimension.
Derivatives of order up to 2 can be computed with this function. The zeroth-order derivative implies either
a smoothing is applied (<code>smoothFlag == "smooth"</code>) or the dimension is not processed at all.</p>
<p>The smoothing filter is <code>[1,2,1]/4</code> (as in the Sobel filter), the first order derivative is <code>[1,0,-1]/2</code>
(central difference), and the second order derivative is <code>[1,-2,1]</code> (which is the composition of twice the
non-central difference <code>[1,-1]</code>). Thus, computing the first derivative twice does not yield the same result
as computing the second derivative directly.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>Set <code>process</code> to false for those dimensions that should not be filtered.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-SobelGradient-Image-CL-Image-L-dip-uint--StringArray-CL"><code>dip::SobelGradient</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-SobelGradient-Image-CL-Image-L-dip-uint--StringArray-CL"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-SobelGradient-Image-CL-Image-L-dip-uint--StringArray-CL" class="m-doc-self">dip::<wbr />SobelGradient</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> dimension = 0,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {}</span>)            </h3>
            <p>The Sobel derivative filter</p>
<p>This function applies the generalization of the Sobel derivative filter to arbitrary dimensions. Along the
dimension <code>dimension</code>, the central difference is computed, and along all other dimensions, the triangular
smoothing filter <code>[1,2,1]/4</code> is applied.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>This function calls <a href="linear.html#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-"><code>dip::FiniteDifference</code></a>.</p>
          </div></section>
                        <section class="m-doc-details" id="dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />Derivative</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> derivativeOrder,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes derivatives</p>
<p>This function provides an interface to the various derivative filters in <em>DIPlib</em>.</p>
<p>For each dimension, provide a value in <code>sigmas</code> and <code>derivativeOrder</code>. The value of sigma determines
the smoothing effect. The zeroth-order derivative is a plain smoothing, no derivative is computed.
If <code>method</code> is <code>"best"</code>, <code>"gaussfir"</code> or <code>"gaussiir"</code>, dimensions where sigma is 0 or negative are not processed,
even if the derivative order is non-zero. That is, sigma must be positive for the dimension(s) where
the derivative is to be computed.</p>
<p><code>method</code> indicates which derivative filter is used:</p>
<ul>
<li><code>"best"</code>: A Gaussian derivative, see <a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a>.</li>
<li><code>"gaussfir"</code>: The FIR implementation of the Gaussian derivative, see <a href="linear.html#dip-GaussFIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-dfloat-"><code>dip::GaussFIR</code></a>.</li>
<li><code>"gaussiir"</code>: The IIR implementation of the Gaussian derivative, see <a href="linear.html#dip-GaussIIR-Image-CL-Image-L-FloatArray--UnsignedArray--StringArray-CL-UnsignedArray--String-CL-dfloat-"><code>dip::GaussIIR</code></a>.</li>
<li><code>"gaussft"</code>: The FT implementation of the Gaussian derivative, see <a href="linear.html#dip-GaussFT-Image-CL-Image-L-FloatArray--UnsignedArray--dfloat--String-CL-String-CL-StringArray-CL"><code>dip::GaussFT</code></a>.</li>
<li><code>"finitediff"</code>: A finite difference derivative, see <a href="linear.html#dip-FiniteDifference-Image-CL-Image-L-UnsignedArray--String-CL-StringArray-CL-BooleanArray-"><code>dip::FiniteDifference</code></a>.</li>
</ul>
<p>A finite difference derivative is an approximation to the derivative operator on the discrete grid.
In contrast, convolving an image with the derivative of a Gaussian provides the exact derivative of
the image convolved with a Gaussian:</p>
<div class="m-math"><svg style="width: 10.183em; height: 2.473em; vertical-align: 0.003em; " viewBox="143.36 -24.76 101.83 24.73">
<title>
\[ \frac{\partial G}{\partial x} \ast f = \frac{\partial}{\partial x}(G \ast f) \]
</title>
<defs>
<path id='eq128-g1-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq128-g4-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq128-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq128-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq128-g7-28' d='M8.6-3.61V-3.8H5.43V-3.61L5.78-3.57C6.17-3.54 6.36-3.42 6.36-3.2C6.36-2.94 6.29-2.63 6.05-1.83C5.79-.92 5.73-.77 5.59-.63C5.32-.37 4.87-.23 4.34-.23C2.8-.23 1.93-1.11 1.93-2.67C1.93-4.13 2.51-5.66 3.45-6.65C3.99-7.21 4.73-7.53 5.51-7.53C6.28-7.53 6.92-7.22 7.29-6.68C7.49-6.37 7.58-6.11 7.63-5.57L7.85-5.54L8.43-7.88L8.25-7.93C8.05-7.65 7.85-7.53 7.54-7.53C7.41-7.53 7.29-7.55 7.02-7.65C6.43-7.84 5.91-7.93 5.42-7.93C2.91-7.93 .62-5.55 .62-2.93C.62-2.12 .96-1.29 1.52-.71C2.13-.11 3 .21 4.04 .21C5.09 .21 5.94-.01 6.86-.52L7.44-2.75C7.63-3.42 7.83-3.56 8.6-3.61Z'/>
<path id='eq128-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq128-g7-71' d='M4.95-1.23L4.79-1.32C4.69-1.2 4.63-1.14 4.53-1C4.25-.64 4.12-.52 3.97-.52C3.8-.52 3.69-.68 3.61-1.01C3.59-1.12 3.57-1.18 3.56-1.2C3.28-2.32 3.13-2.97 3.13-3.14C3.66-4.06 4.09-4.59 4.3-4.59C4.37-4.59 4.48-4.55 4.59-4.49C4.73-4.41 4.81-4.38 4.92-4.38C5.16-4.38 5.32-4.56 5.32-4.81C5.32-5.07 5.12-5.25 4.84-5.25C4.31-5.25 3.87-4.82 3.04-3.55L2.91-4.2C2.74-5.01 2.61-5.25 2.29-5.25C2.01-5.25 1.63-5.16 .89-4.91L.76-4.86L.81-4.68L1.01-4.73C1.24-4.79 1.38-4.81 1.48-4.81C1.77-4.81 1.85-4.7 2.01-3.99L2.36-2.53L1.38-1.13C1.13-.77 .91-.56 .77-.56C.7-.56 .58-.6 .46-.67C.31-.75 .19-.79 .08-.79C-.15-.79-.32-.61-.32-.37C-.32-.06-.1 .13 .27 .13S.79 .02 1.38-.69L2.45-2.1L2.81-.67C2.97-.05 3.12 .13 3.5 .13C3.95 .13 4.26-.15 4.95-1.23Z'/>
<path id='eq128-g7-109' d='M5.86-5.13C5.86-6.85 5.34-8.24 4.05-8.24C3.05-8.24 1.97-7.29 1.97-6.75C1.97-6.36 2.27-6.21 2.51-6.21C2.76-6.21 2.92-6.4 2.94-6.43C2.91-6.47 2.83-6.57 2.83-6.74C2.83-6.85 3.05-7.88 4.07-7.88C4.93-7.88 5.12-6.78 5.12-5.81C5.12-5.09 5.01-4.44 5.01-4.43H5C5-4.44 4.54-5.17 3.6-5.17C1.21-5.17 .23-2.86 .23-1.63C.23-.52 .88 .19 2.2 .19C4.25 .19 5.86-1.89 5.86-5.13ZM4.5-3.79C4.5-3.48 4.19-.1 2.29-.1C1.61-.1 1.3-.48 1.3-1.24C1.3-1.99 1.8-4.88 3.51-4.88C4.18-4.88 4.5-4.49 4.5-3.79Z'/>
</defs>
<g id='eq128-page1'>
<use x='143.61' y='-16.52' xlink:href='#eq128-g7-109'/>
<use x='150.32' y='-16.52' xlink:href='#eq128-g7-28'/>
<rect x='143.36' y='-11.83' height='.67' width='16.38'/>
<use x='145.37' y='-.22' xlink:href='#eq128-g7-109'/>
<use x='152.1' y='-.22' xlink:href='#eq128-g7-71'/>
<use x='163.59' y='-8.42' xlink:href='#eq128-g4-3'/>
<use x='173.96' y='-8.42' xlink:href='#eq128-g7-53'/>
<use x='182.71' y='-8.42' xlink:href='#eq128-g1-61'/>
<use x='198.02' y='-16.52' xlink:href='#eq128-g7-109'/>
<rect x='194.83' y='-11.83' height='.67' width='12.87'/>
<use x='195.08' y='-.22' xlink:href='#eq128-g7-109'/>
<use x='201.81' y='-.22' xlink:href='#eq128-g7-71'/>
<use x='209.49' y='-8.42' xlink:href='#eq128-g4-185'/>
<use x='213.93' y='-8.42' xlink:href='#eq128-g7-28'/>
<use x='226' y='-8.42' xlink:href='#eq128-g4-3'/>
<use x='236.37' y='-8.42' xlink:href='#eq128-g7-53'/>
<use x='241.8' y='-8.42' xlink:href='#eq128-g4-186'/>
</g>
</svg></div>
<p>Thus (considering the regularization provided by the Gaussian smoothing is beneficial) it is always
better to use Gaussian derivatives than finite difference derivatives.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
          </div></section>
                        <section class="m-doc-details" id="dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />Gradient</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the gradient of the image, resulting in an <em>N</em>-vector image, if the input was <em>N</em>-dimensional.</p>
<p>Each tensor component corresponds to the first derivative along the given dimension: <code>out[ 0 ]</code> is the
derivative along <em>x</em> (dimension with index 0), <code>out[ 1 ]</code> is the derivative along <em>y</em> (dimension with index 1),
etc.</p>
<p>The input image must be scalar.</p>
<p>Set <code>process</code> to false for those dimensions along which no derivative should be taken. For example, if <code>in</code> is
a 3D image, and <code>process</code> is <code>{true,false,false}</code>, then <code>out</code> will be a scalar image, containing only the
derivative along the <em>x</em> axis.</p>
<p>By default uses Gaussian derivatives in the computation. Set <code>method = "finitediff"</code> for finite difference
approximations to the gradient. See <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for more information on the other parameters.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-Hessian-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Hessian</code></a>, <a href="linear.html#dip-GradientMagnitude-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::GradientMagnitude</code></a>, <a href="linear.html#dip-GradientDirection-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::GradientDirection</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-GradientMagnitude-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-GradientMagnitude-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />GradientMagnitude</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the gradient magnitude of the image, equivalent to <code>dip::Norm( dip::Gradient( in ))</code>.</p>
<p>For non-scalar images, applies the operation to each image channel. See <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a> for information on the parameters.</p>
<p>By default this function uses Gaussian derivatives in the computation. Set <code>method = "finitediff"</code> for
finite difference approximations to the gradient. See <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for more information on the other
parameters.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a>, <a href="numeric.html#dip-Norm-T-dip-uint--ConstSampleIterator&lt;T&gt;-"><code>dip::Norm</code></a>, <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-GradientDirection-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::GradientDirection</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-GradientDirection-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-GradientDirection-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />GradientDirection</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the direction of the gradient of the image, equivalent to <code>dip::Angle( dip::Gradient( in ))</code>.</p>
<p>The input image must be scalar. For a 2D gradient, the output is scalar also, containing the angle of the
gradient to the x-axis. For a 3D gradient, the output has two tensor components, containing the azimuth and
inclination. See <a href="dip-Vertex-T.html#dip-Angle-T-Vertex&lt;T&gt;-CL-Vertex&lt;T&gt;-CL"><code>dip::Angle</code></a> for an explanation.</p>
<p>See <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a> for information on the parameters.</p>
<p>By default this function uses Gaussian derivatives in the computation. Set <code>method = "finitediff"</code> for
finite difference approximations to the gradient. See <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for more information on the other
parameters.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a>, <a href="dip-Vertex-T.html#dip-Angle-T-Vertex&lt;T&gt;-CL-Vertex&lt;T&gt;-CL"><code>dip::Angle</code></a>, <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-GradientMagnitude-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::GradientMagnitude</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Curl-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Curl-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />Curl</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the curl (rotation) of the 2D or 3D vector field <code>in</code>.</p>
<p>Curl is defined as by <span class="m-math"><svg style="width: 6.467em; height: 0.835em; vertical-align: -0.012em;  vertical-align: -0.012em;" viewBox=".3 -8.23 64.67 8.35">
<title>
\(\mathrm{curl}\,\mathbf{f} = \nabla \times \mathbf{f}\)
</title>
<defs>
<path id='eq130-g7-2' d='M6.91-.42L4.25-3.06L6.91-5.72L6.43-6.19L3.79-3.54L1.14-6.19L.67-5.72L3.31-3.06L.67-.42L1.14 .06L3.79-2.6L6.43 .06L6.91-.42Z'/>
<path id='eq130-g7-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
<path id='eq130-g4-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq130-g2-102' d='M4.63-7.04C4.63-7.74 3.94-8.23 2.93-8.23C2.13-8.23 1.51-7.94 1.19-7.42C.93-7 .85-6.52 .85-5.49H.17V-4.97H.85V-1C.85-.49 .71-.35 .17-.29V0H3.48V-.29C2.64-.31 2.5-.45 2.5-1.23V-4.97H3.54V-5.49H2.5V-6.94C2.5-7.6 2.67-7.86 3.1-7.86C3.31-7.86 3.44-7.78 3.44-7.63C3.44-7.58 3.42-7.5 3.33-7.38C3.23-7.21 3.18-7.09 3.18-6.96C3.18-6.59 3.49-6.3 3.89-6.3C4.34-6.3 4.63-6.6 4.63-7.04Z'/>
<path id='eq130-g11-99' d='M4.91-1.75L4.74-1.86C4.17-1.02 3.74-.74 3.06-.74C1.97-.74 1.21-1.69 1.21-3.06C1.21-4.3 1.87-5.13 2.83-5.13C3.26-5.13 3.42-5 3.54-4.56L3.61-4.3C3.7-3.95 3.92-3.75 4.18-3.75C4.49-3.75 4.74-3.98 4.74-4.25C4.74-4.92 3.91-5.48 2.91-5.48C2.35-5.48 1.77-5.26 1.3-4.87C.66-4.34 .3-3.51 .3-2.53C.3-.99 1.24 .12 2.56 .12C3.07 .12 3.53-.05 3.93-.38C4.29-.67 4.53-1.01 4.91-1.75Z'/>
<path id='eq130-g11-108' d='M3.06 0V-.18C2.3-.23 2.17-.35 2.17-1V-8.11L2.12-8.13C1.5-7.93 1.05-7.81 .23-7.61V-7.42H.3C.43-7.43 .57-7.44 .67-7.44C1.05-7.44 1.17-7.28 1.17-6.72V-1.04C1.17-.39 1-.24 .25-.18V0H3.06Z'/>
<path id='eq130-g11-114' d='M3.99-4.85C3.99-5.24 3.74-5.48 3.33-5.48C2.83-5.48 2.49-5.2 1.91-4.36V-5.46L1.85-5.48C1.21-5.22 .79-5.06 .08-4.84V-4.65C.25-4.68 .36-4.69 .5-4.69C.8-4.69 .91-4.5 .91-3.98V-1C.91-.4 .82-.32 .06-.18V0H2.92V-.18C2.11-.21 1.91-.39 1.91-1.07V-3.75C1.91-4.13 2.42-4.73 2.74-4.73C2.81-4.73 2.92-4.67 3.05-4.55C3.24-4.38 3.37-4.31 3.53-4.31C3.81-4.31 3.99-4.51 3.99-4.85Z'/>
<path id='eq130-g11-117' d='M5.71-.43V-.6H5.65C5.1-.6 4.97-.73 4.97-1.27V-5.36H3.08V-5.16C3.82-5.12 3.97-5 3.97-4.41V-1.61C3.97-1.29 3.91-1.11 3.76-1C3.43-.71 3.06-.57 2.69-.57C2.23-.57 1.85-.98 1.85-1.48V-5.36H.11V-5.19C.68-5.16 .85-4.98 .85-4.43V-1.43C.85-.49 1.42 .12 2.29 .12C2.73 .12 3.19-.07 3.51-.39L4.03-.91V.08L4.07 .11C4.67-.13 5.1-.26 5.71-.43Z'/>
</defs>
<g id='eq130-page1'>
<use x='0' y='0' xlink:href='#eq130-g11-99'/>
<use x='5.31' y='0' xlink:href='#eq130-g11-117'/>
<use x='11.29' y='0' xlink:href='#eq130-g11-114'/>
<use x='15.03' y='0' xlink:href='#eq130-g11-108'/>
<use x='20.34' y='0' xlink:href='#eq130-g2-102'/>
<use x='28.32' y='0' xlink:href='#eq130-g4-61'/>
<use x='39.36' y='0' xlink:href='#eq130-g7-114'/>
<use x='50.07' y='0' xlink:href='#eq130-g7-2'/>
<use x='60.33' y='0' xlink:href='#eq130-g2-102'/>
</g>
</svg></span>, for a 3-vector
<span class="m-math"><svg style="width: 6.825em; height: 1.213em; vertical-align: -0.359em;  vertical-align: -0.361em;" viewBox=".17 -8.54 68.25 12.13">
<title>
\(\mathbf{f}=(f_x, f_y, f_z)\)
</title>
<defs>
<use id='eq131-g13-53' xlink:href='#eq131-g10-53' transform='scale(1.36)'/>
<use id='eq131-g13-150' xlink:href='#eq131-g10-150' transform='scale(1.36)'/>
<path id='eq131-g4-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq131-g10-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq131-g10-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq131-g10-72' d='M3.72-3.37C3.72-3.63 3.5-3.85 3.24-3.85C3.04-3.85 2.9-3.72 2.9-3.53C2.9-3.39 2.97-3.3 3.14-3.19C3.31-3.09 3.37-3.01 3.37-2.89C3.37-2.54 3.06-1.87 2.31-.63L2.13-1.64C2-2.42 1.51-3.85 1.38-3.85H1.35L1.27-3.84L.41-3.69L.13-3.64V-3.49C.24-3.52 .31-3.53 .4-3.53C.75-3.53 .91-3.4 1.07-2.97C1.31-2.38 1.79-.42 1.79-.07C1.79 .03 1.76 .13 1.7 .24C1.63 .35 1.24 .86 1.08 1.03C.88 1.25 .78 1.32 .66 1.32C.6 1.32 .55 1.29 .45 1.22C.32 1.12 .24 1.07 .13 1.07C-.06 1.07-.21 1.22-.21 1.41C-.21 1.64-.03 1.8 .24 1.8C.73 1.8 1.68 .79 2.58-.71C3.31-1.91 3.72-2.87 3.72-3.37Z'/>
<path id='eq131-g10-73' d='M3.17 .04C3.17-.15 3.05-.27 2.86-.27C2.69-.27 2.57-.16 2.57 .01C2.57 .08 2.59 .16 2.65 .26C2.67 .31 2.69 .36 2.69 .39C2.69 .47 2.59 .52 2.45 .52C2.24 .52 2.13 .45 1.84 .09C1.46-.41 1.29-.52 .79-.64L3.32-3.64V-3.74H.84L.57-2.73L.71-2.7C.89-3.14 1-3.21 1.41-3.21H2.69L-.02 .03L.06 .11C.2 0 .31-.04 .45-.04C.68-.04 .96 .07 1.37 .32C1.81 .59 2.1 .71 2.35 .71C2.79 .71 3.17 .39 3.17 .04Z'/>
<path id='eq131-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq131-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq131-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq131-g2-102' d='M4.63-7.04C4.63-7.74 3.94-8.23 2.93-8.23C2.13-8.23 1.51-7.94 1.19-7.42C.93-7 .85-6.52 .85-5.49H.17V-4.97H.85V-1C.85-.49 .71-.35 .17-.29V0H3.48V-.29C2.64-.31 2.5-.45 2.5-1.23V-4.97H3.54V-5.49H2.5V-6.94C2.5-7.6 2.67-7.86 3.1-7.86C3.31-7.86 3.44-7.78 3.44-7.63C3.44-7.58 3.42-7.5 3.33-7.38C3.23-7.21 3.18-7.09 3.18-6.96C3.18-6.59 3.49-6.3 3.89-6.3C4.34-6.3 4.63-6.6 4.63-7.04Z'/>
</defs>
<g id='eq131-page1'>
<use x='0' y='0' xlink:href='#eq131-g2-102'/>
<use x='7.97' y='0' xlink:href='#eq131-g4-61'/>
<use x='19.49' y='0' xlink:href='#eq131-g7-185'/>
<use x='26.03' y='0' xlink:href='#eq131-g13-53'/>
<use x='29.48' y='1.79' xlink:href='#eq131-g10-71'/>
<use x='34.29' y='0' xlink:href='#eq131-g13-150'/>
<use x='41.48' y='0' xlink:href='#eq131-g13-53'/>
<use x='45.28' y='1.79' xlink:href='#eq131-g10-72'/>
<use x='50' y='0' xlink:href='#eq131-g13-150'/>
<use x='57.2' y='0' xlink:href='#eq131-g13-53'/>
<use x='60.85' y='1.79' xlink:href='#eq131-g10-73'/>
<use x='65.02' y='0' xlink:href='#eq131-g7-186'/>
</g>
</svg></span> (the vector image <code>in</code>), resulting in a 3-vector with components:</p>
<div class="m-math"><svg style="width: 13.477em; height: 8.751em; vertical-align: 0.005em; " viewBox="126.6 -87.56 134.77 87.51">
<title>
\begin{eqnarray*}
     (\mathrm{curl}\,\mathbf{f})_x &amp;=&amp; \frac{\partial}{\partial y} f_z - \frac{\partial}{\partial z} f_y \, ,
  \\ (\mathrm{curl}\,\mathbf{f})_y &amp;=&amp; \frac{\partial}{\partial z} f_x - \frac{\partial}{\partial x} f_z \, ,
  \\ (\mathrm{curl}\,\mathbf{f})_z &amp;=&amp; \frac{\partial}{\partial x} f_y - \frac{\partial}{\partial y} f_x \, .
\end{eqnarray*}
</title>
<defs>
<use id='eq129-g13-53' xlink:href='#eq129-g10-53' transform='scale(1.36)'/>
<use id='eq129-g13-71' xlink:href='#eq129-g10-71' transform='scale(1.36)'/>
<use id='eq129-g13-72' xlink:href='#eq129-g10-72' transform='scale(1.36)'/>
<use id='eq129-g13-73' xlink:href='#eq129-g10-73' transform='scale(1.36)'/>
<use id='eq129-g13-109' xlink:href='#eq129-g10-109' transform='scale(1.36)'/>
<use id='eq129-g13-149' xlink:href='#eq129-g10-149' transform='scale(1.36)'/>
<use id='eq129-g13-150' xlink:href='#eq129-g10-150' transform='scale(1.36)'/>
<path id='eq129-g2-102' d='M4.63-7.04C4.63-7.74 3.94-8.23 2.93-8.23C2.13-8.23 1.51-7.94 1.19-7.42C.93-7 .85-6.52 .85-5.49H.17V-4.97H.85V-1C.85-.49 .71-.35 .17-.29V0H3.48V-.29C2.64-.31 2.5-.45 2.5-1.23V-4.97H3.54V-5.49H2.5V-6.94C2.5-7.6 2.67-7.86 3.1-7.86C3.31-7.86 3.44-7.78 3.44-7.63C3.44-7.58 3.42-7.5 3.33-7.38C3.23-7.21 3.18-7.09 3.18-6.96C3.18-6.59 3.49-6.3 3.89-6.3C4.34-6.3 4.63-6.6 4.63-7.04Z'/>
<path id='eq129-g4-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq129-g17-99' d='M4.91-1.75L4.74-1.86C4.17-1.02 3.74-.74 3.06-.74C1.97-.74 1.21-1.69 1.21-3.06C1.21-4.3 1.87-5.13 2.83-5.13C3.26-5.13 3.42-5 3.54-4.56L3.61-4.3C3.7-3.95 3.92-3.75 4.18-3.75C4.49-3.75 4.74-3.98 4.74-4.25C4.74-4.92 3.91-5.48 2.91-5.48C2.35-5.48 1.77-5.26 1.3-4.87C.66-4.34 .3-3.51 .3-2.53C.3-.99 1.24 .12 2.56 .12C3.07 .12 3.53-.05 3.93-.38C4.29-.67 4.53-1.01 4.91-1.75Z'/>
<path id='eq129-g17-108' d='M3.06 0V-.18C2.3-.23 2.17-.35 2.17-1V-8.11L2.12-8.13C1.5-7.93 1.05-7.81 .23-7.61V-7.42H.3C.43-7.43 .57-7.44 .67-7.44C1.05-7.44 1.17-7.28 1.17-6.72V-1.04C1.17-.39 1-.24 .25-.18V0H3.06Z'/>
<path id='eq129-g17-114' d='M3.99-4.85C3.99-5.24 3.74-5.48 3.33-5.48C2.83-5.48 2.49-5.2 1.91-4.36V-5.46L1.85-5.48C1.21-5.22 .79-5.06 .08-4.84V-4.65C.25-4.68 .36-4.69 .5-4.69C.8-4.69 .91-4.5 .91-3.98V-1C.91-.4 .82-.32 .06-.18V0H2.92V-.18C2.11-.21 1.91-.39 1.91-1.07V-3.75C1.91-4.13 2.42-4.73 2.74-4.73C2.81-4.73 2.92-4.67 3.05-4.55C3.24-4.38 3.37-4.31 3.53-4.31C3.81-4.31 3.99-4.51 3.99-4.85Z'/>
<path id='eq129-g17-117' d='M5.71-.43V-.6H5.65C5.1-.6 4.97-.73 4.97-1.27V-5.36H3.08V-5.16C3.82-5.12 3.97-5 3.97-4.41V-1.61C3.97-1.29 3.91-1.11 3.76-1C3.43-.71 3.06-.57 2.69-.57C2.23-.57 1.85-.98 1.85-1.48V-5.36H.11V-5.19C.68-5.16 .85-4.98 .85-4.43V-1.43C.85-.49 1.42 .12 2.29 .12C2.73 .12 3.19-.07 3.51-.39L4.03-.91V.08L4.07 .11C4.67-.13 5.1-.26 5.71-.43Z'/>
<path id='eq129-g10-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq129-g10-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq129-g10-72' d='M3.72-3.37C3.72-3.63 3.5-3.85 3.24-3.85C3.04-3.85 2.9-3.72 2.9-3.53C2.9-3.39 2.97-3.3 3.14-3.19C3.31-3.09 3.37-3.01 3.37-2.89C3.37-2.54 3.06-1.87 2.31-.63L2.13-1.64C2-2.42 1.51-3.85 1.38-3.85H1.35L1.27-3.84L.41-3.69L.13-3.64V-3.49C.24-3.52 .31-3.53 .4-3.53C.75-3.53 .91-3.4 1.07-2.97C1.31-2.38 1.79-.42 1.79-.07C1.79 .03 1.76 .13 1.7 .24C1.63 .35 1.24 .86 1.08 1.03C.88 1.25 .78 1.32 .66 1.32C.6 1.32 .55 1.29 .45 1.22C.32 1.12 .24 1.07 .13 1.07C-.06 1.07-.21 1.22-.21 1.41C-.21 1.64-.03 1.8 .24 1.8C.73 1.8 1.68 .79 2.58-.71C3.31-1.91 3.72-2.87 3.72-3.37Z'/>
<path id='eq129-g10-73' d='M3.17 .04C3.17-.15 3.05-.27 2.86-.27C2.69-.27 2.57-.16 2.57 .01C2.57 .08 2.59 .16 2.65 .26C2.67 .31 2.69 .36 2.69 .39C2.69 .47 2.59 .52 2.45 .52C2.24 .52 2.13 .45 1.84 .09C1.46-.41 1.29-.52 .79-.64L3.32-3.64V-3.74H.84L.57-2.73L.71-2.7C.89-3.14 1-3.21 1.41-3.21H2.69L-.02 .03L.06 .11C.2 0 .31-.04 .45-.04C.68-.04 .96 .07 1.37 .32C1.81 .59 2.1 .71 2.35 .71C2.79 .71 3.17 .39 3.17 .04Z'/>
<path id='eq129-g10-109' d='M4.3-3.76C4.3-5.02 3.91-6.04 2.97-6.04C2.24-6.04 1.44-5.35 1.44-4.95C1.44-4.66 1.67-4.55 1.84-4.55C2.03-4.55 2.14-4.69 2.16-4.72C2.13-4.74 2.08-4.82 2.08-4.94C2.08-5.02 2.24-5.78 2.99-5.78C3.62-5.78 3.76-4.97 3.76-4.26C3.76-3.73 3.68-3.26 3.68-3.25H3.67C3.67-3.26 3.33-3.79 2.64-3.79C.89-3.79 .17-2.1 .17-1.2C.17-.38 .65 .14 1.62 .14C3.12 .14 4.3-1.39 4.3-3.76ZM3.3-2.78C3.3-2.55 3.07-.07 1.68-.07C1.18-.07 .95-.35 .95-.91C.95-1.46 1.32-3.58 2.58-3.58C3.07-3.58 3.3-3.29 3.3-2.78Z'/>
<path id='eq129-g10-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
<path id='eq129-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq129-g7-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq129-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq129-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
</defs>
<g id='eq129-page1'>
<use x='126.29' y='-71.22' xlink:href='#eq129-g7-185'/>
<use x='130.75' y='-71.22' xlink:href='#eq129-g17-99'/>
<use x='136.05' y='-71.22' xlink:href='#eq129-g17-117'/>
<use x='142.03' y='-71.22' xlink:href='#eq129-g17-114'/>
<use x='145.77' y='-71.22' xlink:href='#eq129-g17-108'/>
<use x='151.09' y='-71.22' xlink:href='#eq129-g2-102'/>
<use x='155.74' y='-71.22' xlink:href='#eq129-g7-186'/>
<use x='159.96' y='-69.43' xlink:href='#eq129-g10-71'/>
<use x='174.74' y='-71.22' xlink:href='#eq129-g4-61'/>
<use x='196.87' y='-79.32' xlink:href='#eq129-g13-109'/>
<rect x='193.5' y='-74.63' height='.67' width='13.22'/>
<use x='193.75' y='-63.02' xlink:href='#eq129-g13-109'/>
<use x='200.96' y='-63.02' xlink:href='#eq129-g13-72'/>
<use x='210' y='-71.22' xlink:href='#eq129-g13-53'/>
<use x='213.65' y='-69.43' xlink:href='#eq129-g10-73'/>
<use x='220.48' y='-71.22' xlink:href='#eq129-g7-0'/>
<use x='234.84' y='-79.32' xlink:href='#eq129-g13-109'/>
<rect x='231.94' y='-74.63' height='.67' width='12.28'/>
<use x='232.19' y='-63.02' xlink:href='#eq129-g13-109'/>
<use x='239.2' y='-63.02' xlink:href='#eq129-g13-73'/>
<use x='247.49' y='-71.22' xlink:href='#eq129-g13-53'/>
<use x='251.28' y='-69.43' xlink:href='#eq129-g10-72'/>
<use x='258' y='-71.22' xlink:href='#eq129-g13-150'/>
<use x='126.03' y='-40.2' xlink:href='#eq129-g7-185'/>
<use x='130.49' y='-40.2' xlink:href='#eq129-g17-99'/>
<use x='135.8' y='-40.2' xlink:href='#eq129-g17-117'/>
<use x='141.77' y='-40.2' xlink:href='#eq129-g17-114'/>
<use x='145.52' y='-40.2' xlink:href='#eq129-g17-108'/>
<use x='150.83' y='-40.2' xlink:href='#eq129-g2-102'/>
<use x='155.48' y='-40.2' xlink:href='#eq129-g7-186'/>
<use x='160.05' y='-38.4' xlink:href='#eq129-g10-72'/>
<use x='174.74' y='-40.2' xlink:href='#eq129-g4-61'/>
<use x='196.4' y='-48.29' xlink:href='#eq129-g13-109'/>
<rect x='193.5' y='-43.6' height='.67' width='12.28'/>
<use x='193.75' y='-32' xlink:href='#eq129-g13-109'/>
<use x='200.77' y='-32' xlink:href='#eq129-g13-73'/>
<use x='209.05' y='-40.2' xlink:href='#eq129-g13-53'/>
<use x='212.5' y='-38.4' xlink:href='#eq129-g10-71'/>
<use x='219.97' y='-40.2' xlink:href='#eq129-g7-0'/>
<use x='234.62' y='-48.29' xlink:href='#eq129-g13-109'/>
<rect x='231.43' y='-43.6' height='.67' width='12.87'/>
<use x='231.68' y='-32' xlink:href='#eq129-g13-109'/>
<use x='238.41' y='-32' xlink:href='#eq129-g13-71'/>
<use x='247.57' y='-40.2' xlink:href='#eq129-g13-53'/>
<use x='251.22' y='-38.4' xlink:href='#eq129-g10-73'/>
<use x='257.39' y='-40.2' xlink:href='#eq129-g13-150'/>
<use x='126.72' y='-10.71' xlink:href='#eq129-g7-185'/>
<use x='131.18' y='-10.71' xlink:href='#eq129-g17-99'/>
<use x='136.49' y='-10.71' xlink:href='#eq129-g17-117'/>
<use x='142.47' y='-10.71' xlink:href='#eq129-g17-114'/>
<use x='146.21' y='-10.71' xlink:href='#eq129-g17-108'/>
<use x='151.52' y='-10.71' xlink:href='#eq129-g2-102'/>
<use x='156.17' y='-10.71' xlink:href='#eq129-g7-186'/>
<use x='160.6' y='-8.91' xlink:href='#eq129-g10-73'/>
<use x='174.74' y='-10.71' xlink:href='#eq129-g4-61'/>
<use x='196.7' y='-18.8' xlink:href='#eq129-g13-109'/>
<rect x='193.5' y='-14.11' height='.67' width='12.87'/>
<use x='193.75' y='-2.5' xlink:href='#eq129-g13-109'/>
<use x='200.48' y='-2.5' xlink:href='#eq129-g13-71'/>
<use x='209.65' y='-10.71' xlink:href='#eq129-g13-53'/>
<use x='213.44' y='-8.91' xlink:href='#eq129-g10-72'/>
<use x='220.82' y='-10.71' xlink:href='#eq129-g7-0'/>
<use x='235.65' y='-18.8' xlink:href='#eq129-g13-109'/>
<rect x='232.28' y='-14.11' height='.67' width='13.22'/>
<use x='232.53' y='-2.5' xlink:href='#eq129-g13-109'/>
<use x='239.74' y='-2.5' xlink:href='#eq129-g13-72'/>
<use x='248.77' y='-10.71' xlink:href='#eq129-g13-53'/>
<use x='252.22' y='-8.91' xlink:href='#eq129-g10-71'/>
<use x='259.22' y='-10.71' xlink:href='#eq129-g13-149'/>
</g>
</svg></div>
<p>For the 2D case, <span class="m-math"><svg style="width: 0.872em; height: 1.058em; vertical-align: -0.250em;  vertical-align: -0.251em;" viewBox=".33 -8.08 8.72 10.58">
<title>
\(f_z\)
</title>
<defs>
<use id='eq132-g4-53' xlink:href='#eq132-g1-53' transform='scale(1.36)'/>
<path id='eq132-g1-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq132-g1-73' d='M3.17 .04C3.17-.15 3.05-.27 2.86-.27C2.69-.27 2.57-.16 2.57 .01C2.57 .08 2.59 .16 2.65 .26C2.67 .31 2.69 .36 2.69 .39C2.69 .47 2.59 .52 2.45 .52C2.24 .52 2.13 .45 1.84 .09C1.46-.41 1.29-.52 .79-.64L3.32-3.64V-3.74H.84L.57-2.73L.71-2.7C.89-3.14 1-3.21 1.41-3.21H2.69L-.02 .03L.06 .11C.2 0 .31-.04 .45-.04C.68-.04 .96 .07 1.37 .32C1.81 .59 2.1 .71 2.35 .71C2.79 .71 3.17 .39 3.17 .04Z'/>
</defs>
<g id='eq132-page1'>
<use x='2.08' y='0' xlink:href='#eq132-g4-53'/>
<use x='5.73' y='1.79' xlink:href='#eq132-g1-73'/>
</g>
</svg></span> is assumed to be zero, and only the z-component of the curl is computed, yielding
a scalar output.</p>
<p><code>in</code> is expected to be a 2D or 3D image with a 2-vector or a 3-vector tensor representation, respectively.
However, the image can have more dimensions if they are excluded from processing through <code>process</code>.
See <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a> for information on the parameters.</p>
<p>By default this function uses Gaussian derivatives in the computation. Set <code>method = "finitediff"</code> for
finite difference approximations to the gradient. See <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for more information on the other
parameters.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a>, <a href="linear.html#dip-Divergence-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Divergence</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Divergence-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Divergence-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />Divergence</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the divergence of the vector field <code>in</code>.</p>
<p>Divergence is defined as</p>
<div class="m-math"><svg style="width: 17.932em; height: 2.699em; vertical-align: 0.005em; " viewBox="104.37 -27.04 179.32 26.99">
<title>
\[ \mathrm{div}\,\mathbf{f} = \nabla \cdot \mathbf{f} =
   \frac{\partial}{\partial x}f_x + \frac{\partial}{\partial y}f_y + \frac{\partial}{\partial z}f_z \; , \]
</title>
<defs>
<use id='eq133-g13-53' xlink:href='#eq133-g10-53' transform='scale(1.36)'/>
<use id='eq133-g13-71' xlink:href='#eq133-g10-71' transform='scale(1.36)'/>
<use id='eq133-g13-72' xlink:href='#eq133-g10-72' transform='scale(1.36)'/>
<use id='eq133-g13-73' xlink:href='#eq133-g10-73' transform='scale(1.36)'/>
<use id='eq133-g13-109' xlink:href='#eq133-g10-109' transform='scale(1.36)'/>
<use id='eq133-g13-150' xlink:href='#eq133-g10-150' transform='scale(1.36)'/>
<path id='eq133-g10-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq133-g10-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq133-g10-72' d='M3.72-3.37C3.72-3.63 3.5-3.85 3.24-3.85C3.04-3.85 2.9-3.72 2.9-3.53C2.9-3.39 2.97-3.3 3.14-3.19C3.31-3.09 3.37-3.01 3.37-2.89C3.37-2.54 3.06-1.87 2.31-.63L2.13-1.64C2-2.42 1.51-3.85 1.38-3.85H1.35L1.27-3.84L.41-3.69L.13-3.64V-3.49C.24-3.52 .31-3.53 .4-3.53C.75-3.53 .91-3.4 1.07-2.97C1.31-2.38 1.79-.42 1.79-.07C1.79 .03 1.76 .13 1.7 .24C1.63 .35 1.24 .86 1.08 1.03C.88 1.25 .78 1.32 .66 1.32C.6 1.32 .55 1.29 .45 1.22C.32 1.12 .24 1.07 .13 1.07C-.06 1.07-.21 1.22-.21 1.41C-.21 1.64-.03 1.8 .24 1.8C.73 1.8 1.68 .79 2.58-.71C3.31-1.91 3.72-2.87 3.72-3.37Z'/>
<path id='eq133-g10-73' d='M3.17 .04C3.17-.15 3.05-.27 2.86-.27C2.69-.27 2.57-.16 2.57 .01C2.57 .08 2.59 .16 2.65 .26C2.67 .31 2.69 .36 2.69 .39C2.69 .47 2.59 .52 2.45 .52C2.24 .52 2.13 .45 1.84 .09C1.46-.41 1.29-.52 .79-.64L3.32-3.64V-3.74H.84L.57-2.73L.71-2.7C.89-3.14 1-3.21 1.41-3.21H2.69L-.02 .03L.06 .11C.2 0 .31-.04 .45-.04C.68-.04 .96 .07 1.37 .32C1.81 .59 2.1 .71 2.35 .71C2.79 .71 3.17 .39 3.17 .04Z'/>
<path id='eq133-g10-109' d='M4.3-3.76C4.3-5.02 3.91-6.04 2.97-6.04C2.24-6.04 1.44-5.35 1.44-4.95C1.44-4.66 1.67-4.55 1.84-4.55C2.03-4.55 2.14-4.69 2.16-4.72C2.13-4.74 2.08-4.82 2.08-4.94C2.08-5.02 2.24-5.78 2.99-5.78C3.62-5.78 3.76-4.97 3.76-4.26C3.76-3.73 3.68-3.26 3.68-3.25H3.67C3.67-3.26 3.33-3.79 2.64-3.79C.89-3.79 .17-2.1 .17-1.2C.17-.38 .65 .14 1.62 .14C3.12 .14 4.3-1.39 4.3-3.76ZM3.3-2.78C3.3-2.55 3.07-.07 1.68-.07C1.18-.07 .95-.35 .95-.91C.95-1.46 1.32-3.58 2.58-3.58C3.07-3.58 3.3-3.29 3.3-2.78Z'/>
<path id='eq133-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq133-g7-1' d='M2.16-3.05C2.16-3.42 1.85-3.73 1.49-3.73S.83-3.43 .83-3.05C.83-2.6 1.24-2.41 1.49-2.41S2.16-2.61 2.16-3.05Z'/>
<path id='eq133-g7-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
<path id='eq133-g7-184' d='M3.39-3.45H.74V-2.67H3.39V0H4.18V-2.67H6.84V-3.45H4.18V-6.12H3.39V-3.45Z'/>
<path id='eq133-g4-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq133-g2-102' d='M4.63-7.04C4.63-7.74 3.94-8.23 2.93-8.23C2.13-8.23 1.51-7.94 1.19-7.42C.93-7 .85-6.52 .85-5.49H.17V-4.97H.85V-1C.85-.49 .71-.35 .17-.29V0H3.48V-.29C2.64-.31 2.5-.45 2.5-1.23V-4.97H3.54V-5.49H2.5V-6.94C2.5-7.6 2.67-7.86 3.1-7.86C3.31-7.86 3.44-7.78 3.44-7.63C3.44-7.58 3.42-7.5 3.33-7.38C3.23-7.21 3.18-7.09 3.18-6.96C3.18-6.59 3.49-6.3 3.89-6.3C4.34-6.3 4.63-6.6 4.63-7.04Z'/>
<path id='eq133-g17-100' d='M5.85-.5V-.69C5.63-.68 5.61-.68 5.57-.68C5.15-.68 5.05-.81 5.05-1.36V-8.11L4.99-8.13C4.42-7.93 4-7.81 3.24-7.61V-7.42C3.33-7.43 3.41-7.43 3.5-7.43C3.94-7.43 4.05-7.31 4.05-6.82V-4.97C3.6-5.35 3.28-5.48 2.8-5.48C1.43-5.48 .32-4.13 .32-2.44C.32-.92 1.21 .12 2.53 .12C3.19 .12 3.64-.12 4.05-.68V.08L4.1 .12L5.85-.5ZM4.05-1.21C4.05-1.13 3.97-.99 3.85-.86C3.63-.62 3.33-.5 2.99-.5C2-.5 1.35-1.45 1.35-2.92C1.35-4.26 1.93-5.15 2.83-5.15C3.47-5.15 4.05-4.59 4.05-3.95V-1.21Z'/>
<path id='eq133-g17-105' d='M3.01 0V-.18C2.23-.24 2.13-.36 2.13-1.21V-5.44L2.08-5.48L.24-4.82V-4.65L.33-4.66C.48-4.68 .63-4.69 .74-4.69C1.02-4.69 1.13-4.5 1.13-3.98V-1.21C1.13-.36 1.01-.23 .19-.18V0H3.01ZM2.24-7.53C2.24-7.86 1.98-8.13 1.63-8.13C1.3-8.13 1.02-7.86 1.02-7.53C1.02-7.18 1.3-6.92 1.63-6.92C1.98-6.92 2.24-7.18 2.24-7.53Z'/>
<path id='eq133-g17-118' d='M5.68-5.18V-5.36H4.03V-5.18C4.41-5.15 4.59-5.03 4.59-4.8C4.59-4.68 4.56-4.56 4.51-4.44L3.33-1.36L2.12-4.41C2.05-4.57 2.01-4.74 2.01-4.85C2.01-5.06 2.14-5.15 2.56-5.18V-5.36H.23V-5.18C.68-5.16 .76-5.04 1.31-3.81L2.74-.39C2.76-.32 2.8-.24 2.83-.14C2.91 .07 2.98 .17 3.05 .17S3.2 .01 3.38-.43L4.91-4.25C5.25-5.06 5.32-5.15 5.68-5.18Z'/>
</defs>
<g id='eq133-page1'>
<use x='104.05' y='-10.71' xlink:href='#eq133-g17-100'/>
<use x='110.03' y='-10.71' xlink:href='#eq133-g17-105'/>
<use x='113.35' y='-10.71' xlink:href='#eq133-g17-118'/>
<use x='121.32' y='-10.71' xlink:href='#eq133-g2-102'/>
<use x='129.29' y='-10.71' xlink:href='#eq133-g4-61'/>
<use x='140.34' y='-10.71' xlink:href='#eq133-g7-114'/>
<use x='151.17' y='-10.71' xlink:href='#eq133-g7-1'/>
<use x='156.94' y='-10.71' xlink:href='#eq133-g2-102'/>
<use x='164.91' y='-10.71' xlink:href='#eq133-g4-61'/>
<use x='180.22' y='-18.8' xlink:href='#eq133-g13-109'/>
<rect x='177.03' y='-14.11' height='.67' width='12.87'/>
<use x='177.28' y='-2.5' xlink:href='#eq133-g13-109'/>
<use x='184.01' y='-2.5' xlink:href='#eq133-g13-71'/>
<use x='193.17' y='-10.71' xlink:href='#eq133-g13-53'/>
<use x='196.62' y='-8.91' xlink:href='#eq133-g10-71'/>
<use x='204.09' y='-10.71' xlink:href='#eq133-g7-184'/>
<use x='218.92' y='-18.8' xlink:href='#eq133-g13-109'/>
<rect x='215.54' y='-14.11' height='.67' width='13.22'/>
<use x='215.8' y='-2.5' xlink:href='#eq133-g13-109'/>
<use x='223' y='-2.5' xlink:href='#eq133-g13-72'/>
<use x='232.04' y='-10.71' xlink:href='#eq133-g13-53'/>
<use x='235.84' y='-8.91' xlink:href='#eq133-g10-72'/>
<use x='243.22' y='-10.71' xlink:href='#eq133-g7-184'/>
<use x='257.57' y='-18.8' xlink:href='#eq133-g13-109'/>
<rect x='254.67' y='-14.11' height='.67' width='12.28'/>
<use x='254.92' y='-2.5' xlink:href='#eq133-g13-109'/>
<use x='261.94' y='-2.5' xlink:href='#eq133-g13-73'/>
<use x='270.23' y='-10.71' xlink:href='#eq133-g13-53'/>
<use x='273.88' y='-8.91' xlink:href='#eq133-g10-73'/>
<use x='281.37' y='-10.71' xlink:href='#eq133-g13-150'/>
</g>
</svg></div>
<p>with <span class="m-math"><svg style="width: 6.825em; height: 1.213em; vertical-align: -0.359em;  vertical-align: -0.361em;" viewBox=".17 -8.54 68.25 12.13">
<title>
\(\mathbf{f}=(f_x, f_y, f_z)\)
</title>
<defs>
<use id='eq134-g13-53' xlink:href='#eq134-g10-53' transform='scale(1.36)'/>
<use id='eq134-g13-150' xlink:href='#eq134-g10-150' transform='scale(1.36)'/>
<path id='eq134-g4-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq134-g10-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq134-g10-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq134-g10-72' d='M3.72-3.37C3.72-3.63 3.5-3.85 3.24-3.85C3.04-3.85 2.9-3.72 2.9-3.53C2.9-3.39 2.97-3.3 3.14-3.19C3.31-3.09 3.37-3.01 3.37-2.89C3.37-2.54 3.06-1.87 2.31-.63L2.13-1.64C2-2.42 1.51-3.85 1.38-3.85H1.35L1.27-3.84L.41-3.69L.13-3.64V-3.49C.24-3.52 .31-3.53 .4-3.53C.75-3.53 .91-3.4 1.07-2.97C1.31-2.38 1.79-.42 1.79-.07C1.79 .03 1.76 .13 1.7 .24C1.63 .35 1.24 .86 1.08 1.03C.88 1.25 .78 1.32 .66 1.32C.6 1.32 .55 1.29 .45 1.22C.32 1.12 .24 1.07 .13 1.07C-.06 1.07-.21 1.22-.21 1.41C-.21 1.64-.03 1.8 .24 1.8C.73 1.8 1.68 .79 2.58-.71C3.31-1.91 3.72-2.87 3.72-3.37Z'/>
<path id='eq134-g10-73' d='M3.17 .04C3.17-.15 3.05-.27 2.86-.27C2.69-.27 2.57-.16 2.57 .01C2.57 .08 2.59 .16 2.65 .26C2.67 .31 2.69 .36 2.69 .39C2.69 .47 2.59 .52 2.45 .52C2.24 .52 2.13 .45 1.84 .09C1.46-.41 1.29-.52 .79-.64L3.32-3.64V-3.74H.84L.57-2.73L.71-2.7C.89-3.14 1-3.21 1.41-3.21H2.69L-.02 .03L.06 .11C.2 0 .31-.04 .45-.04C.68-.04 .96 .07 1.37 .32C1.81 .59 2.1 .71 2.35 .71C2.79 .71 3.17 .39 3.17 .04Z'/>
<path id='eq134-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq134-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq134-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq134-g2-102' d='M4.63-7.04C4.63-7.74 3.94-8.23 2.93-8.23C2.13-8.23 1.51-7.94 1.19-7.42C.93-7 .85-6.52 .85-5.49H.17V-4.97H.85V-1C.85-.49 .71-.35 .17-.29V0H3.48V-.29C2.64-.31 2.5-.45 2.5-1.23V-4.97H3.54V-5.49H2.5V-6.94C2.5-7.6 2.67-7.86 3.1-7.86C3.31-7.86 3.44-7.78 3.44-7.63C3.44-7.58 3.42-7.5 3.33-7.38C3.23-7.21 3.18-7.09 3.18-6.96C3.18-6.59 3.49-6.3 3.89-6.3C4.34-6.3 4.63-6.6 4.63-7.04Z'/>
</defs>
<g id='eq134-page1'>
<use x='0' y='0' xlink:href='#eq134-g2-102'/>
<use x='7.97' y='0' xlink:href='#eq134-g4-61'/>
<use x='19.49' y='0' xlink:href='#eq134-g7-185'/>
<use x='26.03' y='0' xlink:href='#eq134-g13-53'/>
<use x='29.48' y='1.79' xlink:href='#eq134-g10-71'/>
<use x='34.29' y='0' xlink:href='#eq134-g13-150'/>
<use x='41.48' y='0' xlink:href='#eq134-g13-53'/>
<use x='45.28' y='1.79' xlink:href='#eq134-g10-72'/>
<use x='50' y='0' xlink:href='#eq134-g13-150'/>
<use x='57.2' y='0' xlink:href='#eq134-g13-53'/>
<use x='60.85' y='1.79' xlink:href='#eq134-g10-73'/>
<use x='65.02' y='0' xlink:href='#eq134-g7-186'/>
</g>
</svg></span> the vector image <code>in</code>. This concept naturally extends to any number
of dimensions.</p>
<p><code>in</code> is expected to have as many dimensions as tensor components. However, the image
can have more dimensions if they are excluded from processing through <code>process</code>.
See <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a> for information on the parameters.</p>
<p>By default this function uses Gaussian derivatives in the computation. Set <code>method = "finitediff"</code> for
finite difference approximations to the gradient. See <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for more information on the other
parameters.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a>, <a href="linear.html#dip-Curl-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Curl</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Hessian-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Hessian-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />Hessian</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the Hessian of the image, resulting in a symmetric <em>NxN</em> tensor image, if the input
was <em>N</em>-dimensional.</p>
<p>The Hessian of input image <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em;  vertical-align: -0.247em;" viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq136-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq136-page1'>
<use x='2.08' y='0' xlink:href='#eq136-g1-53'/>
</g>
</svg></span> is given by <span class="m-math"><svg style="width: 5.269em; height: 1.251em; vertical-align: -0.247em;  vertical-align: -0.247em;" viewBox=".25 -10.04 52.69 12.51">
<title>
\(\mathbf{H} = \nabla \nabla^T f\)
</title>
<defs>
<path id='eq137-g7-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
<use id='eq137-g13-53' xlink:href='#eq137-g10-53' transform='scale(1.36)'/>
<path id='eq137-g4-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq137-g10-41' d='M5.53-5.7H.88L.52-4.36L.67-4.32C1.11-5.22 1.39-5.4 2.57-5.4C2.63-5.4 2.69-5.4 2.75-5.4L1.49-.79C1.35-.32 1.14-.18 .57-.14V0H3.1V-.14L2.77-.17C2.41-.19 2.31-.27 2.31-.54C2.31-.65 2.33-.73 2.42-1.05L3.63-5.4H4.11C4.74-5.4 5.02-5.18 5.02-4.69C5.02-4.58 5.01-4.45 5-4.3L5.14-4.28L5.53-5.7Z'/>
<path id='eq137-g10-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq137-g2-72' d='M9.04 0V-.3C8.18-.4 7.99-.56 7.99-1.14V-6.91C7.99-7.5 8.23-7.69 9.04-7.75V-8.05H4.99V-7.75C5.82-7.69 6.06-7.5 6.06-6.91V-4.44H3.19V-6.91C3.19-7.5 3.43-7.69 4.26-7.75V-8.05H.25V-7.75C1.05-7.68 1.26-7.5 1.26-6.91V-1.14C1.26-.56 1.08-.4 .25-.3V0H4.26V-.3C3.39-.39 3.19-.56 3.19-1.14V-3.88H6.06V-1.14C6.06-.56 5.86-.39 4.99-.3V0H9.04Z'/>
</defs>
<g id='eq137-page1'>
<use x='0' y='0' xlink:href='#eq137-g2-72'/>
<use x='12.62' y='0' xlink:href='#eq137-g4-61'/>
<use x='23.67' y='0' xlink:href='#eq137-g7-114'/>
<use x='31.84' y='0' xlink:href='#eq137-g7-114'/>
<use x='39.59' y='-4.34' xlink:href='#eq137-g10-41'/>
<use x='47.89' y='0' xlink:href='#eq137-g13-53'/>
</g>
</svg></span>, with tensor components</p>
<div class="m-math"><svg style="width: 8.367em; height: 3.014em; vertical-align: 0.003em; " viewBox="152.04 -30.17 83.67 30.14">
<title>
\[ \mathbf{H}_{i,j} = \frac{\partial^2}{\partial u_i \partial u_j} f \; . \]
</title>
<defs>
<path id='eq135-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<use id='eq135-g10-53' xlink:href='#eq135-g7-53' transform='scale(1.36)'/>
<use id='eq135-g10-68' xlink:href='#eq135-g7-68' transform='scale(1.36)'/>
<use id='eq135-g10-109' xlink:href='#eq135-g7-109' transform='scale(1.36)'/>
<use id='eq135-g10-149' xlink:href='#eq135-g7-149' transform='scale(1.36)'/>
<path id='eq135-g7-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq135-g7-56' d='M2.05-.9L1.94-1C1.56-.5 1.37-.31 1.22-.31C1.15-.31 1.08-.38 1.08-.45C1.08-.59 1.17-.85 1.22-1.02L1.99-3.83L1.97-3.85C1.08-3.69 .91-3.66 .57-3.63V-3.49C1.04-3.49 1.12-3.46 1.12-3.28C1.12-3.21 1.09-3.07 1.04-2.9L.62-1.35C.48-.83 .43-.58 .43-.4C.43-.08 .57 .1 .83 .1C1.24 .1 1.55-.17 2.05-.9ZM2.41-5.14C2.41-5.39 2.21-5.62 1.97-5.62S1.56-5.42 1.56-5.15C1.56-4.87 1.73-4.69 1.98-4.69C2.21-4.69 2.41-4.89 2.41-5.14Z'/>
<path id='eq135-g7-57' d='M1.24-.24L2.15-3.83L2.12-3.85C1.39-3.72 .92-3.65 .64-3.63V-3.49L.87-3.5H.93C1.18-3.5 1.28-3.42 1.28-3.22C1.28-3.14 1.25-2.95 1.14-2.52L.52 .03C.22 1.23 .02 1.61-.33 1.61C-.44 1.61-.49 1.57-.49 1.51C-.49 1.48-.48 1.46-.45 1.41C-.39 1.35-.38 1.3-.38 1.23C-.38 1.05-.53 .91-.73 .91S-1.08 1.07-1.08 1.28C-1.08 1.59-.79 1.81-.39 1.81C.37 1.81 .89 1.15 1.24-.24ZM2.63-5.14C2.63-5.39 2.43-5.62 2.19-5.62S1.74-5.42 1.74-5.15C1.74-4.87 1.95-4.69 2.2-4.69C2.43-4.69 2.63-4.89 2.63-5.14Z'/>
<path id='eq135-g7-68' d='M4.15-.94L4.03-1.02C3.56-.45 3.44-.33 3.3-.33C3.24-.33 3.21-.38 3.21-.48C3.21-.53 3.21-.53 3.37-1.16L4.06-3.77H3.42C2.94-2.48 2.85-2.27 2.45-1.64C1.93-.81 1.5-.37 1.22-.37C1.11-.37 1.04-.45 1.04-.59C1.04-.62 1.04-.64 1.05-.66L1.84-3.83L1.82-3.85C1.32-3.74 1-3.68 .51-3.62V-3.49C.84-3.49 .86-3.49 .93-3.44C.99-3.42 1.03-3.35 1.03-3.28C1.03-3.21 .99-2.99 .91-2.7L.59-1.46C.42-.82 .37-.55 .37-.38C.37-.06 .52 .1 .83 .1C1.45 .1 1.91-.38 2.92-2.06C2.66-1.1 2.52-.53 2.52-.34C2.52-.07 2.68 .08 2.94 .08C3.35 .08 3.55-.09 4.15-.94Z'/>
<path id='eq135-g7-109' d='M4.3-3.76C4.3-5.02 3.91-6.04 2.97-6.04C2.24-6.04 1.44-5.35 1.44-4.95C1.44-4.66 1.67-4.55 1.84-4.55C2.03-4.55 2.14-4.69 2.16-4.72C2.13-4.74 2.08-4.82 2.08-4.94C2.08-5.02 2.24-5.78 2.99-5.78C3.62-5.78 3.76-4.97 3.76-4.26C3.76-3.73 3.68-3.26 3.68-3.25H3.67C3.67-3.26 3.33-3.79 2.64-3.79C.89-3.79 .17-2.1 .17-1.2C.17-.38 .65 .14 1.62 .14C3.12 .14 4.3-1.39 4.3-3.76ZM3.3-2.78C3.3-2.55 3.07-.07 1.68-.07C1.18-.07 .95-.35 .95-.91C.95-1.46 1.32-3.58 2.58-3.58C3.07-3.58 3.3-3.29 3.3-2.78Z'/>
<path id='eq135-g7-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
<path id='eq135-g7-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq135-g4-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq135-g2-72' d='M9.04 0V-.3C8.18-.4 7.99-.56 7.99-1.14V-6.91C7.99-7.5 8.23-7.69 9.04-7.75V-8.05H4.99V-7.75C5.82-7.69 6.06-7.5 6.06-6.91V-4.44H3.19V-6.91C3.19-7.5 3.43-7.69 4.26-7.75V-8.05H.25V-7.75C1.05-7.68 1.26-7.5 1.26-6.91V-1.14C1.26-.56 1.08-.4 .25-.3V0H4.26V-.3C3.39-.39 3.19-.56 3.19-1.14V-3.88H6.06V-1.14C6.06-.56 5.86-.39 4.99-.3V0H9.04Z'/>
</defs>
<g id='eq135-page1'>
<use x='151.79' y='-11.83' xlink:href='#eq135-g2-72'/>
<use x='160.92' y='-10.04' xlink:href='#eq135-g7-56'/>
<use x='163.69' y='-10.04' xlink:href='#eq135-g7-150'/>
<use x='167.12' y='-10.04' xlink:href='#eq135-g7-57'/>
<use x='174.2' y='-11.83' xlink:href='#eq135-g4-61'/>
<use x='198.15' y='-19.92' xlink:href='#eq135-g10-109'/>
<use x='204.88' y='-24.26' xlink:href='#eq135-g14-50'/>
<rect x='186.32' y='-15.24' height='.67' width='35.02'/>
<use x='186.58' y='-3.63' xlink:href='#eq135-g10-109'/>
<use x='193.45' y='-3.63' xlink:href='#eq135-g10-68'/>
<use x='199.66' y='-1.84' xlink:href='#eq135-g7-56'/>
<use x='203.18' y='-3.63' xlink:href='#eq135-g10-109'/>
<use x='210.05' y='-3.63' xlink:href='#eq135-g10-68'/>
<use x='217.58' y='-1.84' xlink:href='#eq135-g7-57'/>
<use x='224.62' y='-11.83' xlink:href='#eq135-g10-53'/>
<use x='233.56' y='-11.83' xlink:href='#eq135-g10-149'/>
</g>
</svg></div>
<p>Each tensor component corresponds to one of the second-order derivatives.
Note that <span class="m-math"><svg style="width: 0.923em; height: 0.778em; vertical-align: -0.000em;  vertical-align: -0.000em;" viewBox=".22 -7.78 9.23 7.78">
<title>
\(H\)
</title>
<defs>
<path id='eq138-g1-29' d='M7.48 0V-.19C6.71-.27 6.55-.36 6.55-.69C6.55-.79 6.56-.88 6.59-.98L8.16-6.71C8.36-7.4 8.46-7.47 9.14-7.59V-7.78H6.19V-7.59C6.88-7.5 7.03-7.41 7.03-7.07C7.03-6.9 6.98-6.66 6.9-6.34L6.35-4.38H2.95L3.6-6.71C3.78-7.31 4.09-7.54 4.8-7.59V-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.07C2.47-6.9 2.43-6.66 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.83V-.19C2.12-.29 1.99-.37 1.99-.71C1.99-.8 2-.89 2.02-.98L2.81-3.88H6.21L5.43-1.07C5.24-.45 5-.27 4.23-.19V0H7.48Z'/>
</defs>
<g id='eq138-page1'>
<use x='.31' y='0' xlink:href='#eq138-g1-29'/>
</g>
</svg></span> is a symmetric matrix (order of differentiation does not matter). Duplicate entries
are not stored in the symmetric tensor image.</p>
<p>Image dimensions for which <code>process</code> is false do not participate in the set of dimensions that form the
Hessian matrix. Thus, a 5D image with only two dimensions selected by the <code>process</code> array will yield a 2-by-2
Hessian matrix.</p>
<p>By default this function uses Gaussian derivatives in the computation. Set <code>method = "finitediff"</code> for
finite difference approximations to the gradient. See <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for more information on the other
parameters.</p>
<p>The input image must be scalar.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a>, <a href="linear.html#dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Laplace</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />Laplace</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the Laplacian of the image, equivalent to <code>dip::Trace( dip::Hessian( in ))</code>, but more efficient.</p>
<p>The Laplacian of input image <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em;  vertical-align: -0.247em;" viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq141-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq141-page1'>
<use x='2.08' y='0' xlink:href='#eq141-g1-53'/>
</g>
</svg></span> is written as <span class="m-math"><svg style="width: 9.579em; height: 1.271em; vertical-align: -0.247em;  vertical-align: -0.247em;" viewBox=".49 -10.24 95.79 12.71">
<title>
\(\nabla\cdot\nabla f = \nabla^2 f = \Delta f\)
</title>
<defs>
<path id='eq142-g1-1' d='M7.36 0L4.03-8.04H3.82L.29 0H7.36ZM5.97-.5H1.07L3.62-6.26L5.97-.5Z'/>
<path id='eq142-g1-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq142-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq142-g11-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq142-g4-1' d='M2.16-3.05C2.16-3.42 1.85-3.73 1.49-3.73S.83-3.43 .83-3.05C.83-2.6 1.24-2.41 1.49-2.41S2.16-2.61 2.16-3.05Z'/>
<path id='eq142-g4-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
</defs>
<g id='eq142-page1'>
<use x='.12' y='0' xlink:href='#eq142-g4-114'/>
<use x='10.95' y='0' xlink:href='#eq142-g4-1'/>
<use x='16.84' y='0' xlink:href='#eq142-g4-114'/>
<use x='26.98' y='0' xlink:href='#eq142-g7-53'/>
<use x='35.72' y='0' xlink:href='#eq142-g1-61'/>
<use x='46.77' y='0' xlink:href='#eq142-g4-114'/>
<use x='54.83' y='-4.34' xlink:href='#eq142-g11-50'/>
<use x='61.79' y='0' xlink:href='#eq142-g7-53'/>
<use x='70.54' y='0' xlink:href='#eq142-g1-61'/>
<use x='81.46' y='0' xlink:href='#eq142-g1-1'/>
<use x='91.23' y='0' xlink:href='#eq142-g7-53'/>
</g>
</svg></span>, and given
by</p>
<div class="m-math"><svg style="width: 8.092em; height: 3.207em; vertical-align: 0.119em; " viewBox="153.44 -33.26 80.92 32.07">
<title>
\[ \Delta f = \sum_i \frac{\partial^2}{\partial u_i^2} f \; . \]
</title>
<defs>
<path id='eq139-g4-213' d='M14.78 13.13H14.48C14.07 15.73 13.09 17.12 11.64 17.12H2.53L9.03 8.79L3.48 .62H10.98C12.51 .62 13.33 1.49 13.77 4.13H14.03L13.91 0H1.39L7.77 9.15L.51 18.34H14.54L14.78 13.13Z'/>
<use id='eq139-g10-53' xlink:href='#eq139-g7-53' transform='scale(1.36)'/>
<use id='eq139-g10-68' xlink:href='#eq139-g7-68' transform='scale(1.36)'/>
<use id='eq139-g10-109' xlink:href='#eq139-g7-109' transform='scale(1.36)'/>
<use id='eq139-g10-149' xlink:href='#eq139-g7-149' transform='scale(1.36)'/>
<path id='eq139-g7-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq139-g7-56' d='M2.05-.9L1.94-1C1.56-.5 1.37-.31 1.22-.31C1.15-.31 1.08-.38 1.08-.45C1.08-.59 1.17-.85 1.22-1.02L1.99-3.83L1.97-3.85C1.08-3.69 .91-3.66 .57-3.63V-3.49C1.04-3.49 1.12-3.46 1.12-3.28C1.12-3.21 1.09-3.07 1.04-2.9L.62-1.35C.48-.83 .43-.58 .43-.4C.43-.08 .57 .1 .83 .1C1.24 .1 1.55-.17 2.05-.9ZM2.41-5.14C2.41-5.39 2.21-5.62 1.97-5.62S1.56-5.42 1.56-5.15C1.56-4.87 1.73-4.69 1.98-4.69C2.21-4.69 2.41-4.89 2.41-5.14Z'/>
<path id='eq139-g7-68' d='M4.15-.94L4.03-1.02C3.56-.45 3.44-.33 3.3-.33C3.24-.33 3.21-.38 3.21-.48C3.21-.53 3.21-.53 3.37-1.16L4.06-3.77H3.42C2.94-2.48 2.85-2.27 2.45-1.64C1.93-.81 1.5-.37 1.22-.37C1.11-.37 1.04-.45 1.04-.59C1.04-.62 1.04-.64 1.05-.66L1.84-3.83L1.82-3.85C1.32-3.74 1-3.68 .51-3.62V-3.49C.84-3.49 .86-3.49 .93-3.44C.99-3.42 1.03-3.35 1.03-3.28C1.03-3.21 .99-2.99 .91-2.7L.59-1.46C.42-.82 .37-.55 .37-.38C.37-.06 .52 .1 .83 .1C1.45 .1 1.91-.38 2.92-2.06C2.66-1.1 2.52-.53 2.52-.34C2.52-.07 2.68 .08 2.94 .08C3.35 .08 3.55-.09 4.15-.94Z'/>
<path id='eq139-g7-109' d='M4.3-3.76C4.3-5.02 3.91-6.04 2.97-6.04C2.24-6.04 1.44-5.35 1.44-4.95C1.44-4.66 1.67-4.55 1.84-4.55C2.03-4.55 2.14-4.69 2.16-4.72C2.13-4.74 2.08-4.82 2.08-4.94C2.08-5.02 2.24-5.78 2.99-5.78C3.62-5.78 3.76-4.97 3.76-4.26C3.76-3.73 3.68-3.26 3.68-3.25H3.67C3.67-3.26 3.33-3.79 2.64-3.79C.89-3.79 .17-2.1 .17-1.2C.17-.38 .65 .14 1.62 .14C3.12 .14 4.3-1.39 4.3-3.76ZM3.3-2.78C3.3-2.55 3.07-.07 1.68-.07C1.18-.07 .95-.35 .95-.91C.95-1.46 1.32-3.58 2.58-3.58C3.07-3.58 3.3-3.29 3.3-2.78Z'/>
<path id='eq139-g7-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
<path id='eq139-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq139-g1-1' d='M7.36 0L4.03-8.04H3.82L.29 0H7.36ZM5.97-.5H1.07L3.62-6.26L5.97-.5Z'/>
<path id='eq139-g1-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
</defs>
<g id='eq139-page1'>
<use x='153.15' y='-14.92' xlink:href='#eq139-g1-1'/>
<use x='162.92' y='-14.92' xlink:href='#eq139-g10-53'/>
<use x='171.67' y='-14.92' xlink:href='#eq139-g1-61'/>
<use x='182.59' y='-27.15' xlink:href='#eq139-g4-213'/>
<use x='189.03' y='-1.28' xlink:href='#eq139-g7-56'/>
<use x='205.11' y='-23.02' xlink:href='#eq139-g10-109'/>
<use x='211.84' y='-27.36' xlink:href='#eq139-g14-50'/>
<rect x='201.59' y='-18.33' height='.67' width='18.39'/>
<use x='201.85' y='-5.52' xlink:href='#eq139-g10-109'/>
<use x='208.72' y='-5.52' xlink:href='#eq139-g10-68'/>
<use x='215.1' y='-9.73' xlink:href='#eq139-g14-50'/>
<use x='214.93' y='-1.5' xlink:href='#eq139-g7-56'/>
<use x='223.26' y='-14.92' xlink:href='#eq139-g10-53'/>
<use x='232.2' y='-14.92' xlink:href='#eq139-g10-149'/>
</g>
</svg></div>
<p>See <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a> for information on the parameters.</p>
<p>If <code>method</code> is &ldquo;finitediff&rdquo;, it does not add second order derivatives, but instead computes a convolution
with a 3x3(x3x&hellip;) kernel where all elements are -1 and the middle element is <span class="m-math"><svg style="width: 2.863em; height: 1.047em; vertical-align: -0.016em;  vertical-align: -0.017em;" viewBox=".51 -10.31 28.63 10.47">
<title>
\(3^d - 1\)
</title>
<defs>
<path id='eq143-g1-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq143-g4-51' d='M4.15-.88L4.04-.97C3.56-.42 3.48-.35 3.33-.35C3.24-.35 3.17-.42 3.17-.52C3.17-.66 3.44-1.69 3.74-2.67L4.6-5.92L4.56-5.97C4.1-5.87 3.78-5.82 3.22-5.76V-5.62C3.7-5.6 3.76-5.57 3.76-5.39C3.76-5.27 3.76-5.24 3.63-4.78L3.25-3.35C3.18-3.71 3.02-3.85 2.68-3.85C1.55-3.85 .13-2.21 .13-.9C.13-.28 .48 .1 1.05 .1C1.64 .1 2.03-.18 2.62-1.06C2.52-.62 2.51-.48 2.51-.28C2.51-.04 2.65 .11 2.87 .11C3.24 .11 3.7-.24 4.15-.88ZM3.11-3.15C3.11-1.83 2.2-.32 1.4-.32C1.09-.32 .89-.55 .89-.9C.89-1.62 1.33-2.64 1.9-3.25C2.14-3.49 2.44-3.65 2.68-3.65C2.69-3.65 2.71-3.65 2.72-3.65C2.98-3.63 3.11-3.47 3.11-3.15Z'/>
<path id='eq143-g8-49' d='M4.69 0V-.18C3.75-.19 3.56-.31 3.56-.88V-8.03L3.47-8.05L1.32-6.97V-6.8C1.46-6.86 1.6-6.91 1.64-6.93C1.86-7.02 2.06-7.06 2.18-7.06C2.43-7.06 2.54-6.88 2.54-6.5V-1.11C2.54-.71 2.44-.44 2.25-.33C2.07-.23 1.91-.19 1.41-.18V0H4.69Z'/>
<path id='eq143-g8-51' d='M5.15-2.61C5.15-3.22 4.95-3.78 4.61-4.14C4.37-4.41 4.14-4.55 3.62-4.78C4.44-5.34 4.74-5.78 4.74-6.42C4.74-7.38 3.98-8.05 2.88-8.05C2.29-8.05 1.76-7.85 1.33-7.47C.98-7.15 .8-6.84 .54-6.12L.71-6.07C1.2-6.94 1.74-7.34 2.49-7.34C3.26-7.34 3.8-6.81 3.8-6.06C3.8-5.63 3.62-5.2 3.32-4.91C2.97-4.55 2.63-4.37 1.82-4.09V-3.93C2.53-3.93 2.8-3.91 3.08-3.8C3.82-3.54 4.29-2.86 4.29-2.04C4.29-1.04 3.61-.26 2.73-.26C2.41-.26 2.17-.35 1.73-.63C1.37-.85 1.17-.93 .96-.93C.69-.93 .51-.76 .51-.51C.51-.1 1.02 .17 1.86 .17C2.78 .17 3.72-.14 4.28-.63S5.15-1.81 5.15-2.61Z'/>
</defs>
<g id='eq143-page1'>
<use x='0' y='0' xlink:href='#eq143-g8-51'/>
<use x='6.2' y='-4.34' xlink:href='#eq143-g4-51'/>
<use x='14.19' y='0' xlink:href='#eq143-g1-0'/>
<use x='24.45' y='0' xlink:href='#eq143-g8-49'/>
</g>
</svg></span> (with <span class="m-math"><svg style="width: 0.610em; height: 0.829em; vertical-align: -0.016em;  vertical-align: -0.016em;" viewBox=".48 -8.13 6.1 8.29">
<title>
\(d\)
</title>
<defs>
<path id='eq144-g1-51' d='M5.66-1.2L5.51-1.32C4.86-.57 4.74-.48 4.54-.48C4.42-.48 4.32-.57 4.32-.71C4.32-.91 4.69-2.3 5.1-3.64L6.28-8.08L6.22-8.13C5.59-8 5.16-7.93 4.39-7.86V-7.66C5.05-7.63 5.13-7.6 5.13-7.35C5.13-7.18 5.12-7.15 4.95-6.52L4.43-4.56C4.34-5.06 4.12-5.25 3.66-5.25C2.11-5.25 .18-3.01 .18-1.23C.18-.38 .66 .13 1.43 .13C2.24 .13 2.76-.25 3.57-1.44C3.44-.85 3.42-.66 3.42-.38C3.42-.06 3.61 .15 3.92 .15C4.42 .15 5.05-.33 5.66-1.2ZM4.24-4.3C4.24-2.49 3-.44 1.91-.44C1.49-.44 1.21-.75 1.21-1.23C1.21-2.22 1.81-3.6 2.6-4.43C2.92-4.76 3.32-4.98 3.66-4.98C3.67-4.98 3.69-4.98 3.7-4.98C4.06-4.95 4.24-4.73 4.24-4.3Z'/>
</defs>
<g id='eq144-page1'>
<use x='.3' y='0' xlink:href='#eq144-g1-51'/>
</g>
</svg></span> the number
of image dimensions). That is, the kernel sums to 0. For a 2D image, this translates to the well-known kernel:</p>
<div class="m-math"><svg style="width: 6.724em; height: 4.301em; vertical-align: 0.015em; " viewBox="160.65 -43.16 67.24 43.01">
<title>
\[ \begin{bmatrix}
     -1 &amp; -1 &amp; -1
  \\ -1 &amp;  8 &amp; -1
  \\ -1 &amp; -1 &amp; -1
\end{bmatrix} \]
</title>
<defs>
<path id='eq140-g8-49' d='M4.69 0V-.18C3.75-.19 3.56-.31 3.56-.88V-8.03L3.47-8.05L1.32-6.97V-6.8C1.46-6.86 1.6-6.91 1.64-6.93C1.86-7.02 2.06-7.06 2.18-7.06C2.43-7.06 2.54-6.88 2.54-6.5V-1.11C2.54-.71 2.44-.44 2.25-.33C2.07-.23 1.91-.19 1.41-.18V0H4.69Z'/>
<path id='eq140-g8-56' d='M5.3-1.85C5.3-2.76 4.9-3.35 3.45-4.42C4.63-5.05 5.05-5.55 5.05-6.36C5.05-7.34 4.19-8.05 3-8.05C1.7-8.05 .74-7.25 .74-6.17C.74-5.4 .96-5.05 2.22-3.95C.93-2.98 .67-2.61 .67-1.8C.67-.64 1.61 .17 2.95 .17C4.38 .17 5.3-.62 5.3-1.85ZM4.39-1.48C4.39-.7 3.86-.17 3.08-.17C2.18-.17 1.57-.86 1.57-1.89C1.57-2.66 1.83-3.16 2.53-3.72L3.24-3.19C4.11-2.57 4.39-2.14 4.39-1.48ZM4.23-6.37C4.23-5.69 3.89-5.16 3.22-4.7C3.16-4.67 3.16-4.67 3.11-4.63C2.05-5.32 1.62-5.87 1.62-6.54C1.62-7.23 2.16-7.72 2.91-7.72C3.72-7.72 4.23-7.19 4.23-6.37Z'/>
<path id='eq140-g4-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq140-g1-50' d='M3.92-6.54V-7.15H1.05V.26H1.97V-6.04C1.97-6.34 2.22-6.54 2.51-6.54H3.92Z'/>
<path id='eq140-g1-51' d='M3.28 .26V-7.15H.4V-6.54H1.81C2.11-6.54 2.36-6.34 2.36-6.04V.26H3.28Z'/>
<path id='eq140-g1-52' d='M3.92 0V-.61H2.51C2.22-.61 1.97-.81 1.97-1.11V-7.38H1.05V0H3.92Z'/>
<path id='eq140-g1-53' d='M3.28 0V-7.38H2.36V-1.11C2.36-.81 2.11-.61 1.81-.61H.4V0H3.28Z'/>
<path id='eq140-g1-54' d='M1.97 .14V-7.56H1.05V.14H1.97Z'/>
<path id='eq140-g1-55' d='M3.28 .13V-7.56H2.36V.13H3.28Z'/>
</defs>
<g id='eq140-page1'>
<use x='159.6' y='-36.01' xlink:href='#eq140-g1-50'/>
<use x='159.6' y='-28.84' xlink:href='#eq140-g1-54'/>
<use x='159.6' y='-21.67' xlink:href='#eq140-g1-54'/>
<use x='159.6' y='-14.5' xlink:href='#eq140-g1-54'/>
<use x='159.6' y='-7.32' xlink:href='#eq140-g1-54'/>
<use x='159.6' y='-.15' xlink:href='#eq140-g1-52'/>
<use x='163.94' y='-33.23' xlink:href='#eq140-g4-0'/>
<use x='171.54' y='-33.23' xlink:href='#eq140-g8-49'/>
<use x='187.48' y='-33.23' xlink:href='#eq140-g4-0'/>
<use x='195.08' y='-33.23' xlink:href='#eq140-g8-49'/>
<use x='211.02' y='-33.23' xlink:href='#eq140-g4-0'/>
<use x='218.63' y='-33.23' xlink:href='#eq140-g8-49'/>
<use x='163.94' y='-18.78' xlink:href='#eq140-g4-0'/>
<use x='171.54' y='-18.78' xlink:href='#eq140-g8-49'/>
<use x='191.28' y='-18.78' xlink:href='#eq140-g8-56'/>
<use x='211.02' y='-18.78' xlink:href='#eq140-g4-0'/>
<use x='218.63' y='-18.78' xlink:href='#eq140-g8-49'/>
<use x='163.94' y='-4.33' xlink:href='#eq140-g4-0'/>
<use x='171.54' y='-4.33' xlink:href='#eq140-g8-49'/>
<use x='187.48' y='-4.33' xlink:href='#eq140-g4-0'/>
<use x='195.08' y='-4.33' xlink:href='#eq140-g8-49'/>
<use x='211.02' y='-4.33' xlink:href='#eq140-g4-0'/>
<use x='218.63' y='-4.33' xlink:href='#eq140-g8-49'/>
<use x='224.61' y='-36.01' xlink:href='#eq140-g1-51'/>
<use x='224.61' y='-28.84' xlink:href='#eq140-g1-55'/>
<use x='224.61' y='-21.67' xlink:href='#eq140-g1-55'/>
<use x='224.61' y='-14.5' xlink:href='#eq140-g1-55'/>
<use x='224.61' y='-7.32' xlink:href='#eq140-g1-55'/>
<use x='224.61' y='-.15' xlink:href='#eq140-g1-53'/>
</g>
</svg></div>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a>, <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a>, <a href="linear.html#dip-Hessian-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Hessian</code></a>, <a href="numeric.html#dip-Trace-T-dip-uint--ConstSampleIterator&lt;T&gt;-"><code>dip::Trace</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Dgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Dgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />Dgg</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the second derivative in the gradient direction.</p>
<p>The second derivative in the gradient direction is computed by Raleigh quotient of the
Hessian matrix and the gradient vector:</p>
<div class="m-math"><svg style="width: 10.711em; height: 2.906em; vertical-align: 0.004em; " viewBox="140.36 -29.1 107.11 29.06">
<title>
\[ f_{gg} = \frac{ \nabla^T \! f \; \nabla \nabla^T \! f \; \nabla f } { \nabla^T \! f \; \nabla f } \; . \]
</title>
<defs>
<path id='eq145-g4-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
<path id='eq145-g1-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<use id='eq145-g10-53' xlink:href='#eq145-g7-53' transform='scale(1.36)'/>
<use id='eq145-g10-149' xlink:href='#eq145-g7-149' transform='scale(1.36)'/>
<path id='eq145-g7-41' d='M5.53-5.7H.88L.52-4.36L.67-4.32C1.11-5.22 1.39-5.4 2.57-5.4C2.63-5.4 2.69-5.4 2.75-5.4L1.49-.79C1.35-.32 1.14-.18 .57-.14V0H3.1V-.14L2.77-.17C2.41-.19 2.31-.27 2.31-.54C2.31-.65 2.33-.73 2.42-1.05L3.63-5.4H4.11C4.74-5.4 5.02-5.18 5.02-4.69C5.02-4.58 5.01-4.45 5-4.3L5.14-4.28L5.53-5.7Z'/>
<path id='eq145-g7-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq145-g7-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq145-g7-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
</defs>
<g id='eq145-page1'>
<use x='142.12' y='-10.96' xlink:href='#eq145-g10-53'/>
<use x='145.61' y='-9.17' xlink:href='#eq145-g7-54'/>
<use x='150.31' y='-9.17' xlink:href='#eq145-g7-54'/>
<use x='158.78' y='-10.96' xlink:href='#eq145-g1-61'/>
<use x='171.02' y='-19.05' xlink:href='#eq145-g4-114'/>
<use x='178.77' y='-23.39' xlink:href='#eq145-g7-41'/>
<use x='185.08' y='-19.05' xlink:href='#eq145-g10-53'/>
<use x='193.94' y='-19.05' xlink:href='#eq145-g4-114'/>
<use x='202.12' y='-19.05' xlink:href='#eq145-g4-114'/>
<use x='209.87' y='-23.39' xlink:href='#eq145-g7-41'/>
<use x='216.17' y='-19.05' xlink:href='#eq145-g10-53'/>
<use x='225.04' y='-19.05' xlink:href='#eq145-g4-114'/>
<use x='235.18' y='-19.05' xlink:href='#eq145-g10-53'/>
<rect x='170.9' y='-14.37' height='.67' width='69.7'/>
<use x='186.57' y='-2.5' xlink:href='#eq145-g4-114'/>
<use x='194.32' y='-5.96' xlink:href='#eq145-g7-41'/>
<use x='200.63' y='-2.5' xlink:href='#eq145-g10-53'/>
<use x='209.49' y='-2.5' xlink:href='#eq145-g4-114'/>
<use x='219.63' y='-2.5' xlink:href='#eq145-g10-53'/>
<use x='245.32' y='-10.96' xlink:href='#eq145-g10-149'/>
</g>
</svg></div>
<p>This function is equivalent to:</p>
<div class="m-code"><pre><span></span><span class="n">Image</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">Gradient</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span>
<span class="n">Image</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">Hessian</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span>
<span class="n">Image</span><span class="w"> </span><span class="n">Dgg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">Transpose</span><span class="p">(</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g</span><span class="p">;</span>
<span class="n">Dgg</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">Transpose</span><span class="p">(</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g</span><span class="p">;</span>
</pre></div>

<p>See <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for how derivatives are computed, and the meaning of the parameters. See <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a>
or <a href="linear.html#dip-Hessian-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Hessian</code></a> for the meaning of the <code>process</code> parameter</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Dxx-Image-CL-Image-L-FloatArray-"><code>dip::Dxx</code></a>, <a href="linear.html#dip-Dyy-Image-CL-Image-L-FloatArray-"><code>dip::Dyy</code></a>, <a href="linear.html#dip-Dzz-Image-CL-Image-L-FloatArray-"><code>dip::Dzz</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-LaplacePlusDgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-LaplacePlusDgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />LaplacePlusDgg</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Adds the second derivative in the gradient direction to the Laplacian.</p>
<p>This function computes <code>dip::Laplace( in ) + dip::Dgg( in )</code>, but avoiding computing the second derivatives twice.</p>
<p>The zero-crossings of the result correspond to the edges in the image, just as they do for the individual
Laplace and Dgg operators. However, the localization is improved by an order of magnitude with respect to
the individual operators.</p>
<p>See <a href="linear.html#dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Laplace</code></a> and <a href="linear.html#dip-Dgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Dgg</code></a> for more information.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>L.J. van Vliet, &ldquo;Grey-Scale Measurements in Multi-Dimensional Digitized Images&rdquo;, PhD Thesis, Delft University
  of Technology, 1993.</li>
<li>P.W. Verbeek and L.J. van Vliet, &ldquo;On the location error of curved edges in low-pass filtered 2-D and 3-D images&rdquo;,
  IEEE Transactions on Pattern Analysis and Machine Intelligence 16(7):726-733, 1994.</li>
</ul>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-LaplaceMinusDgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-LaplaceMinusDgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />LaplaceMinusDgg</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Subtracts the second derivative in the gradient direction from the Laplacian.</p>
<p>This function computes <code>dip::Laplace( in ) - dip::Dgg( in )</code>, but avoiding computing the second derivatives twice.</p>
<p>For two-dimensional images, this is equivalent to the second order derivative in the direction perpendicular
to the gradient direction.</p>
<p>See <a href="linear.html#dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Laplace</code></a> and <a href="linear.html#dip-Dgg-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Dgg</code></a> for more information.</p>
          </div></section>
                        <section class="m-doc-details" id="dip-Sharpen-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Sharpen-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />Sharpen</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> weight = 1.0,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Sharpens <code>in</code> by subtracting the Laplacian of the image.</p>
<p>The actual operation applied is:</p>
<div class="m-code"><pre><span></span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">Laplace</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="p">;</span>
</pre></div>

<p>See <a href="linear.html#dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Laplace</code></a> and <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for information on the parameters.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Laplace-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Laplace</code></a>, <a href="linear.html#dip-UnsharpMask-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::UnsharpMask</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-UnsharpMask-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-UnsharpMask-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />UnsharpMask</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> weight = 1.0,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Sharpens <code>in</code> by subtracting the smoothed image.</p>
<p>The actual operation applied is:</p>
<div class="m-code"><pre><span></span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="o">+</span><span class="n">weight</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">Gauss</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="p">;</span>
</pre></div>

<p>See <a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a> for information on the parameters.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a>, <a href="linear.html#dip-Sharpen-Image-CL-Image-L-dfloat--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Sharpen</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-GaborFIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-GaborFIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--dfloat-" class="m-doc-self">dip::<wbr />GaborFIR</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; frequencies,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Finite impulse response implementation of the Gabor filter</p>
<p>Convolves the image with an FIR 1D Gabor kernel along each dimension. For each dimension,
provide a value in <code>sigmas</code> and <code>frequencies</code>.
The value of sigma determines the amount of local averaging. For smaller values, the result is more
precise spatially, but less selective of frequencies. Dimensions where sigma is 0 or negative are not processed.</p>
<p>Frequencies are in the range [0, 0.5), with 0.5 being the frequency corresponding to a period of 2 pixels.</p>
<p>The output is complex-valued. Typically, the magnitude is the interesting part of the result.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>Set <code>process</code> to false for those dimensions that should not be filtered. This is equivalent to setting
<code>sigmas</code> to 0 for those dimensions.</p>
<p>This function is relatively slow compared to <a href="linear.html#dip-GaborIIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--IntegerArray-CL-dfloat-"><code>dip::GaborIIR</code></a>, even for small sigmas. Prefer to use the IIR
implementation.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gabor2D-Image-CL-Image-L-FloatArray--dfloat--dfloat--StringArray-CL-dfloat-"><code>dip::Gabor2D</code></a>, <a href="linear.html#dip-GaborIIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--IntegerArray-CL-dfloat-"><code>dip::GaborIIR</code></a></p>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-GaborIIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--IntegerArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-GaborIIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--IntegerArray-CL-dfloat-" class="m-doc-self">dip::<wbr />GaborIIR</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; frequencies,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> process = {},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-IntegerArray" class="m-doc">dip::IntegerArray</a> const&amp; filterOrder = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Recursive infinite impulse response implementation of the Gabor filter</p>
<p>Convolves the image with an IIR 1D Gabor kernel along each dimension. For each dimension,
provide a value in <code>sigmas</code> and <code>frequencies</code>.
The value of sigma determines the amount of local averaging. For smaller values, the result is more
precise spatially, but less selective of frequencies. Dimensions where sigma is 0 or negative are not processed.</p>
<p>Frequencies are in the range [0, 0.5), with 0.5 being the frequency corresponding to a period of 2 pixels.</p>
<p>The output is complex-valued. Typically, the magnitude is the interesting part of the result.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>Set <code>process</code> to false for those dimensions that should not be filtered. This is equivalent to setting
<code>sigmas</code> to 0 for those dimensions.</p>
<aside class="m-note m-warning">
<h4>Warning</h4>
<p>The <code>filterOrder</code> parameter is not yet implemented. It is ignored and assumed 0 for each dimension.</p>
</aside>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="linear.html#dip-Gabor2D-Image-CL-Image-L-FloatArray--dfloat--dfloat--StringArray-CL-dfloat-"><code>dip::Gabor2D</code></a>, <a href="linear.html#dip-GaborFIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::GaborFIR</code></a></p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>I.T. Young, L.J. van Vliet and M. van Ginkel, &ldquo;Recursive Gabor filtering&rdquo;,
  IEEE Transactions on Signal Processing 50(11):2798-2805, 2002.</li>
</ul>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-Gabor2D-Image-CL-Image-L-FloatArray--dfloat--dfloat--StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-Gabor2D-Image-CL-Image-L-FloatArray--dfloat--dfloat--StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />Gabor2D</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {5.0,5.0},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> frequency = 0.1,</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> direction = dip::pi,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>2D Gabor filter with direction parameter</p>
<p>Convolves the 2D image with a Gabor kernel. This is a convenience wrapper around <a href="linear.html#dip-GaborIIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--IntegerArray-CL-dfloat-"><code>dip::GaborIIR</code></a>.
The value of sigma determines the amount of local averaging, and can be different for each dimension.
For smaller values, the result is more precise spatially, but less selective of frequencies.</p>
<p><code>frequency</code> is in the range [0, 0.5), with 0.5 being the frequency corresponding to a period of 2 pixels.
<code>direction</code> is the filter direction, in the range [0, 2&pi;].</p>
<p>The output is complex-valued. Typically, the magnitude is the interesting part of the result.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>To use cartesian frequency coordinates, see <a href="linear.html#dip-GaborIIR-Image-CL-Image-L-FloatArray--FloatArray-CL-StringArray-CL-BooleanArray--IntegerArray-CL-dfloat-"><code>dip::GaborIIR</code></a>.</p>
          </div></section>
                        <section class="m-doc-details" id="dip-LogGaborFilterBank-Image-CL-Image-L-FloatArray-CL-dfloat--dip-uint--String-CL-String-CL"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-LogGaborFilterBank-Image-CL-Image-L-FloatArray-CL-dfloat--dip-uint--String-CL-String-CL" class="m-doc-self">dip::<wbr />LogGaborFilterBank</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; wavelengths = {3.0,6.0,12.0,24.0},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> bandwidth = 0.75,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> nOrientations = 6,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; inRepresentation = S::SPATIAL,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; outRepresentation = S::SPATIAL</span>)            </h3>
            <p>Applies a log-Gabor filter bank</p>
<p>A log-Gabor filter is a Gabor filter computed on the logarithm of the frequency, leading to a shorter tail of
the Gaussian, in the frequency domain, towards the lower frequencies. The origin (DC component) is thus never
included in the filter. This gives it better scale selection properties than the traditional Gabor filter.</p>
<p>This function generates a filter bank with <code>wavelengths.size()</code> times <code>nOrientations</code> filters. The width of
the filters in the angular axis is determined by the number of orientations used, and their locations are
always equally distributed over &pi; radian, starting at 0. The radial location (scales) of the filters
is determined by <code>wavelengths</code> (in pixels), which determines the center for each scale filter. The widths of
the filters in this direction are determined by the <code>bandwidth</code> parameter; the default value of 0.75 corresponds
approximately to one octave, 0.55 to two octaves, and 0.41 to three octaves.</p>
<p><code>wavelengths.size()</code> and <code>nOrientations</code> must be at least 1.
If <code>nOrientations</code> is 1, no orientation filtering is applied, the filters become purely real. These filters
can be defined for images of any dimensionality. For more than one orientation, the filters are complex-valued
in the spatial domain, and can only be created for 2D images. See <a href="analysis.html#dip-MonogenicSignal-Image-CL-Image-L-FloatArray-CL-dfloat--String-CL-String-CL"><code>dip::MonogenicSignal</code></a> for a generalization
to arbitrary dimensionality.</p>
<p>If <code>in</code> is not forged, its sizes will be used to generate the filters, which will be returned. Thus, this is
identical to (but slightly cheaper than) using a delta pulse image as input.</p>
<p>The filters are always generated in the frequency domain. If <code>outRepresentation</code> is <code>"spatial"</code>, the inverse
Fourier transform will be applied to bring the result back to the spatial domain. Otherwise, it should be
<code>"frequency"</code>, and no inverse transform will be applied. Likewise, <code>inRepresentation</code> specifies whether <code>in</code>
has already been converted to the frequency domain or not.</p>
<p>Out will be a tensor image with <code>wavelengths.size()</code> tensor rows and <code>nFrequencyScales</code> tensor columns.
The data type will be either single-precision float or single-precision complex, depending on the selected
parameters.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>D.J. Field, &ldquo;Relations between the statistics of natural images and the response properties of cortical cells&rdquo;,
  Journal of the Optical Society of America A 4(12):2379-2394, 1987.</li>
<li>P. Kovesi, <a href="https://www.peterkovesi.com/matlabfns/PhaseCongruency/Docs/convexpl.html">&ldquo;What Are Log-Gabor Filters and Why Are They Good?&rdquo;</a> (retrieved July 25, 2018).</li>
</ul>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-NormalizedConvolution-Image-CL-Image-CL-Image-L-FloatArray-CL-String-CL-StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-NormalizedConvolution-Image-CL-Image-CL-Image-L-FloatArray-CL-String-CL-StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />NormalizedConvolution</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {S::ADD_ZEROS},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the normalized convolution with a Gaussian kernel: a Gaussian convolution for missing or
uncertain data.</p>
<p>The normalized convolution is a convolution that handles missing or uncertain data. <code>mask</code> is an image, expected
to be in the range [0,1], that indicates the confidence in each of the values of <code>in</code>. Missing values are indicated
by setting the corresponding value in <code>mask</code> to 0.</p>
<p>The normalized convolution is then <code>Convolution( in * mask ) / Convolution( mask )</code>.</p>
<p>This function applies convolutions with a Gaussian kernel, using <a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a>. See that function for the meaning
of the parameters. <code>boundaryCondition</code> defaults to <code>"add zeros"</code>, the normalized convolution then takes pixels
outside of the image domain as missing values.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>H. Knutsson and C. F. Westin, &ldquo;Normalized and differential convolution&rdquo;, Proceedings of IEEE Conference on
  Computer Vision and Pattern Recognition, New York, NY, 1993, pp. 515-523.</li>
</ul>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-NormalizedDifferentialConvolution-Image-CL-Image-CL-Image-L-dip-uint--FloatArray-CL-String-CL-StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-NormalizedDifferentialConvolution-Image-CL-Image-CL-Image-L-dip-uint--FloatArray-CL-String-CL-StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />NormalizedDifferentialConvolution</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> dimension = 0,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {S::ADD_ZEROS},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the normalized differential convolution with a Gaussian kernel: a derivative operator for missing
or uncertain data.</p>
<p>The normalized convolution is a convolution that handles missing or uncertain data. <code>mask</code> is an image, expected
to be in the range [0,1], that indicates the confidence in each of the values of <code>in</code>. Missing values are indicated
by setting the corresponding value in <code>mask</code> to 0.</p>
<p>The normalized differential convolution is defined here as the derivative of the normalized convolution with a
Gaussian kernel:</p>
<div class="m-math"><svg style="width: 24.383em; height: 3.111em; vertical-align: 0.005em; " viewBox="72.44 -31.16 243.83 31.11">
<title>
\[ \frac{\partial}{\partial x} \frac{(f \, m) \ast g}{m \ast g}
   = \frac{(f \, m) \ast \frac{\partial}{\partial x} g}{m \ast g}
   - \frac{(f \, m) \ast g}{m \ast g} \frac{m \ast \frac{\partial}{\partial x} g}{m \ast g} \; . \]
</title>
<defs>
<path id='eq146-g1-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq146-g4-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq146-g4-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq146-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq146-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<use id='eq146-g10-53' xlink:href='#eq146-g7-53' transform='scale(1.36)'/>
<use id='eq146-g10-54' xlink:href='#eq146-g7-54' transform='scale(1.36)'/>
<use id='eq146-g10-60' xlink:href='#eq146-g7-60' transform='scale(1.36)'/>
<use id='eq146-g10-71' xlink:href='#eq146-g7-71' transform='scale(1.36)'/>
<use id='eq146-g10-109' xlink:href='#eq146-g7-109' transform='scale(1.36)'/>
<use id='eq146-g10-149' xlink:href='#eq146-g7-149' transform='scale(1.36)'/>
<path id='eq146-g7-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq146-g7-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq146-g7-60' d='M6.15-.92L6.02-1.02L5.83-.79C5.58-.47 5.42-.33 5.27-.33C5.2-.33 5.16-.38 5.16-.47C5.16-.51 5.2-.66 5.25-.86L5.84-3.06C5.85-3.1 5.87-3.24 5.87-3.3C5.87-3.62 5.65-3.85 5.36-3.85C5.19-3.85 5.03-3.8 4.82-3.67C4.39-3.4 4.03-2.97 3.42-2C3.63-2.67 3.76-3.16 3.76-3.33C3.76-3.64 3.56-3.85 3.27-3.85C2.73-3.85 2.12-3.28 1.32-2.01L1.83-3.83L1.8-3.85L.4-3.58V-3.44H.62C.86-3.44 .96-3.38 .96-3.25C.96-3.14 .76-2.35 .45-1.25L.1 0H.76C1.18-1.38 1.31-1.71 1.61-2.17C2.1-2.91 2.62-3.4 2.92-3.4C3.03-3.4 3.09-3.32 3.09-3.18C3.09-3.07 2.86-2.14 2.48-.8L2.26 0H2.92C3.26-1.35 3.43-1.78 3.86-2.38C4.3-3 4.74-3.4 5-3.4C5.1-3.4 5.18-3.32 5.18-3.21C5.18-3.17 5.16-3.08 5.12-2.91L4.61-.9C4.52-.56 4.5-.41 4.5-.32C4.5-.06 4.62 .08 4.85 .08C5.26 .08 5.64-.21 6.11-.86L6.15-.92Z'/>
<path id='eq146-g7-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq146-g7-109' d='M4.3-3.76C4.3-5.02 3.91-6.04 2.97-6.04C2.24-6.04 1.44-5.35 1.44-4.95C1.44-4.66 1.67-4.55 1.84-4.55C2.03-4.55 2.14-4.69 2.16-4.72C2.13-4.74 2.08-4.82 2.08-4.94C2.08-5.02 2.24-5.78 2.99-5.78C3.62-5.78 3.76-4.97 3.76-4.26C3.76-3.73 3.68-3.26 3.68-3.25H3.67C3.67-3.26 3.33-3.79 2.64-3.79C.89-3.79 .17-2.1 .17-1.2C.17-.38 .65 .14 1.62 .14C3.12 .14 4.3-1.39 4.3-3.76ZM3.3-2.78C3.3-2.55 3.07-.07 1.68-.07C1.18-.07 .95-.35 .95-.91C.95-1.46 1.32-3.58 2.58-3.58C3.07-3.58 3.3-3.29 3.3-2.78Z'/>
<path id='eq146-g7-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
</defs>
<g id='eq146-page1'>
<use x='75.63' y='-18.8' xlink:href='#eq146-g10-109'/>
<rect x='72.44' y='-14.11' height='.67' width='12.87'/>
<use x='72.69' y='-2.5' xlink:href='#eq146-g10-109'/>
<use x='79.42' y='-2.5' xlink:href='#eq146-g10-71'/>
<use x='88.3' y='-18.8' xlink:href='#eq146-g4-185'/>
<use x='94.84' y='-18.8' xlink:href='#eq146-g10-53'/>
<use x='102.34' y='-18.8' xlink:href='#eq146-g10-60'/>
<use x='111.47' y='-18.8' xlink:href='#eq146-g4-186'/>
<use x='118.71' y='-18.8' xlink:href='#eq146-g4-3'/>
<use x='127.07' y='-18.8' xlink:href='#eq146-g10-54'/>
<rect x='87.7' y='-14.11' height='.67' width='45.71'/>
<use x='97.35' y='-2.5' xlink:href='#eq146-g10-60'/>
<use x='109.14' y='-2.5' xlink:href='#eq146-g4-3'/>
<use x='117.5' y='-2.5' xlink:href='#eq146-g10-54'/>
<use x='137.93' y='-10.71' xlink:href='#eq146-g1-61'/>
<use x='150.64' y='-20.41' xlink:href='#eq146-g4-185'/>
<use x='157.18' y='-20.41' xlink:href='#eq146-g10-53'/>
<use x='164.69' y='-20.41' xlink:href='#eq146-g10-60'/>
<use x='173.82' y='-20.41' xlink:href='#eq146-g4-186'/>
<use x='181.06' y='-20.41' xlink:href='#eq146-g4-3'/>
<use x='192.88' y='-25.12' xlink:href='#eq146-g7-109'/>
<rect x='190.54' y='-23.82' height='.67' width='9.44'/>
<use x='190.72' y='-16.28' xlink:href='#eq146-g7-109'/>
<use x='195.66' y='-16.28' xlink:href='#eq146-g7-71'/>
<use x='201.24' y='-20.41' xlink:href='#eq146-g10-54'/>
<rect x='150.05' y='-14.11' height='.67' width='57.54'/>
<use x='165.61' y='-2.5' xlink:href='#eq146-g10-60'/>
<use x='177.4' y='-2.5' xlink:href='#eq146-g4-3'/>
<use x='185.76' y='-2.5' xlink:href='#eq146-g10-54'/>
<use x='211.44' y='-10.71' xlink:href='#eq146-g4-0'/>
<use x='223.49' y='-18.8' xlink:href='#eq146-g4-185'/>
<use x='230.03' y='-18.8' xlink:href='#eq146-g10-53'/>
<use x='237.54' y='-18.8' xlink:href='#eq146-g10-60'/>
<use x='246.67' y='-18.8' xlink:href='#eq146-g4-186'/>
<use x='253.9' y='-18.8' xlink:href='#eq146-g4-3'/>
<use x='262.26' y='-18.8' xlink:href='#eq146-g10-54'/>
<rect x='222.89' y='-14.11' height='.67' width='45.71'/>
<use x='232.55' y='-2.5' xlink:href='#eq146-g10-60'/>
<use x='244.34' y='-2.5' xlink:href='#eq146-g4-3'/>
<use x='252.7' y='-2.5' xlink:href='#eq146-g10-54'/>
<use x='271.08' y='-20.41' xlink:href='#eq146-g10-60'/>
<use x='282.87' y='-20.41' xlink:href='#eq146-g4-3'/>
<use x='294.7' y='-25.12' xlink:href='#eq146-g7-109'/>
<rect x='292.35' y='-23.82' height='.67' width='9.44'/>
<use x='292.54' y='-16.28' xlink:href='#eq146-g7-109'/>
<use x='297.47' y='-16.28' xlink:href='#eq146-g7-71'/>
<use x='303.06' y='-20.41' xlink:href='#eq146-g10-54'/>
<rect x='271' y='-14.11' height='.67' width='38.4'/>
<use x='277' y='-2.5' xlink:href='#eq146-g10-60'/>
<use x='288.79' y='-2.5' xlink:href='#eq146-g4-3'/>
<use x='297.14' y='-2.5' xlink:href='#eq146-g10-54'/>
<use x='314.11' y='-10.71' xlink:href='#eq146-g10-149'/>
</g>
</svg></div>
<p><span class="m-math"><svg style="width: 0.413em; height: 0.461em; vertical-align: 0.075em;  vertical-align: -0.000em;" viewBox=".74 -5.36 4.13 4.61">
<title>
\(\ast\)
</title>
<defs>
<path id='eq147-g1-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
</defs>
<g id='eq147-page1'>
<use x='0' y='0' xlink:href='#eq147-g1-3'/>
</g>
</svg></span> is the convolution operator, <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em;  vertical-align: -0.247em;" viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq148-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq148-page1'>
<use x='2.08' y='0' xlink:href='#eq148-g1-53'/>
</g>
</svg></span> is <code>in</code>, <span class="m-math"><svg style="width: 0.824em; height: 0.536em; vertical-align: -0.011em;  vertical-align: -0.011em;" viewBox=".23 -5.25 8.24 5.36">
<title>
\(m\)
</title>
<defs>
<path id='eq149-g1-60' d='M8.38-1.25L8.21-1.39L7.96-1.08C7.61-.64 7.38-.45 7.18-.45C7.09-.45 7.04-.51 7.04-.64C7.04-.69 7.09-.91 7.16-1.18L7.97-4.17C7.98-4.23 8-4.42 8-4.5C8-4.93 7.71-5.25 7.31-5.25C7.07-5.25 6.86-5.18 6.57-5C5.99-4.63 5.49-4.05 4.66-2.73C4.95-3.64 5.13-4.31 5.13-4.54C5.13-4.97 4.86-5.25 4.45-5.25C3.73-5.25 2.89-4.47 1.8-2.74L2.49-5.23L2.45-5.25L.55-4.88V-4.69H.85C1.17-4.69 1.31-4.61 1.31-4.43C1.31-4.29 1.04-3.2 .61-1.7L.14 0H1.04C1.61-1.88 1.79-2.33 2.19-2.95C2.86-3.97 3.57-4.63 3.98-4.63C4.13-4.63 4.22-4.53 4.22-4.34C4.22-4.18 3.89-2.92 3.38-1.1L3.08 0H3.98C4.44-1.83 4.68-2.43 5.26-3.25C5.86-4.09 6.47-4.63 6.82-4.63C6.96-4.63 7.06-4.53 7.06-4.38C7.06-4.32 7.04-4.2 6.98-3.97L6.29-1.23C6.17-.76 6.13-.56 6.13-.44C6.13-.08 6.3 .11 6.61 .11C7.17 .11 7.69-.29 8.33-1.17L8.38-1.25Z'/>
</defs>
<g id='eq149-page1'>
<use x='.08' y='0' xlink:href='#eq149-g1-60'/>
</g>
</svg></span> is <code>mask</code>, and <span class="m-math"><svg style="width: 0.548em; height: 0.771em; vertical-align: -0.246em;  vertical-align: -0.246em;" viewBox=".18 -5.25 5.48 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq150-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq150-page1'>
<use x='.07' y='0' xlink:href='#eq150-g1-54'/>
</g>
</svg></span> is the Gaussian kernel</p>
<p>The derivative is computed along <code>dimension</code>.</p>
<p>This function uses <a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a>. See that function for the meaning of the parameters. <code>boundaryCondition</code> defaults
to <code>"add zeros"</code>, the normalized convolution then takes pixels outside of the image domain as missing values.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>H. Knutsson and C. F. Westin, &ldquo;Normalized and differential convolution&rdquo;, Proceedings of IEEE Conference on
  Computer Vision and Pattern Recognition, New York, NY, 1993, pp. 515-523.</li>
</ul>
</aside>
          </div></section>
                        <section class="m-doc-details" id="dip-MeanShiftVector-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-dfloat-"><div>
            <h3>
              <span class="m-doc-return">void</span>
              <span class="m-doc-name"><a href="#dip-MeanShiftVector-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-dfloat-" class="m-doc-self">dip::<wbr />MeanShiftVector</a></span>(
<span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,</span><span class="m-doc-arg"><a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> sigmas = {1.0},</span><span class="m-doc-arg"><a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = S::BEST,</span><span class="m-doc-arg"><a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {},</span><span class="m-doc-arg"><a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 3</span>)            </h3>
            <p>Computes the mean shift vector for each pixel in the image</p>
<p>The output image is a vector image, indicating the step to take to move the window center to its center of
mass. Repeatedly following the vector will lead to a local maximum of the image <code>in</code>. <code>in</code> must be scalar
and real-valued.</p>
<p>The mean shift at a given location <span class="m-math"><svg style="width: 0.565em; height: 0.538em; vertical-align: -0.013em;  vertical-align: -0.013em;" viewBox="-.32 -5.25 5.65 5.38">
<title>
\(x\)
</title>
<defs>
<path id='eq153-g1-71' d='M4.95-1.23L4.79-1.32C4.69-1.2 4.63-1.14 4.53-1C4.25-.64 4.12-.52 3.97-.52C3.8-.52 3.69-.68 3.61-1.01C3.59-1.12 3.57-1.18 3.56-1.2C3.28-2.32 3.13-2.97 3.13-3.14C3.66-4.06 4.09-4.59 4.3-4.59C4.37-4.59 4.48-4.55 4.59-4.49C4.73-4.41 4.81-4.38 4.92-4.38C5.16-4.38 5.32-4.56 5.32-4.81C5.32-5.07 5.12-5.25 4.84-5.25C4.31-5.25 3.87-4.82 3.04-3.55L2.91-4.2C2.74-5.01 2.61-5.25 2.29-5.25C2.01-5.25 1.63-5.16 .89-4.91L.76-4.86L.81-4.68L1.01-4.73C1.24-4.79 1.38-4.81 1.48-4.81C1.77-4.81 1.85-4.7 2.01-3.99L2.36-2.53L1.38-1.13C1.13-.77 .91-.56 .77-.56C.7-.56 .58-.6 .46-.67C.31-.75 .19-.79 .08-.79C-.15-.79-.32-.61-.32-.37C-.32-.06-.1 .13 .27 .13S.79 .02 1.38-.69L2.45-2.1L2.81-.67C2.97-.05 3.12 .13 3.5 .13C3.95 .13 4.26-.15 4.95-1.23Z'/>
</defs>
<g id='eq153-page1'>
<use x='0' y='0' xlink:href='#eq153-g1-71'/>
</g>
</svg></span> is then given by</p>
<div class="m-math"><svg style="width: 21.764em; height: 2.766em; vertical-align: -0.000em; " viewBox="85.3 -27.66 217.64 27.66">
<title>
\[ s = \frac{ \sum_i{(x-x_i) w(x-x_i) f(x_i)} }{ \sum_i{w(x-x_i) f(x_i)} }
      = \frac{ \left ( -x w \right) \ast f }{ w \ast f } \; , \]
</title>
<defs>
<path id='eq151-g7-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq151-g7-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq151-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq151-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq151-g4-205' d='M8.65 7.3H8.4C8.16 8.79 7.61 9.46 6.78 9.46H2.11L5.56 5.03L2.49 .46H6.3C7.17 .46 7.72 .94 7.97 2.45H8.23L8.16 0H1.01L4.66 5.23L.51 10.48H8.52L8.65 7.3Z'/>
<path id='eq151-g1-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<use id='eq151-g13-53' xlink:href='#eq151-g10-53' transform='scale(1.36)'/>
<use id='eq151-g13-66' xlink:href='#eq151-g10-66' transform='scale(1.36)'/>
<use id='eq151-g13-70' xlink:href='#eq151-g10-70' transform='scale(1.36)'/>
<use id='eq151-g13-71' xlink:href='#eq151-g10-71' transform='scale(1.36)'/>
<use id='eq151-g13-150' xlink:href='#eq151-g10-150' transform='scale(1.36)'/>
<path id='eq151-g10-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq151-g10-56' d='M2.05-.9L1.94-1C1.56-.5 1.37-.31 1.22-.31C1.15-.31 1.08-.38 1.08-.45C1.08-.59 1.17-.85 1.22-1.02L1.99-3.83L1.97-3.85C1.08-3.69 .91-3.66 .57-3.63V-3.49C1.04-3.49 1.12-3.46 1.12-3.28C1.12-3.21 1.09-3.07 1.04-2.9L.62-1.35C.48-.83 .43-.58 .43-.4C.43-.08 .57 .1 .83 .1C1.24 .1 1.55-.17 2.05-.9ZM2.41-5.14C2.41-5.39 2.21-5.62 1.97-5.62S1.56-5.42 1.56-5.15C1.56-4.87 1.73-4.69 1.98-4.69C2.21-4.69 2.41-4.89 2.41-5.14Z'/>
<path id='eq151-g10-66' d='M2.66-1.04C2.66-1.38 2.47-1.76 2.06-2.26C1.73-2.67 1.59-2.94 1.59-3.18C1.59-3.48 1.77-3.65 2.08-3.65C2.53-3.65 2.79-3.33 2.88-2.65H3.02L3.2-3.86H3.07C3-3.74 2.94-3.7 2.81-3.7C2.74-3.7 2.66-3.72 2.5-3.76C2.28-3.83 2.16-3.85 2.01-3.85C1.36-3.85 .95-3.48 .95-2.89C.95-2.61 1.14-2.24 1.5-1.76C1.84-1.32 1.99-1.01 1.99-.76C1.99-.36 1.73-.09 1.35-.09C.86-.09 .59-.45 .45-1.28H.31L.14 .11H.28C.36-.03 .39-.07 .49-.07S.74-.03 .92 .01C1.12 .07 1.25 .1 1.4 .1C2.13 .1 2.66-.38 2.66-1.04Z'/>
<path id='eq151-g10-70' d='M5.66-3.4C5.66-3.66 5.47-3.85 5.21-3.85C5-3.85 4.87-3.74 4.87-3.56C4.87-3.44 4.91-3.37 5.05-3.24S5.24-3.02 5.24-2.92C5.24-2.54 4.94-2.08 3.8-.65L3.52-3.72C3.52-3.82 3.5-3.84 3.45-3.84C3.41-3.84 3.38-3.83 3.34-3.76L1.66-1.1C1.62-1.87 1.5-2.93 1.38-3.55C1.33-3.83 1.31-3.85 1.21-3.85C.77-3.75 .14-3.64 .14-3.64V-3.53H.39C.65-3.53 .71-3.48 .78-3.16C.87-2.74 .99-1.73 1.02-1.02L1.06-.25C1.07 .09 1.09 .16 1.17 .16C1.27 .16 2.18-1.53 2.18-1.53L2.95-2.76L3.24-.1C3.26 .13 3.28 .16 3.34 .16C3.42 .16 3.5 .07 3.73-.22L3.81-.31C5.02-1.77 5.66-2.84 5.66-3.4Z'/>
<path id='eq151-g10-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq151-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
</defs>
<g id='eq151-page1'>
<use x='85.11' y='-10.95' xlink:href='#eq151-g13-66'/>
<use x='93.38' y='-10.95' xlink:href='#eq151-g1-61'/>
<use x='105.5' y='-27.48' xlink:href='#eq151-g4-205'/>
<use x='114.99' y='-16.45' xlink:href='#eq151-g10-56'/>
<use x='120.85' y='-19.12' xlink:href='#eq151-g7-185'/>
<use x='125.31' y='-19.12' xlink:href='#eq151-g13-71'/>
<use x='133.85' y='-19.12' xlink:href='#eq151-g7-0'/>
<use x='144.11' y='-19.12' xlink:href='#eq151-g13-71'/>
<use x='149.6' y='-17.32' xlink:href='#eq151-g10-56'/>
<use x='152.87' y='-19.12' xlink:href='#eq151-g7-186'/>
<use x='157.6' y='-19.12' xlink:href='#eq151-g13-70'/>
<use x='166.71' y='-19.12' xlink:href='#eq151-g7-185'/>
<use x='171.17' y='-19.12' xlink:href='#eq151-g13-71'/>
<use x='179.72' y='-19.12' xlink:href='#eq151-g7-0'/>
<use x='189.98' y='-19.12' xlink:href='#eq151-g13-71'/>
<use x='195.47' y='-17.32' xlink:href='#eq151-g10-56'/>
<use x='198.74' y='-19.12' xlink:href='#eq151-g7-186'/>
<use x='205.4' y='-19.12' xlink:href='#eq151-g13-53'/>
<use x='211.42' y='-19.12' xlink:href='#eq151-g7-185'/>
<use x='215.88' y='-19.12' xlink:href='#eq151-g13-71'/>
<use x='221.37' y='-17.32' xlink:href='#eq151-g10-56'/>
<use x='224.64' y='-19.12' xlink:href='#eq151-g7-186'/>
<rect x='105.5' y='-14.36' height='.67' width='123.72'/>
<use x='124.1' y='-11.12' xlink:href='#eq151-g4-205'/>
<use x='133.59' y='-.09' xlink:href='#eq151-g10-56'/>
<use x='139' y='-2.75' xlink:href='#eq151-g13-70'/>
<use x='148.11' y='-2.75' xlink:href='#eq151-g7-185'/>
<use x='152.57' y='-2.75' xlink:href='#eq151-g13-71'/>
<use x='161.12' y='-2.75' xlink:href='#eq151-g7-0'/>
<use x='171.38' y='-2.75' xlink:href='#eq151-g13-71'/>
<use x='176.87' y='-.96' xlink:href='#eq151-g10-56'/>
<use x='180.14' y='-2.75' xlink:href='#eq151-g7-186'/>
<use x='186.8' y='-2.75' xlink:href='#eq151-g13-53'/>
<use x='192.82' y='-2.75' xlink:href='#eq151-g7-185'/>
<use x='197.28' y='-2.75' xlink:href='#eq151-g13-71'/>
<use x='202.77' y='-.96' xlink:href='#eq151-g10-56'/>
<use x='206.04' y='-2.75' xlink:href='#eq151-g7-186'/>
<use x='233.74' y='-10.95' xlink:href='#eq151-g1-61'/>
<use x='246.45' y='-19.06' xlink:href='#eq151-g7-185'/>
<use x='250.91' y='-19.04' xlink:href='#eq151-g7-0'/>
<use x='258.52' y='-19.04' xlink:href='#eq151-g13-71'/>
<use x='264.56' y='-19.04' xlink:href='#eq151-g13-70'/>
<use x='273.07' y='-19.06' xlink:href='#eq151-g7-186'/>
<use x='280.31' y='-19.04' xlink:href='#eq151-g7-3'/>
<use x='290.68' y='-19.04' xlink:href='#eq151-g13-53'/>
<rect x='245.86' y='-14.36' height='.67' width='50.25'/>
<use x='257.58' y='-2.75' xlink:href='#eq151-g13-70'/>
<use x='268.74' y='-2.75' xlink:href='#eq151-g7-3'/>
<use x='279.11' y='-2.75' xlink:href='#eq151-g13-53'/>
<use x='300.62' y='-10.95' xlink:href='#eq151-g13-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em;  vertical-align: -0.247em;" viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq154-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq154-page1'>
<use x='2.08' y='0' xlink:href='#eq154-g1-53'/>
</g>
</svg></span> is the image, <span class="m-math"><svg style="width: 0.753em; height: 0.547em; vertical-align: -0.022em;  vertical-align: -0.022em;" viewBox=".35 -5.25 7.53 5.47">
<title>
\(w\)
</title>
<defs>
<path id='eq155-g1-70' d='M7.72-4.63C7.72-4.99 7.46-5.25 7.1-5.25C6.81-5.25 6.63-5.1 6.63-4.86C6.63-4.69 6.69-4.6 6.88-4.42S7.15-4.12 7.15-3.98C7.15-3.47 6.74-2.83 5.18-.88L4.8-5.07C4.8-5.2 4.78-5.24 4.7-5.24C4.65-5.24 4.61-5.22 4.55-5.12L2.26-1.5C2.22-2.55 2.05-3.99 1.88-4.85C1.81-5.23 1.79-5.25 1.66-5.25C1.05-5.11 .19-4.97 .19-4.97V-4.81H.54C.88-4.81 .96-4.74 1.06-4.31C1.19-3.74 1.35-2.36 1.39-1.39L1.44-.35C1.46 .12 1.49 .21 1.6 .21C1.73 .21 2.98-2.08 2.98-2.08L4.03-3.76L4.42-.14C4.44 .18 4.47 .21 4.55 .21C4.66 .21 4.78 .1 5.09-.3L5.19-.43C6.85-2.42 7.72-3.87 7.72-4.63Z'/>
</defs>
<g id='eq155-page1'>
<use x='.16' y='0' xlink:href='#eq155-g1-70'/>
</g>
</svg></span> is a windowing function, and <span class="m-math"><svg style="width: 0.413em; height: 0.461em; vertical-align: 0.075em;  vertical-align: -0.000em;" viewBox=".74 -5.36 4.13 4.61">
<title>
\(\ast\)
</title>
<defs>
<path id='eq156-g1-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
</defs>
<g id='eq156-page1'>
<use x='0' y='0' xlink:href='#eq156-g1-3'/>
</g>
</svg></span> indicates convolution.</p>
<p>We use a Gaussian window with sizes given by <code>sigmas</code>. A Gaussian window causes slower convergence than a
uniform window, but yields a smooth trajectory and more precise results (according to Comaniciu
and Meer, 2002). It also allows us to rewrite the above (with <span class="m-math"><svg style="width: 1.201em; height: 0.771em; vertical-align: -0.246em;  vertical-align: -0.246em;" viewBox=".18 -5.25 12.01 7.71">
<title>
\(g_\sigma\)
</title>
<defs>
<use id='eq157-g4-54' xlink:href='#eq157-g1-54' transform='scale(1.36)'/>
<path id='eq157-g1-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq157-g1-102' d='M5.9-3.85H2.72C1.4-3.85 .22-2.75 .22-1.28C.22-.4 .69 .1 1.58 .1C2.66 .1 3.99-.94 3.99-2.5C3.99-3 3.83-3.19 3.83-3.2H5.73L5.9-3.85ZM3.33-2.49C3.33-1.19 2.6-.12 1.7-.12C1.03-.12 .94-1 .94-1.26C.94-2.94 1.84-3.62 2.49-3.62C2.81-3.62 3.33-3.53 3.33-2.49Z'/>
</defs>
<g id='eq157-page1'>
<use x='.07' y='0' xlink:href='#eq157-g4-54'/>
<use x='6.28' y='1.79' xlink:href='#eq157-g1-102'/>
</g>
</svg></span> the Gaussian window with
parameter <span class="m-math"><svg style="width: 0.775em; height: 0.538em; vertical-align: -0.013em;  vertical-align: -0.013em;" viewBox=".45 -5.25 7.75 5.38">
<title>
\(\sigma\)
</title>
<defs>
<path id='eq158-g1-102' d='M8.05-5.25H3.7C1.91-5.25 .3-3.75 .3-1.75C.3-.55 .94 .13 2.16 .13C3.62 .13 5.44-1.29 5.44-3.41C5.44-4.09 5.22-4.35 5.22-4.36H7.81L8.05-5.25ZM4.54-3.39C4.54-1.62 3.55-.17 2.32-.17C1.41-.17 1.29-1.36 1.29-1.72C1.29-4.01 2.51-4.93 3.39-4.93C3.84-4.93 4.54-4.81 4.54-3.39Z'/>
</defs>
<g id='eq158-page1'>
<use x='.16' y='0' xlink:href='#eq158-g1-102'/>
</g>
</svg></span>) as</p>
<div class="m-math"><svg style="width: 16.102em; height: 2.996em; vertical-align: 0.004em; " viewBox="113.5 -30 161.02 29.96">
<title>
\[ s = \frac{ \left ( -x g_\sigma \right) \ast f }{ g_\sigma \ast f }
      = \frac{ \left ( \sigma^2 \nabla g_\sigma \right) \ast f }{ g_\sigma \ast f } \; . \]
</title>
<defs>
<path id='eq152-g17-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq152-g4-0' d='M3.13 12.48C1.83 11.02 1.64 8.27 1.64 6.06S1.69 1.21 3.13-.43L2.99-.67C2.42-.19 .6 2.12 .6 6.06S2.42 12.26 2.99 12.73L3.13 12.48Z'/>
<path id='eq152-g4-1' d='M.36 12.48L.5 12.73C1.07 12.26 2.89 10 2.89 6.06S1.07-.19 .5-.67L.36-.43C1.8 1.21 1.85 3.86 1.85 6.06S1.66 11.02 .36 12.48Z'/>
<path id='eq152-g1-61' d='M6.84-4V-4.67H.74V-4H6.84ZM6.84-1.58V-2.25H.74V-1.58H6.84Z'/>
<path id='eq152-g7-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq152-g7-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq152-g7-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
<path id='eq152-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq152-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<use id='eq152-g13-53' xlink:href='#eq152-g10-53' transform='scale(1.36)'/>
<use id='eq152-g13-54' xlink:href='#eq152-g10-54' transform='scale(1.36)'/>
<use id='eq152-g13-66' xlink:href='#eq152-g10-66' transform='scale(1.36)'/>
<use id='eq152-g13-71' xlink:href='#eq152-g10-71' transform='scale(1.36)'/>
<use id='eq152-g13-102' xlink:href='#eq152-g10-102' transform='scale(1.36)'/>
<use id='eq152-g13-149' xlink:href='#eq152-g10-149' transform='scale(1.36)'/>
<path id='eq152-g10-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq152-g10-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq152-g10-66' d='M2.66-1.04C2.66-1.38 2.47-1.76 2.06-2.26C1.73-2.67 1.59-2.94 1.59-3.18C1.59-3.48 1.77-3.65 2.08-3.65C2.53-3.65 2.79-3.33 2.88-2.65H3.02L3.2-3.86H3.07C3-3.74 2.94-3.7 2.81-3.7C2.74-3.7 2.66-3.72 2.5-3.76C2.28-3.83 2.16-3.85 2.01-3.85C1.36-3.85 .95-3.48 .95-2.89C.95-2.61 1.14-2.24 1.5-1.76C1.84-1.32 1.99-1.01 1.99-.76C1.99-.36 1.73-.09 1.35-.09C.86-.09 .59-.45 .45-1.28H.31L.14 .11H.28C.36-.03 .39-.07 .49-.07S.74-.03 .92 .01C1.12 .07 1.25 .1 1.4 .1C2.13 .1 2.66-.38 2.66-1.04Z'/>
<path id='eq152-g10-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq152-g10-102' d='M5.9-3.85H2.72C1.4-3.85 .22-2.75 .22-1.28C.22-.4 .69 .1 1.58 .1C2.66 .1 3.99-.94 3.99-2.5C3.99-3 3.83-3.19 3.83-3.2H5.73L5.9-3.85ZM3.33-2.49C3.33-1.19 2.6-.12 1.7-.12C1.03-.12 .94-1 .94-1.26C.94-2.94 1.84-3.62 2.49-3.62C2.81-3.62 3.33-3.53 3.33-2.49Z'/>
<path id='eq152-g10-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
</defs>
<g id='eq152-page1'>
<use x='113.3' y='-10.71' xlink:href='#eq152-g13-66'/>
<use x='121.57' y='-10.71' xlink:href='#eq152-g1-61'/>
<use x='134.29' y='-18.82' xlink:href='#eq152-g7-185'/>
<use x='138.75' y='-18.8' xlink:href='#eq152-g7-0'/>
<use x='146.36' y='-18.8' xlink:href='#eq152-g13-71'/>
<use x='152.31' y='-18.8' xlink:href='#eq152-g13-54'/>
<use x='158.53' y='-17.01' xlink:href='#eq152-g10-102'/>
<use x='165.3' y='-18.82' xlink:href='#eq152-g7-186'/>
<use x='172.54' y='-18.8' xlink:href='#eq152-g7-3'/>
<use x='182.9' y='-18.8' xlink:href='#eq152-g13-53'/>
<rect x='133.69' y='-14.11' height='.67' width='54.64'/>
<use x='145.33' y='-2.5' xlink:href='#eq152-g13-54'/>
<use x='151.54' y='-.71' xlink:href='#eq152-g10-102'/>
<use x='160.97' y='-2.5' xlink:href='#eq152-g7-3'/>
<use x='171.34' y='-2.5' xlink:href='#eq152-g13-53'/>
<use x='192.85' y='-10.71' xlink:href='#eq152-g1-61'/>
<use x='205.92' y='-28.87' xlink:href='#eq152-g4-0'/>
<use x='209.82' y='-19.76' xlink:href='#eq152-g13-102'/>
<use x='218.38' y='-24.1' xlink:href='#eq152-g17-50'/>
<use x='223.38' y='-19.76' xlink:href='#eq152-g7-114'/>
<use x='231.51' y='-19.76' xlink:href='#eq152-g13-54'/>
<use x='237.72' y='-17.97' xlink:href='#eq152-g10-102'/>
<use x='244.74' y='-28.87' xlink:href='#eq152-g4-1'/>
<use x='251.85' y='-19.76' xlink:href='#eq152-g7-3'/>
<use x='262.22' y='-19.76' xlink:href='#eq152-g13-53'/>
<rect x='204.97' y='-14.11' height='.67' width='62.68'/>
<use x='220.63' y='-2.5' xlink:href='#eq152-g13-54'/>
<use x='226.84' y='-.71' xlink:href='#eq152-g10-102'/>
<use x='236.27' y='-2.5' xlink:href='#eq152-g7-3'/>
<use x='246.64' y='-2.5' xlink:href='#eq152-g13-53'/>
<use x='272.36' y='-10.71' xlink:href='#eq152-g13-149'/>
</g>
</svg></div>
<p>Thus, we can write this filter as <code>dip::Gradient(in, sigmas) / dip::Gauss(in, sigmas) * sigmas * sigmas</code>.
See <a href="linear.html#dip-Derivative-Image-CL-Image-L-UnsignedArray--FloatArray--String-CL-StringArray-CL-dfloat-"><code>dip::Derivative</code></a> for more information on the parameters. Do not use <code>method = "finitediff"</code>,
as it will lead to nonsensical results.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="analysis.html#dip-MeanShift-Image-CL-FloatArray-CL-dfloat-"><code>dip::MeanShift</code></a>, <a href="linear.html#dip-Gradient-Image-CL-Image-L-FloatArray--String-CL-StringArray-CL-BooleanArray--dfloat-"><code>dip::Gradient</code></a>, <a href="linear.html#dip-Gauss-Image-CL-Image-L-FloatArray--UnsignedArray--String-CL-StringArray-CL-dfloat-"><code>dip::Gauss</code></a></p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>D. Comaniciu and P. Meer, &ldquo;Mean Shift: A Robust Approach Toward Feature Space Analysis&rdquo;,
  IEEE Transactions on Pattern Analysis and Machine Intelligence 24(5):603-619, 2002.</li>
</ul>
</aside>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form action="https://diplib.org/diplib-docs/#search">
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript. Enable it or <a href="https://google.com/search?q=site:diplib.org+">use an external search engine</a>.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or modules.
              You can omit any prefix from the symbol or file path; adding a <code>:</code> or
              <code>/</code> suffix lists all members of given symbol or directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span> / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
              <span class="m-label m-dim">Enter</span> to go.
              <span class="m-label m-dim">Tab</span> autocompletes common prefix.
              You can copy a link to the result using <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">L</span>,
              or <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">M</span> to copy a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.<br />Maybe try a full-text <a href="#" id="search-external" data-search-engine="https://google.com/search?q=site:diplib.org+{query}">search with external engine</a>?</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>DIPlib, a library for quantitative image analysis. Documentation compiled with <a href="https://crisluengo.github.io/doxpp/">dox++</a> and styled with <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>