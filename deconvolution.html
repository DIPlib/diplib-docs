<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Filtering &raquo; Deconvolution module | DIPlib | a library for quantitative image analysis</title>
  <link rel="stylesheet" href="m-dip+documentation.compiled.css" />
  <link rel="icon" href="DIPlib_logo_32.png" type="image/png" />
  <link rel="search" type="application/opensearchdescription+xml" href="opensearch.xml" title="Search DIPlib documentation" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#ffffff" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://diplib.org"><img src="DIPlib_logo.svg" alt="" />DIPlib</a><span class="m-breadcrumb">┃</span><a href="index.html" class="m-thin">a library for quantitative image analysis</a><span class="m-breadcrumb">┃</span><a href="https://github.com/DIPlib/diplib/releases/tag/3.5.1" class="m-thin">version 3.5.1</a>      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="modules.html">Modules</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="classes.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="filtering.html">Filtering</a> &raquo;</span>
          Deconvolution <span class="m-thin">module</span>          <div class="m-doc-include m-code m-inverted m-text-right"><span class="cp">#include</span> <a class="cpf" href="file--diplib--deconvolution-h.html">"diplib/deconvolution.h"</a></div>
        </h1>
        <p>Deconvolution algorithms (inverse filtering).</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#function-members">Functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
        <section id="function-members">
          <h2>Functions</h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-WienerDeconvolution-Image-CL-Image-CL-Image-CL-Image-CL-Image-L-StringSet-CL" class="m-doc">dip::<wbr />WienerDeconvolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; signalPower,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; noisePower,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span>
            </dt>
            <dd>Wiener deconvolution using estimates of signal and noise power spectra.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-WienerDeconvolution-Image-CL-Image-CL-Image-L-dfloat--StringSet-CL" class="m-doc">dip::<wbr />WienerDeconvolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 1e-4,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span>
            </dt>
            <dd>Wiener deconvolution using an estimate of noise-to-signal ratio.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-TikhonovMiller-Image-CL-Image-CL-Image-L-dfloat--StringSet-CL" class="m-doc">dip::<wbr />TikhonovMiller</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 0.1,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span>
            </dt>
            <dd>Tikhonov-Miller deconvolution.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-IterativeConstrainedTikhonovMiller-Image-CL-Image-CL-Image-L-dfloat--dfloat--dip-uint--dfloat--StringSet-CL" class="m-doc">dip::<wbr />IterativeConstrainedTikhonovMiller</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 0.1,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tolerance = 1e-6,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> maxIterations = 30,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> stepSize = 0.0,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span>
            </dt>
            <dd>Iterative Constrained Tikhonov-Miller (ICTM) deconvolution.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-RichardsonLucy-Image-CL-Image-CL-Image-L-dfloat--dip-uint--StringSet-CL" class="m-doc">dip::<wbr />RichardsonLucy</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 0.0,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> nIterations = 30,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span>
            </dt>
            <dd>Richardson-Lucy (RL) deconvolution, also sometimes called the expectation maximization (EM) method.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-FastIterativeShrinkageThresholding-Image-CL-Image-CL-Image-L-dfloat--dfloat--dip-uint--dip-uint--StringSet-CL" class="m-doc">dip::<wbr />FastIterativeShrinkageThresholding</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 0.1,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tolerance = 1e-6,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> maxIterations = 30,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> nScales = 3,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span>
            </dt>
            <dd>Fast Iterative Shrinkage-Thresholding (FISTA) deconvolution.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="dip-WienerDeconvolution-Image-CL-Image-CL-Image-CL-Image-CL-Image-L-StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-WienerDeconvolution-Image-CL-Image-CL-Image-CL-Image-CL-Image-L-StringSet-CL" class="m-doc-self">dip::<wbr />WienerDeconvolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; signalPower,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; noisePower,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span></span>
            </h3>
            <p>Wiener deconvolution using estimates of signal and noise power spectra.</p>
<p>Assuming some original image <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em; " viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq25-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq25-page1'>
<use x='2.08' y='0' xlink:href='#eq25-g1-53'/>
</g>
</svg></span>, a known convolution kernel <span class="m-math"><svg style="width: 0.569em; height: 0.824em; vertical-align: -0.011em; " viewBox=".43 -8.13 5.69 8.24">
<title>
\(h\)
</title>
<defs>
<path id='eq26-g1-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
</defs>
<g id='eq26-page1'>
<use x='.43' y='0' xlink:href='#eq26-g1-17'/>
</g>
</svg></span> (given by <code>psf</code>), a noise realization <span class="m-math"><svg style="width: 0.565em; height: 0.536em; vertical-align: -0.011em; " viewBox=".06 -5.25 5.65 5.36">
<title>
\(n\)
</title>
<defs>
<path id='eq27-g1-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq27-page1'>
<use x='.06' y='0' xlink:href='#eq27-g1-61'/>
</g>
</svg></span>,
and an observed image <span class="m-math"><svg style="width: 6.292em; height: 1.060em; vertical-align: -0.247em; " viewBox=".07 -8.13 62.92 10.6">
<title>
\(g = h * f + n\)
</title>
<defs>
<path id='eq28-g4-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq28-g4-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq28-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq28-g7-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq28-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq28-g7-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq28-g7-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq28-page1'>
<use x='.07' y='0' xlink:href='#eq28-g7-54'/>
<use x='9.73' y='0' xlink:href='#eq28-g1-61'/>
<use x='20.56' y='0' xlink:href='#eq28-g7-17'/>
<use x='29.44' y='0' xlink:href='#eq28-g4-3'/>
<use x='39.8' y='0' xlink:href='#eq28-g7-53'/>
<use x='47.89' y='0' xlink:href='#eq28-g4-184'/>
<use x='57.35' y='0' xlink:href='#eq28-g7-61'/>
</g>
</svg></span> (given by <code>in</code>), the Wiener deconvolution filter is the linear filter
<span class="m-math"><svg style="width: 1.696em; height: 1.005em; vertical-align: -0.192em; " viewBox=".43 -8.13 16.96 10.05">
<title>
\(h_\text{inv}\)
</title>
<defs>
<path id='eq29-g0-105' d='M2.22 0V-.13C1.64-.18 1.57-.26 1.57-.89V-4.01L1.53-4.03L.18-3.55V-3.42L.25-3.43C.35-3.45 .46-3.45 .54-3.45C.75-3.45 .83-3.31 .83-2.93V-.89C.83-.26 .75-.17 .14-.13V0H2.22ZM1.65-5.54C1.65-5.79 1.46-5.99 1.2-5.99C.96-5.99 .75-5.79 .75-5.54C.75-5.29 .96-5.09 1.2-5.09C1.46-5.09 1.65-5.29 1.65-5.54Z'/>
<path id='eq29-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq29-g0-118' d='M4.18-3.81V-3.95H2.96V-3.81C3.24-3.79 3.38-3.7 3.38-3.53C3.38-3.45 3.36-3.36 3.32-3.27L2.45-1L1.56-3.24C1.51-3.37 1.48-3.49 1.48-3.57C1.48-3.73 1.58-3.79 1.88-3.81V-3.95H.17V-3.81C.5-3.8 .56-3.71 .96-2.81L2.02-.29C2.03-.24 2.06-.18 2.09-.11C2.14 .05 2.19 .12 2.24 .12S2.36 .01 2.49-.32L3.61-3.13C3.87-3.73 3.92-3.79 4.18-3.81Z'/>
<path id='eq29-g2-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
</defs>
<g id='eq29-page1'>
<use x='.43' y='0' xlink:href='#eq29-g2-17'/>
<use x='6.65' y='1.79' xlink:href='#eq29-g0-105'/>
<use x='9.08' y='1.79' xlink:href='#eq29-g0-110'/>
<use x='13.2' y='1.79' xlink:href='#eq29-g0-118'/>
</g>
</svg></span> that, when convolved with <span class="m-math"><svg style="width: 0.559em; height: 0.771em; vertical-align: -0.246em; " viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq30-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq30-page1'>
<use x='.07' y='0' xlink:href='#eq30-g1-54'/>
</g>
</svg></span>, yields an image <span class="m-math"><svg style="width: 5.559em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 55.59 13.18">
<title>
\(\hat{f} = h_\text{inv} * g\)
</title>
<defs>
<path id='eq31-g0-105' d='M2.22 0V-.13C1.64-.18 1.57-.26 1.57-.89V-4.01L1.53-4.03L.18-3.55V-3.42L.25-3.43C.35-3.45 .46-3.45 .54-3.45C.75-3.45 .83-3.31 .83-2.93V-.89C.83-.26 .75-.17 .14-.13V0H2.22ZM1.65-5.54C1.65-5.79 1.46-5.99 1.2-5.99C.96-5.99 .75-5.79 .75-5.54C.75-5.29 .96-5.09 1.2-5.09C1.46-5.09 1.65-5.29 1.65-5.54Z'/>
<path id='eq31-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq31-g0-118' d='M4.18-3.81V-3.95H2.96V-3.81C3.24-3.79 3.38-3.7 3.38-3.53C3.38-3.45 3.36-3.36 3.32-3.27L2.45-1L1.56-3.24C1.51-3.37 1.48-3.49 1.48-3.57C1.48-3.73 1.58-3.79 1.88-3.81V-3.95H.17V-3.81C.5-3.8 .56-3.71 .96-2.81L2.02-.29C2.03-.24 2.06-.18 2.09-.11C2.14 .05 2.19 .12 2.24 .12S2.36 .01 2.49-.32L3.61-3.13C3.87-3.73 3.92-3.79 4.18-3.81Z'/>
<path id='eq31-g5-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq31-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq31-g8-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq31-g8-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq31-g8-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq31-g12-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq31-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq31-g12-94'/>
<use x='2.08' y='0' xlink:href='#eq31-g8-53'/>
<use x='10.83' y='0' xlink:href='#eq31-g2-61'/>
<use x='21.66' y='0' xlink:href='#eq31-g8-17'/>
<use x='27.87' y='1.79' xlink:href='#eq31-g0-105'/>
<use x='30.31' y='1.79' xlink:href='#eq31-g0-110'/>
<use x='34.43' y='1.79' xlink:href='#eq31-g0-118'/>
<use x='41.97' y='0' xlink:href='#eq31-g5-3'/>
<use x='50.33' y='0' xlink:href='#eq31-g8-54'/>
</g>
</svg></span> such that the mean
square error between <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em; " viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq32-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq32-page1'>
<use x='2.08' y='0' xlink:href='#eq32-g1-53'/>
</g>
</svg></span> and <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq33-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq33-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq33-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq33-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq33-g1-53'/>
</g>
</svg></span> is minimized.</p>
<p>Finding <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq34-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq34-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq34-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq34-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq34-g1-53'/>
</g>
</svg></span> (returned in <code>out</code>) requires knowledge of the power spectra of the signal and the noise.
The Wiener deconvolution filter is defined in the frequency domain as</p>
<div class="m-math"><svg style="width: 9.397em; height: 2.478em; vertical-align: 0.001em; " viewBox="147 -24.79 93.97 24.78">
<title>
\[ H_\text{inv} = \frac{H^* S}{ H^* H S + N } \; , \]
</title>
<defs>
<use id='eq23-g8-184' xlink:href='#eq23-g5-184' transform='scale(1.36)'/>
<path id='eq23-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq23-g0-105' d='M2.22 0V-.13C1.64-.18 1.57-.26 1.57-.89V-4.01L1.53-4.03L.18-3.55V-3.42L.25-3.43C.35-3.45 .46-3.45 .54-3.45C.75-3.45 .83-3.31 .83-2.93V-.89C.83-.26 .75-.17 .14-.13V0H2.22ZM1.65-5.54C1.65-5.79 1.46-5.99 1.2-5.99C.96-5.99 .75-5.79 .75-5.54C.75-5.29 .96-5.09 1.2-5.09C1.46-5.09 1.65-5.29 1.65-5.54Z'/>
<path id='eq23-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq23-g0-118' d='M4.18-3.81V-3.95H2.96V-3.81C3.24-3.79 3.38-3.7 3.38-3.53C3.38-3.45 3.36-3.36 3.32-3.27L2.45-1L1.56-3.24C1.51-3.37 1.48-3.49 1.48-3.57C1.48-3.73 1.58-3.79 1.88-3.81V-3.95H.17V-3.81C.5-3.8 .56-3.71 .96-2.81L2.02-.29C2.03-.24 2.06-.18 2.09-.11C2.14 .05 2.19 .12 2.24 .12S2.36 .01 2.49-.32L3.61-3.13C3.87-3.73 3.92-3.79 4.18-3.81Z'/>
<path id='eq23-g5-3' d='M3.57-2.92C3.57-3.07 3.45-3.22 3.29-3.22C3.09-3.22 2.38-2.51 2.12-2.36C2.12-2.85 2.37-3.34 2.37-3.63C2.37-3.82 2.24-3.93 2.06-3.93C1.89-3.93 1.78-3.81 1.78-3.63C1.78-3.29 1.99-2.83 1.99-2.36C1.71-2.52 1.03-3.26 .85-3.26C.69-3.26 .55-3.11 .55-2.95C.55-2.65 1.58-2.44 1.92-2.24C1.55-2.04 .87-1.93 .7-1.82C.61-1.76 .54-1.68 .54-1.56C.54-1.41 .66-1.27 .82-1.27C1.02-1.27 1.73-1.97 1.99-2.12C1.99-1.64 1.75-1.15 1.75-.85C1.75-.67 1.88-.55 2.05-.55S2.33-.68 2.33-.85C2.33-1.21 2.13-1.66 2.13-2.12C2.4-1.97 3.09-1.23 3.27-1.23C3.42-1.23 3.56-1.38 3.56-1.54C3.56-1.65 3.49-1.73 3.4-1.78C3.17-1.93 2.57-2.03 2.19-2.24C2.6-2.49 3.16-2.52 3.42-2.67C3.51-2.73 3.57-2.8 3.57-2.92Z'/>
<path id='eq23-g5-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<path id='eq23-g11-29' d='M7.48 0V-.19C6.71-.27 6.55-.36 6.55-.69C6.55-.79 6.56-.88 6.59-.98L8.16-6.71C8.36-7.4 8.46-7.47 9.14-7.59V-7.78H6.19V-7.59C6.88-7.5 7.03-7.41 7.03-7.07C7.03-6.9 6.98-6.66 6.9-6.34L6.35-4.38H2.95L3.6-6.71C3.78-7.31 4.09-7.54 4.8-7.59V-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.07C2.47-6.9 2.43-6.66 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.83V-.19C2.12-.29 1.99-.37 1.99-.71C1.99-.8 2-.89 2.02-.98L2.81-3.88H6.21L5.43-1.07C5.24-.45 5-.27 4.23-.19V0H7.48Z'/>
<path id='eq23-g11-35' d='M8.66-7.59V-7.78H6.29V-7.59C6.97-7.53 7.12-7.41 7.12-6.98C7.12-6.84 7.1-6.71 7.02-6.46L6.99-6.36L5.78-1.83L3.3-7.78H1.38V-7.59C1.94-7.54 2.19-7.38 2.41-6.92L.99-1.95C.54-.43 .44-.29-.24-.19V0H2.12V-.19C1.5-.24 1.29-.37 1.29-.7C1.29-.86 1.32-1.1 1.39-1.35L2.75-6.37L5.49 .18H5.71L7.42-5.81C7.86-7.35 7.91-7.42 8.66-7.59Z'/>
<path id='eq23-g11-40' d='M5.13-2.17C5.13-2.94 4.87-3.39 3.79-4.49C2.7-5.57 2.61-5.74 2.61-6.32C2.61-7.07 3.11-7.54 3.92-7.54C4.36-7.54 4.72-7.4 4.97-7.11C5.24-6.81 5.34-6.41 5.36-5.61L5.57-5.57L6.05-7.94H5.78C5.61-7.69 5.5-7.63 5.24-7.63C5.09-7.63 4.94-7.67 4.69-7.77C4.44-7.87 4.05-7.93 3.68-7.93C2.44-7.93 1.56-7.11 1.56-5.94C1.56-5.3 1.74-4.95 2.45-4.19C2.61-4.04 2.76-3.87 2.92-3.69L3.38-3.19C3.94-2.61 4.1-2.3 4.1-1.79C4.1-.88 3.44-.2 2.56-.2C1.56-.2 .82-1.05 .82-2.22C.82-2.3 .82-2.35 .85-2.45L.61-2.48L.2 .18H.42C.5-.1 .63-.21 .87-.21C1-.21 1.17-.17 1.49-.06C2.04 .14 2.36 .21 2.73 .21C4.1 .21 5.13-.81 5.13-2.17Z'/>
<path id='eq23-g11-150' d='M2.32-.07C2.32-1.06 1.63-1.21 1.36-1.21C1.06-1.21 .67-1.04 .67-.52C.67-.05 1.1 .07 1.41 .07C1.49 .07 1.55 .06 1.58 .05C1.63 .04 1.67 .02 1.69 .02C1.77 .02 1.86 .08 1.86 .19C1.86 .42 1.67 .95 .88 1.45L.99 1.68C1.35 1.56 2.32 .77 2.32-.07Z'/>
</defs>
<g id='eq23-page1'>
<use x='147.09' y='-8.42' xlink:href='#eq23-g11-29'/>
<use x='155.84' y='-6.63' xlink:href='#eq23-g0-105'/>
<use x='158.28' y='-6.63' xlink:href='#eq23-g0-110'/>
<use x='162.4' y='-6.63' xlink:href='#eq23-g0-118'/>
<use x='170.6' y='-8.42' xlink:href='#eq23-g2-61'/>
<use x='198.04' y='-16.52' xlink:href='#eq23-g11-29'/>
<use x='207.34' y='-20.86' xlink:href='#eq23-g5-3'/>
<use x='212.21' y='-16.52' xlink:href='#eq23-g11-40'/>
<rect x='182.2' y='-11.83' height='.67' width='51.93'/>
<use x='182.51' y='-.22' xlink:href='#eq23-g11-29'/>
<use x='191.81' y='-3.68' xlink:href='#eq23-g5-3'/>
<use x='196.75' y='-.22' xlink:href='#eq23-g11-29'/>
<use x='206.29' y='-.22' xlink:href='#eq23-g11-40'/>
<use x='215.33' y='-.22' xlink:href='#eq23-g8-184'/>
<use x='225.18' y='-.22' xlink:href='#eq23-g11-35'/>
<use x='238.64' y='-8.42' xlink:href='#eq23-g11-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.860em; height: 0.815em; vertical-align: -0.022em; " viewBox="-.02 -7.93 8.6 8.15">
<title>
\(G\)
</title>
<defs>
<path id='eq35-g1-28' d='M8.6-3.61V-3.8H5.43V-3.61L5.78-3.57C6.17-3.54 6.36-3.42 6.36-3.2C6.36-2.94 6.29-2.63 6.05-1.83C5.79-.92 5.73-.77 5.59-.63C5.32-.37 4.87-.23 4.34-.23C2.8-.23 1.93-1.11 1.93-2.67C1.93-4.13 2.51-5.66 3.45-6.65C3.99-7.21 4.73-7.53 5.51-7.53C6.28-7.53 6.92-7.22 7.29-6.68C7.49-6.37 7.58-6.11 7.63-5.57L7.85-5.54L8.43-7.88L8.25-7.93C8.05-7.65 7.85-7.53 7.54-7.53C7.41-7.53 7.29-7.55 7.02-7.65C6.43-7.84 5.91-7.93 5.42-7.93C2.91-7.93 .62-5.55 .62-2.93C.62-2.12 .96-1.29 1.52-.71C2.13-.11 3 .21 4.04 .21C5.09 .21 5.94-.01 6.86-.52L7.44-2.75C7.63-3.42 7.83-3.56 8.6-3.61Z'/>
</defs>
<g id='eq35-page1'>
<use x='-.02' y='0' xlink:href='#eq35-g1-28'/>
</g>
</svg></span> is the Fourier transform of <code>in</code>, <span class="m-math"><svg style="width: 0.923em; height: 0.778em; vertical-align: -0.000em; " viewBox=".22 -7.78 9.23 7.78">
<title>
\(H\)
</title>
<defs>
<path id='eq36-g1-29' d='M7.48 0V-.19C6.71-.27 6.55-.36 6.55-.69C6.55-.79 6.56-.88 6.59-.98L8.16-6.71C8.36-7.4 8.46-7.47 9.14-7.59V-7.78H6.19V-7.59C6.88-7.5 7.03-7.41 7.03-7.07C7.03-6.9 6.98-6.66 6.9-6.34L6.35-4.38H2.95L3.6-6.71C3.78-7.31 4.09-7.54 4.8-7.59V-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.07C2.47-6.9 2.43-6.66 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.83V-.19C2.12-.29 1.99-.37 1.99-.71C1.99-.8 2-.89 2.02-.98L2.81-3.88H6.21L5.43-1.07C5.24-.45 5-.27 4.23-.19V0H7.48Z'/>
</defs>
<g id='eq36-page1'>
<use x='.31' y='0' xlink:href='#eq36-g1-29'/>
</g>
</svg></span> is the Fourier transform of <code>psf</code>, <span class="m-math"><svg style="width: 0.605em; height: 0.816em; vertical-align: -0.022em; " viewBox=".24 -7.94 6.05 8.16">
<title>
\(S\)
</title>
<defs>
<path id='eq37-g1-40' d='M5.13-2.17C5.13-2.94 4.87-3.39 3.79-4.49C2.7-5.57 2.61-5.74 2.61-6.32C2.61-7.07 3.11-7.54 3.92-7.54C4.36-7.54 4.72-7.4 4.97-7.11C5.24-6.81 5.34-6.41 5.36-5.61L5.57-5.57L6.05-7.94H5.78C5.61-7.69 5.5-7.63 5.24-7.63C5.09-7.63 4.94-7.67 4.69-7.77C4.44-7.87 4.05-7.93 3.68-7.93C2.44-7.93 1.56-7.11 1.56-5.94C1.56-5.3 1.74-4.95 2.45-4.19C2.61-4.04 2.76-3.87 2.92-3.69L3.38-3.19C3.94-2.61 4.1-2.3 4.1-1.79C4.1-.88 3.44-.2 2.56-.2C1.56-.2 .82-1.05 .82-2.22C.82-2.3 .82-2.35 .85-2.45L.61-2.48L.2 .18H.42C.5-.1 .63-.21 .87-.21C1-.21 1.17-.17 1.49-.06C2.04 .14 2.36 .21 2.73 .21C4.1 .21 5.13-.81 5.13-2.17Z'/>
</defs>
<g id='eq37-page1'>
<use x='.24' y='0' xlink:href='#eq37-g1-40'/>
</g>
</svg></span> is <code>signalPower</code>,
and <span class="m-math"><svg style="width: 0.890em; height: 0.796em; vertical-align: -0.018em; " viewBox=".22 -7.78 8.9 7.96">
<title>
\(N\)
</title>
<defs>
<path id='eq38-g1-35' d='M8.66-7.59V-7.78H6.29V-7.59C6.97-7.53 7.12-7.41 7.12-6.98C7.12-6.84 7.1-6.71 7.02-6.46L6.99-6.36L5.78-1.83L3.3-7.78H1.38V-7.59C1.94-7.54 2.19-7.38 2.41-6.92L.99-1.95C.54-.43 .44-.29-.24-.19V0H2.12V-.19C1.5-.24 1.29-.37 1.29-.7C1.29-.86 1.32-1.1 1.39-1.35L2.75-6.37L5.49 .18H5.71L7.42-5.81C7.86-7.35 7.91-7.42 8.66-7.59Z'/>
</defs>
<g id='eq38-page1'>
<use x='.45' y='0' xlink:href='#eq38-g1-35'/>
</g>
</svg></span> is <code>noisePower</code>. These <span class="m-math"><svg style="width: 0.605em; height: 0.816em; vertical-align: -0.022em; " viewBox=".24 -7.94 6.05 8.16">
<title>
\(S\)
</title>
<defs>
<path id='eq39-g1-40' d='M5.13-2.17C5.13-2.94 4.87-3.39 3.79-4.49C2.7-5.57 2.61-5.74 2.61-6.32C2.61-7.07 3.11-7.54 3.92-7.54C4.36-7.54 4.72-7.4 4.97-7.11C5.24-6.81 5.34-6.41 5.36-5.61L5.57-5.57L6.05-7.94H5.78C5.61-7.69 5.5-7.63 5.24-7.63C5.09-7.63 4.94-7.67 4.69-7.77C4.44-7.87 4.05-7.93 3.68-7.93C2.44-7.93 1.56-7.11 1.56-5.94C1.56-5.3 1.74-4.95 2.45-4.19C2.61-4.04 2.76-3.87 2.92-3.69L3.38-3.19C3.94-2.61 4.1-2.3 4.1-1.79C4.1-.88 3.44-.2 2.56-.2C1.56-.2 .82-1.05 .82-2.22C.82-2.3 .82-2.35 .85-2.45L.61-2.48L.2 .18H.42C.5-.1 .63-.21 .87-.21C1-.21 1.17-.17 1.49-.06C2.04 .14 2.36 .21 2.73 .21C4.1 .21 5.13-.81 5.13-2.17Z'/>
</defs>
<g id='eq39-page1'>
<use x='.24' y='0' xlink:href='#eq39-g1-40'/>
</g>
</svg></span> and <span class="m-math"><svg style="width: 0.890em; height: 0.796em; vertical-align: -0.018em; " viewBox=".22 -7.78 8.9 7.96">
<title>
\(N\)
</title>
<defs>
<path id='eq40-g1-35' d='M8.66-7.59V-7.78H6.29V-7.59C6.97-7.53 7.12-7.41 7.12-6.98C7.12-6.84 7.1-6.71 7.02-6.46L6.99-6.36L5.78-1.83L3.3-7.78H1.38V-7.59C1.94-7.54 2.19-7.38 2.41-6.92L.99-1.95C.54-.43 .44-.29-.24-.19V0H2.12V-.19C1.5-.24 1.29-.37 1.29-.7C1.29-.86 1.32-1.1 1.39-1.35L2.75-6.37L5.49 .18H5.71L7.42-5.81C7.86-7.35 7.91-7.42 8.66-7.59Z'/>
</defs>
<g id='eq40-page1'>
<use x='.45' y='0' xlink:href='#eq40-g1-35'/>
</g>
</svg></span> are typically not known, but:</p>
<ul>
<li>
<p><code>signalPower</code> can be estimated as the Fourier transform of the autocorrelation of <code>in</code>. If a raw image
  is passed for this argument (<code>dip::Image{}</code>), then it will be computed as such.</p>
</li>
<li>
<p><code>noisePower</code> can be estimated as a flat function, assuming white noise. A 0D image can be given here,
  it will be expanded to the size of the other images. <code>noisePower</code> should not be zero anywhere, as that
  might lead to division by zero and consequently meaningless results.</p>
</li>
</ul>
<p>The other syntax for <code>dip::WienerDeconvolution</code> takes an estimate of the noise-to-signal
ratio instead of the signal and noise power spectra. Note that <span class="m-math"><svg style="width: 1.959em; height: 0.969em; vertical-align: -0.191em; " viewBox=".22 -7.78 19.59 9.69">
<title>
\(H_\text{inv}\)
</title>
<defs>
<path id='eq41-g0-105' d='M2.22 0V-.13C1.64-.18 1.57-.26 1.57-.89V-4.01L1.53-4.03L.18-3.55V-3.42L.25-3.43C.35-3.45 .46-3.45 .54-3.45C.75-3.45 .83-3.31 .83-2.93V-.89C.83-.26 .75-.17 .14-.13V0H2.22ZM1.65-5.54C1.65-5.79 1.46-5.99 1.2-5.99C.96-5.99 .75-5.79 .75-5.54C.75-5.29 .96-5.09 1.2-5.09C1.46-5.09 1.65-5.29 1.65-5.54Z'/>
<path id='eq41-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq41-g0-118' d='M4.18-3.81V-3.95H2.96V-3.81C3.24-3.79 3.38-3.7 3.38-3.53C3.38-3.45 3.36-3.36 3.32-3.27L2.45-1L1.56-3.24C1.51-3.37 1.48-3.49 1.48-3.57C1.48-3.73 1.58-3.79 1.88-3.81V-3.95H.17V-3.81C.5-3.8 .56-3.71 .96-2.81L2.02-.29C2.03-.24 2.06-.18 2.09-.11C2.14 .05 2.19 .12 2.24 .12S2.36 .01 2.49-.32L3.61-3.13C3.87-3.73 3.92-3.79 4.18-3.81Z'/>
<path id='eq41-g2-29' d='M7.48 0V-.19C6.71-.27 6.55-.36 6.55-.69C6.55-.79 6.56-.88 6.59-.98L8.16-6.71C8.36-7.4 8.46-7.47 9.14-7.59V-7.78H6.19V-7.59C6.88-7.5 7.03-7.41 7.03-7.07C7.03-6.9 6.98-6.66 6.9-6.34L6.35-4.38H2.95L3.6-6.71C3.78-7.31 4.09-7.54 4.8-7.59V-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.07C2.47-6.9 2.43-6.66 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.83V-.19C2.12-.29 1.99-.37 1.99-.71C1.99-.8 2-.89 2.02-.98L2.81-3.88H6.21L5.43-1.07C5.24-.45 5-.27 4.23-.19V0H7.48Z'/>
</defs>
<g id='eq41-page1'>
<use x='.31' y='0' xlink:href='#eq41-g2-29'/>
<use x='9.06' y='1.79' xlink:href='#eq41-g0-105'/>
<use x='11.5' y='1.79' xlink:href='#eq41-g0-110'/>
<use x='15.62' y='1.79' xlink:href='#eq41-g0-118'/>
</g>
</svg></span> can be rewritten as</p>
<div class="m-math"><svg style="width: 14.831em; height: 3.036em; vertical-align: -0.000em; " viewBox="119.83 -30.36 148.31 30.36">
<title>
\[ H_\text{inv} = \frac{H^*}{ H^* H  + \frac{N}{S} } = \frac{H^*}{ H^* H + K } \; , \]
</title>
<defs>
<path id='eq24-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq24-g11-29' d='M5.49 0V-.14C4.92-.2 4.8-.26 4.8-.51C4.8-.58 4.81-.65 4.83-.72L5.98-4.92C6.13-5.42 6.2-5.48 6.7-5.56V-5.7H4.54V-5.56C5.05-5.5 5.15-5.43 5.15-5.19C5.15-5.06 5.12-4.88 5.06-4.65L4.66-3.21H2.17L2.64-4.92C2.77-5.36 3-5.53 3.52-5.56V-5.7H1.14V-5.56C1.69-5.51 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.08V-.14C1.55-.21 1.46-.27 1.46-.52C1.46-.59 1.47-.66 1.48-.72L2.06-2.85H4.55L3.98-.79C3.84-.33 3.67-.2 3.1-.14V0H5.49Z'/>
<path id='eq24-g11-32' d='M5.4 0V-.14C4.85-.19 4.8-.22 4.55-.63L3.03-3.28L5.65-5.25C5.9-5.43 6.1-5.53 6.31-5.56V-5.7H4.37V-5.56L4.6-5.54C4.81-5.52 4.9-5.47 4.9-5.37C4.9-5.16 4.42-4.7 3.64-4.15L2.31-3.22L2.78-4.92C2.91-5.35 3.14-5.53 3.66-5.56V-5.7H1.28V-5.56C1.83-5.51 1.95-5.44 1.95-5.19C1.95-5.06 1.92-4.88 1.85-4.65L.78-.79C.62-.26 .58-.22 .06-.14V0H2.23V-.14C1.68-.2 1.6-.25 1.6-.52C1.6-.62 1.61-.68 1.67-.86L1.72-1.05L2.26-3.04L3.32-1.22C3.53-.86 3.65-.56 3.65-.39C3.65-.26 3.53-.19 3.25-.17L3-.14V0H5.4Z'/>
<path id='eq24-g11-35' d='M6.35-5.56V-5.7H4.61V-5.56C5.11-5.52 5.22-5.43 5.22-5.12C5.22-5.01 5.21-4.92 5.14-4.73L5.13-4.66L4.24-1.35L2.42-5.7H1.01V-5.56C1.42-5.53 1.61-5.42 1.76-5.07L.72-1.43C.39-.31 .32-.21-.17-.14V0H1.55V-.14C1.1-.17 .94-.27 .94-.52C.94-.63 .97-.8 1.02-.99L2.02-4.67L4.03 .13H4.18L5.44-4.26C5.76-5.39 5.8-5.44 6.35-5.56Z'/>
<path id='eq24-g11-40' d='M3.76-1.59C3.76-2.16 3.57-2.49 2.78-3.29C1.98-4.09 1.91-4.21 1.91-4.64C1.91-5.19 2.28-5.53 2.87-5.53C3.2-5.53 3.46-5.42 3.64-5.21C3.84-5 3.91-4.7 3.93-4.11L4.09-4.09L4.44-5.83H4.24C4.11-5.64 4.04-5.6 3.84-5.6C3.73-5.6 3.62-5.62 3.44-5.69C3.26-5.77 2.97-5.82 2.7-5.82C1.79-5.82 1.14-5.21 1.14-4.36C1.14-3.89 1.28-3.63 1.8-3.07C1.91-2.96 2.03-2.84 2.14-2.71L2.48-2.34C2.89-1.91 3-1.69 3-1.31C3-.65 2.52-.15 1.88-.15C1.14-.15 .6-.77 .6-1.62C.6-1.69 .6-1.72 .62-1.8L.45-1.82L.15 .13H.31C.37-.07 .46-.16 .64-.16C.73-.16 .86-.12 1.09-.04C1.49 .1 1.73 .16 2 .16C3 .16 3.76-.59 3.76-1.59Z'/>
<path id='eq24-g11-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<use id='eq24-g8-184' xlink:href='#eq24-g5-184' transform='scale(1.36)'/>
<path id='eq24-g5-3' d='M3.57-2.92C3.57-3.07 3.45-3.22 3.29-3.22C3.09-3.22 2.38-2.51 2.12-2.36C2.12-2.85 2.37-3.34 2.37-3.63C2.37-3.82 2.24-3.93 2.06-3.93C1.89-3.93 1.78-3.81 1.78-3.63C1.78-3.29 1.99-2.83 1.99-2.36C1.71-2.52 1.03-3.26 .85-3.26C.69-3.26 .55-3.11 .55-2.95C.55-2.65 1.58-2.44 1.92-2.24C1.55-2.04 .87-1.93 .7-1.82C.61-1.76 .54-1.68 .54-1.56C.54-1.41 .66-1.27 .82-1.27C1.02-1.27 1.73-1.97 1.99-2.12C1.99-1.64 1.75-1.15 1.75-.85C1.75-.67 1.88-.55 2.05-.55S2.33-.68 2.33-.85C2.33-1.21 2.13-1.66 2.13-2.12C2.4-1.97 3.09-1.23 3.27-1.23C3.42-1.23 3.56-1.38 3.56-1.54C3.56-1.65 3.49-1.73 3.4-1.78C3.17-1.93 2.57-2.03 2.19-2.24C2.6-2.49 3.16-2.52 3.42-2.67C3.51-2.73 3.57-2.8 3.57-2.92Z'/>
<path id='eq24-g5-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<path id='eq24-g0-105' d='M2.22 0V-.13C1.64-.18 1.57-.26 1.57-.89V-4.01L1.53-4.03L.18-3.55V-3.42L.25-3.43C.35-3.45 .46-3.45 .54-3.45C.75-3.45 .83-3.31 .83-2.93V-.89C.83-.26 .75-.17 .14-.13V0H2.22ZM1.65-5.54C1.65-5.79 1.46-5.99 1.2-5.99C.96-5.99 .75-5.79 .75-5.54C.75-5.29 .96-5.09 1.2-5.09C1.46-5.09 1.65-5.29 1.65-5.54Z'/>
<path id='eq24-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq24-g0-118' d='M4.18-3.81V-3.95H2.96V-3.81C3.24-3.79 3.38-3.7 3.38-3.53C3.38-3.45 3.36-3.36 3.32-3.27L2.45-1L1.56-3.24C1.51-3.37 1.48-3.49 1.48-3.57C1.48-3.73 1.58-3.79 1.88-3.81V-3.95H.17V-3.81C.5-3.8 .56-3.71 .96-2.81L2.02-.29C2.03-.24 2.06-.18 2.09-.11C2.14 .05 2.19 .12 2.24 .12S2.36 .01 2.49-.32L3.61-3.13C3.87-3.73 3.92-3.79 4.18-3.81Z'/>
<use id='eq24-g14-29' xlink:href='#eq24-g11-29' transform='scale(1.36)'/>
<use id='eq24-g14-32' xlink:href='#eq24-g11-32' transform='scale(1.36)'/>
<use id='eq24-g14-150' xlink:href='#eq24-g11-150' transform='scale(1.36)'/>
</defs>
<g id='eq24-page1'>
<use x='119.92' y='-14' xlink:href='#eq24-g14-29'/>
<use x='128.67' y='-12.2' xlink:href='#eq24-g0-105'/>
<use x='131.11' y='-12.2' xlink:href='#eq24-g0-110'/>
<use x='135.23' y='-12.2' xlink:href='#eq24-g0-118'/>
<use x='143.43' y='-14' xlink:href='#eq24-g2-61'/>
<use x='170.81' y='-22.09' xlink:href='#eq24-g14-29'/>
<use x='180.11' y='-26.43' xlink:href='#eq24-g5-3'/>
<rect x='155.03' y='-17.4' height='.67' width='45.19'/>
<use x='155.34' y='-4.29' xlink:href='#eq24-g14-29'/>
<use x='164.64' y='-7.74' xlink:href='#eq24-g5-3'/>
<use x='169.58' y='-4.29' xlink:href='#eq24-g14-29'/>
<use x='181.53' y='-4.29' xlink:href='#eq24-g8-184'/>
<use x='192.46' y='-9' xlink:href='#eq24-g11-35'/>
<rect x='192.13' y='-7.69' height='.67' width='6.89'/>
<use x='193.32' y='-.16' xlink:href='#eq24-g11-40'/>
<use x='204.73' y='-14' xlink:href='#eq24-g2-61'/>
<use x='232' y='-22.09' xlink:href='#eq24-g14-29'/>
<use x='241.3' y='-26.43' xlink:href='#eq24-g5-3'/>
<rect x='216.33' y='-17.4' height='.67' width='44.97'/>
<use x='216.64' y='-5.8' xlink:href='#eq24-g14-29'/>
<use x='225.94' y='-9.25' xlink:href='#eq24-g5-3'/>
<use x='230.88' y='-5.8' xlink:href='#eq24-g14-29'/>
<use x='242.83' y='-5.8' xlink:href='#eq24-g8-184'/>
<use x='252.41' y='-5.8' xlink:href='#eq24-g14-32'/>
<use x='265.81' y='-14' xlink:href='#eq24-g14-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.860em; height: 0.778em; vertical-align: -0.000em; " viewBox=".18 -7.78 8.6 7.78">
<title>
\(K\)
</title>
<defs>
<path id='eq42-g1-32' d='M7.36 0V-.19C6.61-.26 6.54-.3 6.21-.86L4.13-4.47L7.71-7.16C8.05-7.41 8.31-7.54 8.6-7.59V-7.78H5.96V-7.59L6.28-7.55C6.56-7.53 6.68-7.46 6.68-7.32C6.68-7.04 6.03-6.41 4.97-5.66L3.16-4.39L3.79-6.71C3.97-7.3 4.29-7.54 4.99-7.59V-7.78H1.74V-7.59C2.49-7.52 2.66-7.42 2.66-7.07C2.66-6.9 2.62-6.66 2.53-6.34L1.06-1.07C.85-.36 .79-.3 .08-.19V0H3.04V-.19C2.29-.27 2.18-.35 2.18-.71C2.18-.85 2.19-.93 2.27-1.18L2.35-1.43L3.08-4.14L4.53-1.67C4.81-1.18 4.98-.76 4.98-.54C4.98-.36 4.81-.26 4.43-.23L4.09-.19V0H7.36Z'/>
</defs>
<g id='eq42-page1'>
<use x='.18' y='0' xlink:href='#eq42-g1-32'/>
</g>
</svg></span> is the noise-to-signal ratio. If <span class="m-math"><svg style="width: 0.860em; height: 0.778em; vertical-align: -0.000em; " viewBox=".18 -7.78 8.6 7.78">
<title>
\(K\)
</title>
<defs>
<path id='eq43-g1-32' d='M7.36 0V-.19C6.61-.26 6.54-.3 6.21-.86L4.13-4.47L7.71-7.16C8.05-7.41 8.31-7.54 8.6-7.59V-7.78H5.96V-7.59L6.28-7.55C6.56-7.53 6.68-7.46 6.68-7.32C6.68-7.04 6.03-6.41 4.97-5.66L3.16-4.39L3.79-6.71C3.97-7.3 4.29-7.54 4.99-7.59V-7.78H1.74V-7.59C2.49-7.52 2.66-7.42 2.66-7.07C2.66-6.9 2.62-6.66 2.53-6.34L1.06-1.07C.85-.36 .79-.3 .08-.19V0H3.04V-.19C2.29-.27 2.18-.35 2.18-.71C2.18-.85 2.19-.93 2.27-1.18L2.35-1.43L3.08-4.14L4.53-1.67C4.81-1.18 4.98-.76 4.98-.54C4.98-.36 4.81-.26 4.43-.23L4.09-.19V0H7.36Z'/>
</defs>
<g id='eq43-page1'>
<use x='.18' y='0' xlink:href='#eq43-g1-32'/>
</g>
</svg></span> is a constant, then the Wiener deconvolution filter is
equivalent to the Tikhonov regularized inverse filter.</p>
<p><code>psf</code> is given in the spatial domain, and will be zero-padded to the size of <code>in</code> and Fourier transformed.
The PSF (point spread function) should sum to one in order to preserve the mean image intensity.
If the OTF (optical transfer function, the Fourier transform of the PSF) is known, it is possible to pass
that as <code>psf</code>; add the string <code>"OTF"</code> to <code>options</code>.</p>
<p>All input images must be real-valued and scalar, except if the OFT is given instead of the PSF, in which
case <code>psf</code> could be complex-valued.</p>
<p>If <code>"pad"</code> is in <code>options</code>, then <code>in</code> is padded by the size of <code>psf</code> in all directions (padded area
is filled by mirroring at the image border). This significantly reduces the effects of the periodicity
of the frequency-domain convolution. <code>"pad"</code> cannot be combined with <code>"OTF"</code>.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>G.M.P. van Kempen, &ldquo;Image Restoration in Fluorescence Microscopy&rdquo;,
  PhD Thesis, Delft University of Technology, Delft, The Netherlands, 1998.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-WienerDeconvolution-Image-CL-Image-CL-Image-L-dfloat--StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-WienerDeconvolution-Image-CL-Image-CL-Image-L-dfloat--StringSet-CL" class="m-doc-self">dip::<wbr />WienerDeconvolution</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 1e-4,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span></span>
            </h3>
            <p>Wiener deconvolution using an estimate of noise-to-signal ratio.</p>
<p>See the description of the function with the same name above. The difference here is that a single number,
<code>regularization</code>, is given instead of the signal and noise power spectra. We then set <span class="m-math"><svg style="width: 0.860em; height: 0.778em; vertical-align: -0.000em; " viewBox=".18 -7.78 8.6 7.78">
<title>
\(K\)
</title>
<defs>
<path id='eq44-g1-32' d='M7.36 0V-.19C6.61-.26 6.54-.3 6.21-.86L4.13-4.47L7.71-7.16C8.05-7.41 8.31-7.54 8.6-7.59V-7.78H5.96V-7.59L6.28-7.55C6.56-7.53 6.68-7.46 6.68-7.32C6.68-7.04 6.03-6.41 4.97-5.66L3.16-4.39L3.79-6.71C3.97-7.3 4.29-7.54 4.99-7.59V-7.78H1.74V-7.59C2.49-7.52 2.66-7.42 2.66-7.07C2.66-6.9 2.62-6.66 2.53-6.34L1.06-1.07C.85-.36 .79-.3 .08-.19V0H3.04V-.19C2.29-.27 2.18-.35 2.18-.71C2.18-.85 2.19-.93 2.27-1.18L2.35-1.43L3.08-4.14L4.53-1.67C4.81-1.18 4.98-.76 4.98-.54C4.98-.36 4.81-.26 4.43-.23L4.09-.19V0H7.36Z'/>
</defs>
<g id='eq44-page1'>
<use x='.18' y='0' xlink:href='#eq44-g1-32'/>
</g>
</svg></span> (the
noise-to-signal ratio) to <code>regularization * dip::Maximum(P)</code>, with <code>P</code> equal to <span class="m-math"><svg style="width: 2.347em; height: 0.827em; vertical-align: -0.000em; " viewBox=".22 -8.27 23.47 8.27">
<title>
\(H^* H\)
</title>
<defs>
<path id='eq45-g1-3' d='M3.57-2.92C3.57-3.07 3.45-3.22 3.29-3.22C3.09-3.22 2.38-2.51 2.12-2.36C2.12-2.85 2.37-3.34 2.37-3.63C2.37-3.82 2.24-3.93 2.06-3.93C1.89-3.93 1.78-3.81 1.78-3.63C1.78-3.29 1.99-2.83 1.99-2.36C1.71-2.52 1.03-3.26 .85-3.26C.69-3.26 .55-3.11 .55-2.95C.55-2.65 1.58-2.44 1.92-2.24C1.55-2.04 .87-1.93 .7-1.82C.61-1.76 .54-1.68 .54-1.56C.54-1.41 .66-1.27 .82-1.27C1.02-1.27 1.73-1.97 1.99-2.12C1.99-1.64 1.75-1.15 1.75-.85C1.75-.67 1.88-.55 2.05-.55S2.33-.68 2.33-.85C2.33-1.21 2.13-1.66 2.13-2.12C2.4-1.97 3.09-1.23 3.27-1.23C3.42-1.23 3.56-1.38 3.56-1.54C3.56-1.65 3.49-1.73 3.4-1.78C3.17-1.93 2.57-2.03 2.19-2.24C2.6-2.49 3.16-2.52 3.42-2.67C3.51-2.73 3.57-2.8 3.57-2.92Z'/>
<path id='eq45-g4-29' d='M7.48 0V-.19C6.71-.27 6.55-.36 6.55-.69C6.55-.79 6.56-.88 6.59-.98L8.16-6.71C8.36-7.4 8.46-7.47 9.14-7.59V-7.78H6.19V-7.59C6.88-7.5 7.03-7.41 7.03-7.07C7.03-6.9 6.98-6.66 6.9-6.34L6.35-4.38H2.95L3.6-6.71C3.78-7.31 4.09-7.54 4.8-7.59V-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.07C2.47-6.9 2.43-6.66 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.83V-.19C2.12-.29 1.99-.37 1.99-.71C1.99-.8 2-.89 2.02-.98L2.81-3.88H6.21L5.43-1.07C5.24-.45 5-.27 4.23-.19V0H7.48Z'/>
</defs>
<g id='eq45-page1'>
<use x='.31' y='0' xlink:href='#eq45-g4-29'/>
<use x='9.61' y='-4.34' xlink:href='#eq45-g1-3'/>
<use x='14.55' y='0' xlink:href='#eq45-g4-29'/>
</g>
</svg></span>.</p>
<p>This formulation of the Wiener deconvolution filter is equivalent to the Tikhonov regularized inverse filter.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>G.M.P. van Kempen, &ldquo;Image Restoration in Fluorescence Microscopy&rdquo;,
  PhD Thesis, Delft University of Technology, Delft, The Netherlands, 1998.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-TikhonovMiller-Image-CL-Image-CL-Image-L-dfloat--StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-TikhonovMiller-Image-CL-Image-CL-Image-L-dfloat--StringSet-CL" class="m-doc-self">dip::<wbr />TikhonovMiller</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 0.1,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span></span>
            </h3>
            <p>Tikhonov-Miller deconvolution.</p>
<p>Assuming some original image <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em; " viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq48-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq48-page1'>
<use x='2.08' y='0' xlink:href='#eq48-g1-53'/>
</g>
</svg></span>, a known convolution kernel <span class="m-math"><svg style="width: 0.569em; height: 0.824em; vertical-align: -0.011em; " viewBox=".43 -8.13 5.69 8.24">
<title>
\(h\)
</title>
<defs>
<path id='eq49-g1-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
</defs>
<g id='eq49-page1'>
<use x='.43' y='0' xlink:href='#eq49-g1-17'/>
</g>
</svg></span> (given by <code>psf</code>), a noise realization <span class="m-math"><svg style="width: 0.565em; height: 0.536em; vertical-align: -0.011em; " viewBox=".06 -5.25 5.65 5.36">
<title>
\(n\)
</title>
<defs>
<path id='eq50-g1-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq50-page1'>
<use x='.06' y='0' xlink:href='#eq50-g1-61'/>
</g>
</svg></span>,
and an observed image <span class="m-math"><svg style="width: 6.292em; height: 1.060em; vertical-align: -0.247em; " viewBox=".07 -8.13 62.92 10.6">
<title>
\(g = h * f + n\)
</title>
<defs>
<path id='eq51-g4-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq51-g4-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq51-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq51-g7-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq51-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq51-g7-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq51-g7-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq51-page1'>
<use x='.07' y='0' xlink:href='#eq51-g7-54'/>
<use x='9.73' y='0' xlink:href='#eq51-g1-61'/>
<use x='20.56' y='0' xlink:href='#eq51-g7-17'/>
<use x='29.44' y='0' xlink:href='#eq51-g4-3'/>
<use x='39.8' y='0' xlink:href='#eq51-g7-53'/>
<use x='47.89' y='0' xlink:href='#eq51-g4-184'/>
<use x='57.35' y='0' xlink:href='#eq51-g7-61'/>
</g>
</svg></span> (given by <code>in</code>), the Tikhonov-Miller deconvolution filter is the linear filter
<span class="m-math"><svg style="width: 1.696em; height: 1.005em; vertical-align: -0.192em; " viewBox=".43 -8.13 16.96 10.05">
<title>
\(h_\text{inv}\)
</title>
<defs>
<path id='eq52-g0-105' d='M2.22 0V-.13C1.64-.18 1.57-.26 1.57-.89V-4.01L1.53-4.03L.18-3.55V-3.42L.25-3.43C.35-3.45 .46-3.45 .54-3.45C.75-3.45 .83-3.31 .83-2.93V-.89C.83-.26 .75-.17 .14-.13V0H2.22ZM1.65-5.54C1.65-5.79 1.46-5.99 1.2-5.99C.96-5.99 .75-5.79 .75-5.54C.75-5.29 .96-5.09 1.2-5.09C1.46-5.09 1.65-5.29 1.65-5.54Z'/>
<path id='eq52-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq52-g0-118' d='M4.18-3.81V-3.95H2.96V-3.81C3.24-3.79 3.38-3.7 3.38-3.53C3.38-3.45 3.36-3.36 3.32-3.27L2.45-1L1.56-3.24C1.51-3.37 1.48-3.49 1.48-3.57C1.48-3.73 1.58-3.79 1.88-3.81V-3.95H.17V-3.81C.5-3.8 .56-3.71 .96-2.81L2.02-.29C2.03-.24 2.06-.18 2.09-.11C2.14 .05 2.19 .12 2.24 .12S2.36 .01 2.49-.32L3.61-3.13C3.87-3.73 3.92-3.79 4.18-3.81Z'/>
<path id='eq52-g2-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
</defs>
<g id='eq52-page1'>
<use x='.43' y='0' xlink:href='#eq52-g2-17'/>
<use x='6.65' y='1.79' xlink:href='#eq52-g0-105'/>
<use x='9.08' y='1.79' xlink:href='#eq52-g0-110'/>
<use x='13.2' y='1.79' xlink:href='#eq52-g0-118'/>
</g>
</svg></span> that, when convolved with <span class="m-math"><svg style="width: 0.559em; height: 0.771em; vertical-align: -0.246em; " viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq53-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq53-page1'>
<use x='.07' y='0' xlink:href='#eq53-g1-54'/>
</g>
</svg></span>, yields an image <span class="m-math"><svg style="width: 5.559em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 55.59 13.18">
<title>
\(\hat{f} = h_\text{inv} * g\)
</title>
<defs>
<path id='eq54-g0-105' d='M2.22 0V-.13C1.64-.18 1.57-.26 1.57-.89V-4.01L1.53-4.03L.18-3.55V-3.42L.25-3.43C.35-3.45 .46-3.45 .54-3.45C.75-3.45 .83-3.31 .83-2.93V-.89C.83-.26 .75-.17 .14-.13V0H2.22ZM1.65-5.54C1.65-5.79 1.46-5.99 1.2-5.99C.96-5.99 .75-5.79 .75-5.54C.75-5.29 .96-5.09 1.2-5.09C1.46-5.09 1.65-5.29 1.65-5.54Z'/>
<path id='eq54-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq54-g0-118' d='M4.18-3.81V-3.95H2.96V-3.81C3.24-3.79 3.38-3.7 3.38-3.53C3.38-3.45 3.36-3.36 3.32-3.27L2.45-1L1.56-3.24C1.51-3.37 1.48-3.49 1.48-3.57C1.48-3.73 1.58-3.79 1.88-3.81V-3.95H.17V-3.81C.5-3.8 .56-3.71 .96-2.81L2.02-.29C2.03-.24 2.06-.18 2.09-.11C2.14 .05 2.19 .12 2.24 .12S2.36 .01 2.49-.32L3.61-3.13C3.87-3.73 3.92-3.79 4.18-3.81Z'/>
<path id='eq54-g5-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq54-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq54-g8-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq54-g8-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq54-g8-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq54-g12-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq54-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq54-g12-94'/>
<use x='2.08' y='0' xlink:href='#eq54-g8-53'/>
<use x='10.83' y='0' xlink:href='#eq54-g2-61'/>
<use x='21.66' y='0' xlink:href='#eq54-g8-17'/>
<use x='27.87' y='1.79' xlink:href='#eq54-g0-105'/>
<use x='30.31' y='1.79' xlink:href='#eq54-g0-110'/>
<use x='34.43' y='1.79' xlink:href='#eq54-g0-118'/>
<use x='41.97' y='0' xlink:href='#eq54-g5-3'/>
<use x='50.33' y='0' xlink:href='#eq54-g8-54'/>
</g>
</svg></span> that minimizes the Tikhonov
functional,</p>
<div class="m-math"><svg style="width: 16.693em; height: 1.735em; vertical-align: 0.003em; " viewBox="110.41 -17.38 166.93 17.35">
<title>
\[ \Theta(\hat{f}) = \left\lVert h * \hat{f} - g \right\rVert^2 + \lambda \left\lVert c * \hat{f} \right\rVert^2 \; , \]
</title>
<defs>
<path id='eq46-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq46-g14-94' d='M2.81-4.43L1.72-5.89H1.18L.1-4.43H.39L1.45-5.33L2.52-4.43H2.81Z'/>
<path id='eq46-g10-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq46-g10-50' d='M4.36-1.14L4.17-1.26C3.51-.56 3.05-.3 2.47-.3C1.79-.3 1.38-.8 1.38-1.66C1.38-2.67 1.8-3.73 2.47-4.43C2.81-4.79 3.29-5 3.76-5C4.04-5 4.2-4.91 4.2-4.76C4.2-4.7 4.19-4.65 4.13-4.54C4.05-4.38 4.03-4.31 4.03-4.19C4.03-3.91 4.2-3.74 4.49-3.74C4.82-3.74 5.06-3.97 5.06-4.29C5.06-4.85 4.54-5.25 3.81-5.25C2.02-5.25 .36-3.51 .36-1.66C.36-.52 1 .13 2.11 .13C3 .13 3.63-.23 4.36-1.14Z'/>
<path id='eq46-g10-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq46-g10-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq46-g10-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
<path id='eq46-g10-150' d='M2.32-.07C2.32-1.06 1.63-1.21 1.36-1.21C1.06-1.21 .67-1.04 .67-.52C.67-.05 1.1 .07 1.41 .07C1.49 .07 1.55 .06 1.58 .05C1.63 .04 1.67 .02 1.69 .02C1.77 .02 1.86 .08 1.86 .19C1.86 .42 1.67 .95 .88 1.45L.99 1.68C1.35 1.56 2.32 .77 2.32-.07Z'/>
<use id='eq46-g17-94' xlink:href='#eq46-g14-94' transform='scale(1.36)'/>
<path id='eq46-g4-13' d='M4.17 7.15V-.36H3.45V7.15H4.17ZM1.74 7.15V-.36H1.02V7.15H1.74Z'/>
<path id='eq46-g7-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq46-g7-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq46-g7-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq46-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq46-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq46-g1-2' d='M5.97-2.81C5.88-3.18 5.84-3.94 5.84-4.3C5.84-4.65 5.88-4.92 5.97-5.25H5.67C5.59-4.85 5.38-4.56 4.98-4.56H3.72C3.25-4.56 3.13-4.76 2.97-5.25H2.67C2.75-4.87 2.8-4.2 2.8-3.85C2.8-3.51 2.76-3.12 2.68-2.81H2.98C3.14-3.3 3.28-3.55 3.73-3.55H4.98C5.41-3.55 5.56-3.26 5.67-2.81H5.97ZM8.19-3.94C8.19-6.3 6.63-8.05 4.3-8.05C1.98-8.05 .4-6.4 .4-3.98C.4-1.5 1.99 .17 4.3 .17C6.59 .17 8.19-1.49 8.19-3.94ZM6.84-4.01C6.84-2.58 6.5-1.46 5.85-.83C5.43-.44 4.91-.26 4.31-.26C3.76-.26 3.24-.43 2.83-.8C2.11-1.46 1.76-2.54 1.76-3.95C1.76-5.09 2.07-6.24 2.58-6.82C3.05-7.36 3.64-7.62 4.29-7.62C4.85-7.62 5.32-7.42 5.75-7.06C6.43-6.49 6.84-5.37 6.84-4.01Z'/>
<path id='eq46-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
</defs>
<g id='eq46-page1'>
<use x='110.41' y='-4.1' xlink:href='#eq46-g1-2'/>
<use x='119.64' y='-4.1' xlink:href='#eq46-g7-185'/>
<use x='128.13' y='-6.79' xlink:href='#eq46-g17-94'/>
<use x='126.18' y='-4.1' xlink:href='#eq46-g10-53'/>
<use x='131.61' y='-4.1' xlink:href='#eq46-g7-186'/>
<use x='139.5' y='-4.1' xlink:href='#eq46-g1-61'/>
<use x='149.9' y='-14.35' xlink:href='#eq46-g4-13'/>
<use x='149.9' y='-7.17' xlink:href='#eq46-g4-13'/>
<use x='155.55' y='-4.1' xlink:href='#eq46-g10-17'/>
<use x='164.42' y='-4.1' xlink:href='#eq46-g7-3'/>
<use x='176.74' y='-6.79' xlink:href='#eq46-g17-94'/>
<use x='174.79' y='-4.1' xlink:href='#eq46-g10-53'/>
<use x='182.87' y='-4.1' xlink:href='#eq46-g7-0'/>
<use x='193.2' y='-4.1' xlink:href='#eq46-g10-54'/>
<use x='199.55' y='-14.35' xlink:href='#eq46-g4-13'/>
<use x='199.55' y='-7.17' xlink:href='#eq46-g4-13'/>
<use x='204.76' y='-11.48' xlink:href='#eq46-g14-50'/>
<use x='212.3' y='-4.1' xlink:href='#eq46-g7-184'/>
<use x='221.54' y='-4.1' xlink:href='#eq46-g10-95'/>
<use x='230.15' y='-14.35' xlink:href='#eq46-g4-13'/>
<use x='230.15' y='-7.17' xlink:href='#eq46-g4-13'/>
<use x='235.49' y='-4.1' xlink:href='#eq46-g10-50'/>
<use x='243.81' y='-4.1' xlink:href='#eq46-g7-3'/>
<use x='256.13' y='-6.79' xlink:href='#eq46-g17-94'/>
<use x='254.18' y='-4.1' xlink:href='#eq46-g10-53'/>
<use x='259.61' y='-14.35' xlink:href='#eq46-g4-13'/>
<use x='259.61' y='-7.17' xlink:href='#eq46-g4-13'/>
<use x='264.82' y='-11.48' xlink:href='#eq46-g14-50'/>
<use x='275.01' y='-4.1' xlink:href='#eq46-g10-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.724em; height: 0.793em; vertical-align: -0.013em; " viewBox="-.16 -7.8 7.24 7.93">
<title>
\(\lambda\)
</title>
<defs>
<path id='eq55-g1-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq55-page1'>
<use x='-.16' y='0' xlink:href='#eq55-g1-95'/>
</g>
</svg></span> is the regularization parameter (given by <code>regularization</code>), and <span class="m-math"><svg style="width: 0.506em; height: 0.538em; vertical-align: -0.013em; " viewBox=".13 -5.25 5.06 5.38">
<title>
\(c\)
</title>
<defs>
<path id='eq56-g1-50' d='M4.36-1.14L4.17-1.26C3.51-.56 3.05-.3 2.47-.3C1.79-.3 1.38-.8 1.38-1.66C1.38-2.67 1.8-3.73 2.47-4.43C2.81-4.79 3.29-5 3.76-5C4.04-5 4.2-4.91 4.2-4.76C4.2-4.7 4.19-4.65 4.13-4.54C4.05-4.38 4.03-4.31 4.03-4.19C4.03-3.91 4.2-3.74 4.49-3.74C4.82-3.74 5.06-3.97 5.06-4.29C5.06-4.85 4.54-5.25 3.81-5.25C2.02-5.25 .36-3.51 .36-1.66C.36-.52 1 .13 2.11 .13C3 .13 3.63-.23 4.36-1.14Z'/>
</defs>
<g id='eq56-page1'>
<use x='.13' y='0' xlink:href='#eq56-g1-50'/>
</g>
</svg></span> is the regularization kernel,
for which we use an ideal Laplace kernel here. <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq57-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq57-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq57-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq57-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq57-g1-53'/>
</g>
</svg></span> is returned in <code>out</code>.</p>
<p>In the frequency domain, the Tikhonov-Miller deconvolution filter is defined as</p>
<div class="m-math"><svg style="width: 10.606em; height: 2.478em; vertical-align: 0.001em; " viewBox="140.95 -24.79 106.06 24.78">
<title>
\[ H_\text{inv} = \frac{H^*}{ H^* H  + \lambda C^* C } \; , \]
</title>
<defs>
<use id='eq47-g8-184' xlink:href='#eq47-g5-184' transform='scale(1.36)'/>
<path id='eq47-g5-3' d='M3.57-2.92C3.57-3.07 3.45-3.22 3.29-3.22C3.09-3.22 2.38-2.51 2.12-2.36C2.12-2.85 2.37-3.34 2.37-3.63C2.37-3.82 2.24-3.93 2.06-3.93C1.89-3.93 1.78-3.81 1.78-3.63C1.78-3.29 1.99-2.83 1.99-2.36C1.71-2.52 1.03-3.26 .85-3.26C.69-3.26 .55-3.11 .55-2.95C.55-2.65 1.58-2.44 1.92-2.24C1.55-2.04 .87-1.93 .7-1.82C.61-1.76 .54-1.68 .54-1.56C.54-1.41 .66-1.27 .82-1.27C1.02-1.27 1.73-1.97 1.99-2.12C1.99-1.64 1.75-1.15 1.75-.85C1.75-.67 1.88-.55 2.05-.55S2.33-.68 2.33-.85C2.33-1.21 2.13-1.66 2.13-2.12C2.4-1.97 3.09-1.23 3.27-1.23C3.42-1.23 3.56-1.38 3.56-1.54C3.56-1.65 3.49-1.73 3.4-1.78C3.17-1.93 2.57-2.03 2.19-2.24C2.6-2.49 3.16-2.52 3.42-2.67C3.51-2.73 3.57-2.8 3.57-2.92Z'/>
<path id='eq47-g5-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<path id='eq47-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq47-g0-105' d='M2.22 0V-.13C1.64-.18 1.57-.26 1.57-.89V-4.01L1.53-4.03L.18-3.55V-3.42L.25-3.43C.35-3.45 .46-3.45 .54-3.45C.75-3.45 .83-3.31 .83-2.93V-.89C.83-.26 .75-.17 .14-.13V0H2.22ZM1.65-5.54C1.65-5.79 1.46-5.99 1.2-5.99C.96-5.99 .75-5.79 .75-5.54C.75-5.29 .96-5.09 1.2-5.09C1.46-5.09 1.65-5.29 1.65-5.54Z'/>
<path id='eq47-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq47-g0-118' d='M4.18-3.81V-3.95H2.96V-3.81C3.24-3.79 3.38-3.7 3.38-3.53C3.38-3.45 3.36-3.36 3.32-3.27L2.45-1L1.56-3.24C1.51-3.37 1.48-3.49 1.48-3.57C1.48-3.73 1.58-3.79 1.88-3.81V-3.95H.17V-3.81C.5-3.8 .56-3.71 .96-2.81L2.02-.29C2.03-.24 2.06-.18 2.09-.11C2.14 .05 2.19 .12 2.24 .12S2.36 .01 2.49-.32L3.61-3.13C3.87-3.73 3.92-3.79 4.18-3.81Z'/>
<path id='eq47-g11-24' d='M7.15-1.56L6.94-1.73C5.87-.67 5.18-.32 4.2-.32C2.88-.32 2.12-1.21 2.12-2.76C2.12-4.18 2.69-5.62 3.62-6.59C4.19-7.18 4.94-7.5 5.73-7.5C6.82-7.5 7.43-6.86 7.55-5.57L7.77-5.54L8.21-7.91H7.96C7.86-7.72 7.74-7.65 7.5-7.65C7.4-7.65 7.27-7.67 7.02-7.73C6.49-7.86 6.01-7.93 5.62-7.93C3.07-7.93 .79-5.55 .79-2.89C.79-1.07 2.07 .21 3.89 .21C5.12 .21 6.07-.3 7.15-1.56Z'/>
<path id='eq47-g11-29' d='M7.48 0V-.19C6.71-.27 6.55-.36 6.55-.69C6.55-.79 6.56-.88 6.59-.98L8.16-6.71C8.36-7.4 8.46-7.47 9.14-7.59V-7.78H6.19V-7.59C6.88-7.5 7.03-7.41 7.03-7.07C7.03-6.9 6.98-6.66 6.9-6.34L6.35-4.38H2.95L3.6-6.71C3.78-7.31 4.09-7.54 4.8-7.59V-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.07C2.47-6.9 2.43-6.66 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.83V-.19C2.12-.29 1.99-.37 1.99-.71C1.99-.8 2-.89 2.02-.98L2.81-3.88H6.21L5.43-1.07C5.24-.45 5-.27 4.23-.19V0H7.48Z'/>
<path id='eq47-g11-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
<path id='eq47-g11-150' d='M2.32-.07C2.32-1.06 1.63-1.21 1.36-1.21C1.06-1.21 .67-1.04 .67-.52C.67-.05 1.1 .07 1.41 .07C1.49 .07 1.55 .06 1.58 .05C1.63 .04 1.67 .02 1.69 .02C1.77 .02 1.86 .08 1.86 .19C1.86 .42 1.67 .95 .88 1.45L.99 1.68C1.35 1.56 2.32 .77 2.32-.07Z'/>
</defs>
<g id='eq47-page1'>
<use x='141.05' y='-8.42' xlink:href='#eq47-g11-29'/>
<use x='149.8' y='-6.63' xlink:href='#eq47-g0-105'/>
<use x='152.23' y='-6.63' xlink:href='#eq47-g0-110'/>
<use x='156.35' y='-6.63' xlink:href='#eq47-g0-118'/>
<use x='164.56' y='-8.42' xlink:href='#eq47-g2-61'/>
<use x='201.35' y='-16.52' xlink:href='#eq47-g11-29'/>
<use x='210.65' y='-20.86' xlink:href='#eq47-g5-3'/>
<rect x='176.15' y='-11.83' height='.67' width='64.02'/>
<use x='176.46' y='-.22' xlink:href='#eq47-g11-29'/>
<use x='185.76' y='-3.68' xlink:href='#eq47-g5-3'/>
<use x='190.7' y='-.22' xlink:href='#eq47-g11-29'/>
<use x='202.66' y='-.22' xlink:href='#eq47-g8-184'/>
<use x='211.9' y='-.22' xlink:href='#eq47-g11-95'/>
<use x='218.33' y='-.22' xlink:href='#eq47-g11-24'/>
<use x='227.03' y='-3.68' xlink:href='#eq47-g5-3'/>
<use x='231.47' y='-.22' xlink:href='#eq47-g11-24'/>
<use x='244.69' y='-8.42' xlink:href='#eq47-g11-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.860em; height: 0.815em; vertical-align: -0.022em; " viewBox="-.02 -7.93 8.6 8.15">
<title>
\(G\)
</title>
<defs>
<path id='eq58-g1-28' d='M8.6-3.61V-3.8H5.43V-3.61L5.78-3.57C6.17-3.54 6.36-3.42 6.36-3.2C6.36-2.94 6.29-2.63 6.05-1.83C5.79-.92 5.73-.77 5.59-.63C5.32-.37 4.87-.23 4.34-.23C2.8-.23 1.93-1.11 1.93-2.67C1.93-4.13 2.51-5.66 3.45-6.65C3.99-7.21 4.73-7.53 5.51-7.53C6.28-7.53 6.92-7.22 7.29-6.68C7.49-6.37 7.58-6.11 7.63-5.57L7.85-5.54L8.43-7.88L8.25-7.93C8.05-7.65 7.85-7.53 7.54-7.53C7.41-7.53 7.29-7.55 7.02-7.65C6.43-7.84 5.91-7.93 5.42-7.93C2.91-7.93 .62-5.55 .62-2.93C.62-2.12 .96-1.29 1.52-.71C2.13-.11 3 .21 4.04 .21C5.09 .21 5.94-.01 6.86-.52L7.44-2.75C7.63-3.42 7.83-3.56 8.6-3.61Z'/>
</defs>
<g id='eq58-page1'>
<use x='-.02' y='0' xlink:href='#eq58-g1-28'/>
</g>
</svg></span> is the Fourier transform of <code>in</code>, <span class="m-math"><svg style="width: 0.923em; height: 0.778em; vertical-align: -0.000em; " viewBox=".22 -7.78 9.23 7.78">
<title>
\(H\)
</title>
<defs>
<path id='eq59-g1-29' d='M7.48 0V-.19C6.71-.27 6.55-.36 6.55-.69C6.55-.79 6.56-.88 6.59-.98L8.16-6.71C8.36-7.4 8.46-7.47 9.14-7.59V-7.78H6.19V-7.59C6.88-7.5 7.03-7.41 7.03-7.07C7.03-6.9 6.98-6.66 6.9-6.34L6.35-4.38H2.95L3.6-6.71C3.78-7.31 4.09-7.54 4.8-7.59V-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.07C2.47-6.9 2.43-6.66 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.83V-.19C2.12-.29 1.99-.37 1.99-.71C1.99-.8 2-.89 2.02-.98L2.81-3.88H6.21L5.43-1.07C5.24-.45 5-.27 4.23-.19V0H7.48Z'/>
</defs>
<g id='eq59-page1'>
<use x='.31' y='0' xlink:href='#eq59-g1-29'/>
</g>
</svg></span> is the Fourier transform of <code>psf</code>, and <span class="m-math"><svg style="width: 0.821em; height: 0.815em; vertical-align: -0.022em; " viewBox="-.19 -7.93 8.21 8.15">
<title>
\(C\)
</title>
<defs>
<path id='eq60-g1-24' d='M7.15-1.56L6.94-1.73C5.87-.67 5.18-.32 4.2-.32C2.88-.32 2.12-1.21 2.12-2.76C2.12-4.18 2.69-5.62 3.62-6.59C4.19-7.18 4.94-7.5 5.73-7.5C6.82-7.5 7.43-6.86 7.55-5.57L7.77-5.54L8.21-7.91H7.96C7.86-7.72 7.74-7.65 7.5-7.65C7.4-7.65 7.27-7.67 7.02-7.73C6.49-7.86 6.01-7.93 5.62-7.93C3.07-7.93 .79-5.55 .79-2.89C.79-1.07 2.07 .21 3.89 .21C5.12 .21 6.07-.3 7.15-1.56Z'/>
</defs>
<g id='eq60-page1'>
<use x='-.19' y='0' xlink:href='#eq60-g1-24'/>
</g>
</svg></span> is the regularization
kernel in the frequency domain.</p>
<p><code>psf</code> is given in the spatial domain, and will be zero-padded to the size of <code>in</code> and Fourier transformed.
The PSF (point spread function) should sum to one in order to preserve the mean image intensity.
If the OTF (optical transfer function, the Fourier transform of the PSF) is known, it is possible to pass
that as <code>psf</code>; add the string <code>"OTF"</code> to <code>options</code>.</p>
<p>All input images must be real-valued and scalar, except if the OFT is given instead of the PSF, in which
case <code>psf</code> could be complex-valued.</p>
<p>If <code>"pad"</code> is in <code>options</code>, then <code>in</code> is padded by the size of <code>psf</code> in all directions (padded area
is filled by mirroring at the image border). This significantly reduces the effects of the periodicity
of the frequency-domain convolution. <code>"pad"</code> cannot be combined with <code>"OTF"</code>.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>G.M.P. van Kempen, &ldquo;Image Restoration in Fluorescence Microscopy&rdquo;,
  PhD Thesis, Delft University of Technology, Delft, The Netherlands, 1998.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-IterativeConstrainedTikhonovMiller-Image-CL-Image-CL-Image-L-dfloat--dfloat--dip-uint--dfloat--StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-IterativeConstrainedTikhonovMiller-Image-CL-Image-CL-Image-L-dfloat--dfloat--dip-uint--dfloat--StringSet-CL" class="m-doc-self">dip::<wbr />IterativeConstrainedTikhonovMiller</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 0.1,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tolerance = 1e-6,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> maxIterations = 30,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> stepSize = 0.0,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span></span>
            </h3>
            <p>Iterative Constrained Tikhonov-Miller (ICTM) deconvolution.</p>
<p>Assuming some original image <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em; " viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq62-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq62-page1'>
<use x='2.08' y='0' xlink:href='#eq62-g1-53'/>
</g>
</svg></span>, a known convolution kernel <span class="m-math"><svg style="width: 0.569em; height: 0.824em; vertical-align: -0.011em; " viewBox=".43 -8.13 5.69 8.24">
<title>
\(h\)
</title>
<defs>
<path id='eq63-g1-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
</defs>
<g id='eq63-page1'>
<use x='.43' y='0' xlink:href='#eq63-g1-17'/>
</g>
</svg></span> (given by <code>psf</code>), a noise realization <span class="m-math"><svg style="width: 0.565em; height: 0.536em; vertical-align: -0.011em; " viewBox=".06 -5.25 5.65 5.36">
<title>
\(n\)
</title>
<defs>
<path id='eq64-g1-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq64-page1'>
<use x='.06' y='0' xlink:href='#eq64-g1-61'/>
</g>
</svg></span>,
and an observed image <span class="m-math"><svg style="width: 6.292em; height: 1.060em; vertical-align: -0.247em; " viewBox=".07 -8.13 62.92 10.6">
<title>
\(g = h * f + n\)
</title>
<defs>
<path id='eq65-g4-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq65-g4-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq65-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq65-g7-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq65-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq65-g7-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq65-g7-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq65-page1'>
<use x='.07' y='0' xlink:href='#eq65-g7-54'/>
<use x='9.73' y='0' xlink:href='#eq65-g1-61'/>
<use x='20.56' y='0' xlink:href='#eq65-g7-17'/>
<use x='29.44' y='0' xlink:href='#eq65-g4-3'/>
<use x='39.8' y='0' xlink:href='#eq65-g7-53'/>
<use x='47.89' y='0' xlink:href='#eq65-g4-184'/>
<use x='57.35' y='0' xlink:href='#eq65-g7-61'/>
</g>
</svg></span> (given by <code>in</code>), ICTM deconvolution finds the <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq66-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq66-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq66-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq66-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq66-g1-53'/>
</g>
</svg></span> (returned in <code>out</code>)
that minimizes the Tikhonov functional,</p>
<div class="m-math"><svg style="width: 16.693em; height: 1.735em; vertical-align: 0.003em; " viewBox="110.41 -17.38 166.93 17.35">
<title>
\[ \Theta(\hat{f}) = \left\lVert h * \hat{f} - g \right\rVert^2 + \lambda \left\lVert c * \hat{f} \right\rVert^2 \; , \]
</title>
<defs>
<path id='eq61-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq61-g14-94' d='M2.81-4.43L1.72-5.89H1.18L.1-4.43H.39L1.45-5.33L2.52-4.43H2.81Z'/>
<path id='eq61-g10-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq61-g10-50' d='M4.36-1.14L4.17-1.26C3.51-.56 3.05-.3 2.47-.3C1.79-.3 1.38-.8 1.38-1.66C1.38-2.67 1.8-3.73 2.47-4.43C2.81-4.79 3.29-5 3.76-5C4.04-5 4.2-4.91 4.2-4.76C4.2-4.7 4.19-4.65 4.13-4.54C4.05-4.38 4.03-4.31 4.03-4.19C4.03-3.91 4.2-3.74 4.49-3.74C4.82-3.74 5.06-3.97 5.06-4.29C5.06-4.85 4.54-5.25 3.81-5.25C2.02-5.25 .36-3.51 .36-1.66C.36-.52 1 .13 2.11 .13C3 .13 3.63-.23 4.36-1.14Z'/>
<path id='eq61-g10-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq61-g10-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq61-g10-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
<path id='eq61-g10-150' d='M2.32-.07C2.32-1.06 1.63-1.21 1.36-1.21C1.06-1.21 .67-1.04 .67-.52C.67-.05 1.1 .07 1.41 .07C1.49 .07 1.55 .06 1.58 .05C1.63 .04 1.67 .02 1.69 .02C1.77 .02 1.86 .08 1.86 .19C1.86 .42 1.67 .95 .88 1.45L.99 1.68C1.35 1.56 2.32 .77 2.32-.07Z'/>
<use id='eq61-g17-94' xlink:href='#eq61-g14-94' transform='scale(1.36)'/>
<path id='eq61-g4-13' d='M4.17 7.15V-.36H3.45V7.15H4.17ZM1.74 7.15V-.36H1.02V7.15H1.74Z'/>
<path id='eq61-g7-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq61-g7-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq61-g7-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq61-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq61-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq61-g1-2' d='M5.97-2.81C5.88-3.18 5.84-3.94 5.84-4.3C5.84-4.65 5.88-4.92 5.97-5.25H5.67C5.59-4.85 5.38-4.56 4.98-4.56H3.72C3.25-4.56 3.13-4.76 2.97-5.25H2.67C2.75-4.87 2.8-4.2 2.8-3.85C2.8-3.51 2.76-3.12 2.68-2.81H2.98C3.14-3.3 3.28-3.55 3.73-3.55H4.98C5.41-3.55 5.56-3.26 5.67-2.81H5.97ZM8.19-3.94C8.19-6.3 6.63-8.05 4.3-8.05C1.98-8.05 .4-6.4 .4-3.98C.4-1.5 1.99 .17 4.3 .17C6.59 .17 8.19-1.49 8.19-3.94ZM6.84-4.01C6.84-2.58 6.5-1.46 5.85-.83C5.43-.44 4.91-.26 4.31-.26C3.76-.26 3.24-.43 2.83-.8C2.11-1.46 1.76-2.54 1.76-3.95C1.76-5.09 2.07-6.24 2.58-6.82C3.05-7.36 3.64-7.62 4.29-7.62C4.85-7.62 5.32-7.42 5.75-7.06C6.43-6.49 6.84-5.37 6.84-4.01Z'/>
<path id='eq61-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
</defs>
<g id='eq61-page1'>
<use x='110.41' y='-4.1' xlink:href='#eq61-g1-2'/>
<use x='119.64' y='-4.1' xlink:href='#eq61-g7-185'/>
<use x='128.13' y='-6.79' xlink:href='#eq61-g17-94'/>
<use x='126.18' y='-4.1' xlink:href='#eq61-g10-53'/>
<use x='131.61' y='-4.1' xlink:href='#eq61-g7-186'/>
<use x='139.5' y='-4.1' xlink:href='#eq61-g1-61'/>
<use x='149.9' y='-14.35' xlink:href='#eq61-g4-13'/>
<use x='149.9' y='-7.17' xlink:href='#eq61-g4-13'/>
<use x='155.55' y='-4.1' xlink:href='#eq61-g10-17'/>
<use x='164.42' y='-4.1' xlink:href='#eq61-g7-3'/>
<use x='176.74' y='-6.79' xlink:href='#eq61-g17-94'/>
<use x='174.79' y='-4.1' xlink:href='#eq61-g10-53'/>
<use x='182.87' y='-4.1' xlink:href='#eq61-g7-0'/>
<use x='193.2' y='-4.1' xlink:href='#eq61-g10-54'/>
<use x='199.55' y='-14.35' xlink:href='#eq61-g4-13'/>
<use x='199.55' y='-7.17' xlink:href='#eq61-g4-13'/>
<use x='204.76' y='-11.48' xlink:href='#eq61-g14-50'/>
<use x='212.3' y='-4.1' xlink:href='#eq61-g7-184'/>
<use x='221.54' y='-4.1' xlink:href='#eq61-g10-95'/>
<use x='230.15' y='-14.35' xlink:href='#eq61-g4-13'/>
<use x='230.15' y='-7.17' xlink:href='#eq61-g4-13'/>
<use x='235.49' y='-4.1' xlink:href='#eq61-g10-50'/>
<use x='243.81' y='-4.1' xlink:href='#eq61-g7-3'/>
<use x='256.13' y='-6.79' xlink:href='#eq61-g17-94'/>
<use x='254.18' y='-4.1' xlink:href='#eq61-g10-53'/>
<use x='259.61' y='-14.35' xlink:href='#eq61-g4-13'/>
<use x='259.61' y='-7.17' xlink:href='#eq61-g4-13'/>
<use x='264.82' y='-11.48' xlink:href='#eq61-g14-50'/>
<use x='275.01' y='-4.1' xlink:href='#eq61-g10-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.724em; height: 0.793em; vertical-align: -0.013em; " viewBox="-.16 -7.8 7.24 7.93">
<title>
\(\lambda\)
</title>
<defs>
<path id='eq67-g1-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq67-page1'>
<use x='-.16' y='0' xlink:href='#eq67-g1-95'/>
</g>
</svg></span> is the regularization parameter (given by <code>regularization</code>), and <span class="m-math"><svg style="width: 0.506em; height: 0.538em; vertical-align: -0.013em; " viewBox=".13 -5.25 5.06 5.38">
<title>
\(c\)
</title>
<defs>
<path id='eq68-g1-50' d='M4.36-1.14L4.17-1.26C3.51-.56 3.05-.3 2.47-.3C1.79-.3 1.38-.8 1.38-1.66C1.38-2.67 1.8-3.73 2.47-4.43C2.81-4.79 3.29-5 3.76-5C4.04-5 4.2-4.91 4.2-4.76C4.2-4.7 4.19-4.65 4.13-4.54C4.05-4.38 4.03-4.31 4.03-4.19C4.03-3.91 4.2-3.74 4.49-3.74C4.82-3.74 5.06-3.97 5.06-4.29C5.06-4.85 4.54-5.25 3.81-5.25C2.02-5.25 .36-3.51 .36-1.66C.36-.52 1 .13 2.11 .13C3 .13 3.63-.23 4.36-1.14Z'/>
</defs>
<g id='eq68-page1'>
<use x='.13' y='0' xlink:href='#eq68-g1-50'/>
</g>
</svg></span> is the regularization kernel,
for which we use an ideal Laplace kernel here. <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq69-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq69-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq69-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq69-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq69-g1-53'/>
</g>
</svg></span> is returned in <code>out</code>.</p>
<p>If <code>stepSize</code> is 0 (the default), ICTM uses the conjugate gradient method to estimate <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq70-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq70-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq70-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq70-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq70-g1-53'/>
</g>
</svg></span>. In this case, it
uses the results of Verveer and Jovin to estimate the optimal step size for each step.</p>
<p>If a positive step size is given (a value in the range (0, 1]), then ICTM uses gradient descent (with steepest
descent) and a fixed step size. This is much simpler code, with quicker steps, but converges much more slowly and
can even diverge under certain circumstances. It is provided here because this is a common implementation in other
software packages; we do not recommend using it.</p>
<p>The iterative algorithm is stopped when the maximum difference of <span class="m-math"><svg style="width: 2.459em; height: 1.318em; vertical-align: -0.246em; " viewBox="0 -10.72 24.59 13.18">
<title>
\(\Theta(\hat{f})\)
</title>
<defs>
<path id='eq71-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq71-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq71-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq71-g11-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
<path id='eq71-g1-2' d='M5.97-2.81C5.88-3.18 5.84-3.94 5.84-4.3C5.84-4.65 5.88-4.92 5.97-5.25H5.67C5.59-4.85 5.38-4.56 4.98-4.56H3.72C3.25-4.56 3.13-4.76 2.97-5.25H2.67C2.75-4.87 2.8-4.2 2.8-3.85C2.8-3.51 2.76-3.12 2.68-2.81H2.98C3.14-3.3 3.28-3.55 3.73-3.55H4.98C5.41-3.55 5.56-3.26 5.67-2.81H5.97ZM8.19-3.94C8.19-6.3 6.63-8.05 4.3-8.05C1.98-8.05 .4-6.4 .4-3.98C.4-1.5 1.99 .17 4.3 .17C6.59 .17 8.19-1.49 8.19-3.94ZM6.84-4.01C6.84-2.58 6.5-1.46 5.85-.83C5.43-.44 4.91-.26 4.31-.26C3.76-.26 3.24-.43 2.83-.8C2.11-1.46 1.76-2.54 1.76-3.95C1.76-5.09 2.07-6.24 2.58-6.82C3.05-7.36 3.64-7.62 4.29-7.62C4.85-7.62 5.32-7.42 5.75-7.06C6.43-6.49 6.84-5.37 6.84-4.01Z'/>
</defs>
<g id='eq71-page1'>
<use x='0' y='0' xlink:href='#eq71-g1-2'/>
<use x='9.23' y='0' xlink:href='#eq71-g4-185'/>
<use x='17.72' y='-2.69' xlink:href='#eq71-g11-94'/>
<use x='15.77' y='0' xlink:href='#eq71-g7-53'/>
<use x='21.2' y='0' xlink:href='#eq71-g4-186'/>
</g>
</svg></span> between two steps (ignoring
the regularization term) is less than <code>tolerance</code> times the maximum absolute value in <span class="m-math"><svg style="width: 0.559em; height: 0.771em; vertical-align: -0.246em; " viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq72-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq72-page1'>
<use x='.07' y='0' xlink:href='#eq72-g1-54'/>
</g>
</svg></span>.</p>
<p><code>maxIterations</code> provides an additional stopping condition, in case the algorithm does not converge quickly
enough. In a way, providing a small maximum number of iterations is an additional form of regularization.
Setting <code>maxIterations</code> to 0 runs the algorithm until convergence.</p>
<p><code>psf</code> is given in the spatial domain, and will be zero-padded to the size of <code>in</code> and Fourier transformed.
The PSF (point spread function) should sum to one in order to preserve the mean image intensity.
If the OTF (optical transfer function, the Fourier transform of the PSF) is known, it is possible to pass
that as <code>psf</code>; add the string <code>"OTF"</code> to <code>options</code>.</p>
<p>All input images must be real-valued and scalar, except if the OFT is given instead of the PSF, in which
case <code>psf</code> could be complex-valued.</p>
<p>If <code>"pad"</code> is in <code>options</code>, then <code>in</code> is padded by the size of <code>psf</code> in all directions (padded area
is filled by mirroring at the image border). This significantly reduces the effects of the periodicity
of the frequency-domain convolution. <code>"pad"</code> cannot be combined with <code>"OTF"</code>.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>G.M.P. van Kempen, &ldquo;Image Restoration in Fluorescence Microscopy&rdquo;,
  PhD Thesis, Delft University of Technology, Delft, The Netherlands, 1998.</li>
<li>P.J. Verveer and T.M. Jovin, &ldquo;Acceleration of the ICTM image restoration algorithm&rdquo;,
  Journal of Microscopy 188(3):191-195, 1997.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-RichardsonLucy-Image-CL-Image-CL-Image-L-dfloat--dip-uint--StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-RichardsonLucy-Image-CL-Image-CL-Image-L-dfloat--dip-uint--StringSet-CL" class="m-doc-self">dip::<wbr />RichardsonLucy</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 0.0,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> nIterations = 30,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span></span>
            </h3>
            <p>Richardson-Lucy (RL) deconvolution, also sometimes called the expectation maximization (EM) method.</p>
<p>Assuming some original image <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em; " viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq74-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq74-page1'>
<use x='2.08' y='0' xlink:href='#eq74-g1-53'/>
</g>
</svg></span>, a known convolution kernel <span class="m-math"><svg style="width: 0.569em; height: 0.824em; vertical-align: -0.011em; " viewBox=".43 -8.13 5.69 8.24">
<title>
\(h\)
</title>
<defs>
<path id='eq75-g1-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
</defs>
<g id='eq75-page1'>
<use x='.43' y='0' xlink:href='#eq75-g1-17'/>
</g>
</svg></span> (given by <code>psf</code>), and an observed image
<span class="m-math"><svg style="width: 6.157em; height: 1.101em; vertical-align: -0.247em; " viewBox=".07 -8.54 61.57 11.01">
<title>
\(g = P(h * f)\)
</title>
<defs>
<path id='eq76-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq76-g4-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq76-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq76-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq76-g7-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq76-g7-37' d='M7.21-6C7.21-7.15 6.31-7.78 4.69-7.78H1.74V-7.59C2.42-7.5 2.58-7.41 2.58-7.09C2.58-6.91 2.54-6.69 2.38-6.13L.98-1.07C.76-.36 .68-.29 0-.19V0H2.92V-.19C2.17-.3 2.11-.33 2.11-.75C2.11-.88 2.13-.98 2.25-1.43L2.88-3.73C3.19-3.66 3.48-3.63 3.98-3.63C4.92-3.63 5.73-3.82 6.23-4.18C6.85-4.61 7.21-5.29 7.21-6ZM5.98-6C5.98-5.23 5.71-4.68 5.18-4.37C4.81-4.17 4.35-4.07 3.61-4.07C3.39-4.07 3.33-4.07 2.99-4.13L3.84-7.09C3.91-7.34 4.05-7.42 4.38-7.42C4.84-7.42 5.29-7.31 5.53-7.15C5.84-6.93 5.98-6.57 5.98-6Z'/>
<path id='eq76-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq76-g7-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq76-page1'>
<use x='.07' y='0' xlink:href='#eq76-g7-54'/>
<use x='9.73' y='0' xlink:href='#eq76-g1-61'/>
<use x='20.48' y='0' xlink:href='#eq76-g7-37'/>
<use x='28.69' y='0' xlink:href='#eq76-g4-185'/>
<use x='33.58' y='0' xlink:href='#eq76-g7-17'/>
<use x='42.46' y='0' xlink:href='#eq76-g4-3'/>
<use x='52.82' y='0' xlink:href='#eq76-g7-53'/>
<use x='58.25' y='0' xlink:href='#eq76-g4-186'/>
</g>
</svg></span> (given by <code>in</code>), where <span class="m-math"><svg style="width: 2.195em; height: 1.095em; vertical-align: -0.241em; " viewBox=".35 -8.54 21.95 10.95">
<title>
\(P(x)\)
</title>
<defs>
<path id='eq77-g1-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq77-g1-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq77-g4-37' d='M7.21-6C7.21-7.15 6.31-7.78 4.69-7.78H1.74V-7.59C2.42-7.5 2.58-7.41 2.58-7.09C2.58-6.91 2.54-6.69 2.38-6.13L.98-1.07C.76-.36 .68-.29 0-.19V0H2.92V-.19C2.17-.3 2.11-.33 2.11-.75C2.11-.88 2.13-.98 2.25-1.43L2.88-3.73C3.19-3.66 3.48-3.63 3.98-3.63C4.92-3.63 5.73-3.82 6.23-4.18C6.85-4.61 7.21-5.29 7.21-6ZM5.98-6C5.98-5.23 5.71-4.68 5.18-4.37C4.81-4.17 4.35-4.07 3.61-4.07C3.39-4.07 3.33-4.07 2.99-4.13L3.84-7.09C3.91-7.34 4.05-7.42 4.38-7.42C4.84-7.42 5.29-7.31 5.53-7.15C5.84-6.93 5.98-6.57 5.98-6Z'/>
<path id='eq77-g4-71' d='M4.95-1.23L4.79-1.32C4.69-1.2 4.63-1.14 4.53-1C4.25-.64 4.12-.52 3.97-.52C3.8-.52 3.69-.68 3.61-1.01C3.59-1.12 3.57-1.18 3.56-1.2C3.28-2.32 3.13-2.97 3.13-3.14C3.66-4.06 4.09-4.59 4.3-4.59C4.37-4.59 4.48-4.55 4.59-4.49C4.73-4.41 4.81-4.38 4.92-4.38C5.16-4.38 5.32-4.56 5.32-4.81C5.32-5.07 5.12-5.25 4.84-5.25C4.31-5.25 3.87-4.82 3.04-3.55L2.91-4.2C2.74-5.01 2.61-5.25 2.29-5.25C2.01-5.25 1.63-5.16 .89-4.91L.76-4.86L.81-4.68L1.01-4.73C1.24-4.79 1.38-4.81 1.48-4.81C1.77-4.81 1.85-4.7 2.01-3.99L2.36-2.53L1.38-1.13C1.13-.77 .91-.56 .77-.56C.7-.56 .58-.6 .46-.67C.31-.75 .19-.79 .08-.79C-.15-.79-.32-.61-.32-.37C-.32-.06-.1 .13 .27 .13S.79 .02 1.38-.69L2.45-2.1L2.81-.67C2.97-.05 3.12 .13 3.5 .13C3.95 .13 4.26-.15 4.95-1.23Z'/>
</defs>
<g id='eq77-page1'>
<use x='.35' y='0' xlink:href='#eq77-g4-37'/>
<use x='8.56' y='0' xlink:href='#eq77-g1-185'/>
<use x='13.02' y='0' xlink:href='#eq77-g4-71'/>
<use x='18.91' y='0' xlink:href='#eq77-g1-186'/>
</g>
</svg></span> is Poisson noise with mean <span class="m-math"><svg style="width: 0.565em; height: 0.538em; vertical-align: -0.013em; " viewBox="-.32 -5.25 5.65 5.38">
<title>
\(x\)
</title>
<defs>
<path id='eq78-g1-71' d='M4.95-1.23L4.79-1.32C4.69-1.2 4.63-1.14 4.53-1C4.25-.64 4.12-.52 3.97-.52C3.8-.52 3.69-.68 3.61-1.01C3.59-1.12 3.57-1.18 3.56-1.2C3.28-2.32 3.13-2.97 3.13-3.14C3.66-4.06 4.09-4.59 4.3-4.59C4.37-4.59 4.48-4.55 4.59-4.49C4.73-4.41 4.81-4.38 4.92-4.38C5.16-4.38 5.32-4.56 5.32-4.81C5.32-5.07 5.12-5.25 4.84-5.25C4.31-5.25 3.87-4.82 3.04-3.55L2.91-4.2C2.74-5.01 2.61-5.25 2.29-5.25C2.01-5.25 1.63-5.16 .89-4.91L.76-4.86L.81-4.68L1.01-4.73C1.24-4.79 1.38-4.81 1.48-4.81C1.77-4.81 1.85-4.7 2.01-3.99L2.36-2.53L1.38-1.13C1.13-.77 .91-.56 .77-.56C.7-.56 .58-.6 .46-.67C.31-.75 .19-.79 .08-.79C-.15-.79-.32-.61-.32-.37C-.32-.06-.1 .13 .27 .13S.79 .02 1.38-.69L2.45-2.1L2.81-.67C2.97-.05 3.12 .13 3.5 .13C3.95 .13 4.26-.15 4.95-1.23Z'/>
</defs>
<g id='eq78-page1'>
<use x='0' y='0' xlink:href='#eq78-g1-71'/>
</g>
</svg></span>, RL deconvolution finds the
<span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq79-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq79-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq79-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq79-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq79-g1-53'/>
</g>
</svg></span> (returned in <code>out</code>) with maximal likelihood, given by</p>
<div class="m-math"><svg style="width: 18.481em; height: 1.834em; vertical-align: -0.002em; " viewBox="101.49 -18.32 184.81 18.34">
<title>
\[ log p(g | \hat{f}) = \sum g \log(h * \hat{f}) - h * \hat{f} \; , \]
</title>
<defs>
<path id='eq73-g4-213' d='M14.78 13.13H14.48C14.07 15.73 13.09 17.12 11.64 17.12H2.53L9.03 8.79L3.48 .62H10.98C12.51 .62 13.33 1.49 13.77 4.13H14.03L13.91 0H1.39L7.77 9.15L.51 18.34H14.54L14.78 13.13Z'/>
<path id='eq73-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq73-g7-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq73-g7-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq73-g7-106' d='M1.52 2.3V-8.42H.86V2.3H1.52Z'/>
<path id='eq73-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq73-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq73-g14-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
<path id='eq73-g14-103' d='M5.6-4.62V-5.09H4.68C4.44-5.09 4.26-5.12 4.03-5.2L3.76-5.3C3.44-5.42 3.12-5.48 2.81-5.48C1.7-5.48 .82-4.62 .82-3.54C.82-2.79 1.14-2.33 1.93-1.94L1.42-1.46C1.02-1.12 .87-.88 .87-.64C.87-.39 1.01-.25 1.5-.01C.66 .61 .33 1 .33 1.44C.33 2.07 1.26 2.6 2.39 2.6C3.29 2.6 4.22 2.29 4.84 1.79C5.29 1.42 5.49 1.04 5.49 .58C5.49-.15 4.93-.66 4.05-.69L2.51-.76C1.88-.79 1.58-.89 1.58-1.08C1.58-1.32 1.98-1.74 2.3-1.83C2.41-1.82 2.49-1.81 2.53-1.81C2.75-1.79 2.91-1.77 2.98-1.77C3.42-1.77 3.89-1.95 4.26-2.27C4.66-2.61 4.84-3.03 4.84-3.62C4.84-3.97 4.78-4.24 4.61-4.62H5.6ZM5.16 .76C5.16 1.45 4.25 1.92 2.91 1.92C1.86 1.92 1.17 1.57 1.17 1.05C1.17 .77 1.25 .62 1.75 .02C2.14 .11 3.1 .18 3.68 .18C4.76 .18 5.16 .33 5.16 .76ZM3.92-3.16C3.92-2.49 3.57-2.07 3.03-2.07C2.31-2.07 1.81-2.85 1.81-3.99V-4.03C1.81-4.73 2.14-5.15 2.69-5.15C3.06-5.15 3.37-4.94 3.56-4.59C3.78-4.17 3.92-3.62 3.92-3.16Z'/>
<path id='eq73-g14-108' d='M3.06 0V-.18C2.3-.23 2.17-.35 2.17-1V-8.11L2.12-8.13C1.5-7.93 1.05-7.81 .23-7.61V-7.42H.3C.43-7.43 .57-7.44 .67-7.44C1.05-7.44 1.17-7.28 1.17-6.72V-1.04C1.17-.39 1-.24 .25-.18V0H3.06Z'/>
<path id='eq73-g14-111' d='M5.6-2.79C5.6-4.35 4.5-5.48 2.98-5.48C1.43-5.48 .35-4.34 .35-2.69C.35-1.08 1.45 .12 2.95 .12S5.6-1.14 5.6-2.79ZM4.53-2.37C4.53-1.02 3.99-.21 3.1-.21C2.63-.21 2.19-.5 1.94-.98C1.61-1.6 1.42-2.43 1.42-3.28C1.42-4.41 1.98-5.15 2.82-5.15C3.82-5.15 4.53-4 4.53-2.37Z'/>
<path id='eq73-g10-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq73-g10-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq73-g10-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq73-g10-59' d='M2.87-1.36L2.72-1.46C2.61-1.33 2.5-1.19 2.41-1.06C2.01-.56 1.8-.38 1.58-.38C1.46-.38 1.41-.45 1.41-.6C1.41-.71 1.46-.95 1.52-1.18L3.32-8.08L3.26-8.13C2.56-7.98 2.11-7.9 1.41-7.81V-7.62H1.61C1.98-7.62 2.22-7.52 2.22-7.35C2.22-7.31 2.2-7.23 2.17-7.13L.54-.85C.5-.73 .49-.63 .49-.54C.49-.1 .69 .13 1.07 .13C1.69 .13 2.1-.21 2.87-1.36Z'/>
<path id='eq73-g10-62' d='M5.57-3.59C5.57-4.57 4.88-5.25 3.87-5.25C3.38-5.25 2.93-5.13 2.47-4.88C1.21-4.22 .32-2.82 .32-1.54C.32-.5 .99 .13 2.07 .13C2.86 .13 3.62-.21 4.31-.91C5.1-1.68 5.57-2.68 5.57-3.59ZM4.57-3.88C4.57-3.03 4.2-1.87 3.69-1.1C3.24-.44 2.78-.12 2.25-.12C1.69-.12 1.32-.55 1.32-1.2C1.32-2.06 1.66-3.08 2.2-3.92C2.68-4.63 3.2-5 3.73-5C4.24-5 4.57-4.56 4.57-3.88Z'/>
<path id='eq73-g10-63' d='M5.59-3.76C5.59-4.69 5.07-5.25 4.22-5.25C3.44-5.25 2.87-4.87 2.18-3.91L2.55-5.2C2.55-5.2 2.53-5.25 2.49-5.25H2.48L.64-4.99L.67-4.81C1.02-4.81 1.44-4.81 1.44-4.49C1.44-4.35 1.02-2.7 .6-1.12L-.1 1.55C-.21 2.1-.38 2.24-.89 2.25V2.44H1.55V2.26C.99 2.26 .79 2.17 .79 1.91C.79 1.74 .99 .85 1.23-.07C1.52 .08 1.74 .13 2.01 .13C3.75 .13 5.59-1.86 5.59-3.76ZM4.51-3.73C4.51-2.94 4.19-1.95 3.69-1.23C3.18-.48 2.6-.1 1.97-.1C1.63-.1 1.39-.27 1.39-.54C1.39-.94 1.81-2.49 2.17-3.38C2.48-4.17 3.14-4.74 3.73-4.74C3.74-4.74 3.76-4.74 3.78-4.74C4.29-4.72 4.51-4.41 4.51-3.73Z'/>
<path id='eq73-g10-150' d='M2.32-.07C2.32-1.06 1.63-1.21 1.36-1.21C1.06-1.21 .67-1.04 .67-.52C.67-.05 1.1 .07 1.41 .07C1.49 .07 1.55 .06 1.58 .05C1.63 .04 1.67 .02 1.69 .02C1.77 .02 1.86 .08 1.86 .19C1.86 .42 1.67 .95 .88 1.45L.99 1.68C1.35 1.56 2.32 .77 2.32-.07Z'/>
</defs>
<g id='eq73-page1'>
<use x='101.49' y='-6.09' xlink:href='#eq73-g10-59'/>
<use x='105.71' y='-6.09' xlink:href='#eq73-g10-62'/>
<use x='112.12' y='-6.09' xlink:href='#eq73-g10-54'/>
<use x='119.33' y='-6.09' xlink:href='#eq73-g10-63'/>
<use x='126.39' y='-6.09' xlink:href='#eq73-g7-185'/>
<use x='130.92' y='-6.09' xlink:href='#eq73-g10-54'/>
<use x='137.74' y='-6.09' xlink:href='#eq73-g7-106'/>
<use x='144.64' y='-8.78' xlink:href='#eq73-g14-94'/>
<use x='142.69' y='-6.09' xlink:href='#eq73-g10-53'/>
<use x='148.12' y='-6.09' xlink:href='#eq73-g7-186'/>
<use x='156.02' y='-6.09' xlink:href='#eq73-g1-61'/>
<use x='166.41' y='-18.32' xlink:href='#eq73-g4-213'/>
<use x='184.29' y='-6.09' xlink:href='#eq73-g10-54'/>
<use x='192.63' y='-6.09' xlink:href='#eq73-g14-108'/>
<use x='195.95' y='-6.09' xlink:href='#eq73-g14-111'/>
<use x='201.93' y='-6.09' xlink:href='#eq73-g14-103'/>
<use x='208.51' y='-6.09' xlink:href='#eq73-g7-185'/>
<use x='213.4' y='-6.09' xlink:href='#eq73-g10-17'/>
<use x='222.27' y='-6.09' xlink:href='#eq73-g7-3'/>
<use x='234.59' y='-8.78' xlink:href='#eq73-g14-94'/>
<use x='232.64' y='-6.09' xlink:href='#eq73-g10-53'/>
<use x='238.06' y='-6.09' xlink:href='#eq73-g7-186'/>
<use x='245.3' y='-6.09' xlink:href='#eq73-g7-0'/>
<use x='255.99' y='-6.09' xlink:href='#eq73-g10-17'/>
<use x='264.86' y='-6.09' xlink:href='#eq73-g7-3'/>
<use x='277.19' y='-8.78' xlink:href='#eq73-g14-94'/>
<use x='275.23' y='-6.09' xlink:href='#eq73-g10-53'/>
<use x='283.98' y='-6.09' xlink:href='#eq73-g10-150'/>
</g>
</svg></div>
<p>This is the basic, non-regularized Richardson-Lucy deconvolution, which requires <code>regularization</code> to be
set to 0.</p>
<p>The <code>nIterations</code> parameter serves as regularization, the iterative process must be stopped before the noise
gets amplified too much. Even when using the regularization parameter, there is no ideal way to see if the
algorithm has converged.</p>
<p>If <code>regularization</code> is positive, total variation (TV) regularization is added, according to Dey et al. In this
case, a term <span class="m-math"><svg style="width: 4.130em; height: 1.318em; vertical-align: -0.246em; " viewBox="-.16 -10.72 41.3 13.18">
<title>
\(\lambda \sum |\nabla\hat{f}|\)
</title>
<defs>
<path id='eq80-g11-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
<path id='eq80-g4-106' d='M1.52 2.3V-8.42H.86V2.3H1.52Z'/>
<path id='eq80-g4-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
<path id='eq80-g1-205' d='M8.65 7.3H8.4C8.16 8.79 7.61 9.46 6.78 9.46H2.11L5.56 5.03L2.49 .46H6.3C7.17 .46 7.72 .94 7.97 2.45H8.23L8.16 0H1.01L4.66 5.23L.51 10.48H8.52L8.65 7.3Z'/>
<path id='eq80-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq80-g7-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq80-page1'>
<use x='-.16' y='0' xlink:href='#eq80-g7-95'/>
<use x='8.45' y='-8.37' xlink:href='#eq80-g1-205'/>
<use x='20.58' y='0' xlink:href='#eq80-g4-106'/>
<use x='23.57' y='0' xlink:href='#eq80-g4-114'/>
<use x='35.67' y='-2.69' xlink:href='#eq80-g11-94'/>
<use x='33.71' y='0' xlink:href='#eq80-g7-53'/>
<use x='39.62' y='0' xlink:href='#eq80-g4-106'/>
</g>
</svg></span> is added to the expression above, with <span class="m-math"><svg style="width: 0.724em; height: 0.793em; vertical-align: -0.013em; " viewBox="-.16 -7.8 7.24 7.93">
<title>
\(\lambda\)
</title>
<defs>
<path id='eq81-g1-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq81-page1'>
<use x='-.16' y='0' xlink:href='#eq81-g1-95'/>
</g>
</svg></span> equal to
<code>regularization</code>. This should be a small value, 0.01 is a good start point. Note that TV regularization tends
to introduce a stair-case effect, as it penalizes slow transitions but allows sharp jumps.</p>
<p><code>psf</code> is given in the spatial domain, and will be zero-padded to the size of <code>in</code> and Fourier transformed.
The PSF (point spread function) should sum to one in order to preserve the mean image intensity.
If the OTF (optical transfer function, the Fourier transform of the PSF) is known, it is possible to pass
that as <code>psf</code>; add the string <code>"OTF"</code> to <code>options</code>.</p>
<p>All input images must be real-valued and scalar, except if the OFT is given instead of the PSF, in which
case <code>psf</code> could be complex-valued.</p>
<p>If <code>"pad"</code> is in <code>options</code>, then <code>in</code> is padded by the size of <code>psf</code> in all directions (padded area
is filled by mirroring at the image border). This significantly reduces the effects of the periodicity
of the frequency-domain convolution. <code>"pad"</code> cannot be combined with <code>"OTF"</code>.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>G.M.P. van Kempen, &ldquo;Image Restoration in Fluorescence Microscopy&rdquo;,
  PhD Thesis, Delft University of Technology, Delft, The Netherlands, 1998.</li>
<li>W.H. Richardson, &ldquo;Bayesian-based iterative method of image restoration&rdquo;,
  Journal of the Optical Society of America 62(1):55–59, 1972.</li>
<li>L.B. Lucy, &ldquo;An iterative technique for the rectification of observed distributions&rdquo;,
  Astronomical Journal 79(6):745–754, 1974.</li>
<li>N. Dey, L. Blanc-Féraud, C. Zimmer, P. Roux, Z. Kam, J. Olivo-Marin, J. Zerubia,
  &ldquo;Richardson–Lucy algorithm with total variation regularization for 3D confocal microscope deconvolution&rdquo;,
  Microscopy Research &amp; Technique 69(4):260–266, 2006.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-FastIterativeShrinkageThresholding-Image-CL-Image-CL-Image-L-dfloat--dfloat--dip-uint--dip-uint--StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-FastIterativeShrinkageThresholding-Image-CL-Image-CL-Image-L-dfloat--dfloat--dip-uint--dip-uint--StringSet-CL" class="m-doc-self">dip::<wbr />FastIterativeShrinkageThresholding</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; psf,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularization = 0.1,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tolerance = 1e-6,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> maxIterations = 30,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> nScales = 3,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; options = {S::PAD})</span></span>
            </h3>
            <p>Fast Iterative Shrinkage-Thresholding (FISTA) deconvolution.</p>
<p>Assuming some original image <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.246em; " viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq83-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq83-page1'>
<use x='2.08' y='0' xlink:href='#eq83-g1-53'/>
</g>
</svg></span>, a known convolution kernel <span class="m-math"><svg style="width: 0.569em; height: 0.824em; vertical-align: -0.011em; " viewBox=".43 -8.13 5.69 8.24">
<title>
\(h\)
</title>
<defs>
<path id='eq84-g1-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
</defs>
<g id='eq84-page1'>
<use x='.43' y='0' xlink:href='#eq84-g1-17'/>
</g>
</svg></span> (given by <code>psf</code>), a noise realization <span class="m-math"><svg style="width: 0.565em; height: 0.536em; vertical-align: -0.011em; " viewBox=".06 -5.25 5.65 5.36">
<title>
\(n\)
</title>
<defs>
<path id='eq85-g1-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq85-page1'>
<use x='.06' y='0' xlink:href='#eq85-g1-61'/>
</g>
</svg></span>,
and an observed image <span class="m-math"><svg style="width: 6.292em; height: 1.060em; vertical-align: -0.247em; " viewBox=".07 -8.13 62.92 10.6">
<title>
\(g = h * f + n\)
</title>
<defs>
<path id='eq86-g4-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq86-g4-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq86-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq86-g7-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq86-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq86-g7-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq86-g7-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq86-page1'>
<use x='.07' y='0' xlink:href='#eq86-g7-54'/>
<use x='9.73' y='0' xlink:href='#eq86-g1-61'/>
<use x='20.56' y='0' xlink:href='#eq86-g7-17'/>
<use x='29.44' y='0' xlink:href='#eq86-g4-3'/>
<use x='39.8' y='0' xlink:href='#eq86-g7-53'/>
<use x='47.89' y='0' xlink:href='#eq86-g4-184'/>
<use x='57.35' y='0' xlink:href='#eq86-g7-61'/>
</g>
</svg></span> (given by <code>in</code>), FISTA deconvolution finds the <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq87-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq87-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq87-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq87-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq87-g1-53'/>
</g>
</svg></span> (returned in <code>out</code>)
that minimizes the functional</p>
<div class="m-math"><svg style="width: 17.054em; height: 1.782em; vertical-align: -0.000em; " viewBox="108.6 -17.82 170.54 17.82">
<title>
\[ \Theta(\hat{f}) = \left\lVert h * \hat{f} - g \right\rVert^2 + \lambda \left\lVert W(\hat{f}) \right\rVert_1 \; , \]
</title>
<defs>
<path id='eq82-g14-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq82-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq82-g14-94' d='M2.81-4.43L1.72-5.89H1.18L.1-4.43H.39L1.45-5.33L2.52-4.43H2.81Z'/>
<path id='eq82-g4-13' d='M4.17 7.15V-.36H3.45V7.15H4.17ZM1.74 7.15V-.36H1.02V7.15H1.74Z'/>
<path id='eq82-g10-17' d='M5.69-1.25L5.54-1.39C4.9-.58 4.75-.45 4.56-.45C4.45-.45 4.37-.55 4.37-.67C4.37-.8 4.56-1.54 4.76-2.16C5.12-3.28 5.34-4.16 5.34-4.45C5.34-4.93 5.01-5.25 4.55-5.25C3.78-5.25 2.93-4.48 1.82-2.74L3.25-8.08L3.19-8.13C2.5-7.98 2.04-7.9 1.32-7.81V-7.63C1.38-7.63 1.45-7.63 1.52-7.63C1.82-7.63 2.12-7.61 2.12-7.35C2.12-7.07 1.93-6.46 1.83-6.1L.23 0H1.12C1.6-1.83 1.75-2.24 2.23-2.97C2.85-3.91 3.66-4.65 4.07-4.65C4.25-4.65 4.41-4.5 4.41-4.35C4.41-4.3 4.37-4.14 4.32-3.95L3.67-1.49C3.51-.91 3.43-.54 3.43-.39C3.43-.08 3.63 .11 3.95 .11C4.56 .11 4.97-.21 5.69-1.25Z'/>
<path id='eq82-g10-44' d='M10.79-7.59V-7.78H8.59V-7.59C9.24-7.53 9.36-7.44 9.36-7.11C9.36-6.91 9.28-6.63 9.11-6.31L6.88-1.93L6.41-6.72L6.4-6.88C6.4-7.37 6.57-7.53 7.21-7.59V-7.78H4.37V-7.59C5.06-7.56 5.18-7.48 5.26-6.9L5.37-6.07L3.32-1.93L2.8-6.77L2.79-6.93C2.79-7.4 2.93-7.5 3.66-7.59V-7.78H.85V-7.59C1.23-7.54 1.33-7.5 1.45-7.41C1.6-7.27 1.64-7.06 1.79-5.94L2.53 .21H2.75L5.4-5.19H5.46L6.05 .21H6.29L9.9-6.73C10.22-7.34 10.34-7.44 10.79-7.59Z'/>
<path id='eq82-g10-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq82-g10-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq82-g10-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
<path id='eq82-g10-150' d='M2.32-.07C2.32-1.06 1.63-1.21 1.36-1.21C1.06-1.21 .67-1.04 .67-.52C.67-.05 1.1 .07 1.41 .07C1.49 .07 1.55 .06 1.58 .05C1.63 .04 1.67 .02 1.69 .02C1.77 .02 1.86 .08 1.86 .19C1.86 .42 1.67 .95 .88 1.45L.99 1.68C1.35 1.56 2.32 .77 2.32-.07Z'/>
<use id='eq82-g17-94' xlink:href='#eq82-g14-94' transform='scale(1.36)'/>
<path id='eq82-g7-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq82-g7-3' d='M4.87-3.98C4.87-4.18 4.7-4.39 4.49-4.39C4.22-4.39 3.24-3.42 2.89-3.22C2.89-3.88 3.23-4.55 3.23-4.95C3.23-5.2 3.06-5.36 2.81-5.36C2.57-5.36 2.43-5.19 2.43-4.95C2.43-4.49 2.72-3.86 2.72-3.22C2.33-3.44 1.41-4.44 1.16-4.44C.94-4.44 .75-4.24 .75-4.03C.75-3.61 2.16-3.32 2.62-3.06C2.12-2.78 1.19-2.63 .95-2.48C.83-2.39 .74-2.29 .74-2.13C.74-1.92 .91-1.73 1.12-1.73C1.39-1.73 2.36-2.69 2.72-2.89C2.72-2.24 2.38-1.57 2.38-1.16C2.38-.92 2.56-.75 2.8-.75S3.18-.93 3.18-1.16C3.18-1.64 2.91-2.26 2.91-2.89C3.28-2.68 4.22-1.68 4.45-1.68C4.67-1.68 4.86-1.88 4.86-2.1C4.86-2.25 4.75-2.36 4.63-2.43C4.32-2.63 3.5-2.76 2.99-3.06C3.55-3.39 4.31-3.44 4.66-3.64C4.79-3.72 4.87-3.82 4.87-3.98Z'/>
<path id='eq82-g7-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq82-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq82-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq82-g1-2' d='M5.97-2.81C5.88-3.18 5.84-3.94 5.84-4.3C5.84-4.65 5.88-4.92 5.97-5.25H5.67C5.59-4.85 5.38-4.56 4.98-4.56H3.72C3.25-4.56 3.13-4.76 2.97-5.25H2.67C2.75-4.87 2.8-4.2 2.8-3.85C2.8-3.51 2.76-3.12 2.68-2.81H2.98C3.14-3.3 3.28-3.55 3.73-3.55H4.98C5.41-3.55 5.56-3.26 5.67-2.81H5.97ZM8.19-3.94C8.19-6.3 6.63-8.05 4.3-8.05C1.98-8.05 .4-6.4 .4-3.98C.4-1.5 1.99 .17 4.3 .17C6.59 .17 8.19-1.49 8.19-3.94ZM6.84-4.01C6.84-2.58 6.5-1.46 5.85-.83C5.43-.44 4.91-.26 4.31-.26C3.76-.26 3.24-.43 2.83-.8C2.11-1.46 1.76-2.54 1.76-3.95C1.76-5.09 2.07-6.24 2.58-6.82C3.05-7.36 3.64-7.62 4.29-7.62C4.85-7.62 5.32-7.42 5.75-7.06C6.43-6.49 6.84-5.37 6.84-4.01Z'/>
<path id='eq82-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
</defs>
<g id='eq82-page1'>
<use x='108.6' y='-4.54' xlink:href='#eq82-g1-2'/>
<use x='117.83' y='-4.54' xlink:href='#eq82-g7-185'/>
<use x='126.33' y='-7.23' xlink:href='#eq82-g17-94'/>
<use x='124.37' y='-4.54' xlink:href='#eq82-g10-53'/>
<use x='129.8' y='-4.54' xlink:href='#eq82-g7-186'/>
<use x='137.7' y='-4.54' xlink:href='#eq82-g1-61'/>
<use x='148.1' y='-14.78' xlink:href='#eq82-g4-13'/>
<use x='148.1' y='-7.61' xlink:href='#eq82-g4-13'/>
<use x='153.74' y='-4.54' xlink:href='#eq82-g10-17'/>
<use x='162.61' y='-4.54' xlink:href='#eq82-g7-3'/>
<use x='174.94' y='-7.23' xlink:href='#eq82-g17-94'/>
<use x='172.98' y='-4.54' xlink:href='#eq82-g10-53'/>
<use x='181.07' y='-4.54' xlink:href='#eq82-g7-0'/>
<use x='191.4' y='-4.54' xlink:href='#eq82-g10-54'/>
<use x='197.74' y='-14.78' xlink:href='#eq82-g4-13'/>
<use x='197.74' y='-7.61' xlink:href='#eq82-g4-13'/>
<use x='202.95' y='-11.91' xlink:href='#eq82-g14-50'/>
<use x='210.49' y='-4.54' xlink:href='#eq82-g7-184'/>
<use x='219.73' y='-4.54' xlink:href='#eq82-g10-95'/>
<use x='228.34' y='-14.78' xlink:href='#eq82-g4-13'/>
<use x='228.34' y='-7.61' xlink:href='#eq82-g4-13'/>
<use x='233.25' y='-4.54' xlink:href='#eq82-g10-44'/>
<use x='244.87' y='-4.54' xlink:href='#eq82-g7-185'/>
<use x='253.36' y='-7.23' xlink:href='#eq82-g17-94'/>
<use x='251.41' y='-4.54' xlink:href='#eq82-g10-53'/>
<use x='256.83' y='-4.54' xlink:href='#eq82-g7-186'/>
<use x='261.41' y='-14.78' xlink:href='#eq82-g4-13'/>
<use x='261.41' y='-7.61' xlink:href='#eq82-g4-13'/>
<use x='266.62' y='0' xlink:href='#eq82-g14-49'/>
<use x='276.82' y='-4.54' xlink:href='#eq82-g10-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.724em; height: 0.793em; vertical-align: -0.013em; " viewBox="-.16 -7.8 7.24 7.93">
<title>
\(\lambda\)
</title>
<defs>
<path id='eq88-g1-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq88-page1'>
<use x='-.16' y='0' xlink:href='#eq88-g1-95'/>
</g>
</svg></span> is the regularization parameter (given by <code>regularization</code>), and <span class="m-math"><svg style="width: 2.698em; height: 1.318em; vertical-align: -0.246em; " viewBox="-.31 -10.72 26.98 13.18">
<title>
\(W(\hat{f})\)
</title>
<defs>
<path id='eq89-g8-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
<path id='eq89-g1-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq89-g1-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq89-g4-44' d='M10.79-7.59V-7.78H8.59V-7.59C9.24-7.53 9.36-7.44 9.36-7.11C9.36-6.91 9.28-6.63 9.11-6.31L6.88-1.93L6.41-6.72L6.4-6.88C6.4-7.37 6.57-7.53 7.21-7.59V-7.78H4.37V-7.59C5.06-7.56 5.18-7.48 5.26-6.9L5.37-6.07L3.32-1.93L2.8-6.77L2.79-6.93C2.79-7.4 2.93-7.5 3.66-7.59V-7.78H.85V-7.59C1.23-7.54 1.33-7.5 1.45-7.41C1.6-7.27 1.64-7.06 1.79-5.94L2.53 .21H2.75L5.4-5.19H5.46L6.05 .21H6.29L9.9-6.73C10.22-7.34 10.34-7.44 10.79-7.59Z'/>
<path id='eq89-g4-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq89-page1'>
<use x='-.31' y='0' xlink:href='#eq89-g4-44'/>
<use x='11.31' y='0' xlink:href='#eq89-g1-185'/>
<use x='19.8' y='-2.69' xlink:href='#eq89-g8-94'/>
<use x='17.85' y='0' xlink:href='#eq89-g4-53'/>
<use x='23.28' y='0' xlink:href='#eq89-g1-186'/>
</g>
</svg></span> is a wavelet transform
of <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq90-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq90-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq90-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq90-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq90-g1-53'/>
</g>
</svg></span>. The <span class="m-math"><svg style="width: 0.712em; height: 0.993em; vertical-align: -0.180em; " viewBox=".05 -8.13 7.12 9.93">
<title>
\(l_1\)
</title>
<defs>
<path id='eq91-g5-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq91-g1-59' d='M2.87-1.36L2.72-1.46C2.61-1.33 2.5-1.19 2.41-1.06C2.01-.56 1.8-.38 1.58-.38C1.46-.38 1.41-.45 1.41-.6C1.41-.71 1.46-.95 1.52-1.18L3.32-8.08L3.26-8.13C2.56-7.98 2.11-7.9 1.41-7.81V-7.62H1.61C1.98-7.62 2.22-7.52 2.22-7.35C2.22-7.31 2.2-7.23 2.17-7.13L.54-.85C.5-.73 .49-.63 .49-.54C.49-.1 .69 .13 1.07 .13C1.69 .13 2.1-.21 2.87-1.36Z'/>
</defs>
<g id='eq91-page1'>
<use x='.05' y='0' xlink:href='#eq91-g1-59'/>
<use x='3.73' y='1.79' xlink:href='#eq91-g5-49'/>
</g>
</svg></span> regularization is applied in some wavelet domain, assuming that the image has a sparse
representation in the wavelet domain. We use the Haar wavelet, due to its computational simplicity (it is also
the wavelet used by Beck and Teboulle). <span class="m-math"><svg style="width: 0.754em; height: 1.318em; vertical-align: -0.246em; " viewBox=".33 -10.72 7.54 13.18">
<title>
\(\hat{f}\)
</title>
<defs>
<path id='eq92-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq92-g5-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
</defs>
<g id='eq92-page1'>
<use x='4.03' y='-2.69' xlink:href='#eq92-g5-94'/>
<use x='2.08' y='0' xlink:href='#eq92-g1-53'/>
</g>
</svg></span> is returned in <code>out</code>.</p>
<p>The iterative algorithm is stopped when the maximum difference of <span class="m-math"><svg style="width: 2.459em; height: 1.318em; vertical-align: -0.246em; " viewBox="0 -10.72 24.59 13.18">
<title>
\(\Theta(\hat{f})\)
</title>
<defs>
<path id='eq93-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq93-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq93-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq93-g11-94' d='M3.84-6.04L2.35-8.03H1.61L.13-6.04H.54L1.98-7.27L3.43-6.04H3.84Z'/>
<path id='eq93-g1-2' d='M5.97-2.81C5.88-3.18 5.84-3.94 5.84-4.3C5.84-4.65 5.88-4.92 5.97-5.25H5.67C5.59-4.85 5.38-4.56 4.98-4.56H3.72C3.25-4.56 3.13-4.76 2.97-5.25H2.67C2.75-4.87 2.8-4.2 2.8-3.85C2.8-3.51 2.76-3.12 2.68-2.81H2.98C3.14-3.3 3.28-3.55 3.73-3.55H4.98C5.41-3.55 5.56-3.26 5.67-2.81H5.97ZM8.19-3.94C8.19-6.3 6.63-8.05 4.3-8.05C1.98-8.05 .4-6.4 .4-3.98C.4-1.5 1.99 .17 4.3 .17C6.59 .17 8.19-1.49 8.19-3.94ZM6.84-4.01C6.84-2.58 6.5-1.46 5.85-.83C5.43-.44 4.91-.26 4.31-.26C3.76-.26 3.24-.43 2.83-.8C2.11-1.46 1.76-2.54 1.76-3.95C1.76-5.09 2.07-6.24 2.58-6.82C3.05-7.36 3.64-7.62 4.29-7.62C4.85-7.62 5.32-7.42 5.75-7.06C6.43-6.49 6.84-5.37 6.84-4.01Z'/>
</defs>
<g id='eq93-page1'>
<use x='0' y='0' xlink:href='#eq93-g1-2'/>
<use x='9.23' y='0' xlink:href='#eq93-g4-185'/>
<use x='17.72' y='-2.69' xlink:href='#eq93-g11-94'/>
<use x='15.77' y='0' xlink:href='#eq93-g7-53'/>
<use x='21.2' y='0' xlink:href='#eq93-g4-186'/>
</g>
</svg></span> between two steps (ignoring
the regularization term) is less than <code>tolerance</code> times the maximum absolute value in <span class="m-math"><svg style="width: 0.559em; height: 0.771em; vertical-align: -0.246em; " viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq94-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq94-page1'>
<use x='.07' y='0' xlink:href='#eq94-g1-54'/>
</g>
</svg></span>.</p>
<p><code>maxIterations</code> provides an additional stopping condition, in case the algorithm does not converge quickly
enough. In a way, providing a small maximum number of iterations is an additional form of regularization.
Setting <code>maxIterations</code> to 0 runs the algorithm until convergence.</p>
<p><code>nScales</code> determines how many scales of the Haar wavelet to compute. It defaults to 3, as used by Beck and Teboulle.
Increasing this value might be useful for very large images.</p>
<p><code>psf</code> is given in the spatial domain, and will be zero-padded to the size of <code>in</code> and Fourier transformed.
The PSF (point spread function) should sum to one in order to preserve the mean image intensity.
If the OTF (optical transfer function, the Fourier transform of the PSF) is known, it is possible to pass
that as <code>psf</code>; add the string <code>"OTF"</code> to <code>options</code>.</p>
<p>All input images must be real-valued and scalar, except if the OFT is given instead of the PSF, in which
case <code>psf</code> could be complex-valued.</p>
<p>If <code>"pad"</code> is in <code>options</code>, then <code>in</code> is padded by the size of <code>psf</code> in all directions (padded area
is filled by mirroring at the image border). This significantly reduces the effects of the periodicity
of the frequency-domain convolution. <code>"pad"</code> cannot be combined with <code>"OTF"</code>.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>A. Beck, M. Teboulle, &ldquo;A fast iterative shrinkage-thresholding algorithm for linear inverse problems&rdquo;,
  SIAM Journal on Imaging Sciences 2(1):183–202, 2009.</li>
</ul>
</aside>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form action="https://diplib.org/diplib-docs/#search">
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript. Enable it or <a href="https://google.com/search?q=site:diplib.org+">use an external search engine</a>.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or modules.
              You can omit any prefix from the symbol or file path; adding a <code>:</code> or
              <code>/</code> suffix lists all members of given symbol or directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span> / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
              <span class="m-label m-dim">Enter</span> to go.
              <span class="m-label m-dim">Tab</span> autocompletes common prefix.
              You can copy a link to the result using <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">L</span>,
              or <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">M</span> to copy a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.<br />Maybe try a full-text <a href="#" id="search-external" data-search-engine="https://google.com/search?q=site:diplib.org+{query}">search with external engine</a>?</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>DIPlib, a library for quantitative image analysis. Documentation compiled with <a href="https://crisluengo.github.io/doxpp/">dox++</a> and styled with <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>