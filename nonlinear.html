<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Filtering &raquo; Non-linear filters module | DIPlib | a library for quantitative image analysis</title>
  <link rel="stylesheet" href="m-dip+documentation.compiled.css" />
  <link rel="icon" href="DIPlib_logo_32.png" type="image/png" />
  <link rel="search" type="application/opensearchdescription+xml" href="opensearch.xml" title="Search DIPlib documentation" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#ffffff" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://diplib.org"><img src="DIPlib_logo.svg" alt="" />DIPlib</a><span class="m-breadcrumb">┃</span><a href="index.html" class="m-thin">a library for quantitative image analysis</a><span class="m-breadcrumb">┃</span><a href="https://github.com/DIPlib/diplib/releases/tag/3.3.0" class="m-thin">version 3.3.0</a>      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="modules.html">Modules</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="classes.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="filtering.html">Filtering</a> &raquo;</span>
          Non-linear filters <span class="m-thin">module</span>          <div class="m-doc-include m-code m-inverted m-text-right"><span class="cp">#include</span> <a class="cpf" href="file--diplib--nonlinear-h.html">"diplib/nonlinear.h"</a></div>
        </h1>
        <p>Non-linear filters for noise reduction, detection, etc., excluding morphological filters.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#function-members">Functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
        <section id="function-members">
          <h2>Functions</h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-PercentileFilter-dip-Image-CL-dip-Image-L-dip-dfloat--dip-Kernel-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />PercentileFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> percentile,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies a percentile filter to <code>in</code>.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MedianFilter-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MedianFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>The median filter, a non-linear smoothing filter.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-VarianceFilter-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />VarianceFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Computes, for each pixel, the sample variance within a filter window around the pixel.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-SelectionFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-dfloat--dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />SelectionFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; control,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> threshold = 0.0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::MINIMUM,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Selects, for each pixel, a value from within the filter window, where a control image is minimal or maximal.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Kuwahara-dip-Image-CL-dip-Image-L-dip-Kernel--dip-dfloat--dip-StringArray-CL" class="m-doc">dip::<wbr />Kuwahara</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> kernel = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> threshold = 0.0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>The Kuwahara-Nagao operator, a non-linear edge-preserving smoothing filter.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-NonMaximumSuppression-dip-Image-CL-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-String-CL" class="m-doc">dip::<wbr />NonMaximumSuppression</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; gradmag,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; gradient,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::INTERPOLATE)</span>
            </dt>
            <dd>Non-maximum suppression, as used in the Canny edge detector.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MoveToLocalMinimum-dip-Image-CL-dip-Image-CL-dip-Image-L" class="m-doc">dip::<wbr />MoveToLocalMinimum</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; bin,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; weights,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out)</span>
            </dt>
            <dd>Given a sparse binary image <code>bin</code>, moves each set pixel to the pixel in the 3x3 neighborhood with
lowest <code>weight</code>.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-PeronaMalikDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat--dip-String-CL" class="m-doc">dip::<wbr />PeronaMalikDiffusion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> iterations = 5,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> K = 10,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> lambda = 0.25,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; g = "Gauss")</span>
            </dt>
            <dd>Applies Perona-Malik anisotropic diffusion</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-GaussianAnisotropicDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat--dip-String-CL" class="m-doc">dip::<wbr />GaussianAnisotropicDiffusion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> iterations = 5,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> K = 10,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> lambda = 0.25,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; g = "Gauss")</span>
            </dt>
            <dd>Applies iterative generic anisotropic diffusion using Gaussian derivatives</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-RobustAnisotropicDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat-" class="m-doc">dip::<wbr />RobustAnisotropicDiffusion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> iterations = 5,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> sigma = 10,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> lambda = 0.25)</span>
            </dt>
            <dd>Applies iterative robust anisotropic diffusion</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-CoherenceEnhancingDiffusion-dip-Image-CL-dip-Image-L-dip-dfloat--dip-dfloat--dip-uint--dip-StringSet-CL" class="m-doc">dip::<wbr />CoherenceEnhancingDiffusion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> derivativeSigma = 1,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularizationSigma = 3,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> iterations = 5,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; flags = {})</span>
            </dt>
            <dd>Applies iterative coherence enhancing (anisotropic) diffusion</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-AdaptiveGauss-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL" class="m-doc">dip::<wbr />AdaptiveGauss</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html#dip-ImageConstRefArray" class="m-doc">dip::ImageConstRefArray</a> const&amp; params,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; sigmas = {5.0,1.0},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> const&amp; orders = {0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> const&amp; exponents = {0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; interpolationMethod = S::LINEAR,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; boundaryCondition = S::SYMMETRIC_MIRROR)</span>
            </dt>
            <dd>Adaptive Gaussian filtering.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-AdaptiveBanana-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL" class="m-doc">dip::<wbr />AdaptiveBanana</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html#dip-ImageConstRefArray" class="m-doc">dip::ImageConstRefArray</a> const&amp; params,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; sigmas = {5.0,1.0},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> const&amp; orders = {0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> const&amp; exponents = {0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; interpolationMethod = S::LINEAR,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; boundaryCondition = S::SYMMETRIC_MIRROR)</span>
            </dt>
            <dd>Adaptive Gaussian filtering using curvature.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-FullBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-dfloat--dip-dfloat--dip-StringArray-CL" class="m-doc">dip::<wbr />FullBilateralFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; estimate,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> spatialSigmas = {2.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tonalSigma = 30.0,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Bilateral filter, brute-force full kernel implementation</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-QuantizedBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-dfloat--dip-FloatArray--dip-dfloat--dip-StringArray-CL" class="m-doc">dip::<wbr />QuantizedBilateralFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; estimate,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> spatialSigmas = {2.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tonalSigma = 30.0,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> tonalBins = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Quantized (piecewise linear) bilateral filter</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-SeparableBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-BooleanArray-CL-dip-FloatArray--dip-dfloat--dip-dfloat--dip-StringArray-CL" class="m-doc">dip::<wbr />SeparableBilateralFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; estimate,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> const&amp; process = {},
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> spatialSigmas = {2.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tonalSigma = 30.0,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Separable bilateral filter, a very fast approximation</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-BilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray-CL-dip-dfloat--dip-dfloat--dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />BilateralFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; estimate,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; spatialSigmas = {2.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tonalSigma = 30.0,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = "xysep",
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Bilateral filter, convenience function that allows selecting an implementation</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="dip-PercentileFilter-dip-Image-CL-dip-Image-L-dip-dfloat--dip-Kernel-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-PercentileFilter-dip-Image-CL-dip-Image-L-dip-dfloat--dip-Kernel-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />PercentileFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> percentile,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Applies a percentile filter to <code>in</code>.</p>
<p>Determines the <code>percentile</code> percentile within the filter window, and assigns that value to the output pixel.
See also <a href="morphology.html#dip-RankFilter-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-String-CL-dip-StringArray-CL"><code>dip::RankFilter</code></a>, which does the same thing but uses a rank instead of a percentile as input argument.</p>
<p>The size and shape of the filter window is given by <code>kernel</code>, which you can define through a default
shape with corresponding sizes, or through a binary image. See <a href="dip-Kernel.html"><code>dip::Kernel</code></a>.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
          </div></section>
          <section class="m-doc-details" id="dip-MedianFilter-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MedianFilter-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MedianFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>The median filter, a non-linear smoothing filter.</p>
<p>The size and shape of the filter window is given by <code>kernel</code>, which you can define through a default
shape with corresponding sizes, or through a binary image. See <a href="dip-Kernel.html"><code>dip::Kernel</code></a>.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>Calls <a href="nonlinear.html#dip-PercentileFilter-dip-Image-CL-dip-Image-L-dip-dfloat--dip-Kernel-CL-dip-StringArray-CL"><code>dip::PercentileFilter</code></a> with the <code>percentile</code> parameter set to 50.</p>
          </div></section>
          <section class="m-doc-details" id="dip-VarianceFilter-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-VarianceFilter-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />VarianceFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Computes, for each pixel, the sample variance within a filter window around the pixel.</p>
<p>The size and shape of the filter window is given by <code>kernel</code>, which you can define through a default
shape with corresponding sizes, or through a binary image. See <a href="dip-Kernel.html"><code>dip::Kernel</code></a>.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>Uses <a href="dip-FastVarianceAccumulator.html"><code>dip::FastVarianceAccumulator</code></a> for the computation.</p>
          </div></section>
          <section class="m-doc-details" id="dip-SelectionFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-dfloat--dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-SelectionFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-dfloat--dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />SelectionFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; control,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> const&amp; kernel = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> threshold = 0.0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::MINIMUM,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Selects, for each pixel, a value from within the filter window, where a control image is minimal or maximal.</p>
<p>For each pixel, within the filter window, looks for the pixel with the lowest value (<code>mode</code> is <code>"minimum"</code>) or
highest value (<code>mode</code> is <code>"maximum"</code>), and takes the value from <code>in</code> at that location as the output value. To
prevent a stair-case effect in the output, where many pixels use the same input value, a <code>threshold</code> can be
specified. If it is a positive value, then the lowest (or highest) value found must be <code>threshold</code> lower (or
higher) than the central pixel, otherwise the central pixel is used.</p>
<p>Ties are solved by picking the value closest to the central pixel. Multiple control pixels with the same value
and at the same distance to the central pixel are solved arbitrarily (in the current implementation, the first
of these pixels encountered is used).</p>
<p>The Kuwahara-Nagao operator (see <a href="nonlinear.html#dip-Kuwahara-dip-Image-CL-dip-Image-L-dip-Kernel--dip-dfloat--dip-StringArray-CL"><code>dip::Kuwahara</code></a>) is implemented in terms of the <code>SelectionFilter</code>:</p>
<div class="m-code"><pre><span></span><span class="n">Image</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">Uniform</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">Image</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">VarianceFilter</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">kernel</span><span class="p">.</span><span class="n">Mirror</span><span class="p">();</span><span class="w"></span>
<span class="n">Image</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">SelectionFilter</span><span class="p">(</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>

<p>Note that the following reproduces the result of the erosion (albeit in a very costly manner):</p>
<div class="m-code"><pre><span></span><span class="n">Image</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">SelectionFilter</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>

<p>Nonetheless, this can used to implement color morphology, for example (note there are much better approaches to
build the <code>control</code> image):</p>
<div class="m-code"><pre><span></span><span class="c1">// Image in is a color image</span>
<span class="n">Image</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">SumTensorElements</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">Image</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">SelectionFilter</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;maximum&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>

<p>The size and shape of the filter window is given by <code>kernel</code>, which you can define through a default
shape with corresponding sizes, or through a binary image. See <a href="dip-Kernel.html"><code>dip::Kernel</code></a>.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p><code>control</code> must be a real-valued scalar image. <code>in</code> can be of any data type and tensor size. <code>out</code> will be of
the same size, tensor size, and data type as <code>in</code>.</p>
          </div></section>
          <section class="m-doc-details" id="dip-Kuwahara-dip-Image-CL-dip-Image-L-dip-Kernel--dip-dfloat--dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-Kuwahara-dip-Image-CL-dip-Image-L-dip-Kernel--dip-dfloat--dip-StringArray-CL" class="m-doc-self">dip::<wbr />Kuwahara</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Kernel.html" class="m-doc">dip::Kernel</a> kernel = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> threshold = 0.0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>The Kuwahara-Nagao operator, a non-linear edge-preserving smoothing filter.</p>
<p>For each pixel, shifts the filtering window such that the variance within the window is minimal, then
computes the average value as the output. The shift of the window is always such that the pixel under
consideration stays within the window.</p>
<p>In the two original papers describing the method (Kuwahara et al., 1980; Nagao and Matsuyama, 1979), a limited
number of sub-windows within the filtering window were examined (4 and 8, respectively). This function implements
a generalized version that allows as many different shifts are pixels are in the filtering window (Bakker et al.,
1999).</p>
<p>As described by Bakker (2002), this operator produces artificial boundaries in flat regions. This is because,
due to noise, one position of the filtering window will have the lowest variance in its neighborhood, and therefore
that position will be selected for all output pixels in the neighborhood. The solution we implement here is
requiring that the variance at the minimum be lower than the variance when the window is not shifted. The parameter
<code>threshold</code> controls how much lower the minimum must be. If the neighborhood is uniform w.r.t. this threshold
parameter, then the filtering window is not shifted.</p>
<p>The size and shape of the filter window is given by <code>kernel</code>, which you can define through a default
shape with corresponding sizes, or through a binary image. See <a href="dip-Kernel.html"><code>dip::Kernel</code></a>.</p>
<p>If <code>in</code> is non-scalar (e.g. a color image), then the variance is computed per-channel, and the maximum variance
at each pixel (i.e. the maximum across tensor elements) is used to direct the filtering for all channels.
If the Kuwahara filter were applied to each channel independently, false colors would appear.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="nonlinear.html#dip-SelectionFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-Kernel-CL-dip-dfloat--dip-String-CL-dip-StringArray-CL"><code>dip::SelectionFilter</code></a></p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>M. Kuwahara, K. Hachimura and M. Kinoshita, &ldquo;Image enhancement and left ventricular contour extraction techniques
  applied to radioisotope angiocardiograms&rdquo;, Automedica 3:107-119, 1980.</li>
<li>M. Nagao and T. Matsuyama, &ldquo;Edge preserving smoothing&rdquo;, Computer Graphics and Image Processing 9:394-407, 1979.</li>
<li>P. Bakker, P.W. Verbeek and L.J. van Vliet, &ldquo;Edge preserving orientation adaptive filtering&rdquo;, in: CVPR&lsquo;99 2:535–540, 1999.</li>
<li>P. Bakker, &ldquo;Image structure analysis for seismic interpretation&rdquo;, PhD Thesis, Delft University of Technology,
  The Netherlands, 2002.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-NonMaximumSuppression-dip-Image-CL-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-NonMaximumSuppression-dip-Image-CL-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-String-CL" class="m-doc-self">dip::<wbr />NonMaximumSuppression</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; gradmag,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; gradient,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::INTERPOLATE)</span></span>
            </h3>
            <p>Non-maximum suppression, as used in the Canny edge detector.</p>
<p><code>out</code> contains the value of <code>gradmag</code> where <code>gradmag</code> is a local maximum in the orientation
specified by the vector image <code>gradient</code>. Note that <code>gradmag</code> does not need to be the magnitude
of <code>gradient</code>, and that only the direction of the vectors (or orientation) is used.</p>
<p><code>gradmag</code> and <code>gradient</code> must be of the same floating-point type (i.e. they are either
<a href="pixeltypes.html#dip-DT_SFLOAT"><code>dip::DT_SFLOAT</code></a> or <a href="pixeltypes.html#dip-DT_DFLOAT"><code>dip::DT_DFLOAT</code></a>). <code>gradmag</code> must be scalar, and <code>gradient</code> must have as
many tensor elements as spatial dimensions. In the 1D case, <code>gradient</code> is not used.</p>
<p>If <code>gradmag</code> is not forged, the magnitude (<a href="numeric.html#dip-Norm-T-dip-uint--ConstSampleIterator&lt;T&gt;-"><code>dip::Norm</code></a>) of <code>gradient</code> is used instead.</p>
<p><code>mask</code>, if forged, must be a binary scalar image. Only those pixels are evaluated that are set in <code>mask</code>.</p>
<p>All three input images (if forged) must have the same spatial dimensions.</p>
<p><code>mode</code> can be &ldquo;interpolate&rdquo; or &ldquo;round&rdquo;. The interpolating mode is only valid in 2D; the gradient magnitude
is interpolated to take into account all information present in the direction of the gradient. The rounding
mode rounds the angles to point to the nearest neighbor.
For higher-dimensional images, gradients are always rounded.</p>
          </div></section>
          <section class="m-doc-details" id="dip-MoveToLocalMinimum-dip-Image-CL-dip-Image-CL-dip-Image-L"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MoveToLocalMinimum-dip-Image-CL-dip-Image-CL-dip-Image-L" class="m-doc-self">dip::<wbr />MoveToLocalMinimum</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; bin,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; weights,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out)</span></span>
            </h3>
            <p>Given a sparse binary image <code>bin</code>, moves each set pixel to the pixel in the 3x3 neighborhood with
lowest <code>weight</code>.</p>
<p>The neighborhood used is 3x3 in 2D, or 3x3x3 in 3D.
In other words, the connectivity is equal to <code>bin.Dimensionality()</code>.</p>
<p>Note that the output doesn&rsquo;t necessarily have the same number of set pixels as the <code>bin</code> input. However,
it will not have more. To move pixels over a larger distance, call this function repeatedly.</p>
<p><code>out</code> will have the same properties as <code>bin</code>. <code>bin</code> must be binary, scalar, and have at least one dimension.
<code>weights</code> must be real-valued, scalar, and of the same sizes as <code>bin</code>. No singleton expansion is applied.</p>
          </div></section>
          <section class="m-doc-details" id="dip-PeronaMalikDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat--dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-PeronaMalikDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat--dip-String-CL" class="m-doc-self">dip::<wbr />PeronaMalikDiffusion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> iterations = 5,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> K = 10,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> lambda = 0.25,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; g = "Gauss")</span></span>
            </h3>
            <p>Applies Perona-Malik anisotropic diffusion</p>
<p>Applies <code>iterations</code> steps of the anisotropic diffusion as proposed by Perona and Malik:</p>
<div class="m-math"><svg style="width: 12.986em; height: 2.895em;" viewBox="129.14 -30.15 129.86 28.95">
<title>
\[ I^{t+1} = I^t + \lambda \sum_\eta \left( c_\eta^t \nabla_\eta I^t \right) \; , \]
</title>
<defs>
<use id='eq152-g10-114' xlink:href='#eq152-g7-114' transform='scale(1.36)'/>
<use id='eq152-g10-184' xlink:href='#eq152-g7-184' transform='scale(1.36)'/>
<path id='eq152-g20-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq152-g7-114' d='M5.49-5.9H.27L2.85 0H3.02L5.49-5.9ZM4.77-5.14L3.16-1.27L1.55-5.14H4.77Z'/>
<path id='eq152-g7-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<path id='eq152-g4-16' d='M3.88 20.41C2.17 18.38 1.69 13.35 1.69 10.05S2.17 1.74 3.88-.3L3.73-.67C2.43 .81 .6 4.13 .6 10.05S2.36 19.3 3.73 20.77L3.88 20.41Z'/>
<path id='eq152-g4-17' d='M.36 20.41L.51 20.77C1.88 19.3 3.64 15.97 3.64 10.05S1.81 .81 .51-.67L.36-.3C2.07 1.74 2.55 6.75 2.55 10.05S2.07 18.38 .36 20.41Z'/>
<path id='eq152-g4-213' d='M14.78 13.13H14.48C14.07 15.73 13.09 17.12 11.64 17.12H2.53L9.03 8.79L3.48 .62H10.98C12.51 .62 13.33 1.49 13.77 4.13H14.03L13.91 0H1.39L7.77 9.15L.51 18.34H14.54L14.78 13.13Z'/>
<path id='eq152-g13-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq152-g13-50' d='M3.2-.84L3.06-.93C2.58-.41 2.24-.22 1.81-.22C1.31-.22 1.01-.59 1.01-1.21C1.01-1.96 1.32-2.73 1.81-3.25C2.06-3.51 2.41-3.67 2.76-3.67C2.96-3.67 3.08-3.6 3.08-3.49C3.08-3.45 3.07-3.41 3.03-3.33C2.97-3.21 2.95-3.16 2.95-3.07C2.95-2.86 3.08-2.74 3.29-2.74C3.54-2.74 3.71-2.91 3.71-3.14C3.71-3.55 3.33-3.85 2.79-3.85C1.48-3.85 .26-2.58 .26-1.21C.26-.38 .73 .1 1.55 .1C2.2 .1 2.66-.17 3.2-.84Z'/>
<path id='eq152-g13-67' d='M2.59-3.74H1.89L2.13-4.64C2.14-4.66 2.14-4.67 2.14-4.68C2.14-4.74 2.11-4.77 2.07-4.77C2.02-4.77 1.99-4.76 1.94-4.69C1.11-3.61 .5-3.79 .5-3.51C.5-3.5 .5-3.49 .51-3.46H1.15L.52-1.06C.5-.94 .32-.4 .32-.24C.32-.04 .51 .1 .74 .1C1.14 .1 1.43-.15 1.98-.96L1.87-1.02C1.44-.47 1.3-.33 1.16-.33C1.08-.33 1.03-.4 1.03-.51C1.03-.52 1.03-.52 1.04-.55L1.81-3.46H2.54L2.59-3.74Z'/>
<path id='eq152-g13-91' d='M4.16-3.15C4.16-3.62 3.91-3.85 3.42-3.85C2.62-3.85 1.81-3.14 1.8-3.14C1.8-3.14 1.82-3.17 1.82-3.28C1.82-3.5 1.72-3.85 1.11-3.85S.25-3.29 .25-3.09C.25-3.04 .26-3.01 .29-3.01C.49-3.01 .39-3.54 .93-3.54C1.07-3.54 1.14-3.43 1.14-3.27C1.14-3.03 1.03-2.68 .91-2.23L.54-.88C.4-.38 .24-.09 .19 0H1.01C1.03-.08 1.09-.39 1.23-.88L1.76-2.74C1.79-2.86 2.38-3.44 2.92-3.44C3.31-3.44 3.43-3.28 3.43-3.02C3.43-2.87 3.39-2.68 3.34-2.49L2.47 .58C2.34 1.04 2.24 1.7 2.23 1.81H3V1.77C3 1.63 3 1.19 3.17 .59L4.05-2.52C4.12-2.77 4.16-2.98 4.16-3.15Z'/>
<path id='eq152-g13-95' d='M4.6-.64L4.59-.66C4.47-.66 4.32-.36 3.96-.36C2.31-.36 5.31-5.72 2.74-5.72H2.65C2.49-5.72 2.12-5.59 2.01-5.49C2-5.48 2.07-5.4 2.08-5.4C2.12-5.43 2.31-5.51 2.49-5.51C3.34-5.51 3.11-4.11 3.11-3.89C3.12-3.86 3.11-3.84 3.1-3.81C2.93-3 .35-.71 .14 0H1.01C1.01-.09 1.02-.17 1.04-.27C1.29-1.39 3-3.08 3-3.09H3.01C2.96-2.64 2.17 .1 3.6 .1C3.98 .1 4.59-.53 4.6-.64Z'/>
<path id='eq152-g13-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq152-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<use id='eq152-g16-30' xlink:href='#eq152-g13-30' transform='scale(1.36)'/>
<use id='eq152-g16-50' xlink:href='#eq152-g13-50' transform='scale(1.36)'/>
<use id='eq152-g16-95' xlink:href='#eq152-g13-95' transform='scale(1.36)'/>
<use id='eq152-g16-150' xlink:href='#eq152-g13-150' transform='scale(1.36)'/>
</defs>
<g id='eq152-page1'>
<use x='129.23' y='-16.28' xlink:href='#eq152-g16-30'/>
<use x='134.05' y='-21.21' xlink:href='#eq152-g13-67'/>
<use x='137' y='-21.21' xlink:href='#eq152-g7-184'/>
<use x='141.94' y='-21.21' xlink:href='#eq152-g20-49'/>
<use x='150.15' y='-16.28' xlink:href='#eq152-g1-61'/>
<use x='161.03' y='-16.28' xlink:href='#eq152-g16-30'/>
<use x='165.85' y='-21.21' xlink:href='#eq152-g13-67'/>
<use x='171.95' y='-16.28' xlink:href='#eq152-g10-184'/>
<use x='181.2' y='-16.28' xlink:href='#eq152-g16-95'/>
<use x='189.81' y='-28.51' xlink:href='#eq152-g4-213'/>
<use x='195.42' y='-3.01' xlink:href='#eq152-g13-91'/>
<use x='208.57' y='-29.49' xlink:href='#eq152-g4-16'/>
<use x='213.2' y='-16.28' xlink:href='#eq152-g16-50'/>
<use x='218.82' y='-21.21' xlink:href='#eq152-g13-67'/>
<use x='218.94' y='-13.32' xlink:href='#eq152-g13-91'/>
<use x='224.14' y='-16.28' xlink:href='#eq152-g10-114'/>
<use x='232.08' y='-14.48' xlink:href='#eq152-g13-91'/>
<use x='237.65' y='-16.28' xlink:href='#eq152-g16-30'/>
<use x='242.47' y='-21.21' xlink:href='#eq152-g13-67'/>
<use x='246.15' y='-29.49' xlink:href='#eq152-g4-17'/>
<use x='256.68' y='-16.28' xlink:href='#eq152-g16-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.724em; height: 0.793em;" viewBox="-.16 -7.8 7.24 7.93">
<title>
\(\lambda\)
</title>
<defs>
<path id='eq154-g1-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq154-page1'>
<use x='-.16' y='0' xlink:href='#eq154-g1-95'/>
</g>
</svg></span> is set with the <code>lambda</code> parameter, <span class="m-math"><svg style="width: 0.567em; height: 0.772em;" viewBox="0 -5.25 5.67 7.72">
<title>
\(\eta\)
</title>
<defs>
<path id='eq155-g1-91' d='M5.67-4.3C5.67-4.94 5.34-5.25 4.67-5.25C3.57-5.25 2.47-4.28 2.45-4.28C2.45-4.28 2.48-4.32 2.48-4.48C2.48-4.78 2.35-5.25 1.51-5.25S.35-4.49 .35-4.22C.35-4.14 .36-4.11 .39-4.11C.67-4.11 .54-4.82 1.27-4.82C1.46-4.82 1.55-4.68 1.55-4.45C1.55-4.13 1.41-3.66 1.24-3.04L.74-1.2C.55-.52 .33-.12 .26 0H1.38C1.41-.11 1.49-.54 1.68-1.2L2.39-3.74C2.44-3.89 3.24-4.69 3.98-4.69C4.51-4.69 4.68-4.47 4.68-4.12C4.68-3.92 4.62-3.66 4.55-3.39L3.37 .79C3.19 1.42 3.06 2.32 3.04 2.47H4.09V2.42C4.09 2.23 4.09 1.62 4.32 .8L5.53-3.44C5.62-3.78 5.67-4.06 5.67-4.3Z'/>
</defs>
<g id='eq155-page1'>
<use x='0' y='0' xlink:href='#eq155-g1-91'/>
</g>
</svg></span> are the each of the cardinal directions,
<span class="m-math"><svg style="width: 1.210em; height: 1.165em;" viewBox=".12 -8.05 12.1 11.65">
<title>
\(\nabla_\eta\)
</title>
<defs>
<path id='eq156-g4-91' d='M4.16-3.15C4.16-3.62 3.91-3.85 3.42-3.85C2.62-3.85 1.81-3.14 1.8-3.14C1.8-3.14 1.82-3.17 1.82-3.28C1.82-3.5 1.72-3.85 1.11-3.85S.25-3.29 .25-3.09C.25-3.04 .26-3.01 .29-3.01C.49-3.01 .39-3.54 .93-3.54C1.07-3.54 1.14-3.43 1.14-3.27C1.14-3.03 1.03-2.68 .91-2.23L.54-.88C.4-.38 .24-.09 .19 0H1.01C1.03-.08 1.09-.39 1.23-.88L1.76-2.74C1.79-2.86 2.38-3.44 2.92-3.44C3.31-3.44 3.43-3.28 3.43-3.02C3.43-2.87 3.39-2.68 3.34-2.49L2.47 .58C2.34 1.04 2.24 1.7 2.23 1.81H3V1.77C3 1.63 3 1.19 3.17 .59L4.05-2.52C4.12-2.77 4.16-2.98 4.16-3.15Z'/>
<path id='eq156-g1-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
</defs>
<g id='eq156-page1'>
<use x='.12' y='0' xlink:href='#eq156-g1-114'/>
<use x='8.06' y='1.79' xlink:href='#eq156-g4-91'/>
</g>
</svg></span> is the finite difference in direction <span class="m-math"><svg style="width: 0.567em; height: 0.772em;" viewBox="0 -5.25 5.67 7.72">
<title>
\(\eta\)
</title>
<defs>
<path id='eq157-g1-91' d='M5.67-4.3C5.67-4.94 5.34-5.25 4.67-5.25C3.57-5.25 2.47-4.28 2.45-4.28C2.45-4.28 2.48-4.32 2.48-4.48C2.48-4.78 2.35-5.25 1.51-5.25S.35-4.49 .35-4.22C.35-4.14 .36-4.11 .39-4.11C.67-4.11 .54-4.82 1.27-4.82C1.46-4.82 1.55-4.68 1.55-4.45C1.55-4.13 1.41-3.66 1.24-3.04L.74-1.2C.55-.52 .33-.12 .26 0H1.38C1.41-.11 1.49-.54 1.68-1.2L2.39-3.74C2.44-3.89 3.24-4.69 3.98-4.69C4.51-4.69 4.68-4.47 4.68-4.12C4.68-3.92 4.62-3.66 4.55-3.39L3.37 .79C3.19 1.42 3.06 2.32 3.04 2.47H4.09V2.42C4.09 2.23 4.09 1.62 4.32 .8L5.53-3.44C5.62-3.78 5.67-4.06 5.67-4.3Z'/>
</defs>
<g id='eq157-page1'>
<use x='0' y='0' xlink:href='#eq157-g1-91'/>
</g>
</svg></span>,</p>
<div class="m-math"><svg style="width: 8.383em; height: 1.454em;" viewBox="152.02 -14.55 83.83 14.54">
<title>
\[ c_\eta^t = g\left( \| \nabla_\eta I^t \| \right) \; , \]
</title>
<defs>
<path id='eq153-g7-107' d='M3.91 2.3V-8.42H3.24V2.3H3.91ZM1.52 2.3V-8.42H.86V2.3H1.52Z'/>
<path id='eq153-g7-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
<path id='eq153-g4-0' d='M3.13 12.48C1.83 11.02 1.64 8.27 1.64 6.06S1.69 1.21 3.13-.43L2.99-.67C2.42-.19 .6 2.12 .6 6.06S2.42 12.26 2.99 12.73L3.13 12.48Z'/>
<path id='eq153-g4-1' d='M.36 12.48L.5 12.73C1.07 12.26 2.89 10 2.89 6.06S1.07-.19 .5-.67L.36-.43C1.8 1.21 1.85 3.86 1.85 6.06S1.66 11.02 .36 12.48Z'/>
<path id='eq153-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq153-g10-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq153-g10-50' d='M3.2-.84L3.06-.93C2.58-.41 2.24-.22 1.81-.22C1.31-.22 1.01-.59 1.01-1.21C1.01-1.96 1.32-2.73 1.81-3.25C2.06-3.51 2.41-3.67 2.76-3.67C2.96-3.67 3.08-3.6 3.08-3.49C3.08-3.45 3.07-3.41 3.03-3.33C2.97-3.21 2.95-3.16 2.95-3.07C2.95-2.86 3.08-2.74 3.29-2.74C3.54-2.74 3.71-2.91 3.71-3.14C3.71-3.55 3.33-3.85 2.79-3.85C1.48-3.85 .26-2.58 .26-1.21C.26-.38 .73 .1 1.55 .1C2.2 .1 2.66-.17 3.2-.84Z'/>
<path id='eq153-g10-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq153-g10-67' d='M2.59-3.74H1.89L2.13-4.64C2.14-4.66 2.14-4.67 2.14-4.68C2.14-4.74 2.11-4.77 2.07-4.77C2.02-4.77 1.99-4.76 1.94-4.69C1.11-3.61 .5-3.79 .5-3.51C.5-3.5 .5-3.49 .51-3.46H1.15L.52-1.06C.5-.94 .32-.4 .32-.24C.32-.04 .51 .1 .74 .1C1.14 .1 1.43-.15 1.98-.96L1.87-1.02C1.44-.47 1.3-.33 1.16-.33C1.08-.33 1.03-.4 1.03-.51C1.03-.52 1.03-.52 1.04-.55L1.81-3.46H2.54L2.59-3.74Z'/>
<path id='eq153-g10-91' d='M4.16-3.15C4.16-3.62 3.91-3.85 3.42-3.85C2.62-3.85 1.81-3.14 1.8-3.14C1.8-3.14 1.82-3.17 1.82-3.28C1.82-3.5 1.72-3.85 1.11-3.85S.25-3.29 .25-3.09C.25-3.04 .26-3.01 .29-3.01C.49-3.01 .39-3.54 .93-3.54C1.07-3.54 1.14-3.43 1.14-3.27C1.14-3.03 1.03-2.68 .91-2.23L.54-.88C.4-.38 .24-.09 .19 0H1.01C1.03-.08 1.09-.39 1.23-.88L1.76-2.74C1.79-2.86 2.38-3.44 2.92-3.44C3.31-3.44 3.43-3.28 3.43-3.02C3.43-2.87 3.39-2.68 3.34-2.49L2.47 .58C2.34 1.04 2.24 1.7 2.23 1.81H3V1.77C3 1.63 3 1.19 3.17 .59L4.05-2.52C4.12-2.77 4.16-2.98 4.16-3.15Z'/>
<path id='eq153-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<use id='eq153-g13-30' xlink:href='#eq153-g10-30' transform='scale(1.36)'/>
<use id='eq153-g13-50' xlink:href='#eq153-g10-50' transform='scale(1.36)'/>
<use id='eq153-g13-54' xlink:href='#eq153-g10-54' transform='scale(1.36)'/>
<use id='eq153-g13-150' xlink:href='#eq153-g10-150' transform='scale(1.36)'/>
</defs>
<g id='eq153-page1'>
<use x='152.02' y='-4.77' xlink:href='#eq153-g13-50'/>
<use x='157.65' y='-9.71' xlink:href='#eq153-g10-67'/>
<use x='157.76' y='-1.82' xlink:href='#eq153-g10-91'/>
<use x='166.17' y='-4.77' xlink:href='#eq153-g1-61'/>
<use x='176.64' y='-4.77' xlink:href='#eq153-g13-54'/>
<use x='185.93' y='-13.88' xlink:href='#eq153-g4-0'/>
<use x='190.27' y='-4.77' xlink:href='#eq153-g7-107'/>
<use x='195.77' y='-4.77' xlink:href='#eq153-g7-114'/>
<use x='203.7' y='-2.98' xlink:href='#eq153-g10-91'/>
<use x='209.28' y='-4.77' xlink:href='#eq153-g13-30'/>
<use x='214.1' y='-9.71' xlink:href='#eq153-g10-67'/>
<use x='218.14' y='-4.77' xlink:href='#eq153-g7-107'/>
<use x='223.76' y='-13.88' xlink:href='#eq153-g4-1'/>
<use x='233.53' y='-4.77' xlink:href='#eq153-g13-150'/>
</g>
</svg></div>
<p>and <span class="m-math"><svg style="width: 0.559em; height: 0.771em;" viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq158-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq158-page1'>
<use x='.07' y='0' xlink:href='#eq158-g1-54'/>
</g>
</svg></span> is a monotonically decreasing function, selected with the <code>g</code> parameter, and modulated
by the <code>K</code> parameter:</p>
<ul>
<li><code>"Gauss"</code>: <span class="m-math"><svg style="width: 9.204em; height: 1.437em;" viewBox=".07 -10.24 92.04 14.37">
<title>
\(g(x) = \exp(-(\frac{x}{K})^2)\)
</title>
<defs>
<path id='eq159-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq159-g14-101' d='M3.7-1.37L3.56-1.43C3.14-.77 2.77-.52 2.21-.52C1.73-.52 1.36-.74 1.11-1.21C.93-1.55 .86-1.86 .85-2.42H3.54C3.47-2.99 3.38-3.24 3.16-3.52C2.9-3.83 2.5-4.02 2.04-4.02C.96-4.02 .22-3.14 .22-1.87C.22-.66 .85 .09 1.85 .09C2.69 .09 3.34-.43 3.7-1.37ZM2.65-2.7H.86C.96-3.39 1.26-3.7 1.79-3.7S2.53-3.46 2.65-2.7Z'/>
<path id='eq159-g14-112' d='M4.11-2.16C4.11-3.24 3.49-4.02 2.65-4.02C2.16-4.02 1.77-3.8 1.39-3.33V-4L1.34-4.02C.86-3.83 .56-3.72 .08-3.57V-3.43C.16-3.44 .22-3.44 .3-3.44C.59-3.44 .66-3.35 .66-2.94V1.14C.66 1.6 .56 1.69 .04 1.75V1.9H2.16V1.74C1.5 1.73 1.39 1.63 1.39 1.08V-.29C1.69 0 1.9 .09 2.27 .09C3.3 .09 4.11-.89 4.11-2.16ZM3.35-1.82C3.35-.85 2.93-.19 2.3-.19C1.89-.19 1.39-.51 1.39-.77V-2.92C1.39-3.18 1.88-3.49 2.28-3.49C2.93-3.49 3.35-2.83 3.35-1.82Z'/>
<path id='eq159-g14-120' d='M4.18 0V-.13C3.91-.13 3.74-.27 3.47-.66L2.35-2.37L3.07-3.42C3.24-3.65 3.5-3.79 3.78-3.8V-3.93H2.4V-3.8C2.66-3.78 2.75-3.73 2.75-3.61C2.75-3.5 2.65-3.31 2.43-3.04C2.38-2.99 2.28-2.83 2.17-2.66L2.04-2.83C1.8-3.2 1.64-3.49 1.64-3.61C1.64-3.73 1.76-3.79 2.02-3.8V-3.93H.21V-3.8H.29C.55-3.8 .69-3.69 .96-3.28L1.78-2.02L.79-.58C.52-.22 .44-.16 .15-.13V0H1.41V-.13C1.17-.13 1.07-.17 1.07-.29C1.07-.34 1.13-.47 1.24-.65L1.93-1.72L2.73-.5C2.76-.45 2.78-.39 2.78-.34C2.78-.18 2.72-.15 2.43-.13V0H4.18Z'/>
<path id='eq159-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq159-g7-32' d='M5.4 0V-.14C4.85-.19 4.8-.22 4.55-.63L3.03-3.28L5.65-5.25C5.9-5.43 6.1-5.53 6.31-5.56V-5.7H4.37V-5.56L4.6-5.54C4.81-5.52 4.9-5.47 4.9-5.37C4.9-5.16 4.42-4.7 3.64-4.15L2.31-3.22L2.78-4.92C2.91-5.35 3.14-5.53 3.66-5.56V-5.7H1.28V-5.56C1.83-5.51 1.95-5.44 1.95-5.19C1.95-5.06 1.92-4.88 1.85-4.65L.78-.79C.62-.26 .58-.22 .06-.14V0H2.23V-.14C1.68-.2 1.6-.25 1.6-.52C1.6-.62 1.61-.68 1.67-.86L1.72-1.05L2.26-3.04L3.32-1.22C3.53-.86 3.65-.56 3.65-.39C3.65-.26 3.53-.19 3.25-.17L3-.14V0H5.4Z'/>
<path id='eq159-g7-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq159-g7-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq159-g4-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq159-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq159-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<use id='eq159-g17-101' xlink:href='#eq159-g14-101' transform='scale(1.36)'/>
<use id='eq159-g17-112' xlink:href='#eq159-g14-112' transform='scale(1.36)'/>
<use id='eq159-g17-120' xlink:href='#eq159-g14-120' transform='scale(1.36)'/>
<use id='eq159-g10-54' xlink:href='#eq159-g7-54' transform='scale(1.36)'/>
<use id='eq159-g10-71' xlink:href='#eq159-g7-71' transform='scale(1.36)'/>
</defs>
<g id='eq159-page1'>
<use x='.07' y='0' xlink:href='#eq159-g10-54'/>
<use x='7.01' y='0' xlink:href='#eq159-g4-185'/>
<use x='11.47' y='0' xlink:href='#eq159-g10-71'/>
<use x='17.36' y='0' xlink:href='#eq159-g4-186'/>
<use x='25.26' y='0' xlink:href='#eq159-g1-61'/>
<use x='35.66' y='0' xlink:href='#eq159-g17-101'/>
<use x='40.55' y='0' xlink:href='#eq159-g17-120'/>
<use x='46.52' y='0' xlink:href='#eq159-g17-112'/>
<use x='53.1' y='0' xlink:href='#eq159-g4-185'/>
<use x='57.56' y='0' xlink:href='#eq159-g4-0'/>
<use x='65.76' y='0' xlink:href='#eq159-g4-185'/>
<use x='72.58' y='-4.71' xlink:href='#eq159-g7-71'/>
<rect x='71.41' y='-3.41' height='.67' width='6.65'/>
<use x='71.55' y='4.12' xlink:href='#eq159-g7-32'/>
<use x='79.26' y='0' xlink:href='#eq159-g4-186'/>
<use x='83.83' y='-4.34' xlink:href='#eq159-g14-50'/>
<use x='88.72' y='0' xlink:href='#eq159-g4-186'/>
</g>
</svg></span></li>
<li><code>"quadratic"</code>: <span class="m-math"><svg style="width: 9.710em; height: 1.437em;" viewBox=".07 -10.24 97.1 14.37">
<title>
\(g(x) = 1 / (1 + (\frac{x}{K})^2)\)
</title>
<defs>
<path id='eq160-g14-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq160-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq160-g7-32' d='M5.4 0V-.14C4.85-.19 4.8-.22 4.55-.63L3.03-3.28L5.65-5.25C5.9-5.43 6.1-5.53 6.31-5.56V-5.7H4.37V-5.56L4.6-5.54C4.81-5.52 4.9-5.47 4.9-5.37C4.9-5.16 4.42-4.7 3.64-4.15L2.31-3.22L2.78-4.92C2.91-5.35 3.14-5.53 3.66-5.56V-5.7H1.28V-5.56C1.83-5.51 1.95-5.44 1.95-5.19C1.95-5.06 1.92-4.88 1.85-4.65L.78-.79C.62-.26 .58-.22 .06-.14V0H2.23V-.14C1.68-.2 1.6-.25 1.6-.52C1.6-.62 1.61-.68 1.67-.86L1.72-1.05L2.26-3.04L3.32-1.22C3.53-.86 3.65-.56 3.65-.39C3.65-.26 3.53-.19 3.25-.17L3-.14V0H5.4Z'/>
<path id='eq160-g7-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq160-g7-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<use id='eq160-g17-49' xlink:href='#eq160-g14-49' transform='scale(1.36)'/>
<path id='eq160-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq160-g4-157' d='M.74 2.3H1.36L4.74-8.42H4.12L.74 2.3Z'/>
<path id='eq160-g4-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq160-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq160-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<use id='eq160-g10-54' xlink:href='#eq160-g7-54' transform='scale(1.36)'/>
<use id='eq160-g10-71' xlink:href='#eq160-g7-71' transform='scale(1.36)'/>
</defs>
<g id='eq160-page1'>
<use x='.07' y='0' xlink:href='#eq160-g10-54'/>
<use x='7.01' y='0' xlink:href='#eq160-g4-185'/>
<use x='11.47' y='0' xlink:href='#eq160-g10-71'/>
<use x='17.36' y='0' xlink:href='#eq160-g4-186'/>
<use x='25.26' y='0' xlink:href='#eq160-g1-61'/>
<use x='35.66' y='0' xlink:href='#eq160-g17-49'/>
<use x='41.63' y='0' xlink:href='#eq160-g4-157'/>
<use x='47.73' y='0' xlink:href='#eq160-g4-185'/>
<use x='52.19' y='0' xlink:href='#eq160-g17-49'/>
<use x='60.83' y='0' xlink:href='#eq160-g4-184'/>
<use x='70.82' y='0' xlink:href='#eq160-g4-185'/>
<use x='77.64' y='-4.71' xlink:href='#eq160-g7-71'/>
<rect x='76.48' y='-3.41' height='.67' width='6.65'/>
<use x='76.61' y='4.12' xlink:href='#eq160-g7-32'/>
<use x='84.32' y='0' xlink:href='#eq160-g4-186'/>
<use x='88.9' y='-4.34' xlink:href='#eq160-g14-50'/>
<use x='93.78' y='0' xlink:href='#eq160-g4-186'/>
</g>
</svg></span></li>
<li><code>"exponential"</code>: <span class="m-math"><svg style="width: 7.752em; height: 1.269em;" viewBox=".07 -8.56 77.52 12.69">
<title>
\(g(x) = \exp(-\frac{x}{K})\)
</title>
<defs>
<path id='eq161-g7-32' d='M5.4 0V-.14C4.85-.19 4.8-.22 4.55-.63L3.03-3.28L5.65-5.25C5.9-5.43 6.1-5.53 6.31-5.56V-5.7H4.37V-5.56L4.6-5.54C4.81-5.52 4.9-5.47 4.9-5.37C4.9-5.16 4.42-4.7 3.64-4.15L2.31-3.22L2.78-4.92C2.91-5.35 3.14-5.53 3.66-5.56V-5.7H1.28V-5.56C1.83-5.51 1.95-5.44 1.95-5.19C1.95-5.06 1.92-4.88 1.85-4.65L.78-.79C.62-.26 .58-.22 .06-.14V0H2.23V-.14C1.68-.2 1.6-.25 1.6-.52C1.6-.62 1.61-.68 1.67-.86L1.72-1.05L2.26-3.04L3.32-1.22C3.53-.86 3.65-.56 3.65-.39C3.65-.26 3.53-.19 3.25-.17L3-.14V0H5.4Z'/>
<path id='eq161-g7-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq161-g7-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq161-g14-101' d='M5.05-1.87L4.86-1.95C4.29-1.05 3.78-.7 3.01-.7C2.36-.7 1.86-1.01 1.51-1.66C1.27-2.12 1.18-2.54 1.16-3.3H4.82C4.73-4.07 4.61-4.42 4.31-4.8C3.95-5.23 3.41-5.48 2.79-5.48C1.31-5.48 .3-4.29 .3-2.55C.3-.91 1.16 .12 2.53 .12C3.67 .12 4.55-.58 5.05-1.87ZM3.61-3.68H1.18C1.31-4.62 1.72-5.05 2.44-5.05S3.45-4.72 3.61-3.68Z'/>
<path id='eq161-g14-112' d='M5.6-2.94C5.6-4.42 4.76-5.48 3.61-5.48C2.94-5.48 2.42-5.18 1.89-4.54V-5.46L1.82-5.48C1.18-5.23 .76-5.07 .11-4.87V-4.68C.21-4.69 .3-4.69 .4-4.69C.81-4.69 .89-4.57 .89-4.01V1.56C.89 2.18 .76 2.31 .06 2.38V2.58H2.94V2.37C2.05 2.36 1.89 2.23 1.89 1.48V-.39C2.31 0 2.6 .12 3.1 .12C4.5 .12 5.6-1.21 5.6-2.94ZM4.57-2.48C4.57-1.16 3.99-.26 3.13-.26C2.57-.26 1.89-.69 1.89-1.05V-3.98C1.89-4.34 2.56-4.76 3.11-4.76C3.99-4.76 4.57-3.86 4.57-2.48Z'/>
<path id='eq161-g14-120' d='M5.71 0V-.18C5.34-.18 5.1-.37 4.73-.89L3.2-3.23L4.19-4.66C4.42-4.98 4.78-5.17 5.16-5.18V-5.36H3.28V-5.18C3.63-5.16 3.75-5.09 3.75-4.92C3.75-4.78 3.61-4.51 3.31-4.14C3.25-4.07 3.11-3.86 2.95-3.62L2.79-3.86C2.45-4.36 2.24-4.76 2.24-4.92C2.24-5.09 2.39-5.17 2.75-5.18V-5.36H.29V-5.18H.39C.75-5.18 .94-5.03 1.31-4.47L2.43-2.75L1.07-.79C.71-.3 .6-.21 .2-.18V0H1.93V-.18C1.6-.18 1.45-.24 1.45-.39C1.45-.46 1.54-.64 1.69-.88L2.63-2.35L3.72-.68C3.76-.61 3.79-.54 3.79-.46C3.79-.25 3.7-.2 3.31-.18V0H5.71Z'/>
<path id='eq161-g4-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq161-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq161-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq161-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<use id='eq161-g10-54' xlink:href='#eq161-g7-54' transform='scale(1.36)'/>
<use id='eq161-g10-71' xlink:href='#eq161-g7-71' transform='scale(1.36)'/>
</defs>
<g id='eq161-page1'>
<use x='.07' y='0' xlink:href='#eq161-g10-54'/>
<use x='7.01' y='0' xlink:href='#eq161-g4-185'/>
<use x='11.47' y='0' xlink:href='#eq161-g10-71'/>
<use x='17.36' y='0' xlink:href='#eq161-g4-186'/>
<use x='25.26' y='0' xlink:href='#eq161-g1-61'/>
<use x='35.66' y='0' xlink:href='#eq161-g14-101'/>
<use x='40.55' y='0' xlink:href='#eq161-g14-120'/>
<use x='46.52' y='0' xlink:href='#eq161-g14-112'/>
<use x='53.1' y='0' xlink:href='#eq161-g4-185'/>
<use x='57.56' y='0' xlink:href='#eq161-g4-0'/>
<use x='67.52' y='-4.71' xlink:href='#eq161-g7-71'/>
<rect x='66.36' y='-3.41' height='.67' width='6.65'/>
<use x='66.49' y='4.12' xlink:href='#eq161-g7-32'/>
<use x='74.2' y='0' xlink:href='#eq161-g4-186'/>
</g>
</svg></span></li>
</ul>
<p>The diffusion is generalized to any image dimensionality. <code>in</code> must be scalar and real-valued.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>P. Perona and J. Malik, &ldquo;Scale-space and edge detection using anisotropic diffusion&rdquo;,
  IEEE Transactions on Pattern Analysis and Machine Intelligence 12(7):629:639, 1990.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-GaussianAnisotropicDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat--dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-GaussianAnisotropicDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat--dip-String-CL" class="m-doc-self">dip::<wbr />GaussianAnisotropicDiffusion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> iterations = 5,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> K = 10,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> lambda = 0.25,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; g = "Gauss")</span></span>
            </h3>
            <p>Applies iterative generic anisotropic diffusion using Gaussian derivatives</p>
<p>Applies <code>iterations</code> steps of the generic anisotropic diffusion equation:</p>
<div class="m-math"><svg style="width: 12.110em; height: 1.446em;" viewBox="133.52 -14.48 121.1 14.46">
<title>
\[ I^{t+1} = I^t + \lambda \, \mathrm{div} \left( c^t \nabla I^t \right) \; , \]
</title>
<defs>
<path id='eq162-g4-0' d='M3.13 12.48C1.83 11.02 1.64 8.27 1.64 6.06S1.69 1.21 3.13-.43L2.99-.67C2.42-.19 .6 2.12 .6 6.06S2.42 12.26 2.99 12.73L3.13 12.48Z'/>
<path id='eq162-g4-1' d='M.36 12.48L.5 12.73C1.07 12.26 2.89 10 2.89 6.06S1.07-.19 .5-.67L.36-.43C1.8 1.21 1.85 3.86 1.85 6.06S1.66 11.02 .36 12.48Z'/>
<use id='eq162-g23-100' xlink:href='#eq162-g20-100' transform='scale(1.36)'/>
<use id='eq162-g23-105' xlink:href='#eq162-g20-105' transform='scale(1.36)'/>
<use id='eq162-g23-118' xlink:href='#eq162-g20-118' transform='scale(1.36)'/>
<path id='eq162-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq162-g20-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq162-g20-100' d='M4.29-.37V-.51C4.13-.5 4.11-.5 4.09-.5C3.77-.5 3.7-.59 3.7-1V-5.95L3.66-5.97C3.24-5.82 2.93-5.73 2.38-5.58V-5.44C2.45-5.45 2.5-5.45 2.57-5.45C2.89-5.45 2.97-5.36 2.97-5V-3.64C2.64-3.92 2.4-4.02 2.05-4.02C1.05-4.02 .24-3.03 .24-1.79C.24-.67 .89 .09 1.85 .09C2.34 .09 2.67-.09 2.97-.5V.06L3 .09L4.29-.37ZM2.97-.89C2.97-.83 2.91-.72 2.82-.63C2.66-.45 2.45-.37 2.19-.37C1.47-.37 .99-1.07 .99-2.14C.99-3.13 1.41-3.77 2.08-3.77C2.54-3.77 2.97-3.36 2.97-2.9V-.89Z'/>
<path id='eq162-g20-105' d='M2.21 0V-.13C1.63-.17 1.56-.26 1.56-.89V-3.99L1.53-4.02L.17-3.54V-3.41L.24-3.42C.35-3.43 .46-3.44 .54-3.44C.75-3.44 .83-3.3 .83-2.92V-.89C.83-.26 .74-.17 .14-.13V0H2.21ZM1.64-5.52C1.64-5.76 1.45-5.97 1.2-5.97C.95-5.97 .75-5.76 .75-5.52C.75-5.27 .95-5.07 1.2-5.07C1.45-5.07 1.64-5.27 1.64-5.52Z'/>
<path id='eq162-g20-118' d='M4.17-3.8V-3.93H2.95V-3.8C3.23-3.77 3.36-3.69 3.36-3.52C3.36-3.43 3.35-3.35 3.31-3.26L2.45-1L1.55-3.23C1.5-3.35 1.48-3.48 1.48-3.55C1.48-3.71 1.57-3.77 1.88-3.8V-3.93H.17V-3.8C.5-3.78 .56-3.69 .96-2.79L2.01-.29C2.03-.24 2.05-.17 2.08-.1C2.13 .05 2.18 .12 2.24 .12S2.35 .01 2.48-.31L3.6-3.12C3.85-3.71 3.9-3.77 4.17-3.8Z'/>
<use id='eq162-g10-114' xlink:href='#eq162-g7-114' transform='scale(1.36)'/>
<use id='eq162-g10-184' xlink:href='#eq162-g7-184' transform='scale(1.36)'/>
<path id='eq162-g7-114' d='M5.49-5.9H.27L2.85 0H3.02L5.49-5.9ZM4.77-5.14L3.16-1.27L1.55-5.14H4.77Z'/>
<path id='eq162-g7-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<path id='eq162-g13-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq162-g13-50' d='M3.2-.84L3.06-.93C2.58-.41 2.24-.22 1.81-.22C1.31-.22 1.01-.59 1.01-1.21C1.01-1.96 1.32-2.73 1.81-3.25C2.06-3.51 2.41-3.67 2.76-3.67C2.96-3.67 3.08-3.6 3.08-3.49C3.08-3.45 3.07-3.41 3.03-3.33C2.97-3.21 2.95-3.16 2.95-3.07C2.95-2.86 3.08-2.74 3.29-2.74C3.54-2.74 3.71-2.91 3.71-3.14C3.71-3.55 3.33-3.85 2.79-3.85C1.48-3.85 .26-2.58 .26-1.21C.26-.38 .73 .1 1.55 .1C2.2 .1 2.66-.17 3.2-.84Z'/>
<path id='eq162-g13-67' d='M2.59-3.74H1.89L2.13-4.64C2.14-4.66 2.14-4.67 2.14-4.68C2.14-4.74 2.11-4.77 2.07-4.77C2.02-4.77 1.99-4.76 1.94-4.69C1.11-3.61 .5-3.79 .5-3.51C.5-3.5 .5-3.49 .51-3.46H1.15L.52-1.06C.5-.94 .32-.4 .32-.24C.32-.04 .51 .1 .74 .1C1.14 .1 1.43-.15 1.98-.96L1.87-1.02C1.44-.47 1.3-.33 1.16-.33C1.08-.33 1.03-.4 1.03-.51C1.03-.52 1.03-.52 1.04-.55L1.81-3.46H2.54L2.59-3.74Z'/>
<path id='eq162-g13-95' d='M4.6-.64L4.59-.66C4.47-.66 4.32-.36 3.96-.36C2.31-.36 5.31-5.72 2.74-5.72H2.65C2.49-5.72 2.12-5.59 2.01-5.49C2-5.48 2.07-5.4 2.08-5.4C2.12-5.43 2.31-5.51 2.49-5.51C3.34-5.51 3.11-4.11 3.11-3.89C3.12-3.86 3.11-3.84 3.1-3.81C2.93-3 .35-.71 .14 0H1.01C1.01-.09 1.02-.17 1.04-.27C1.29-1.39 3-3.08 3-3.09H3.01C2.96-2.64 2.17 .1 3.6 .1C3.98 .1 4.59-.53 4.6-.64Z'/>
<path id='eq162-g13-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<use id='eq162-g16-30' xlink:href='#eq162-g13-30' transform='scale(1.36)'/>
<use id='eq162-g16-50' xlink:href='#eq162-g13-50' transform='scale(1.36)'/>
<use id='eq162-g16-95' xlink:href='#eq162-g13-95' transform='scale(1.36)'/>
<use id='eq162-g16-150' xlink:href='#eq162-g13-150' transform='scale(1.36)'/>
</defs>
<g id='eq162-page1'>
<use x='133.61' y='-3.64' xlink:href='#eq162-g16-30'/>
<use x='138.43' y='-8.57' xlink:href='#eq162-g13-67'/>
<use x='141.38' y='-8.57' xlink:href='#eq162-g7-184'/>
<use x='146.32' y='-8.57' xlink:href='#eq162-g20-49'/>
<use x='154.53' y='-3.64' xlink:href='#eq162-g1-61'/>
<use x='165.41' y='-3.64' xlink:href='#eq162-g16-30'/>
<use x='170.23' y='-8.57' xlink:href='#eq162-g13-67'/>
<use x='176.33' y='-3.64' xlink:href='#eq162-g10-184'/>
<use x='185.58' y='-3.64' xlink:href='#eq162-g16-95'/>
<use x='194.19' y='-3.64' xlink:href='#eq162-g23-100'/>
<use x='200.16' y='-3.64' xlink:href='#eq162-g23-105'/>
<use x='203.49' y='-3.64' xlink:href='#eq162-g23-118'/>
<use x='212.41' y='-12.75' xlink:href='#eq162-g4-0'/>
<use x='216.29' y='-3.64' xlink:href='#eq162-g16-50'/>
<use x='221.91' y='-8.57' xlink:href='#eq162-g13-67'/>
<use x='225.48' y='-3.64' xlink:href='#eq162-g10-114'/>
<use x='234.02' y='-3.64' xlink:href='#eq162-g16-30'/>
<use x='238.84' y='-8.57' xlink:href='#eq162-g13-67'/>
<use x='242.53' y='-12.75' xlink:href='#eq162-g4-1'/>
<use x='252.3' y='-3.64' xlink:href='#eq162-g16-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.724em; height: 0.793em;" viewBox="-.16 -7.8 7.24 7.93">
<title>
\(\lambda\)
</title>
<defs>
<path id='eq164-g1-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq164-page1'>
<use x='-.16' y='0' xlink:href='#eq164-g1-95'/>
</g>
</svg></span> is set with the <code>lambda</code> parameter, <span class="m-math"><svg style="width: 0.749em; height: 0.805em;" viewBox=".12 -8.05 7.49 8.05">
<title>
\(\nabla\)
</title>
<defs>
<path id='eq165-g1-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
</defs>
<g id='eq165-page1'>
<use x='.12' y='0' xlink:href='#eq165-g1-114'/>
</g>
</svg></span> and <span class="m-math"><svg style="width: 1.498em; height: 0.830em;" viewBox="0 -8.13 14.98 8.3">
<title>
\(\mathrm{div}\)
</title>
<defs>
<path id='eq166-g2-100' d='M5.85-.5V-.69C5.63-.68 5.61-.68 5.57-.68C5.15-.68 5.05-.81 5.05-1.36V-8.11L4.99-8.13C4.42-7.93 4-7.81 3.24-7.61V-7.42C3.33-7.43 3.41-7.43 3.5-7.43C3.94-7.43 4.05-7.31 4.05-6.82V-4.97C3.6-5.35 3.28-5.48 2.8-5.48C1.43-5.48 .32-4.13 .32-2.44C.32-.92 1.21 .12 2.53 .12C3.19 .12 3.64-.12 4.05-.68V.08L4.1 .12L5.85-.5ZM4.05-1.21C4.05-1.13 3.97-.99 3.85-.86C3.63-.62 3.33-.5 2.99-.5C2-.5 1.35-1.45 1.35-2.92C1.35-4.26 1.93-5.15 2.83-5.15C3.47-5.15 4.05-4.59 4.05-3.95V-1.21Z'/>
<path id='eq166-g2-105' d='M3.01 0V-.18C2.23-.24 2.13-.36 2.13-1.21V-5.44L2.08-5.48L.24-4.82V-4.65L.33-4.66C.48-4.68 .63-4.69 .74-4.69C1.02-4.69 1.13-4.5 1.13-3.98V-1.21C1.13-.36 1.01-.23 .19-.18V0H3.01ZM2.24-7.53C2.24-7.86 1.98-8.13 1.63-8.13C1.3-8.13 1.02-7.86 1.02-7.53C1.02-7.18 1.3-6.92 1.63-6.92C1.98-6.92 2.24-7.18 2.24-7.53Z'/>
<path id='eq166-g2-118' d='M5.68-5.18V-5.36H4.03V-5.18C4.41-5.15 4.59-5.03 4.59-4.8C4.59-4.68 4.56-4.56 4.51-4.44L3.33-1.36L2.12-4.41C2.05-4.57 2.01-4.74 2.01-4.85C2.01-5.06 2.14-5.15 2.56-5.18V-5.36H.23V-5.18C.68-5.16 .76-5.04 1.31-3.81L2.74-.39C2.76-.32 2.8-.24 2.83-.14C2.91 .07 2.98 .17 3.05 .17S3.2 .01 3.38-.43L4.91-4.25C5.25-5.06 5.32-5.15 5.68-5.18Z'/>
</defs>
<g id='eq166-page1'>
<use x='0' y='0' xlink:href='#eq166-g2-100'/>
<use x='5.98' y='0' xlink:href='#eq166-g2-105'/>
<use x='9.3' y='0' xlink:href='#eq166-g2-118'/>
</g>
</svg></span> are computed using
Gaussian gradients (<a href="linear.html#dip-Gradient-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-String-CL-dip-StringArray-CL-dip-BooleanArray--dip-dfloat-"><code>dip::Gradient</code></a> and <a href="linear.html#dip-Divergence-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-String-CL-dip-StringArray-CL-dip-BooleanArray--dip-dfloat-"><code>dip::Divergence</code></a>),</p>
<div class="m-math"><svg style="width: 7.711em; height: 1.340em;" viewBox="155.38 -13.42 77.11 13.4">
<title>
\[ c^t = g\left( \| \nabla I^t \| \right) \; , \]
</title>
<defs>
<path id='eq163-g7-107' d='M3.91 2.3V-8.42H3.24V2.3H3.91ZM1.52 2.3V-8.42H.86V2.3H1.52Z'/>
<path id='eq163-g7-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
<path id='eq163-g4-0' d='M3.13 12.48C1.83 11.02 1.64 8.27 1.64 6.06S1.69 1.21 3.13-.43L2.99-.67C2.42-.19 .6 2.12 .6 6.06S2.42 12.26 2.99 12.73L3.13 12.48Z'/>
<path id='eq163-g4-1' d='M.36 12.48L.5 12.73C1.07 12.26 2.89 10 2.89 6.06S1.07-.19 .5-.67L.36-.43C1.8 1.21 1.85 3.86 1.85 6.06S1.66 11.02 .36 12.48Z'/>
<path id='eq163-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq163-g10-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq163-g10-50' d='M3.2-.84L3.06-.93C2.58-.41 2.24-.22 1.81-.22C1.31-.22 1.01-.59 1.01-1.21C1.01-1.96 1.32-2.73 1.81-3.25C2.06-3.51 2.41-3.67 2.76-3.67C2.96-3.67 3.08-3.6 3.08-3.49C3.08-3.45 3.07-3.41 3.03-3.33C2.97-3.21 2.95-3.16 2.95-3.07C2.95-2.86 3.08-2.74 3.29-2.74C3.54-2.74 3.71-2.91 3.71-3.14C3.71-3.55 3.33-3.85 2.79-3.85C1.48-3.85 .26-2.58 .26-1.21C.26-.38 .73 .1 1.55 .1C2.2 .1 2.66-.17 3.2-.84Z'/>
<path id='eq163-g10-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq163-g10-67' d='M2.59-3.74H1.89L2.13-4.64C2.14-4.66 2.14-4.67 2.14-4.68C2.14-4.74 2.11-4.77 2.07-4.77C2.02-4.77 1.99-4.76 1.94-4.69C1.11-3.61 .5-3.79 .5-3.51C.5-3.5 .5-3.49 .51-3.46H1.15L.52-1.06C.5-.94 .32-.4 .32-.24C.32-.04 .51 .1 .74 .1C1.14 .1 1.43-.15 1.98-.96L1.87-1.02C1.44-.47 1.3-.33 1.16-.33C1.08-.33 1.03-.4 1.03-.51C1.03-.52 1.03-.52 1.04-.55L1.81-3.46H2.54L2.59-3.74Z'/>
<path id='eq163-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<use id='eq163-g13-30' xlink:href='#eq163-g10-30' transform='scale(1.36)'/>
<use id='eq163-g13-50' xlink:href='#eq163-g10-50' transform='scale(1.36)'/>
<use id='eq163-g13-54' xlink:href='#eq163-g10-54' transform='scale(1.36)'/>
<use id='eq163-g13-150' xlink:href='#eq163-g10-150' transform='scale(1.36)'/>
</defs>
<g id='eq163-page1'>
<use x='155.38' y='-3.64' xlink:href='#eq163-g13-50'/>
<use x='161.01' y='-8.57' xlink:href='#eq163-g10-67'/>
<use x='167.77' y='-3.64' xlink:href='#eq163-g1-61'/>
<use x='178.24' y='-3.64' xlink:href='#eq163-g13-54'/>
<use x='187.53' y='-12.75' xlink:href='#eq163-g4-0'/>
<use x='191.87' y='-3.64' xlink:href='#eq163-g7-107'/>
<use x='197.37' y='-3.64' xlink:href='#eq163-g7-114'/>
<use x='205.92' y='-3.64' xlink:href='#eq163-g13-30'/>
<use x='210.74' y='-8.57' xlink:href='#eq163-g10-67'/>
<use x='214.78' y='-3.64' xlink:href='#eq163-g7-107'/>
<use x='220.4' y='-12.75' xlink:href='#eq163-g4-1'/>
<use x='230.17' y='-3.64' xlink:href='#eq163-g13-150'/>
</g>
</svg></div>
<p>and <span class="m-math"><svg style="width: 0.559em; height: 0.771em;" viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq167-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq167-page1'>
<use x='.07' y='0' xlink:href='#eq167-g1-54'/>
</g>
</svg></span> is a monotonically decreasing function, selected with the <code>g</code> parameter, and modulated
by the <code>K</code> parameter:</p>
<ul>
<li><code>"Gauss"</code>: <span class="m-math"><svg style="width: 9.204em; height: 1.437em;" viewBox=".07 -10.24 92.04 14.37">
<title>
\(g(x) = \exp(-(\frac{x}{K})^2)\)
</title>
<defs>
<path id='eq168-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq168-g14-101' d='M3.7-1.37L3.56-1.43C3.14-.77 2.77-.52 2.21-.52C1.73-.52 1.36-.74 1.11-1.21C.93-1.55 .86-1.86 .85-2.42H3.54C3.47-2.99 3.38-3.24 3.16-3.52C2.9-3.83 2.5-4.02 2.04-4.02C.96-4.02 .22-3.14 .22-1.87C.22-.66 .85 .09 1.85 .09C2.69 .09 3.34-.43 3.7-1.37ZM2.65-2.7H.86C.96-3.39 1.26-3.7 1.79-3.7S2.53-3.46 2.65-2.7Z'/>
<path id='eq168-g14-112' d='M4.11-2.16C4.11-3.24 3.49-4.02 2.65-4.02C2.16-4.02 1.77-3.8 1.39-3.33V-4L1.34-4.02C.86-3.83 .56-3.72 .08-3.57V-3.43C.16-3.44 .22-3.44 .3-3.44C.59-3.44 .66-3.35 .66-2.94V1.14C.66 1.6 .56 1.69 .04 1.75V1.9H2.16V1.74C1.5 1.73 1.39 1.63 1.39 1.08V-.29C1.69 0 1.9 .09 2.27 .09C3.3 .09 4.11-.89 4.11-2.16ZM3.35-1.82C3.35-.85 2.93-.19 2.3-.19C1.89-.19 1.39-.51 1.39-.77V-2.92C1.39-3.18 1.88-3.49 2.28-3.49C2.93-3.49 3.35-2.83 3.35-1.82Z'/>
<path id='eq168-g14-120' d='M4.18 0V-.13C3.91-.13 3.74-.27 3.47-.66L2.35-2.37L3.07-3.42C3.24-3.65 3.5-3.79 3.78-3.8V-3.93H2.4V-3.8C2.66-3.78 2.75-3.73 2.75-3.61C2.75-3.5 2.65-3.31 2.43-3.04C2.38-2.99 2.28-2.83 2.17-2.66L2.04-2.83C1.8-3.2 1.64-3.49 1.64-3.61C1.64-3.73 1.76-3.79 2.02-3.8V-3.93H.21V-3.8H.29C.55-3.8 .69-3.69 .96-3.28L1.78-2.02L.79-.58C.52-.22 .44-.16 .15-.13V0H1.41V-.13C1.17-.13 1.07-.17 1.07-.29C1.07-.34 1.13-.47 1.24-.65L1.93-1.72L2.73-.5C2.76-.45 2.78-.39 2.78-.34C2.78-.18 2.72-.15 2.43-.13V0H4.18Z'/>
<path id='eq168-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq168-g7-32' d='M5.4 0V-.14C4.85-.19 4.8-.22 4.55-.63L3.03-3.28L5.65-5.25C5.9-5.43 6.1-5.53 6.31-5.56V-5.7H4.37V-5.56L4.6-5.54C4.81-5.52 4.9-5.47 4.9-5.37C4.9-5.16 4.42-4.7 3.64-4.15L2.31-3.22L2.78-4.92C2.91-5.35 3.14-5.53 3.66-5.56V-5.7H1.28V-5.56C1.83-5.51 1.95-5.44 1.95-5.19C1.95-5.06 1.92-4.88 1.85-4.65L.78-.79C.62-.26 .58-.22 .06-.14V0H2.23V-.14C1.68-.2 1.6-.25 1.6-.52C1.6-.62 1.61-.68 1.67-.86L1.72-1.05L2.26-3.04L3.32-1.22C3.53-.86 3.65-.56 3.65-.39C3.65-.26 3.53-.19 3.25-.17L3-.14V0H5.4Z'/>
<path id='eq168-g7-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq168-g7-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq168-g4-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq168-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq168-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<use id='eq168-g17-101' xlink:href='#eq168-g14-101' transform='scale(1.36)'/>
<use id='eq168-g17-112' xlink:href='#eq168-g14-112' transform='scale(1.36)'/>
<use id='eq168-g17-120' xlink:href='#eq168-g14-120' transform='scale(1.36)'/>
<use id='eq168-g10-54' xlink:href='#eq168-g7-54' transform='scale(1.36)'/>
<use id='eq168-g10-71' xlink:href='#eq168-g7-71' transform='scale(1.36)'/>
</defs>
<g id='eq168-page1'>
<use x='.07' y='0' xlink:href='#eq168-g10-54'/>
<use x='7.01' y='0' xlink:href='#eq168-g4-185'/>
<use x='11.47' y='0' xlink:href='#eq168-g10-71'/>
<use x='17.36' y='0' xlink:href='#eq168-g4-186'/>
<use x='25.26' y='0' xlink:href='#eq168-g1-61'/>
<use x='35.66' y='0' xlink:href='#eq168-g17-101'/>
<use x='40.55' y='0' xlink:href='#eq168-g17-120'/>
<use x='46.52' y='0' xlink:href='#eq168-g17-112'/>
<use x='53.1' y='0' xlink:href='#eq168-g4-185'/>
<use x='57.56' y='0' xlink:href='#eq168-g4-0'/>
<use x='65.76' y='0' xlink:href='#eq168-g4-185'/>
<use x='72.58' y='-4.71' xlink:href='#eq168-g7-71'/>
<rect x='71.41' y='-3.41' height='.67' width='6.65'/>
<use x='71.55' y='4.12' xlink:href='#eq168-g7-32'/>
<use x='79.26' y='0' xlink:href='#eq168-g4-186'/>
<use x='83.83' y='-4.34' xlink:href='#eq168-g14-50'/>
<use x='88.72' y='0' xlink:href='#eq168-g4-186'/>
</g>
</svg></span></li>
<li><code>"quadratic"</code>: <span class="m-math"><svg style="width: 9.710em; height: 1.437em;" viewBox=".07 -10.24 97.1 14.37">
<title>
\(g(x) = 1 / (1 + (\frac{x}{K})^2)\)
</title>
<defs>
<path id='eq169-g14-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq169-g14-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq169-g7-32' d='M5.4 0V-.14C4.85-.19 4.8-.22 4.55-.63L3.03-3.28L5.65-5.25C5.9-5.43 6.1-5.53 6.31-5.56V-5.7H4.37V-5.56L4.6-5.54C4.81-5.52 4.9-5.47 4.9-5.37C4.9-5.16 4.42-4.7 3.64-4.15L2.31-3.22L2.78-4.92C2.91-5.35 3.14-5.53 3.66-5.56V-5.7H1.28V-5.56C1.83-5.51 1.95-5.44 1.95-5.19C1.95-5.06 1.92-4.88 1.85-4.65L.78-.79C.62-.26 .58-.22 .06-.14V0H2.23V-.14C1.68-.2 1.6-.25 1.6-.52C1.6-.62 1.61-.68 1.67-.86L1.72-1.05L2.26-3.04L3.32-1.22C3.53-.86 3.65-.56 3.65-.39C3.65-.26 3.53-.19 3.25-.17L3-.14V0H5.4Z'/>
<path id='eq169-g7-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq169-g7-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<use id='eq169-g17-49' xlink:href='#eq169-g14-49' transform='scale(1.36)'/>
<path id='eq169-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq169-g4-157' d='M.74 2.3H1.36L4.74-8.42H4.12L.74 2.3Z'/>
<path id='eq169-g4-184' d='M2.97-3.41H.36V-2.62H2.97V0H3.75V-2.62H6.36V-3.41H3.75V-6.03H2.97V-3.41Z'/>
<path id='eq169-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq169-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<use id='eq169-g10-54' xlink:href='#eq169-g7-54' transform='scale(1.36)'/>
<use id='eq169-g10-71' xlink:href='#eq169-g7-71' transform='scale(1.36)'/>
</defs>
<g id='eq169-page1'>
<use x='.07' y='0' xlink:href='#eq169-g10-54'/>
<use x='7.01' y='0' xlink:href='#eq169-g4-185'/>
<use x='11.47' y='0' xlink:href='#eq169-g10-71'/>
<use x='17.36' y='0' xlink:href='#eq169-g4-186'/>
<use x='25.26' y='0' xlink:href='#eq169-g1-61'/>
<use x='35.66' y='0' xlink:href='#eq169-g17-49'/>
<use x='41.63' y='0' xlink:href='#eq169-g4-157'/>
<use x='47.73' y='0' xlink:href='#eq169-g4-185'/>
<use x='52.19' y='0' xlink:href='#eq169-g17-49'/>
<use x='60.83' y='0' xlink:href='#eq169-g4-184'/>
<use x='70.82' y='0' xlink:href='#eq169-g4-185'/>
<use x='77.64' y='-4.71' xlink:href='#eq169-g7-71'/>
<rect x='76.48' y='-3.41' height='.67' width='6.65'/>
<use x='76.61' y='4.12' xlink:href='#eq169-g7-32'/>
<use x='84.32' y='0' xlink:href='#eq169-g4-186'/>
<use x='88.9' y='-4.34' xlink:href='#eq169-g14-50'/>
<use x='93.78' y='0' xlink:href='#eq169-g4-186'/>
</g>
</svg></span></li>
<li><code>"exponential"</code>: <span class="m-math"><svg style="width: 7.752em; height: 1.269em;" viewBox=".07 -8.56 77.52 12.69">
<title>
\(g(x) = \exp(-\frac{x}{K})\)
</title>
<defs>
<path id='eq170-g7-32' d='M5.4 0V-.14C4.85-.19 4.8-.22 4.55-.63L3.03-3.28L5.65-5.25C5.9-5.43 6.1-5.53 6.31-5.56V-5.7H4.37V-5.56L4.6-5.54C4.81-5.52 4.9-5.47 4.9-5.37C4.9-5.16 4.42-4.7 3.64-4.15L2.31-3.22L2.78-4.92C2.91-5.35 3.14-5.53 3.66-5.56V-5.7H1.28V-5.56C1.83-5.51 1.95-5.44 1.95-5.19C1.95-5.06 1.92-4.88 1.85-4.65L.78-.79C.62-.26 .58-.22 .06-.14V0H2.23V-.14C1.68-.2 1.6-.25 1.6-.52C1.6-.62 1.61-.68 1.67-.86L1.72-1.05L2.26-3.04L3.32-1.22C3.53-.86 3.65-.56 3.65-.39C3.65-.26 3.53-.19 3.25-.17L3-.14V0H5.4Z'/>
<path id='eq170-g7-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq170-g7-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq170-g14-101' d='M5.05-1.87L4.86-1.95C4.29-1.05 3.78-.7 3.01-.7C2.36-.7 1.86-1.01 1.51-1.66C1.27-2.12 1.18-2.54 1.16-3.3H4.82C4.73-4.07 4.61-4.42 4.31-4.8C3.95-5.23 3.41-5.48 2.79-5.48C1.31-5.48 .3-4.29 .3-2.55C.3-.91 1.16 .12 2.53 .12C3.67 .12 4.55-.58 5.05-1.87ZM3.61-3.68H1.18C1.31-4.62 1.72-5.05 2.44-5.05S3.45-4.72 3.61-3.68Z'/>
<path id='eq170-g14-112' d='M5.6-2.94C5.6-4.42 4.76-5.48 3.61-5.48C2.94-5.48 2.42-5.18 1.89-4.54V-5.46L1.82-5.48C1.18-5.23 .76-5.07 .11-4.87V-4.68C.21-4.69 .3-4.69 .4-4.69C.81-4.69 .89-4.57 .89-4.01V1.56C.89 2.18 .76 2.31 .06 2.38V2.58H2.94V2.37C2.05 2.36 1.89 2.23 1.89 1.48V-.39C2.31 0 2.6 .12 3.1 .12C4.5 .12 5.6-1.21 5.6-2.94ZM4.57-2.48C4.57-1.16 3.99-.26 3.13-.26C2.57-.26 1.89-.69 1.89-1.05V-3.98C1.89-4.34 2.56-4.76 3.11-4.76C3.99-4.76 4.57-3.86 4.57-2.48Z'/>
<path id='eq170-g14-120' d='M5.71 0V-.18C5.34-.18 5.1-.37 4.73-.89L3.2-3.23L4.19-4.66C4.42-4.98 4.78-5.17 5.16-5.18V-5.36H3.28V-5.18C3.63-5.16 3.75-5.09 3.75-4.92C3.75-4.78 3.61-4.51 3.31-4.14C3.25-4.07 3.11-3.86 2.95-3.62L2.79-3.86C2.45-4.36 2.24-4.76 2.24-4.92C2.24-5.09 2.39-5.17 2.75-5.18V-5.36H.29V-5.18H.39C.75-5.18 .94-5.03 1.31-4.47L2.43-2.75L1.07-.79C.71-.3 .6-.21 .2-.18V0H1.93V-.18C1.6-.18 1.45-.24 1.45-.39C1.45-.46 1.54-.64 1.69-.88L2.63-2.35L3.72-.68C3.76-.61 3.79-.54 3.79-.46C3.79-.25 3.7-.2 3.31-.18V0H5.71Z'/>
<path id='eq170-g4-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq170-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq170-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq170-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<use id='eq170-g10-54' xlink:href='#eq170-g7-54' transform='scale(1.36)'/>
<use id='eq170-g10-71' xlink:href='#eq170-g7-71' transform='scale(1.36)'/>
</defs>
<g id='eq170-page1'>
<use x='.07' y='0' xlink:href='#eq170-g10-54'/>
<use x='7.01' y='0' xlink:href='#eq170-g4-185'/>
<use x='11.47' y='0' xlink:href='#eq170-g10-71'/>
<use x='17.36' y='0' xlink:href='#eq170-g4-186'/>
<use x='25.26' y='0' xlink:href='#eq170-g1-61'/>
<use x='35.66' y='0' xlink:href='#eq170-g14-101'/>
<use x='40.55' y='0' xlink:href='#eq170-g14-120'/>
<use x='46.52' y='0' xlink:href='#eq170-g14-112'/>
<use x='53.1' y='0' xlink:href='#eq170-g4-185'/>
<use x='57.56' y='0' xlink:href='#eq170-g4-0'/>
<use x='67.52' y='-4.71' xlink:href='#eq170-g7-71'/>
<rect x='66.36' y='-3.41' height='.67' width='6.65'/>
<use x='66.49' y='4.12' xlink:href='#eq170-g7-32'/>
<use x='74.2' y='0' xlink:href='#eq170-g4-186'/>
</g>
</svg></span></li>
</ul>
<p>Note that the parameters here are identical to those in <a href="nonlinear.html#dip-PeronaMalikDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat--dip-String-CL"><code>dip::PeronaMalikDiffusion</code></a>. The Perona-Malik diffusion
is a discrete differences approximation to the generic anisotropic diffusion equation. This function uses Gaussian
gradients as a discretization strategy.</p>
<p>The diffusion is generalized to any image dimensionality. <code>in</code> must be scalar and real-valued.</p>
          </div></section>
          <section class="m-doc-details" id="dip-RobustAnisotropicDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat-"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-RobustAnisotropicDiffusion-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-dfloat-" class="m-doc-self">dip::<wbr />RobustAnisotropicDiffusion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> iterations = 5,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> sigma = 10,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> lambda = 0.25)</span></span>
            </h3>
            <p>Applies iterative robust anisotropic diffusion</p>
<p>Applies <code>iterations</code> steps of the robust anisotropic diffusion using Tukey&rsquo;s biweight (Black et al., 1998):</p>
<div class="m-math"><svg style="width: 13.744em; height: 2.730em;" viewBox="125.35 -28.51 137.44 27.3">
<title>
\[ I^{t+1} = I^t + \lambda \sum_\eta \psi ( \nabla_\eta I^t, \sigma ) \; , \]
</title>
<defs>
<use id='eq171-g10-114' xlink:href='#eq171-g7-114' transform='scale(1.36)'/>
<use id='eq171-g10-184' xlink:href='#eq171-g7-184' transform='scale(1.36)'/>
<use id='eq171-g10-185' xlink:href='#eq171-g7-185' transform='scale(1.36)'/>
<use id='eq171-g10-186' xlink:href='#eq171-g7-186' transform='scale(1.36)'/>
<path id='eq171-g4-213' d='M14.78 13.13H14.48C14.07 15.73 13.09 17.12 11.64 17.12H2.53L9.03 8.79L3.48 .62H10.98C12.51 .62 13.33 1.49 13.77 4.13H14.03L13.91 0H1.39L7.77 9.15L.51 18.34H14.54L14.78 13.13Z'/>
<path id='eq171-g20-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq171-g7-114' d='M5.49-5.9H.27L2.85 0H3.02L5.49-5.9ZM4.77-5.14L3.16-1.27L1.55-5.14H4.77Z'/>
<path id='eq171-g7-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<path id='eq171-g7-185' d='M2.58-6.26C1.31-5.44 .42-4.03 .42-2.24C.42-.62 1.35 1.02 2.55 1.76L2.66 1.62C1.5 .72 1.17-.34 1.17-2.27C1.17-4.21 1.53-5.21 2.66-6.12L2.58-6.26Z'/>
<path id='eq171-g7-186' d='M.33-6.26L.25-6.12C1.38-5.21 1.74-4.21 1.74-2.27C1.74-.34 1.41 .72 .25 1.62L.36 1.76C1.56 1.02 2.49-.62 2.49-2.24C2.49-4.03 1.6-5.44 .33-6.26Z'/>
<path id='eq171-g13-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq171-g13-67' d='M2.59-3.74H1.89L2.13-4.64C2.14-4.66 2.14-4.67 2.14-4.68C2.14-4.74 2.11-4.77 2.07-4.77C2.02-4.77 1.99-4.76 1.94-4.69C1.11-3.61 .5-3.79 .5-3.51C.5-3.5 .5-3.49 .51-3.46H1.15L.52-1.06C.5-.94 .32-.4 .32-.24C.32-.04 .51 .1 .74 .1C1.14 .1 1.43-.15 1.98-.96L1.87-1.02C1.44-.47 1.3-.33 1.16-.33C1.08-.33 1.03-.4 1.03-.51C1.03-.52 1.03-.52 1.04-.55L1.81-3.46H2.54L2.59-3.74Z'/>
<path id='eq171-g13-91' d='M4.16-3.15C4.16-3.62 3.91-3.85 3.42-3.85C2.62-3.85 1.81-3.14 1.8-3.14C1.8-3.14 1.82-3.17 1.82-3.28C1.82-3.5 1.72-3.85 1.11-3.85S.25-3.29 .25-3.09C.25-3.04 .26-3.01 .29-3.01C.49-3.01 .39-3.54 .93-3.54C1.07-3.54 1.14-3.43 1.14-3.27C1.14-3.03 1.03-2.68 .91-2.23L.54-.88C.4-.38 .24-.09 .19 0H1.01C1.03-.08 1.09-.39 1.23-.88L1.76-2.74C1.79-2.86 2.38-3.44 2.92-3.44C3.31-3.44 3.43-3.28 3.43-3.02C3.43-2.87 3.39-2.68 3.34-2.49L2.47 .58C2.34 1.04 2.24 1.7 2.23 1.81H3V1.77C3 1.63 3 1.19 3.17 .59L4.05-2.52C4.12-2.77 4.16-2.98 4.16-3.15Z'/>
<path id='eq171-g13-95' d='M4.6-.64L4.59-.66C4.47-.66 4.32-.36 3.96-.36C2.31-.36 5.31-5.72 2.74-5.72H2.65C2.49-5.72 2.12-5.59 2.01-5.49C2-5.48 2.07-5.4 2.08-5.4C2.12-5.43 2.31-5.51 2.49-5.51C3.34-5.51 3.11-4.11 3.11-3.89C3.12-3.86 3.11-3.84 3.1-3.81C2.93-3 .35-.71 .14 0H1.01C1.01-.09 1.02-.17 1.04-.27C1.29-1.39 3-3.08 3-3.09H3.01C2.96-2.64 2.17 .1 3.6 .1C3.98 .1 4.59-.53 4.6-.64Z'/>
<path id='eq171-g13-102' d='M5.9-3.85H2.72C1.4-3.85 .22-2.75 .22-1.28C.22-.4 .69 .1 1.58 .1C2.66 .1 3.99-.94 3.99-2.5C3.99-3 3.83-3.19 3.83-3.2H5.73L5.9-3.85ZM3.33-2.49C3.33-1.19 2.6-.12 1.7-.12C1.03-.12 .94-1 .94-1.26C.94-2.94 1.84-3.62 2.49-3.62C2.81-3.62 3.33-3.53 3.33-2.49Z'/>
<path id='eq171-g13-107' d='M5.36-3.75C4-3.73 3.76-2.35 3.49-1.37C3.26-.51 2.6-.26 2.11-.26L3.72-5.45L3-5.34L1.74-.25C1.34-.25 .93-.39 .93-1.05C.93-1.57 1.31-2.18 1.31-2.95C1.31-3.49 1.02-3.75 .41-3.75L.38-3.64C.45-3.64 .66-3.6 .66-3.11C.66-2.71 .24-1.68 .24-1.21C.24-.15 1.31 .1 1.64 .1L1.23 1.81H1.44L2.01 .09C2.8 .09 3.91-.26 4.27-1.56L4.59-2.7C4.68-3.06 5.03-3.62 5.34-3.63L5.36-3.75Z'/>
<path id='eq171-g13-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq171-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<use id='eq171-g16-30' xlink:href='#eq171-g13-30' transform='scale(1.36)'/>
<use id='eq171-g16-95' xlink:href='#eq171-g13-95' transform='scale(1.36)'/>
<use id='eq171-g16-102' xlink:href='#eq171-g13-102' transform='scale(1.36)'/>
<use id='eq171-g16-107' xlink:href='#eq171-g13-107' transform='scale(1.36)'/>
<use id='eq171-g16-150' xlink:href='#eq171-g13-150' transform='scale(1.36)'/>
</defs>
<g id='eq171-page1'>
<use x='125.45' y='-16.28' xlink:href='#eq171-g16-30'/>
<use x='130.26' y='-21.21' xlink:href='#eq171-g13-67'/>
<use x='133.21' y='-21.21' xlink:href='#eq171-g7-184'/>
<use x='138.15' y='-21.21' xlink:href='#eq171-g20-49'/>
<use x='146.36' y='-16.28' xlink:href='#eq171-g1-61'/>
<use x='157.25' y='-16.28' xlink:href='#eq171-g16-30'/>
<use x='162.06' y='-21.21' xlink:href='#eq171-g13-67'/>
<use x='168.16' y='-16.28' xlink:href='#eq171-g10-184'/>
<use x='177.41' y='-16.28' xlink:href='#eq171-g16-95'/>
<use x='186.02' y='-28.51' xlink:href='#eq171-g4-213'/>
<use x='191.63' y='-3.01' xlink:href='#eq171-g13-91'/>
<use x='203.84' y='-16.28' xlink:href='#eq171-g16-107'/>
<use x='212.39' y='-16.28' xlink:href='#eq171-g10-185'/>
<use x='216.97' y='-16.28' xlink:href='#eq171-g10-114'/>
<use x='224.9' y='-14.48' xlink:href='#eq171-g13-91'/>
<use x='230.48' y='-16.28' xlink:href='#eq171-g16-30'/>
<use x='235.3' y='-21.21' xlink:href='#eq171-g13-67'/>
<use x='238.74' y='-16.28' xlink:href='#eq171-g16-150'/>
<use x='244.01' y='-16.28' xlink:href='#eq171-g16-102'/>
<use x='252.57' y='-16.28' xlink:href='#eq171-g10-186'/>
<use x='260.47' y='-16.28' xlink:href='#eq171-g16-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.724em; height: 0.793em;" viewBox="-.16 -7.8 7.24 7.93">
<title>
\(\lambda\)
</title>
<defs>
<path id='eq173-g1-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq173-page1'>
<use x='-.16' y='0' xlink:href='#eq173-g1-95'/>
</g>
</svg></span> is set with the <code>lambda</code> parameter, <span class="m-math"><svg style="width: 0.567em; height: 0.772em;" viewBox="0 -5.25 5.67 7.72">
<title>
\(\eta\)
</title>
<defs>
<path id='eq174-g1-91' d='M5.67-4.3C5.67-4.94 5.34-5.25 4.67-5.25C3.57-5.25 2.47-4.28 2.45-4.28C2.45-4.28 2.48-4.32 2.48-4.48C2.48-4.78 2.35-5.25 1.51-5.25S.35-4.49 .35-4.22C.35-4.14 .36-4.11 .39-4.11C.67-4.11 .54-4.82 1.27-4.82C1.46-4.82 1.55-4.68 1.55-4.45C1.55-4.13 1.41-3.66 1.24-3.04L.74-1.2C.55-.52 .33-.12 .26 0H1.38C1.41-.11 1.49-.54 1.68-1.2L2.39-3.74C2.44-3.89 3.24-4.69 3.98-4.69C4.51-4.69 4.68-4.47 4.68-4.12C4.68-3.92 4.62-3.66 4.55-3.39L3.37 .79C3.19 1.42 3.06 2.32 3.04 2.47H4.09V2.42C4.09 2.23 4.09 1.62 4.32 .8L5.53-3.44C5.62-3.78 5.67-4.06 5.67-4.3Z'/>
</defs>
<g id='eq174-page1'>
<use x='0' y='0' xlink:href='#eq174-g1-91'/>
</g>
</svg></span> are each of the cardinal directions,
<span class="m-math"><svg style="width: 1.210em; height: 1.165em;" viewBox=".12 -8.05 12.1 11.65">
<title>
\(\nabla_\eta\)
</title>
<defs>
<path id='eq175-g4-91' d='M4.16-3.15C4.16-3.62 3.91-3.85 3.42-3.85C2.62-3.85 1.81-3.14 1.8-3.14C1.8-3.14 1.82-3.17 1.82-3.28C1.82-3.5 1.72-3.85 1.11-3.85S.25-3.29 .25-3.09C.25-3.04 .26-3.01 .29-3.01C.49-3.01 .39-3.54 .93-3.54C1.07-3.54 1.14-3.43 1.14-3.27C1.14-3.03 1.03-2.68 .91-2.23L.54-.88C.4-.38 .24-.09 .19 0H1.01C1.03-.08 1.09-.39 1.23-.88L1.76-2.74C1.79-2.86 2.38-3.44 2.92-3.44C3.31-3.44 3.43-3.28 3.43-3.02C3.43-2.87 3.39-2.68 3.34-2.49L2.47 .58C2.34 1.04 2.24 1.7 2.23 1.81H3V1.77C3 1.63 3 1.19 3.17 .59L4.05-2.52C4.12-2.77 4.16-2.98 4.16-3.15Z'/>
<path id='eq175-g1-114' d='M7.49-8.05H.37L3.88 0H4.12L7.49-8.05ZM6.5-7.02L4.31-1.73L2.11-7.02H6.5Z'/>
</defs>
<g id='eq175-page1'>
<use x='.12' y='0' xlink:href='#eq175-g1-114'/>
<use x='8.06' y='1.79' xlink:href='#eq175-g4-91'/>
</g>
</svg></span> is the finite difference in direction <span class="m-math"><svg style="width: 0.567em; height: 0.772em;" viewBox="0 -5.25 5.67 7.72">
<title>
\(\eta\)
</title>
<defs>
<path id='eq176-g1-91' d='M5.67-4.3C5.67-4.94 5.34-5.25 4.67-5.25C3.57-5.25 2.47-4.28 2.45-4.28C2.45-4.28 2.48-4.32 2.48-4.48C2.48-4.78 2.35-5.25 1.51-5.25S.35-4.49 .35-4.22C.35-4.14 .36-4.11 .39-4.11C.67-4.11 .54-4.82 1.27-4.82C1.46-4.82 1.55-4.68 1.55-4.45C1.55-4.13 1.41-3.66 1.24-3.04L.74-1.2C.55-.52 .33-.12 .26 0H1.38C1.41-.11 1.49-.54 1.68-1.2L2.39-3.74C2.44-3.89 3.24-4.69 3.98-4.69C4.51-4.69 4.68-4.47 4.68-4.12C4.68-3.92 4.62-3.66 4.55-3.39L3.37 .79C3.19 1.42 3.06 2.32 3.04 2.47H4.09V2.42C4.09 2.23 4.09 1.62 4.32 .8L5.53-3.44C5.62-3.78 5.67-4.06 5.67-4.3Z'/>
</defs>
<g id='eq176-page1'>
<use x='0' y='0' xlink:href='#eq176-g1-91'/>
</g>
</svg></span>, and</p>
<div class="m-math"><svg style="width: 17.925em; height: 4.361em;" viewBox="103.94 -43.7 179.25 43.61">
<title>
\[ \psi(x,\sigma) =
      \begin{cases}
         x\,\left(1-\frac{x^2}{\sigma^2}\right)^2, &amp; \text{if}\ |x| &lt; \sigma
      \\ 0, &amp; \text{otherwise}
      \end{cases} \]
</title>
<defs>
<use id='eq172-g20-50' xlink:href='#eq172-g17-50' transform='scale(1.33)'/>
<path id='eq172-g10-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq172-g10-102' d='M5.9-3.85H2.72C1.4-3.85 .22-2.75 .22-1.28C.22-.4 .69 .1 1.58 .1C2.66 .1 3.99-.94 3.99-2.5C3.99-3 3.83-3.19 3.83-3.2H5.73L5.9-3.85ZM3.33-2.49C3.33-1.19 2.6-.12 1.7-.12C1.03-.12 .94-1 .94-1.26C.94-2.94 1.84-3.62 2.49-3.62C2.81-3.62 3.33-3.53 3.33-2.49Z'/>
<path id='eq172-g10-107' d='M5.36-3.75C4-3.73 3.76-2.35 3.49-1.37C3.26-.51 2.6-.26 2.11-.26L3.72-5.45L3-5.34L1.74-.25C1.34-.25 .93-.39 .93-1.05C.93-1.57 1.31-2.18 1.31-2.95C1.31-3.49 1.02-3.75 .41-3.75L.38-3.64C.45-3.64 .66-3.6 .66-3.11C.66-2.71 .24-1.68 .24-1.21C.24-.15 1.31 .1 1.64 .1L1.23 1.81H1.44L2.01 .09C2.8 .09 3.91-.26 4.27-1.56L4.59-2.7C4.68-3.06 5.03-3.62 5.34-3.63L5.36-3.75Z'/>
<path id='eq172-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq172-g10-159' d='M5.01-.05V-.54L1.38-2.24L5.01-3.95V-4.44L.54-2.33V-2.16L5.01-.05Z'/>
<path id='eq172-g4-16' d='M3.88 20.41C2.17 18.38 1.69 13.35 1.69 10.05S2.17 1.74 3.88-.3L3.73-.67C2.43 .81 .6 4.13 .6 10.05S2.36 19.3 3.73 20.77L3.88 20.41Z'/>
<path id='eq172-g4-17' d='M.36 20.41L.51 20.77C1.88 19.3 3.64 15.97 3.64 10.05S1.81 .81 .51-.67L.36-.3C2.07 1.74 2.55 6.75 2.55 10.05S2.07 18.38 .36 20.41Z'/>
<path id='eq172-g4-56' d='M6-7.15C6-7.18 5.98-7.21 5.93-7.21C5.82-7.21 5.63-7.11 5.59-7.09C3.57-6.01 2.75-3.53 2.75-.52V.24H3.82V-.73C3.82-2.92 3.91-5.51 5.69-6.84C5.8-6.92 6-7.05 6-7.15Z'/>
<path id='eq172-g4-58' d='M6 0C6-.1 5.8-.23 5.69-.31C3.91-1.63 3.82-4.23 3.82-6.42V-7.38H2.75V-6.62C2.75-3.62 3.57-1.13 5.59-.06C5.63-.04 5.82 .06 5.93 .06C5.98 .06 6 .04 6 0Z'/>
<path id='eq172-g4-60' d='M2.78 10.18L2.75 14.53H3.82V10.81C3.82 9.75 3.67 7.93 1.75 7.13C3.67 6.3 3.82 4.49 3.82 3.44V-.24H2.75L2.74 4.32C2.74 5.1 1.99 6.56 .79 7C.73 7.03 .69 7.06 .69 7.13C.69 7.22 .71 7.25 .81 7.29C2.41 7.87 2.78 9.56 2.78 10.18Z'/>
<path id='eq172-g4-62' d='M3.82 .24V-3.81H2.75V.24H3.82Z'/>
<use id='eq172-g13-71' xlink:href='#eq172-g10-71' transform='scale(1.36)'/>
<use id='eq172-g13-102' xlink:href='#eq172-g10-102' transform='scale(1.36)'/>
<use id='eq172-g13-107' xlink:href='#eq172-g10-107' transform='scale(1.36)'/>
<use id='eq172-g13-150' xlink:href='#eq172-g10-150' transform='scale(1.36)'/>
<use id='eq172-g13-159' xlink:href='#eq172-g10-159' transform='scale(1.36)'/>
<use id='eq172-g23-48' xlink:href='#eq172-g17-48' transform='scale(1.82)'/>
<use id='eq172-g23-49' xlink:href='#eq172-g17-49' transform='scale(1.82)'/>
<path id='eq172-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq172-g24-101' d='M5.07-1.88L4.88-1.96C4.3-1.05 3.79-.71 3.02-.71C2.37-.71 1.87-1.02 1.52-1.66C1.28-2.13 1.18-2.55 1.16-3.31H4.84C4.75-4.09 4.63-4.44 4.33-4.82C3.97-5.25 3.42-5.5 2.8-5.5C1.32-5.5 .3-4.3 .3-2.56C.3-.91 1.16 .12 2.53 .12C3.68 .12 4.57-.59 5.07-1.88ZM3.62-3.69H1.18C1.32-4.64 1.72-5.07 2.45-5.07S3.47-4.73 3.62-3.69Z'/>
<path id='eq172-g24-102' d='M4.58-7.42C4.58-7.85 4.05-8.17 3.34-8.17C2.58-8.17 1.96-7.84 1.65-7.3S1.24-6.34 1.23-5.38H.25V-5H1.23V-1.24C1.23-.37 1.1-.23 .24-.18V0H3.35V-.18C2.37-.22 2.24-.35 2.24-1.24V-5H3.69V-5.38H2.22V-6.77C2.22-7.47 2.45-7.83 2.91-7.83C3.17-7.83 3.32-7.71 3.54-7.36C3.73-7.04 3.87-6.93 4.08-6.93C4.36-6.93 4.58-7.15 4.58-7.42Z'/>
<path id='eq172-g24-104' d='M5.82 0V-.18C5.18-.3 5.1-.39 5.1-1.22V-3.6C5.1-4.85 4.6-5.5 3.63-5.5C2.93-5.5 2.43-5.21 1.88-4.5V-8.13L1.82-8.17C1.41-8.02 1.11-7.93 .44-7.73L.12-7.64V-7.45C.17-7.46 .2-7.46 .26-7.46C.78-7.46 .87-7.36 .87-6.85V-1.22C.87-.38 .8-.27 .11-.18V0H2.69V-.18C2-.25 1.88-.39 1.88-1.22V-4.1C2.38-4.65 2.74-4.85 3.2-4.85C3.8-4.85 4.1-4.42 4.1-3.59V-1.22C4.1-.41 3.98-.25 3.29-.18V0H5.82Z'/>
<path id='eq172-g24-105' d='M3.02 0V-.18C2.24-.24 2.14-.36 2.14-1.22V-5.46L2.09-5.5L.24-4.84V-4.66L.33-4.67C.48-4.7 .63-4.71 .74-4.71C1.03-4.71 1.14-4.52 1.14-3.99V-1.22C1.14-.36 1.02-.23 .19-.18V0H3.02ZM2.25-7.56C2.25-7.89 1.98-8.17 1.64-8.17C1.3-8.17 1.03-7.89 1.03-7.56C1.03-7.21 1.3-6.95 1.64-6.95C1.98-6.95 2.25-7.21 2.25-7.56Z'/>
<path id='eq172-g24-111' d='M5.62-2.8C5.62-4.36 4.52-5.5 2.99-5.5C1.43-5.5 .35-4.35 .35-2.7C.35-1.09 1.46 .12 2.96 .12S5.62-1.15 5.62-2.8ZM4.54-2.38C4.54-1.03 4-.22 3.11-.22C2.64-.22 2.2-.5 1.95-.98C1.61-1.6 1.42-2.44 1.42-3.29C1.42-4.42 1.98-5.16 2.83-5.16C3.84-5.16 4.54-4.02 4.54-2.38Z'/>
<path id='eq172-g24-114' d='M4-4.87C4-5.26 3.75-5.5 3.35-5.5C2.85-5.5 2.5-5.22 1.91-4.38V-5.48L1.85-5.5C1.22-5.24 .79-5.08 .08-4.85V-4.66C.25-4.7 .36-4.71 .5-4.71C.8-4.71 .91-4.52 .91-3.99V-1C.91-.41 .82-.32 .06-.18V0H2.93V-.18C2.12-.22 1.91-.39 1.91-1.08V-3.77C1.91-4.15 2.43-4.75 2.75-4.75C2.82-4.75 2.93-4.69 3.06-4.57C3.25-4.4 3.38-4.33 3.54-4.33C3.83-4.33 4-4.53 4-4.87Z'/>
<path id='eq172-g24-115' d='M4.16-1.41C4.16-2.01 3.89-2.4 3.16-2.83L1.87-3.6C1.53-3.79 1.35-4.09 1.35-4.41C1.35-4.9 1.72-5.22 2.27-5.22C2.95-5.22 3.31-4.83 3.59-3.75H3.77L3.72-5.38H3.59L3.56-5.36C3.46-5.27 3.44-5.26 3.4-5.26C3.32-5.26 3.2-5.28 3.07-5.34C2.82-5.44 2.55-5.49 2.26-5.49C1.28-5.49 .61-4.89 .61-4.02C.61-3.35 .99-2.88 2.01-2.3L2.7-1.9C3.12-1.66 3.32-1.37 3.32-1C3.32-.48 2.94-.14 2.33-.14C1.51-.14 1.09-.6 .81-1.82H.62V.05H.78C.86-.07 .91-.1 1.05-.1C1.18-.1 1.32-.07 1.6 0C1.94 .07 2.24 .12 2.49 .12C3.4 .12 4.16-.57 4.16-1.41Z'/>
<path id='eq172-g24-116' d='M3.34-.79L3.18-.92C2.92-.61 2.73-.5 2.46-.5C2.02-.5 1.84-.81 1.84-1.58V-5H3.05V-5.38H1.84V-6.77C1.84-6.89 1.82-6.92 1.76-6.92C1.69-6.8 1.6-6.69 1.52-6.59C1.08-5.93 .67-5.49 .36-5.31C.23-5.22 .16-5.15 .16-5.08C.16-5.05 .17-5.02 .2-5H.84V-1.4C.84-.39 1.2 .12 1.89 .12C2.49 .12 2.94-.17 3.34-.79Z'/>
<path id='eq172-g24-119' d='M8.3-5.2V-5.38H6.83V-5.2C7.23-5.12 7.35-5.03 7.35-4.83C7.35-4.65 7.28-4.36 7.15-4.04L6.07-1.39L5.07-4.06C4.87-4.61 4.87-4.61 4.87-4.77C4.87-5.03 5-5.12 5.56-5.2V-5.38H3.13V-5.2C3.57-5.15 3.72-5.02 3.96-4.38L4.2-3.71L3.11-1.33L1.92-4.45C1.88-4.57 1.85-4.69 1.85-4.81C1.85-5.06 2-5.15 2.4-5.2V-5.38H.25V-5.2C.53-5.18 .62-5.06 .88-4.45L2.5-.36C2.64 0 2.74 .17 2.81 .17C2.87 .17 2.96 .01 3.11-.3L4.45-3.17L5.54-.35C5.7 .1 5.75 .17 5.82 .17C5.91 .17 5.97 .06 6.16-.42L7.81-4.55C8.02-5.06 8.06-5.12 8.3-5.2Z'/>
<path id='eq172-g17-48' d='M3.12-2.16C3.12-3.5 2.52-4.43 1.66-4.43C1.3-4.43 1.03-4.32 .79-4.09C.41-3.72 .16-2.97 .16-2.2C.16-1.49 .37-.72 .68-.35C.92-.07 1.26 .09 1.64 .09C1.97 .09 2.25-.02 2.49-.25C2.87-.61 3.12-1.37 3.12-2.16ZM2.49-2.15C2.49-.78 2.2-.08 1.64-.08S.79-.78 .79-2.14C.79-3.53 1.08-4.26 1.64-4.26C2.19-4.26 2.49-3.52 2.49-2.15Z'/>
<path id='eq172-g17-49' d='M2.58 0V-.1C2.06-.1 1.96-.17 1.96-.48V-4.42L1.91-4.43L.73-3.83V-3.74C.81-3.77 .88-3.8 .9-3.81C1.02-3.86 1.13-3.88 1.2-3.88C1.34-3.88 1.4-3.79 1.4-3.58V-.61C1.4-.39 1.34-.24 1.24-.18C1.14-.12 1.05-.1 .77-.1V0H2.58Z'/>
<path id='eq172-g17-50' d='M3.11-.9L3.03-.93C2.78-.56 2.7-.5 2.4-.5H.84L1.94-1.65C2.52-2.26 2.78-2.76 2.78-3.27C2.78-3.92 2.25-4.43 1.57-4.43C1.21-4.43 .86-4.28 .62-4.02C.41-3.8 .31-3.59 .2-3.12L.34-3.09C.6-3.73 .84-3.94 1.29-3.94C1.84-3.94 2.21-3.57 2.21-3.02C2.21-2.51 1.91-1.9 1.36-1.32L.2-.08V0H2.75L3.11-.9Z'/>
<path id='eq172-g7-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq172-g7-106' d='M1.52 2.3V-8.42H.86V2.3H1.52Z'/>
<path id='eq172-g7-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq172-g7-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
</defs>
<g id='eq172-page1'>
<use x='103.94' y='-18.67' xlink:href='#eq172-g13-107'/>
<use x='112.48' y='-18.67' xlink:href='#eq172-g7-185'/>
<use x='116.94' y='-18.67' xlink:href='#eq172-g13-71'/>
<use x='122.83' y='-18.67' xlink:href='#eq172-g13-150'/>
<use x='128.1' y='-18.67' xlink:href='#eq172-g13-102'/>
<use x='136.66' y='-18.67' xlink:href='#eq172-g7-186'/>
<use x='144.56' y='-18.67' xlink:href='#eq172-g1-61'/>
<use x='155.44' y='-36.49' xlink:href='#eq172-g4-56'/>
<use x='155.44' y='-32.91' xlink:href='#eq172-g4-62'/>
<use x='155.44' y='-29.32' xlink:href='#eq172-g4-62'/>
<use x='155.44' y='-29.32' xlink:href='#eq172-g4-60'/>
<use x='155.44' y='-11.15' xlink:href='#eq172-g4-62'/>
<use x='155.44' y='-7.56' xlink:href='#eq172-g4-62'/>
<use x='155.44' y='-.15' xlink:href='#eq172-g4-58'/>
<use x='162.51' y='-26.07' xlink:href='#eq172-g13-71'/>
<use x='173.34' y='-39.28' xlink:href='#eq172-g4-16'/>
<use x='177.84' y='-26.07' xlink:href='#eq172-g23-49'/>
<use x='186.47' y='-26.07' xlink:href='#eq172-g7-0'/>
<use x='198.96' y='-30.78' xlink:href='#eq172-g10-71'/>
<use x='203.28' y='-33.96' xlink:href='#eq172-g17-50'/>
<rect x='197.93' y='-29.48' height='.67' width='10.18'/>
<use x='198.04' y='-21.17' xlink:href='#eq172-g10-102'/>
<use x='204.32' y='-23.7' xlink:href='#eq172-g17-50'/>
<use x='209.54' y='-39.28' xlink:href='#eq172-g4-17'/>
<use x='214.75' y='-36.57' xlink:href='#eq172-g20-50'/>
<use x='221.63' y='-26.07' xlink:href='#eq172-g13-150'/>
<use x='236.7' y='-26.07' xlink:href='#eq172-g24-105'/>
<use x='240.03' y='-26.07' xlink:href='#eq172-g24-102'/>
<use x='247.47' y='-26.07' xlink:href='#eq172-g7-106'/>
<use x='250.34' y='-26.07' xlink:href='#eq172-g13-71'/>
<use x='256.71' y='-26.07' xlink:href='#eq172-g7-106'/>
<use x='263.15' y='-26.07' xlink:href='#eq172-g13-159'/>
<use x='274.49' y='-26.07' xlink:href='#eq172-g13-102'/>
<use x='162.51' y='-6.2' xlink:href='#eq172-g23-48'/>
<use x='168.49' y='-6.2' xlink:href='#eq172-g13-150'/>
<use x='236.7' y='-6.2' xlink:href='#eq172-g24-111'/>
<use x='242.68' y='-6.2' xlink:href='#eq172-g24-116'/>
<use x='246' y='-6.2' xlink:href='#eq172-g24-104'/>
<use x='251.98' y='-6.2' xlink:href='#eq172-g24-101'/>
<use x='257.29' y='-6.2' xlink:href='#eq172-g24-114'/>
<use x='261.51' y='-6.2' xlink:href='#eq172-g24-119'/>
<use x='270.14' y='-6.2' xlink:href='#eq172-g24-105'/>
<use x='273.46' y='-6.2' xlink:href='#eq172-g24-115'/>
<use x='278.11' y='-6.2' xlink:href='#eq172-g24-101'/>
</g>
</svg></div>
<p><span class="m-math"><svg style="width: 0.805em; height: 0.538em;" viewBox=".16 -5.25 8.05 5.38">
<title>
\(\sigma\)
</title>
<defs>
<path id='eq177-g1-102' d='M8.05-5.25H3.7C1.91-5.25 .3-3.75 .3-1.75C.3-.55 .94 .13 2.16 .13C3.62 .13 5.44-1.29 5.44-3.41C5.44-4.09 5.22-4.35 5.22-4.36H7.81L8.05-5.25ZM4.54-3.39C4.54-1.62 3.55-.17 2.32-.17C1.41-.17 1.29-1.36 1.29-1.72C1.29-4.01 2.51-4.93 3.39-4.93C3.84-4.93 4.54-4.81 4.54-3.39Z'/>
</defs>
<g id='eq177-page1'>
<use x='.16' y='0' xlink:href='#eq177-g1-102'/>
</g>
</svg></span> is set by the <code>sigma</code> parameter.</p>
<p>The diffusion is generalized to any image dimensionality. <code>in</code> must be scalar and real-valued.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>M.J. Black, G. Sapiro, D.H. Marimont and D. Heeger, &ldquo;Robust anisotropic diffusion&rdquo;,
  IEEE Transactions on Image Processing 7(3):421-432, 1998.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-CoherenceEnhancingDiffusion-dip-Image-CL-dip-Image-L-dip-dfloat--dip-dfloat--dip-uint--dip-StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-CoherenceEnhancingDiffusion-dip-Image-CL-dip-Image-L-dip-dfloat--dip-dfloat--dip-uint--dip-StringSet-CL" class="m-doc-self">dip::<wbr />CoherenceEnhancingDiffusion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> derivativeSigma = 1,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> regularizationSigma = 3,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> iterations = 5,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; flags = {})</span></span>
            </h3>
            <p>Applies iterative coherence enhancing (anisotropic) diffusion</p>
<p>Applies <code>iterations</code> steps of the coherence enhancing diffusion:</p>
<div class="m-math"><svg style="width: 12.169em; height: 1.446em;" viewBox="133.22 -14.48 121.69 14.46">
<title>
\[ I^{t+1} = I^t + \lambda \, \mathrm{div} \left( D \nabla I^t \right) \; , \]
</title>
<defs>
<use id='eq178-g23-100' xlink:href='#eq178-g20-100' transform='scale(1.36)'/>
<use id='eq178-g23-105' xlink:href='#eq178-g20-105' transform='scale(1.36)'/>
<use id='eq178-g23-118' xlink:href='#eq178-g20-118' transform='scale(1.36)'/>
<use id='eq178-g10-114' xlink:href='#eq178-g7-114' transform='scale(1.36)'/>
<use id='eq178-g10-184' xlink:href='#eq178-g7-184' transform='scale(1.36)'/>
<path id='eq178-g20-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq178-g20-100' d='M4.29-.37V-.51C4.13-.5 4.11-.5 4.09-.5C3.77-.5 3.7-.59 3.7-1V-5.95L3.66-5.97C3.24-5.82 2.93-5.73 2.38-5.58V-5.44C2.45-5.45 2.5-5.45 2.57-5.45C2.89-5.45 2.97-5.36 2.97-5V-3.64C2.64-3.92 2.4-4.02 2.05-4.02C1.05-4.02 .24-3.03 .24-1.79C.24-.67 .89 .09 1.85 .09C2.34 .09 2.67-.09 2.97-.5V.06L3 .09L4.29-.37ZM2.97-.89C2.97-.83 2.91-.72 2.82-.63C2.66-.45 2.45-.37 2.19-.37C1.47-.37 .99-1.07 .99-2.14C.99-3.13 1.41-3.77 2.08-3.77C2.54-3.77 2.97-3.36 2.97-2.9V-.89Z'/>
<path id='eq178-g20-105' d='M2.21 0V-.13C1.63-.17 1.56-.26 1.56-.89V-3.99L1.53-4.02L.17-3.54V-3.41L.24-3.42C.35-3.43 .46-3.44 .54-3.44C.75-3.44 .83-3.3 .83-2.92V-.89C.83-.26 .74-.17 .14-.13V0H2.21ZM1.64-5.52C1.64-5.76 1.45-5.97 1.2-5.97C.95-5.97 .75-5.76 .75-5.52C.75-5.27 .95-5.07 1.2-5.07C1.45-5.07 1.64-5.27 1.64-5.52Z'/>
<path id='eq178-g20-118' d='M4.17-3.8V-3.93H2.95V-3.8C3.23-3.77 3.36-3.69 3.36-3.52C3.36-3.43 3.35-3.35 3.31-3.26L2.45-1L1.55-3.23C1.5-3.35 1.48-3.48 1.48-3.55C1.48-3.71 1.57-3.77 1.88-3.8V-3.93H.17V-3.8C.5-3.78 .56-3.69 .96-2.79L2.01-.29C2.03-.24 2.05-.17 2.08-.1C2.13 .05 2.18 .12 2.24 .12S2.35 .01 2.48-.31L3.6-3.12C3.85-3.71 3.9-3.77 4.17-3.8Z'/>
<path id='eq178-g4-0' d='M3.13 12.48C1.83 11.02 1.64 8.27 1.64 6.06S1.69 1.21 3.13-.43L2.99-.67C2.42-.19 .6 2.12 .6 6.06S2.42 12.26 2.99 12.73L3.13 12.48Z'/>
<path id='eq178-g4-1' d='M.36 12.48L.5 12.73C1.07 12.26 2.89 10 2.89 6.06S1.07-.19 .5-.67L.36-.43C1.8 1.21 1.85 3.86 1.85 6.06S1.66 11.02 .36 12.48Z'/>
<path id='eq178-g13-25' d='M6.11-3.35C6.11-4.79 5.12-5.7 3.56-5.7H1.14V-5.56C1.69-5.51 1.81-5.44 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.14C3.14 0 4.05-.26 4.72-.72C5.59-1.34 6.11-2.32 6.11-3.35ZM5.14-3.56C5.14-2.61 4.78-1.64 4.18-1.05C3.67-.52 2.96-.26 2.05-.26C1.65-.26 1.48-.36 1.48-.59C1.48-.7 1.53-.87 1.68-1.41L2.73-5.19C2.79-5.38 2.91-5.44 3.27-5.44C3.76-5.44 4.18-5.33 4.46-5.14C4.9-4.83 5.14-4.26 5.14-3.56Z'/>
<path id='eq178-g13-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq178-g13-67' d='M2.59-3.74H1.89L2.13-4.64C2.14-4.66 2.14-4.67 2.14-4.68C2.14-4.74 2.11-4.77 2.07-4.77C2.02-4.77 1.99-4.76 1.94-4.69C1.11-3.61 .5-3.79 .5-3.51C.5-3.5 .5-3.49 .51-3.46H1.15L.52-1.06C.5-.94 .32-.4 .32-.24C.32-.04 .51 .1 .74 .1C1.14 .1 1.43-.15 1.98-.96L1.87-1.02C1.44-.47 1.3-.33 1.16-.33C1.08-.33 1.03-.4 1.03-.51C1.03-.52 1.03-.52 1.04-.55L1.81-3.46H2.54L2.59-3.74Z'/>
<path id='eq178-g13-95' d='M4.6-.64L4.59-.66C4.47-.66 4.32-.36 3.96-.36C2.31-.36 5.31-5.72 2.74-5.72H2.65C2.49-5.72 2.12-5.59 2.01-5.49C2-5.48 2.07-5.4 2.08-5.4C2.12-5.43 2.31-5.51 2.49-5.51C3.34-5.51 3.11-4.11 3.11-3.89C3.12-3.86 3.11-3.84 3.1-3.81C2.93-3 .35-.71 .14 0H1.01C1.01-.09 1.02-.17 1.04-.27C1.29-1.39 3-3.08 3-3.09H3.01C2.96-2.64 2.17 .1 3.6 .1C3.98 .1 4.59-.53 4.6-.64Z'/>
<path id='eq178-g13-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq178-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq178-g7-114' d='M5.49-5.9H.27L2.85 0H3.02L5.49-5.9ZM4.77-5.14L3.16-1.27L1.55-5.14H4.77Z'/>
<path id='eq178-g7-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<use id='eq178-g16-25' xlink:href='#eq178-g13-25' transform='scale(1.36)'/>
<use id='eq178-g16-30' xlink:href='#eq178-g13-30' transform='scale(1.36)'/>
<use id='eq178-g16-95' xlink:href='#eq178-g13-95' transform='scale(1.36)'/>
<use id='eq178-g16-150' xlink:href='#eq178-g13-150' transform='scale(1.36)'/>
</defs>
<g id='eq178-page1'>
<use x='133.32' y='-3.64' xlink:href='#eq178-g16-30'/>
<use x='138.14' y='-8.57' xlink:href='#eq178-g13-67'/>
<use x='141.08' y='-8.57' xlink:href='#eq178-g7-184'/>
<use x='146.03' y='-8.57' xlink:href='#eq178-g20-49'/>
<use x='154.23' y='-3.64' xlink:href='#eq178-g1-61'/>
<use x='165.12' y='-3.64' xlink:href='#eq178-g16-30'/>
<use x='169.94' y='-8.57' xlink:href='#eq178-g13-67'/>
<use x='176.04' y='-3.64' xlink:href='#eq178-g10-184'/>
<use x='185.28' y='-3.64' xlink:href='#eq178-g16-95'/>
<use x='193.89' y='-3.64' xlink:href='#eq178-g23-100'/>
<use x='199.87' y='-3.64' xlink:href='#eq178-g23-105'/>
<use x='203.19' y='-3.64' xlink:href='#eq178-g23-118'/>
<use x='212.12' y='-12.75' xlink:href='#eq178-g4-0'/>
<use x='216.3' y='-3.64' xlink:href='#eq178-g16-25'/>
<use x='225.77' y='-3.64' xlink:href='#eq178-g10-114'/>
<use x='234.32' y='-3.64' xlink:href='#eq178-g16-30'/>
<use x='239.14' y='-8.57' xlink:href='#eq178-g13-67'/>
<use x='242.82' y='-12.75' xlink:href='#eq178-g4-1'/>
<use x='252.59' y='-3.64' xlink:href='#eq178-g16-150'/>
</g>
</svg></div>
<p>where <span class="m-math"><svg style="width: 0.724em; height: 0.793em;" viewBox="-.16 -7.8 7.24 7.93">
<title>
\(\lambda\)
</title>
<defs>
<path id='eq182-g1-95' d='M6.28-.87L6.26-.89C6.1-.89 5.9-.49 5.4-.49C3.14-.49 7.24-7.8 3.74-7.8H3.61C3.39-7.8 2.89-7.62 2.74-7.48C2.73-7.47 2.82-7.36 2.83-7.36C2.89-7.41 3.16-7.52 3.39-7.52C4.55-7.52 4.24-5.61 4.24-5.3C4.25-5.26 4.24-5.24 4.23-5.19C3.99-4.09 .48-.96 .19 0H1.38C1.38-.12 1.39-.24 1.42-.37C1.76-1.89 4.1-4.2 4.1-4.22H4.11C4.04-3.6 2.97 .13 4.91 .13C5.43 .13 6.25-.73 6.28-.87Z'/>
</defs>
<g id='eq182-page1'>
<use x='-.16' y='0' xlink:href='#eq182-g1-95'/>
</g>
</svg></span> is set with the <code>lambda</code> parameter, and <span class="m-math"><svg style="width: 0.843em; height: 0.778em;" viewBox=".35 -7.78 8.43 7.78">
<title>
\(D\)
</title>
<defs>
<path id='eq183-g1-25' d='M8.34-4.57C8.34-6.53 6.98-7.78 4.86-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.1C2.47-6.92 2.42-6.63 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.92C4.28 0 5.53-.36 6.43-.99C7.62-1.82 8.34-3.17 8.34-4.57ZM7.02-4.86C7.02-3.56 6.52-2.24 5.71-1.43C5-.71 4.04-.36 2.8-.36C2.25-.36 2.02-.49 2.02-.8C2.02-.95 2.08-1.19 2.29-1.93L3.73-7.07C3.8-7.34 3.97-7.42 4.45-7.42C5.12-7.42 5.71-7.27 6.09-7C6.68-6.59 7.02-5.81 7.02-4.86Z'/>
</defs>
<g id='eq183-page1'>
<use x='.44' y='0' xlink:href='#eq183-g1-25'/>
</g>
</svg></span> is the diffusion tensor, derived from
the structure tensor (see <a href="analysis.html#dip-StructureTensor-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray-CL-dip-FloatArray-CL-dip-String-CL-dip-StringArray-CL-dip-dfloat-"><code>dip::StructureTensor</code></a>). <code>derivativeSigma</code> and <code>regularizationSigma</code>
are the sigmas for the Gaussian derivatives and smoothing in the structure tensor. The gradient and
divergence are computed using Gaussian derivatives also, using a sigma of 0.5.</p>
<p><code>flags</code> allows the selection of different computational options:</p>
<ul>
<li>
<p><code>"const"</code>: <span class="m-math"><svg style="width: 0.843em; height: 0.778em;" viewBox=".35 -7.78 8.43 7.78">
<title>
\(D\)
</title>
<defs>
<path id='eq197-g1-25' d='M8.34-4.57C8.34-6.53 6.98-7.78 4.86-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.1C2.47-6.92 2.42-6.63 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.92C4.28 0 5.53-.36 6.43-.99C7.62-1.82 8.34-3.17 8.34-4.57ZM7.02-4.86C7.02-3.56 6.52-2.24 5.71-1.43C5-.71 4.04-.36 2.8-.36C2.25-.36 2.02-.49 2.02-.8C2.02-.95 2.08-1.19 2.29-1.93L3.73-7.07C3.8-7.34 3.97-7.42 4.45-7.42C5.12-7.42 5.71-7.27 6.09-7C6.68-6.59 7.02-5.81 7.02-4.86Z'/>
</defs>
<g id='eq197-page1'>
<use x='.44' y='0' xlink:href='#eq197-g1-25'/>
</g>
</svg></span> is taken as constant, simplifying the computation from
  <span class="m-math"><svg style="width: 6.147em; height: 2.144em;" viewBox="1.2 -13.88 61.47 21.44">
<title>
\(\frac{\partial}{\partial x} \left( D_{xx} \frac{\partial}{\partial x} I^t \right)\)
</title>
<defs>
<use id='eq198-g7-25' xlink:href='#eq198-g4-25' transform='scale(1.36)'/>
<use id='eq198-g7-30' xlink:href='#eq198-g4-30' transform='scale(1.36)'/>
<path id='eq198-g1-16' d='M3.88 20.41C2.17 18.38 1.69 13.35 1.69 10.05S2.17 1.74 3.88-.3L3.73-.67C2.43 .81 .6 4.13 .6 10.05S2.36 19.3 3.73 20.77L3.88 20.41Z'/>
<path id='eq198-g1-17' d='M.36 20.41L.51 20.77C1.88 19.3 3.64 15.97 3.64 10.05S1.81 .81 .51-.67L.36-.3C2.07 1.74 2.55 6.75 2.55 10.05S2.07 18.38 .36 20.41Z'/>
<path id='eq198-g4-25' d='M6.11-3.35C6.11-4.79 5.12-5.7 3.56-5.7H1.14V-5.56C1.69-5.51 1.81-5.44 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.14C3.14 0 4.05-.26 4.72-.72C5.59-1.34 6.11-2.32 6.11-3.35ZM5.14-3.56C5.14-2.61 4.78-1.64 4.18-1.05C3.67-.52 2.96-.26 2.05-.26C1.65-.26 1.48-.36 1.48-.59C1.48-.7 1.53-.87 1.68-1.41L2.73-5.19C2.79-5.38 2.91-5.44 3.27-5.44C3.76-5.44 4.18-5.33 4.46-5.14C4.9-4.83 5.14-4.26 5.14-3.56Z'/>
<path id='eq198-g4-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq198-g4-67' d='M2.59-3.74H1.89L2.13-4.64C2.14-4.66 2.14-4.67 2.14-4.68C2.14-4.74 2.11-4.77 2.07-4.77C2.02-4.77 1.99-4.76 1.94-4.69C1.11-3.61 .5-3.79 .5-3.51C.5-3.5 .5-3.49 .51-3.46H1.15L.52-1.06C.5-.94 .32-.4 .32-.24C.32-.04 .51 .1 .74 .1C1.14 .1 1.43-.15 1.98-.96L1.87-1.02C1.44-.47 1.3-.33 1.16-.33C1.08-.33 1.03-.4 1.03-.51C1.03-.52 1.03-.52 1.04-.55L1.81-3.46H2.54L2.59-3.74Z'/>
<path id='eq198-g4-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq198-g4-109' d='M4.3-3.76C4.3-5.02 3.91-6.04 2.97-6.04C2.24-6.04 1.44-5.35 1.44-4.95C1.44-4.66 1.67-4.55 1.84-4.55C2.03-4.55 2.14-4.69 2.16-4.72C2.13-4.74 2.08-4.82 2.08-4.94C2.08-5.02 2.24-5.78 2.99-5.78C3.62-5.78 3.76-4.97 3.76-4.26C3.76-3.73 3.68-3.26 3.68-3.25H3.67C3.67-3.26 3.33-3.79 2.64-3.79C.89-3.79 .17-2.1 .17-1.2C.17-.38 .65 .14 1.62 .14C3.12 .14 4.3-1.39 4.3-3.76ZM3.3-2.78C3.3-2.55 3.07-.07 1.68-.07C1.18-.07 .95-.35 .95-.91C.95-1.46 1.32-3.58 2.58-3.58C3.07-3.58 3.3-3.29 3.3-2.78Z'/>
</defs>
<g id='eq198-page1'>
<use x='3.54' y='-4.71' xlink:href='#eq198-g4-109'/>
<rect x='1.2' y='-3.41' height='.67' width='9.44'/>
<use x='1.38' y='4.12' xlink:href='#eq198-g4-109'/>
<use x='6.32' y='4.12' xlink:href='#eq198-g4-71'/>
<use x='14.78' y='-13.21' xlink:href='#eq198-g1-16'/>
<use x='19.72' y='0' xlink:href='#eq198-g7-25'/>
<use x='29.06' y='1.79' xlink:href='#eq198-g4-71'/>
<use x='33.38' y='1.79' xlink:href='#eq198-g4-71'/>
<use x='41.74' y='-4.71' xlink:href='#eq198-g4-109'/>
<rect x='39.39' y='-3.41' height='.67' width='9.44'/>
<use x='39.58' y='4.12' xlink:href='#eq198-g4-109'/>
<use x='44.51' y='4.12' xlink:href='#eq198-g4-71'/>
<use x='50.52' y='0' xlink:href='#eq198-g7-30'/>
<use x='55.34' y='-4.34' xlink:href='#eq198-g4-67'/>
<use x='59.02' y='-13.21' xlink:href='#eq198-g1-17'/>
</g>
</svg></span>
  to <span class="m-math"><svg style="width: 4.209em; height: 1.736em;" viewBox=".35 -12.32 42.09 17.36">
<title>
\(D_{xx} \frac{\partial^2}{\partial x^2} I^t\)
</title>
<defs>
<path id='eq199-g8-50' d='M3.11-.9L3.03-.93C2.78-.56 2.7-.5 2.4-.5H.84L1.94-1.65C2.52-2.26 2.78-2.76 2.78-3.27C2.78-3.92 2.25-4.43 1.57-4.43C1.21-4.43 .86-4.28 .62-4.02C.41-3.8 .31-3.59 .2-3.12L.34-3.09C.6-3.73 .84-3.94 1.29-3.94C1.84-3.94 2.21-3.57 2.21-3.02C2.21-2.51 1.91-1.9 1.36-1.32L.2-.08V0H2.75L3.11-.9Z'/>
<path id='eq199-g1-25' d='M6.11-3.35C6.11-4.79 5.12-5.7 3.56-5.7H1.14V-5.56C1.69-5.51 1.81-5.44 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.14C3.14 0 4.05-.26 4.72-.72C5.59-1.34 6.11-2.32 6.11-3.35ZM5.14-3.56C5.14-2.61 4.78-1.64 4.18-1.05C3.67-.52 2.96-.26 2.05-.26C1.65-.26 1.48-.36 1.48-.59C1.48-.7 1.53-.87 1.68-1.41L2.73-5.19C2.79-5.38 2.91-5.44 3.27-5.44C3.76-5.44 4.18-5.33 4.46-5.14C4.9-4.83 5.14-4.26 5.14-3.56Z'/>
<path id='eq199-g1-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq199-g1-67' d='M2.59-3.74H1.89L2.13-4.64C2.14-4.66 2.14-4.67 2.14-4.68C2.14-4.74 2.11-4.77 2.07-4.77C2.02-4.77 1.99-4.76 1.94-4.69C1.11-3.61 .5-3.79 .5-3.51C.5-3.5 .5-3.49 .51-3.46H1.15L.52-1.06C.5-.94 .32-.4 .32-.24C.32-.04 .51 .1 .74 .1C1.14 .1 1.43-.15 1.98-.96L1.87-1.02C1.44-.47 1.3-.33 1.16-.33C1.08-.33 1.03-.4 1.03-.51C1.03-.52 1.03-.52 1.04-.55L1.81-3.46H2.54L2.59-3.74Z'/>
<path id='eq199-g1-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq199-g1-109' d='M4.3-3.76C4.3-5.02 3.91-6.04 2.97-6.04C2.24-6.04 1.44-5.35 1.44-4.95C1.44-4.66 1.67-4.55 1.84-4.55C2.03-4.55 2.14-4.69 2.16-4.72C2.13-4.74 2.08-4.82 2.08-4.94C2.08-5.02 2.24-5.78 2.99-5.78C3.62-5.78 3.76-4.97 3.76-4.26C3.76-3.73 3.68-3.26 3.68-3.25H3.67C3.67-3.26 3.33-3.79 2.64-3.79C.89-3.79 .17-2.1 .17-1.2C.17-.38 .65 .14 1.62 .14C3.12 .14 4.3-1.39 4.3-3.76ZM3.3-2.78C3.3-2.55 3.07-.07 1.68-.07C1.18-.07 .95-.35 .95-.91C.95-1.46 1.32-3.58 2.58-3.58C3.07-3.58 3.3-3.29 3.3-2.78Z'/>
<use id='eq199-g4-25' xlink:href='#eq199-g1-25' transform='scale(1.36)'/>
<use id='eq199-g4-30' xlink:href='#eq199-g1-30' transform='scale(1.36)'/>
</defs>
<g id='eq199-page1'>
<use x='.44' y='0' xlink:href='#eq199-g4-25'/>
<use x='9.79' y='1.79' xlink:href='#eq199-g1-71'/>
<use x='14.11' y='1.79' xlink:href='#eq199-g1-71'/>
<use x='22.46' y='-4.71' xlink:href='#eq199-g1-109'/>
<use x='27.4' y='-7.89' xlink:href='#eq199-g8-50'/>
<rect x='20.12' y='-3.41' height='.67' width='13.22'/>
<use x='20.3' y='4.9' xlink:href='#eq199-g1-109'/>
<use x='25.24' y='4.9' xlink:href='#eq199-g1-71'/>
<use x='29.56' y='2.37' xlink:href='#eq199-g8-50'/>
<use x='35.03' y='0' xlink:href='#eq199-g4-30'/>
<use x='39.85' y='-4.34' xlink:href='#eq199-g1-67'/>
</g>
</svg></span>, reducing the number of filters to apply from
  4 to 3. The opposite is <code>"variable"</code>, which is the default.</p>
</li>
<li>
<p><code>"all"</code>: <span class="m-math"><svg style="width: 0.843em; height: 0.778em;" viewBox=".35 -7.78 8.43 7.78">
<title>
\(D\)
</title>
<defs>
<path id='eq195-g1-25' d='M8.34-4.57C8.34-6.53 6.98-7.78 4.86-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.1C2.47-6.92 2.42-6.63 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.92C4.28 0 5.53-.36 6.43-.99C7.62-1.82 8.34-3.17 8.34-4.57ZM7.02-4.86C7.02-3.56 6.52-2.24 5.71-1.43C5-.71 4.04-.36 2.8-.36C2.25-.36 2.02-.49 2.02-.8C2.02-.95 2.08-1.19 2.29-1.93L3.73-7.07C3.8-7.34 3.97-7.42 4.45-7.42C5.12-7.42 5.71-7.27 6.09-7C6.68-6.59 7.02-5.81 7.02-4.86Z'/>
</defs>
<g id='eq195-page1'>
<use x='.44' y='0' xlink:href='#eq195-g1-25'/>
</g>
</svg></span> is obtained in a simple manner from the structure tensor, where all eigenvalues of <span class="m-math"><svg style="width: 0.843em; height: 0.778em;" viewBox=".35 -7.78 8.43 7.78">
<title>
\(D\)
</title>
<defs>
<path id='eq196-g1-25' d='M8.34-4.57C8.34-6.53 6.98-7.78 4.86-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.1C2.47-6.92 2.42-6.63 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.92C4.28 0 5.53-.36 6.43-.99C7.62-1.82 8.34-3.17 8.34-4.57ZM7.02-4.86C7.02-3.56 6.52-2.24 5.71-1.43C5-.71 4.04-.36 2.8-.36C2.25-.36 2.02-.49 2.02-.8C2.02-.95 2.08-1.19 2.29-1.93L3.73-7.07C3.8-7.34 3.97-7.42 4.45-7.42C5.12-7.42 5.71-7.27 6.09-7C6.68-6.59 7.02-5.81 7.02-4.86Z'/>
</defs>
<g id='eq196-page1'>
<use x='.44' y='0' xlink:href='#eq196-g1-25'/>
</g>
</svg></span>
  are adjusted. The opposite is <code>"first"</code>, which is the default. See below for more information.</p>
</li>
<li>
<p><code>"resample"</code>: the output is twice the size of the input. Computations are always done on the larger image,
  this flag returns the larger image instead of the subsampled one.</p>
</li>
</ul>
<p>This function can be applied to images with two or more dimensions. <code>in</code> must be scalar and real-valued.
The <code>"first"</code> flag is only supported for 2D images, if <code>in</code> has more dimensions, the <code>"first"</code> flag is
ignored and <code>"all"</code> is assumed.</p>
<p>In <code>"all"</code> mode, <span class="m-math"><svg style="width: 0.843em; height: 0.778em;" viewBox=".35 -7.78 8.43 7.78">
<title>
\(D\)
</title>
<defs>
<path id='eq184-g1-25' d='M8.34-4.57C8.34-6.53 6.98-7.78 4.86-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.1C2.47-6.92 2.42-6.63 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.92C4.28 0 5.53-.36 6.43-.99C7.62-1.82 8.34-3.17 8.34-4.57ZM7.02-4.86C7.02-3.56 6.52-2.24 5.71-1.43C5-.71 4.04-.36 2.8-.36C2.25-.36 2.02-.49 2.02-.8C2.02-.95 2.08-1.19 2.29-1.93L3.73-7.07C3.8-7.34 3.97-7.42 4.45-7.42C5.12-7.42 5.71-7.27 6.09-7C6.68-6.59 7.02-5.81 7.02-4.86Z'/>
</defs>
<g id='eq184-page1'>
<use x='.44' y='0' xlink:href='#eq184-g1-25'/>
</g>
</svg></span> is composed from the eigen decomposition of the structure tensor <span class="m-math"><svg style="width: 0.605em; height: 0.816em;" viewBox=".24 -7.94 6.05 8.16">
<title>
\(S\)
</title>
<defs>
<path id='eq185-g1-40' d='M5.13-2.17C5.13-2.94 4.87-3.39 3.79-4.49C2.7-5.57 2.61-5.74 2.61-6.32C2.61-7.07 3.11-7.54 3.92-7.54C4.36-7.54 4.72-7.4 4.97-7.11C5.24-6.81 5.34-6.41 5.36-5.61L5.57-5.57L6.05-7.94H5.78C5.61-7.69 5.5-7.63 5.24-7.63C5.09-7.63 4.94-7.67 4.69-7.77C4.44-7.87 4.05-7.93 3.68-7.93C2.44-7.93 1.56-7.11 1.56-5.94C1.56-5.3 1.74-4.95 2.45-4.19C2.61-4.04 2.76-3.87 2.92-3.69L3.38-3.19C3.94-2.61 4.1-2.3 4.1-1.79C4.1-.88 3.44-.2 2.56-.2C1.56-.2 .82-1.05 .82-2.22C.82-2.3 .82-2.35 .85-2.45L.61-2.48L.2 .18H.42C.5-.1 .63-.21 .87-.21C1-.21 1.17-.17 1.49-.06C2.04 .14 2.36 .21 2.73 .21C4.1 .21 5.13-.81 5.13-2.17Z'/>
</defs>
<g id='eq185-page1'>
<use x='.24' y='0' xlink:href='#eq185-g1-40'/>
</g>
</svg></span>:</p>
<div class="m-math"><svg style="width: 14.671em; height: 1.232em;" viewBox="120.64 -12.33 146.71 12.32">
<title>
\[ S = V \, E \, V^T \; \rightarrow \; D = V \, E&#x27; \, V^T \; , \]
</title>
<defs>
<path id='eq179-g4-33' d='M8.4-2.25L6.69-4.04L6.42-3.75L7.46-2.49H.54V-2H7.46L6.42-.74L6.69-.45L8.4-2.25Z'/>
<path id='eq179-g4-48' d='M2.59-3.59C2.59-3.9 2.28-4.11 2-4.11C1.68-4.11 1.52-3.79 1.43-3.53L.52-.88C.5-.81 .44-.66 .44-.58S.49-.39 .58-.39C.71-.39 .86-.58 .92-.67L2.35-2.93C2.47-3.12 2.59-3.36 2.59-3.59Z'/>
<use id='eq179-g7-33' xlink:href='#eq179-g4-33' transform='scale(1.36)'/>
<path id='eq179-g10-25' d='M6.11-3.35C6.11-4.79 5.12-5.7 3.56-5.7H1.14V-5.56C1.69-5.51 1.81-5.44 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.14C3.14 0 4.05-.26 4.72-.72C5.59-1.34 6.11-2.32 6.11-3.35ZM5.14-3.56C5.14-2.61 4.78-1.64 4.18-1.05C3.67-.52 2.96-.26 2.05-.26C1.65-.26 1.48-.36 1.48-.59C1.48-.7 1.53-.87 1.68-1.41L2.73-5.19C2.79-5.38 2.91-5.44 3.27-5.44C3.76-5.44 4.18-5.33 4.46-5.14C4.9-4.83 5.14-4.26 5.14-3.56Z'/>
<path id='eq179-g10-26' d='M4.96-1.41L4.82-1.48C4.41-.92 4.18-.7 3.81-.52C3.49-.38 2.89-.29 2.23-.29C1.74-.29 1.54-.38 1.54-.59C1.54-.69 1.63-1.09 1.85-1.86L2.13-2.86L2.81-2.84C2.84-2.84 2.86-2.84 2.88-2.84C3.19-2.84 3.41-2.79 3.49-2.71C3.54-2.66 3.55-2.59 3.55-2.44C3.55-2.28 3.54-2.17 3.49-1.98L3.67-1.94L4.26-3.97L4.11-4C3.77-3.26 3.69-3.2 2.9-3.17L2.21-3.15L2.79-5.19C2.84-5.38 2.93-5.42 3.42-5.42C4.8-5.42 5.1-5.3 5.1-4.78C5.1-4.66 5.09-4.53 5.08-4.38L5.27-4.37L5.54-5.7H1.2V-5.56C1.74-5.51 1.87-5.44 1.87-5.21C1.87-5.1 1.82-4.82 1.77-4.65L.7-.79C.54-.28 .48-.23-.01-.14V0H4.42L4.96-1.41Z'/>
<path id='eq179-g10-40' d='M3.76-1.59C3.76-2.16 3.57-2.49 2.78-3.29C1.98-4.09 1.91-4.21 1.91-4.64C1.91-5.19 2.28-5.53 2.87-5.53C3.2-5.53 3.46-5.42 3.64-5.21C3.84-5 3.91-4.7 3.93-4.11L4.09-4.09L4.44-5.83H4.24C4.11-5.64 4.04-5.6 3.84-5.6C3.73-5.6 3.62-5.62 3.44-5.69C3.26-5.77 2.97-5.82 2.7-5.82C1.79-5.82 1.14-5.21 1.14-4.36C1.14-3.89 1.28-3.63 1.8-3.07C1.91-2.96 2.03-2.84 2.14-2.71L2.48-2.34C2.89-1.91 3-1.69 3-1.31C3-.65 2.52-.15 1.88-.15C1.14-.15 .6-.77 .6-1.62C.6-1.69 .6-1.72 .62-1.8L.45-1.82L.15 .13H.31C.37-.07 .46-.16 .64-.16C.73-.16 .86-.12 1.09-.04C1.49 .1 1.73 .16 2 .16C3 .16 3.76-.59 3.76-1.59Z'/>
<path id='eq179-g10-41' d='M5.53-5.7H.88L.52-4.36L.67-4.32C1.11-5.22 1.39-5.4 2.57-5.4C2.63-5.4 2.69-5.4 2.75-5.4L1.49-.79C1.35-.32 1.14-.18 .57-.14V0H3.1V-.14L2.77-.17C2.41-.19 2.31-.27 2.31-.54C2.31-.65 2.33-.73 2.42-1.05L3.63-5.4H4.11C4.74-5.4 5.02-5.18 5.02-4.69C5.02-4.58 5.01-4.45 5-4.3L5.14-4.28L5.53-5.7Z'/>
<path id='eq179-g10-43' d='M6.01-5.56V-5.7H4.38V-5.56C4.78-5.52 4.93-5.43 4.93-5.27S4.78-4.73 4.48-4.23L2.68-1.12L2.1-4.99C2.1-5.03 2.1-5.07 2.1-5.12C2.1-5.42 2.22-5.5 2.77-5.56V-5.7H.66V-5.56C1.15-5.5 1.17-5.48 1.35-4.38L2.1 .16H2.26L5.52-5.21C5.67-5.45 5.81-5.56 6.01-5.56Z'/>
<path id='eq179-g10-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq179-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<use id='eq179-g13-25' xlink:href='#eq179-g10-25' transform='scale(1.36)'/>
<use id='eq179-g13-26' xlink:href='#eq179-g10-26' transform='scale(1.36)'/>
<use id='eq179-g13-40' xlink:href='#eq179-g10-40' transform='scale(1.36)'/>
<use id='eq179-g13-43' xlink:href='#eq179-g10-43' transform='scale(1.36)'/>
<use id='eq179-g13-150' xlink:href='#eq179-g10-150' transform='scale(1.36)'/>
</defs>
<g id='eq179-page1'>
<use x='120.64' y='-1.69' xlink:href='#eq179-g13-40'/>
<use x='130.34' y='-1.69' xlink:href='#eq179-g1-61'/>
<use x='140.26' y='-1.69' xlink:href='#eq179-g13-43'/>
<use x='151.01' y='-1.69' xlink:href='#eq179-g13-26'/>
<use x='160.83' y='-1.69' xlink:href='#eq179-g13-43'/>
<use x='168.94' y='-6.62' xlink:href='#eq179-g10-41'/>
<use x='181.79' y='-1.69' xlink:href='#eq179-g7-33'/>
<use x='201.12' y='-1.69' xlink:href='#eq179-g13-25'/>
<use x='213.79' y='-1.69' xlink:href='#eq179-g1-61'/>
<use x='223.71' y='-1.69' xlink:href='#eq179-g13-43'/>
<use x='234.45' y='-1.69' xlink:href='#eq179-g13-26'/>
<use x='242.59' y='-6.62' xlink:href='#eq179-g4-48'/>
<use x='247.38' y='-1.69' xlink:href='#eq179-g13-43'/>
<use x='255.49' y='-6.62' xlink:href='#eq179-g10-41'/>
<use x='265.02' y='-1.69' xlink:href='#eq179-g13-150'/>
</g>
</svg></div>
<p>with</p>
<div class="m-math"><svg style="width: 9.862em; height: 2.491em;" viewBox="144.61 -24.92 98.62 24.91">
<title>
\[ E&#x27; = \frac{1}{\mathrm{trace}\,E^{-1}} \, E^{-1} \; . \]
</title>
<defs>
<path id='eq180-g11-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq180-g11-97' d='M3.86-.35V-.58C3.71-.45 3.61-.41 3.48-.41C3.28-.41 3.21-.53 3.21-.92V-2.62C3.21-3.07 3.17-3.31 3.05-3.51C2.86-3.84 2.49-4.02 1.96-4.02C1.51-4.02 1.09-3.9 .85-3.69C.63-3.51 .49-3.26 .49-3.04C.49-2.84 .66-2.66 .86-2.66S1.26-2.84 1.26-3.03C1.26-3.07 1.25-3.11 1.24-3.17C1.22-3.25 1.21-3.32 1.21-3.38C1.21-3.62 1.49-3.81 1.84-3.81C2.27-3.81 2.51-3.55 2.51-3.08V-2.55C1.16-2.01 1.01-1.94 .64-1.61C.45-1.43 .32-1.14 .32-.85C.32-.3 .7 .09 1.24 .09C1.62 .09 1.98-.1 2.52-.55C2.56-.09 2.72 .09 3.07 .09C3.37 .09 3.55-.02 3.86-.35ZM2.51-1.07C2.51-.8 2.46-.72 2.28-.61C2.07-.49 1.83-.42 1.64-.42C1.34-.42 1.09-.72 1.09-1.09V-1.13C1.09-1.64 1.45-1.96 2.51-2.34V-1.07Z'/>
<path id='eq180-g11-99' d='M3.6-1.28L3.48-1.36C3.06-.75 2.74-.54 2.24-.54C1.44-.54 .89-1.24 .89-2.24C.89-3.15 1.37-3.76 2.08-3.76C2.39-3.76 2.51-3.67 2.59-3.35L2.65-3.15C2.72-2.9 2.87-2.75 3.07-2.75C3.29-2.75 3.48-2.92 3.48-3.12C3.48-3.61 2.86-4.02 2.13-4.02C1.72-4.02 1.3-3.86 .95-3.57C.48-3.18 .22-2.58 .22-1.85C.22-.72 .91 .09 1.88 .09C2.25 .09 2.59-.03 2.88-.28C3.14-.49 3.32-.74 3.6-1.28Z'/>
<path id='eq180-g11-101' d='M3.7-1.37L3.56-1.43C3.14-.77 2.77-.52 2.21-.52C1.73-.52 1.36-.74 1.11-1.21C.93-1.55 .86-1.86 .85-2.42H3.54C3.47-2.99 3.38-3.24 3.16-3.52C2.9-3.83 2.5-4.02 2.04-4.02C.96-4.02 .22-3.14 .22-1.87C.22-.66 .85 .09 1.85 .09C2.69 .09 3.34-.43 3.7-1.37ZM2.65-2.7H.86C.96-3.39 1.26-3.7 1.79-3.7S2.53-3.46 2.65-2.7Z'/>
<path id='eq180-g11-114' d='M2.93-3.55C2.93-3.84 2.74-4.02 2.45-4.02C2.08-4.02 1.83-3.82 1.4-3.2V-4L1.35-4.02C.89-3.83 .58-3.71 .06-3.55V-3.41C.18-3.43 .26-3.44 .37-3.44C.59-3.44 .66-3.3 .66-2.92V-.73C.66-.3 .6-.24 .04-.13V0H2.14V-.13C1.55-.16 1.4-.29 1.4-.79V-2.75C1.4-3.03 1.77-3.47 2.01-3.47C2.06-3.47 2.14-3.42 2.24-3.34C2.38-3.21 2.47-3.16 2.59-3.16C2.79-3.16 2.93-3.31 2.93-3.55Z'/>
<path id='eq180-g11-116' d='M2.44-.58L2.32-.67C2.13-.45 1.99-.37 1.8-.37C1.48-.37 1.35-.59 1.35-1.15V-3.65H2.23V-3.93H1.35V-4.94C1.35-5.03 1.33-5.06 1.28-5.06C1.23-4.97 1.17-4.89 1.11-4.81C.79-4.33 .49-4.01 .26-3.88C.17-3.82 .11-3.76 .11-3.71C.11-3.69 .12-3.67 .15-3.65H.61V-1.02C.61-.29 .87 .09 1.38 .09C1.82 .09 2.15-.12 2.44-.58Z'/>
<use id='eq180-g14-49' xlink:href='#eq180-g11-49' transform='scale(1.36)'/>
<use id='eq180-g14-97' xlink:href='#eq180-g11-97' transform='scale(1.36)'/>
<use id='eq180-g14-99' xlink:href='#eq180-g11-99' transform='scale(1.36)'/>
<use id='eq180-g14-101' xlink:href='#eq180-g11-101' transform='scale(1.36)'/>
<use id='eq180-g14-114' xlink:href='#eq180-g11-114' transform='scale(1.36)'/>
<use id='eq180-g14-116' xlink:href='#eq180-g11-116' transform='scale(1.36)'/>
<path id='eq180-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq180-g4-0' d='M5.01-2V-2.49H.54V-2H5.01Z'/>
<path id='eq180-g4-48' d='M2.59-3.59C2.59-3.9 2.28-4.11 2-4.11C1.68-4.11 1.52-3.79 1.43-3.53L.52-.88C.5-.81 .44-.66 .44-.58S.49-.39 .58-.39C.71-.39 .86-.58 .92-.67L2.35-2.93C2.47-3.12 2.59-3.36 2.59-3.59Z'/>
<path id='eq180-g7-26' d='M6.77-1.93L6.57-2.02C6.01-1.25 5.71-.95 5.19-.71C4.75-.51 3.94-.39 3.04-.39C2.37-.39 2.1-.51 2.1-.8C2.1-.94 2.23-1.49 2.53-2.54L2.91-3.91L3.84-3.87C3.87-3.87 3.91-3.87 3.93-3.87C4.35-3.87 4.65-3.8 4.76-3.69C4.82-3.63 4.85-3.53 4.85-3.32C4.85-3.11 4.82-2.97 4.76-2.7L5-2.64L5.81-5.41L5.6-5.46C5.15-4.44 5.03-4.36 3.95-4.32L3.01-4.3L3.8-7.07C3.87-7.34 3.99-7.38 4.67-7.38C6.54-7.38 6.96-7.23 6.96-6.52C6.96-6.36 6.94-6.18 6.93-5.98L7.18-5.96L7.55-7.78H1.63V-7.59C2.37-7.52 2.55-7.42 2.55-7.1C2.55-6.96 2.48-6.57 2.42-6.34L.95-1.07C.74-.38 .66-.31-.01-.19V0H6.03L6.77-1.93Z'/>
<path id='eq180-g7-149' d='M2.16-.51C2.16-.88 1.85-1.19 1.49-1.19S.83-.89 .83-.51C.83-.06 1.24 .13 1.49 .13S2.16-.07 2.16-.51Z'/>
</defs>
<g id='eq180-page1'>
<use x='144.62' y='-8.78' xlink:href='#eq180-g7-26'/>
<use x='152.75' y='-13.71' xlink:href='#eq180-g4-48'/>
<use x='159.35' y='-8.78' xlink:href='#eq180-g1-61'/>
<use x='190.12' y='-16.87' xlink:href='#eq180-g14-49'/>
<rect x='170.94' y='-12.18' height='.67' width='44.32'/>
<use x='170.94' y='-.13' xlink:href='#eq180-g14-116'/>
<use x='174.27' y='-.13' xlink:href='#eq180-g14-114'/>
<use x='178.25' y='-.13' xlink:href='#eq180-g14-97'/>
<use x='183.56' y='-.13' xlink:href='#eq180-g14-99'/>
<use x='188.86' y='-.13' xlink:href='#eq180-g14-101'/>
<use x='196.5' y='-.13' xlink:href='#eq180-g7-26'/>
<use x='204.81' y='-3.59' xlink:href='#eq180-g4-0'/>
<use x='210.38' y='-3.59' xlink:href='#eq180-g11-49'/>
<use x='218.79' y='-8.78' xlink:href='#eq180-g7-26'/>
<use x='227.1' y='-13.71' xlink:href='#eq180-g4-0'/>
<use x='232.67' y='-13.71' xlink:href='#eq180-g11-49'/>
<use x='241.07' y='-8.78' xlink:href='#eq180-g7-149'/>
</g>
</svg></div>
<p>In <code>"first"</code> mode, <span class="m-math"><svg style="width: 0.843em; height: 0.778em;" viewBox=".35 -7.78 8.43 7.78">
<title>
\(D\)
</title>
<defs>
<path id='eq186-g1-25' d='M8.34-4.57C8.34-6.53 6.98-7.78 4.86-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.1C2.47-6.92 2.42-6.63 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.92C4.28 0 5.53-.36 6.43-.99C7.62-1.82 8.34-3.17 8.34-4.57ZM7.02-4.86C7.02-3.56 6.52-2.24 5.71-1.43C5-.71 4.04-.36 2.8-.36C2.25-.36 2.02-.49 2.02-.8C2.02-.95 2.08-1.19 2.29-1.93L3.73-7.07C3.8-7.34 3.97-7.42 4.45-7.42C5.12-7.42 5.71-7.27 6.09-7C6.68-6.59 7.02-5.81 7.02-4.86Z'/>
</defs>
<g id='eq186-page1'>
<use x='.44' y='0' xlink:href='#eq186-g1-25'/>
</g>
</svg></span> is composed similarly, but the two eigenvalues of <span class="m-math"><svg style="width: 0.843em; height: 0.778em;" viewBox=".35 -7.78 8.43 7.78">
<title>
\(D\)
</title>
<defs>
<path id='eq187-g1-25' d='M8.34-4.57C8.34-6.53 6.98-7.78 4.86-7.78H1.55V-7.59C2.3-7.52 2.47-7.42 2.47-7.1C2.47-6.92 2.42-6.63 2.33-6.34L.87-1.07C.66-.38 .57-.31-.1-.19V0H2.92C4.28 0 5.53-.36 6.43-.99C7.62-1.82 8.34-3.17 8.34-4.57ZM7.02-4.86C7.02-3.56 6.52-2.24 5.71-1.43C5-.71 4.04-.36 2.8-.36C2.25-.36 2.02-.49 2.02-.8C2.02-.95 2.08-1.19 2.29-1.93L3.73-7.07C3.8-7.34 3.97-7.42 4.45-7.42C5.12-7.42 5.71-7.27 6.09-7C6.68-6.59 7.02-5.81 7.02-4.86Z'/>
</defs>
<g id='eq187-page1'>
<use x='.44' y='0' xlink:href='#eq187-g1-25'/>
</g>
</svg></span>, <span class="m-math"><svg style="width: 0.850em; height: 1.002em;" viewBox=".3 -8.13 8.5 10.02">
<title>
\(d_i\)
</title>
<defs>
<path id='eq188-g1-51' d='M4.15-.88L4.04-.97C3.56-.42 3.48-.35 3.33-.35C3.24-.35 3.17-.42 3.17-.52C3.17-.66 3.44-1.69 3.74-2.67L4.6-5.92L4.56-5.97C4.1-5.87 3.78-5.82 3.22-5.76V-5.62C3.7-5.6 3.76-5.57 3.76-5.39C3.76-5.27 3.76-5.24 3.63-4.78L3.25-3.35C3.18-3.71 3.02-3.85 2.68-3.85C1.55-3.85 .13-2.21 .13-.9C.13-.28 .48 .1 1.05 .1C1.64 .1 2.03-.18 2.62-1.06C2.52-.62 2.51-.48 2.51-.28C2.51-.04 2.65 .11 2.87 .11C3.24 .11 3.7-.24 4.15-.88ZM3.11-3.15C3.11-1.83 2.2-.32 1.4-.32C1.09-.32 .89-.55 .89-.9C.89-1.62 1.33-2.64 1.9-3.25C2.14-3.49 2.44-3.65 2.68-3.65C2.69-3.65 2.71-3.65 2.72-3.65C2.98-3.63 3.11-3.47 3.11-3.15Z'/>
<path id='eq188-g1-56' d='M2.05-.9L1.94-1C1.56-.5 1.37-.31 1.22-.31C1.15-.31 1.08-.38 1.08-.45C1.08-.59 1.17-.85 1.22-1.02L1.99-3.83L1.97-3.85C1.08-3.69 .91-3.66 .57-3.63V-3.49C1.04-3.49 1.12-3.46 1.12-3.28C1.12-3.21 1.09-3.07 1.04-2.9L.62-1.35C.48-.83 .43-.58 .43-.4C.43-.08 .57 .1 .83 .1C1.24 .1 1.55-.17 2.05-.9ZM2.41-5.14C2.41-5.39 2.21-5.62 1.97-5.62S1.56-5.42 1.56-5.15C1.56-4.87 1.73-4.69 1.98-4.69C2.21-4.69 2.41-4.89 2.41-5.14Z'/>
<use id='eq188-g4-51' xlink:href='#eq188-g1-51' transform='scale(1.36)'/>
</defs>
<g id='eq188-page1'>
<use x='.3' y='0' xlink:href='#eq188-g4-51'/>
<use x='6.39' y='1.79' xlink:href='#eq188-g1-56'/>
</g>
</svg></span>, are determined
from the eigenvalues <span class="m-math"><svg style="width: 0.945em; height: 0.772em;" viewBox="-.01 -5.25 9.45 7.72">
<title>
\(\mu_i\)
</title>
<defs>
<path id='eq189-g1-56' d='M2.05-.9L1.94-1C1.56-.5 1.37-.31 1.22-.31C1.15-.31 1.08-.38 1.08-.45C1.08-.59 1.17-.85 1.22-1.02L1.99-3.83L1.97-3.85C1.08-3.69 .91-3.66 .57-3.63V-3.49C1.04-3.49 1.12-3.46 1.12-3.28C1.12-3.21 1.09-3.07 1.04-2.9L.62-1.35C.48-.83 .43-.58 .43-.4C.43-.08 .57 .1 .83 .1C1.24 .1 1.55-.17 2.05-.9ZM2.41-5.14C2.41-5.39 2.21-5.62 1.97-5.62S1.56-5.42 1.56-5.15C1.56-4.87 1.73-4.69 1.98-4.69C2.21-4.69 2.41-4.89 2.41-5.14Z'/>
<path id='eq189-g1-96' d='M4.32-.67C4.32-.72 4.31-.75 4.29-.75C4.16-.75 4.17-.24 3.69-.24C3.56-.24 3.51-.35 3.51-.52C3.51-.74 3.6-1.07 3.69-1.42L4.3-3.85L3.54-3.72L2.84-1.09C2.82-1.05 2.31-.32 1.77-.32C1.28-.32 1.12-.78 1.12-1.12C1.12-1.22 1.14-1.32 1.15-1.4L1.77-3.85L1.13-3.74L.17 0C-.01 .71-.36 1.65-.43 1.81H.34L.9-.38H.91C.91-.37 .94 .1 1.57 .1C2.27 .1 2.7-.59 2.79-.7C2.78-.63 2.77-.57 2.77-.51C2.77 .07 3.3 .1 3.45 .1H3.48C4.08 .1 4.32-.47 4.32-.67Z'/>
<use id='eq189-g4-96' xlink:href='#eq189-g1-96' transform='scale(1.36)'/>
</defs>
<g id='eq189-page1'>
<use x='.57' y='0' xlink:href='#eq189-g4-96'/>
<use x='7.03' y='1.79' xlink:href='#eq189-g1-56'/>
</g>
</svg></span> of <span class="m-math"><svg style="width: 0.605em; height: 0.816em;" viewBox=".24 -7.94 6.05 8.16">
<title>
\(S\)
</title>
<defs>
<path id='eq190-g1-40' d='M5.13-2.17C5.13-2.94 4.87-3.39 3.79-4.49C2.7-5.57 2.61-5.74 2.61-6.32C2.61-7.07 3.11-7.54 3.92-7.54C4.36-7.54 4.72-7.4 4.97-7.11C5.24-6.81 5.34-6.41 5.36-5.61L5.57-5.57L6.05-7.94H5.78C5.61-7.69 5.5-7.63 5.24-7.63C5.09-7.63 4.94-7.67 4.69-7.77C4.44-7.87 4.05-7.93 3.68-7.93C2.44-7.93 1.56-7.11 1.56-5.94C1.56-5.3 1.74-4.95 2.45-4.19C2.61-4.04 2.76-3.87 2.92-3.69L3.38-3.19C3.94-2.61 4.1-2.3 4.1-1.79C4.1-.88 3.44-.2 2.56-.2C1.56-.2 .82-1.05 .82-2.22C.82-2.3 .82-2.35 .85-2.45L.61-2.48L.2 .18H.42C.5-.1 .63-.21 .87-.21C1-.21 1.17-.17 1.49-.06C2.04 .14 2.36 .21 2.73 .21C4.1 .21 5.13-.81 5.13-2.17Z'/>
</defs>
<g id='eq190-page1'>
<use x='.24' y='0' xlink:href='#eq190-g1-40'/>
</g>
</svg></span> (with <span class="m-math"><svg style="width: 3.842em; height: 0.930em;" viewBox="-.01 -6.84 38.42 9.3">
<title>
\(\mu_1 \ge \mu_2\)
</title>
<defs>
<path id='eq191-g1-21' d='M6.84-3.73V-3.97L.74-6.84V-6.16L5.69-3.84L.74-1.51V-.85L6.84-3.73ZM6.84 .69V.06H.74V.69H6.84Z'/>
<path id='eq191-g8-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq191-g8-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq191-g4-96' d='M5.9-.92C5.9-.99 5.88-1.02 5.85-1.02C5.67-1.02 5.68-.32 5.04-.32C4.86-.32 4.79-.48 4.79-.7C4.79-1.01 4.91-1.46 5.03-1.94L5.86-5.25L4.82-5.07L3.87-1.49C3.85-1.43 3.14-.44 2.42-.44C1.74-.44 1.52-1.06 1.52-1.52C1.52-1.67 1.55-1.8 1.57-1.91L2.42-5.25L1.54-5.1L.24 0C-.01 .96-.49 2.25-.58 2.47H.46L1.23-.51H1.24C1.24-.5 1.29 .13 2.14 .13C3.1 .13 3.68-.81 3.8-.95C3.79-.86 3.78-.77 3.78-.69C3.78 .1 4.5 .13 4.7 .13H4.74C5.56 .13 5.9-.64 5.9-.92Z'/>
</defs>
<g id='eq191-page1'>
<use x='.57' y='0' xlink:href='#eq191-g4-96'/>
<use x='7.21' y='1.79' xlink:href='#eq191-g8-49'/>
<use x='15.77' y='0' xlink:href='#eq191-g1-21'/>
<use x='27.63' y='0' xlink:href='#eq191-g4-96'/>
<use x='34.26' y='1.79' xlink:href='#eq191-g8-50'/>
</g>
</svg></span>) as follows:</p>
<div class="m-math"><svg style="width: 34.202em; height: 5.119em;" viewBox="22.52 -52.86 342.02 51.19">
<title>
\begin{eqnarray*}
      d_1 &amp;=&amp; \alpha
   \\ d_2 &amp;=&amp; \begin{cases}
                   \alpha + ( 1.0 - \alpha ) \exp\left(\frac{-c}{(\mu_1 - \mu_2)^2}\right) \, ,
                               &amp; \text{if}\ \frac{\mu_1 - \mu_2}{\mu_1 + \mu_2} &gt; \alpha \; \text{(high anisotropy)}
                \\ \alpha \, , &amp; \text{otherwise}
              \end{cases}
\end{eqnarray*}
</title>
<defs>
<path id='eq181-g27-40' d='M3.63 1.92C2.68 1.17 2.34 .75 2.02-.14C1.73-.94 1.6-1.85 1.6-3.05C1.6-4.3 1.76-5.28 2.08-6.03C2.41-6.77 2.77-7.2 3.63-7.89L3.53-8.08C2.64-7.51 2.28-7.2 1.84-6.65C.99-5.61 .57-4.41 .57-3.01C.57-1.49 1.02-.32 2.07 .9C2.56 1.47 2.87 1.73 3.49 2.12L3.63 1.92Z'/>
<path id='eq181-g27-41' d='M3.41-2.95C3.41-4.48 2.96-5.64 1.91-6.86C1.42-7.44 1.11-7.7 .49-8.08L.35-7.89C1.3-7.14 1.63-6.72 1.96-5.82C2.25-5.02 2.38-4.11 2.38-2.92C2.38-1.67 2.22-.68 1.9 .05C1.57 .8 1.21 1.23 .35 1.92L.45 2.12C1.34 1.54 1.7 1.23 2.14 .68C2.99-.36 3.41-1.55 3.41-2.95Z'/>
<path id='eq181-g27-97' d='M5.28-.48V-.79C5.08-.62 4.94-.56 4.76-.56C4.48-.56 4.4-.73 4.4-1.26V-3.59C4.4-4.2 4.34-4.53 4.17-4.81C3.92-5.26 3.41-5.5 2.68-5.5C2.07-5.5 1.49-5.33 1.16-5.06C.86-4.81 .67-4.46 .67-4.16C.67-3.89 .9-3.65 1.18-3.65S1.72-3.89 1.72-4.15C1.72-4.2 1.71-4.26 1.7-4.34C1.67-4.45 1.66-4.54 1.66-4.63C1.66-4.95 2.04-5.21 2.52-5.21C3.11-5.21 3.43-4.87 3.43-4.22V-3.49C1.59-2.75 1.39-2.65 .87-2.2C.61-1.96 .44-1.55 .44-1.16C.44-.41 .96 .12 1.7 .12C2.22 .12 2.71-.13 3.44-.75C3.5-.12 3.72 .12 4.21 .12C4.61 .12 4.87-.02 5.28-.48ZM3.43-1.47C3.43-1.1 3.37-.99 3.12-.84C2.83-.67 2.5-.57 2.25-.57C1.83-.57 1.49-.98 1.49-1.49V-1.54C1.49-2.25 1.98-2.68 3.43-3.2V-1.47Z'/>
<path id='eq181-g27-101' d='M5.07-1.88L4.88-1.96C4.3-1.05 3.79-.71 3.02-.71C2.37-.71 1.87-1.02 1.52-1.66C1.28-2.13 1.18-2.55 1.16-3.31H4.84C4.75-4.09 4.63-4.44 4.33-4.82C3.97-5.25 3.42-5.5 2.8-5.5C1.32-5.5 .3-4.3 .3-2.56C.3-.91 1.16 .12 2.53 .12C3.68 .12 4.57-.59 5.07-1.88ZM3.62-3.69H1.18C1.32-4.64 1.72-5.07 2.45-5.07S3.47-4.73 3.62-3.69Z'/>
<path id='eq181-g27-102' d='M4.58-7.42C4.58-7.85 4.05-8.17 3.34-8.17C2.58-8.17 1.96-7.84 1.65-7.3S1.24-6.34 1.23-5.38H.25V-5H1.23V-1.24C1.23-.37 1.1-.23 .24-.18V0H3.35V-.18C2.37-.22 2.24-.35 2.24-1.24V-5H3.69V-5.38H2.22V-6.77C2.22-7.47 2.45-7.83 2.91-7.83C3.17-7.83 3.32-7.71 3.54-7.36C3.73-7.04 3.87-6.93 4.08-6.93C4.36-6.93 4.58-7.15 4.58-7.42Z'/>
<path id='eq181-g27-103' d='M5.62-4.64V-5.1H4.7C4.46-5.1 4.28-5.14 4.04-5.22L3.78-5.32C3.46-5.44 3.13-5.5 2.82-5.5C1.71-5.5 .82-4.64 .82-3.55C.82-2.8 1.15-2.34 1.94-1.95L1.42-1.47C1.03-1.12 .87-.88 .87-.65C.87-.39 1.02-.25 1.51-.01C.66 .61 .33 1 .33 1.45C.33 2.08 1.27 2.61 2.4 2.61C3.3 2.61 4.23 2.3 4.85 1.79C5.31 1.42 5.51 1.04 5.51 .59C5.51-.16 4.95-.66 4.06-.69L2.52-.77C1.89-.79 1.59-.9 1.59-1.09C1.59-1.33 1.98-1.75 2.31-1.84C2.41-1.83 2.5-1.82 2.53-1.82C2.76-1.79 2.92-1.78 2.99-1.78C3.43-1.78 3.91-1.96 4.28-2.28C4.67-2.62 4.85-3.04 4.85-3.63C4.85-3.98 4.79-4.26 4.63-4.64H5.62ZM5.18 .77C5.18 1.46 4.27 1.92 2.92 1.92C1.87 1.92 1.17 1.58 1.17 1.05C1.17 .78 1.26 .62 1.76 .02C2.15 .11 3.11 .18 3.69 .18C4.78 .18 5.18 .33 5.18 .77ZM3.93-3.17C3.93-2.5 3.59-2.08 3.04-2.08C2.32-2.08 1.82-2.86 1.82-4V-4.04C1.82-4.75 2.15-5.16 2.7-5.16C3.07-5.16 3.38-4.96 3.57-4.6C3.79-4.18 3.93-3.63 3.93-3.17Z'/>
<path id='eq181-g27-104' d='M5.82 0V-.18C5.18-.3 5.1-.39 5.1-1.22V-3.6C5.1-4.85 4.6-5.5 3.63-5.5C2.93-5.5 2.43-5.21 1.88-4.5V-8.13L1.82-8.17C1.41-8.02 1.11-7.93 .44-7.73L.12-7.64V-7.45C.17-7.46 .2-7.46 .26-7.46C.78-7.46 .87-7.36 .87-6.85V-1.22C.87-.38 .8-.27 .11-.18V0H2.69V-.18C2-.25 1.88-.39 1.88-1.22V-4.1C2.38-4.65 2.74-4.85 3.2-4.85C3.8-4.85 4.1-4.42 4.1-3.59V-1.22C4.1-.41 3.98-.25 3.29-.18V0H5.82Z'/>
<path id='eq181-g27-105' d='M3.02 0V-.18C2.24-.24 2.14-.36 2.14-1.22V-5.46L2.09-5.5L.24-4.84V-4.66L.33-4.67C.48-4.7 .63-4.71 .74-4.71C1.03-4.71 1.14-4.52 1.14-3.99V-1.22C1.14-.36 1.02-.23 .19-.18V0H3.02ZM2.25-7.56C2.25-7.89 1.98-8.17 1.64-8.17C1.3-8.17 1.03-7.89 1.03-7.56C1.03-7.21 1.3-6.95 1.64-6.95C1.98-6.95 2.25-7.21 2.25-7.56Z'/>
<path id='eq181-g27-110' d='M5.8 0V-.18C5.21-.24 5.07-.38 5.07-.97V-3.71C5.07-4.83 4.54-5.5 3.66-5.5C3.11-5.5 2.74-5.3 1.92-4.53V-5.48L1.84-5.5C1.26-5.28 .85-5.15 .19-4.96V-4.76C.26-4.79 .38-4.81 .51-4.81C.85-4.81 .96-4.63 .96-4.04V-1.08C.96-.39 .82-.23 .22-.18V0H2.75V-.18C2.14-.23 1.96-.37 1.96-.8V-4.16C2.53-4.7 2.8-4.84 3.19-4.84C3.78-4.84 4.06-4.47 4.06-3.68V-1.18C4.06-.43 3.91-.23 3.31-.18V0H5.8Z'/>
<path id='eq181-g27-111' d='M5.62-2.8C5.62-4.36 4.52-5.5 2.99-5.5C1.43-5.5 .35-4.35 .35-2.7C.35-1.09 1.46 .12 2.96 .12S5.62-1.15 5.62-2.8ZM4.54-2.38C4.54-1.03 4-.22 3.11-.22C2.64-.22 2.2-.5 1.95-.98C1.61-1.6 1.42-2.44 1.42-3.29C1.42-4.42 1.98-5.16 2.83-5.16C3.84-5.16 4.54-4.02 4.54-2.38Z'/>
<path id='eq181-g27-112' d='M5.62-2.95C5.62-4.44 4.78-5.5 3.62-5.5C2.95-5.5 2.43-5.2 1.9-4.55V-5.48L1.83-5.5C1.18-5.25 .77-5.09 .11-4.89V-4.7C.22-4.71 .3-4.71 .41-4.71C.81-4.71 .9-4.59 .9-4.03V1.57C.9 2.19 .77 2.32 .06 2.39V2.59H2.95V2.38C2.06 2.37 1.9 2.24 1.9 1.48V-.39C2.32 0 2.61 .12 3.11 .12C4.52 .12 5.62-1.22 5.62-2.95ZM4.59-2.49C4.59-1.16 4-.26 3.14-.26C2.58-.26 1.9-.69 1.9-1.05V-3.99C1.9-4.35 2.57-4.78 3.12-4.78C4-4.78 4.59-3.87 4.59-2.49Z'/>
<path id='eq181-g27-114' d='M4-4.87C4-5.26 3.75-5.5 3.35-5.5C2.85-5.5 2.5-5.22 1.91-4.38V-5.48L1.85-5.5C1.22-5.24 .79-5.08 .08-4.85V-4.66C.25-4.7 .36-4.71 .5-4.71C.8-4.71 .91-4.52 .91-3.99V-1C.91-.41 .82-.32 .06-.18V0H2.93V-.18C2.12-.22 1.91-.39 1.91-1.08V-3.77C1.91-4.15 2.43-4.75 2.75-4.75C2.82-4.75 2.93-4.69 3.06-4.57C3.25-4.4 3.38-4.33 3.54-4.33C3.83-4.33 4-4.53 4-4.87Z'/>
<path id='eq181-g27-115' d='M4.16-1.41C4.16-2.01 3.89-2.4 3.16-2.83L1.87-3.6C1.53-3.79 1.35-4.09 1.35-4.41C1.35-4.9 1.72-5.22 2.27-5.22C2.95-5.22 3.31-4.83 3.59-3.75H3.77L3.72-5.38H3.59L3.56-5.36C3.46-5.27 3.44-5.26 3.4-5.26C3.32-5.26 3.2-5.28 3.07-5.34C2.82-5.44 2.55-5.49 2.26-5.49C1.28-5.49 .61-4.89 .61-4.02C.61-3.35 .99-2.88 2.01-2.3L2.7-1.9C3.12-1.66 3.32-1.37 3.32-1C3.32-.48 2.94-.14 2.33-.14C1.51-.14 1.09-.6 .81-1.82H.62V.05H.78C.86-.07 .91-.1 1.05-.1C1.18-.1 1.32-.07 1.6 0C1.94 .07 2.24 .12 2.49 .12C3.4 .12 4.16-.57 4.16-1.41Z'/>
<path id='eq181-g27-116' d='M3.34-.79L3.18-.92C2.92-.61 2.73-.5 2.46-.5C2.02-.5 1.84-.81 1.84-1.58V-5H3.05V-5.38H1.84V-6.77C1.84-6.89 1.82-6.92 1.76-6.92C1.69-6.8 1.6-6.69 1.52-6.59C1.08-5.93 .67-5.49 .36-5.31C.23-5.22 .16-5.15 .16-5.08C.16-5.05 .17-5.02 .2-5H.84V-1.4C.84-.39 1.2 .12 1.89 .12C2.49 .12 2.94-.17 3.34-.79Z'/>
<path id='eq181-g27-119' d='M8.3-5.2V-5.38H6.83V-5.2C7.23-5.12 7.35-5.03 7.35-4.83C7.35-4.65 7.28-4.36 7.15-4.04L6.07-1.39L5.07-4.06C4.87-4.61 4.87-4.61 4.87-4.77C4.87-5.03 5-5.12 5.56-5.2V-5.38H3.13V-5.2C3.57-5.15 3.72-5.02 3.96-4.38L4.2-3.71L3.11-1.33L1.92-4.45C1.88-4.57 1.85-4.69 1.85-4.81C1.85-5.06 2-5.15 2.4-5.2V-5.38H.25V-5.2C.53-5.18 .62-5.06 .88-4.45L2.5-.36C2.64 0 2.74 .17 2.81 .17C2.87 .17 2.96 .01 3.11-.3L4.45-3.17L5.54-.35C5.7 .1 5.75 .17 5.82 .17C5.91 .17 5.97 .06 6.16-.42L7.81-4.55C8.02-5.06 8.06-5.12 8.3-5.2Z'/>
<path id='eq181-g27-121' d='M5.68-5.2V-5.38H4.06V-5.2C4.45-5.2 4.64-5.09 4.64-4.9C4.64-4.85 4.63-4.78 4.59-4.7L3.43-1.4L2.06-4.42C1.98-4.59 1.94-4.75 1.94-4.88C1.94-5.09 2.12-5.18 2.63-5.2V-5.38H.17V-5.21C.48-5.16 .68-5.03 .78-4.83L2.75-.67C2.83-.47 2.88-.32 2.88-.23C2.88-.05 2.61 .71 2.4 1.06C2.24 1.37 1.97 1.6 1.81 1.6C1.73 1.6 1.63 1.58 1.51 1.52C1.28 1.43 1.08 1.39 .87 1.39C.6 1.39 .36 1.63 .36 1.91C.36 2.31 .74 2.61 1.24 2.61C2.04 2.61 2.62 1.94 3.26 .22L5.1-4.66C5.26-5.05 5.39-5.16 5.68-5.2Z'/>
<path id='eq181-g13-50' d='M3.2-.84L3.06-.93C2.58-.41 2.24-.22 1.81-.22C1.31-.22 1.01-.59 1.01-1.21C1.01-1.96 1.32-2.73 1.81-3.25C2.06-3.51 2.41-3.67 2.76-3.67C2.96-3.67 3.08-3.6 3.08-3.49C3.08-3.45 3.07-3.41 3.03-3.33C2.97-3.21 2.95-3.16 2.95-3.07C2.95-2.86 3.08-2.74 3.29-2.74C3.54-2.74 3.71-2.91 3.71-3.14C3.71-3.55 3.33-3.85 2.79-3.85C1.48-3.85 .26-2.58 .26-1.21C.26-.38 .73 .1 1.55 .1C2.2 .1 2.66-.17 3.2-.84Z'/>
<path id='eq181-g13-51' d='M4.15-.88L4.04-.97C3.56-.42 3.48-.35 3.33-.35C3.24-.35 3.17-.42 3.17-.52C3.17-.66 3.44-1.69 3.74-2.67L4.6-5.92L4.56-5.97C4.1-5.87 3.78-5.82 3.22-5.76V-5.62C3.7-5.6 3.76-5.57 3.76-5.39C3.76-5.27 3.76-5.24 3.63-4.78L3.25-3.35C3.18-3.71 3.02-3.85 2.68-3.85C1.55-3.85 .13-2.21 .13-.9C.13-.28 .48 .1 1.05 .1C1.64 .1 2.03-.18 2.62-1.06C2.52-.62 2.51-.48 2.51-.28C2.51-.04 2.65 .11 2.87 .11C3.24 .11 3.7-.24 4.15-.88ZM3.11-3.15C3.11-1.83 2.2-.32 1.4-.32C1.09-.32 .89-.55 .89-.9C.89-1.62 1.33-2.64 1.9-3.25C2.14-3.49 2.44-3.65 2.68-3.65C2.69-3.65 2.71-3.65 2.72-3.65C2.98-3.63 3.11-3.47 3.11-3.15Z'/>
<path id='eq181-g13-85' d='M5.1-3.59L4.5-3.5C4.26-2.83 3.57-1.8 3.57-1.79H3.56C3.56-1.8 3.71-2.17 3.71-2.64C3.71-3.21 3.51-3.85 2.58-3.85C1.11-3.85 .21-2.31 .21-1.25C.21-.51 .6 .1 1.51 .1C2.2 .1 2.73-.44 2.73-.45H2.73C2.73-.38 2.75 .08 3.39 .08C4.09 .08 4.5-.71 4.5-.91C4.5-.93 4.49-.95 4.47-.95C4.36-.95 4.15-.24 3.64-.24C3.45-.24 3.4-.45 3.4-.68C3.4-.87 3.43-1.07 3.47-1.16C3.59-1.33 5.1-3.58 5.1-3.59ZM3.07-2.58C3.07-1.75 2.75-.79 2.75-.79S2.31-.12 1.64-.12C1.45-.12 .98-.18 .98-1.3C.98-1.75 1.21-3.63 2.43-3.63C3.02-3.63 3.07-2.89 3.07-2.58Z'/>
<path id='eq181-g13-96' d='M4.32-.67C4.32-.72 4.31-.75 4.29-.75C4.16-.75 4.17-.24 3.69-.24C3.56-.24 3.51-.35 3.51-.52C3.51-.74 3.6-1.07 3.69-1.42L4.3-3.85L3.54-3.72L2.84-1.09C2.82-1.05 2.31-.32 1.77-.32C1.28-.32 1.12-.78 1.12-1.12C1.12-1.22 1.14-1.32 1.15-1.4L1.77-3.85L1.13-3.74L.17 0C-.01 .71-.36 1.65-.43 1.81H.34L.9-.38H.91C.91-.37 .94 .1 1.57 .1C2.27 .1 2.7-.59 2.79-.7C2.78-.63 2.77-.57 2.77-.51C2.77 .07 3.3 .1 3.45 .1H3.48C4.08 .1 4.32-.47 4.32-.67Z'/>
<path id='eq181-g13-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
<path id='eq181-g13-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq181-g13-161' d='M5.01-2.16V-2.33L.54-4.44V-3.95L4.18-2.24L.54-.54V-.05L5.01-2.16Z'/>
<path id='eq181-g7-0' d='M5.01-2V-2.49H.54V-2H5.01Z'/>
<path id='eq181-g7-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<path id='eq181-g7-185' d='M2.58-6.26C1.31-5.44 .42-4.03 .42-2.24C.42-.62 1.35 1.02 2.55 1.76L2.66 1.62C1.5 .72 1.17-.34 1.17-2.27C1.17-4.21 1.53-5.21 2.66-6.12L2.58-6.26Z'/>
<path id='eq181-g7-186' d='M.33-6.26L.25-6.12C1.38-5.21 1.74-4.21 1.74-2.27C1.74-.34 1.41 .72 .25 1.62L.36 1.76C1.56 1.02 2.49-.62 2.49-2.24C2.49-4.03 1.6-5.44 .33-6.26Z'/>
<use id='eq181-g26-48' xlink:href='#eq181-g20-48' transform='scale(1.82)'/>
<use id='eq181-g26-49' xlink:href='#eq181-g20-49' transform='scale(1.82)'/>
<use id='eq181-g26-101' xlink:href='#eq181-g20-101' transform='scale(1.82)'/>
<use id='eq181-g26-112' xlink:href='#eq181-g20-112' transform='scale(1.82)'/>
<use id='eq181-g26-120' xlink:href='#eq181-g20-120' transform='scale(1.82)'/>
<use id='eq181-g10-0' xlink:href='#eq181-g7-0' transform='scale(1.36)'/>
<use id='eq181-g10-184' xlink:href='#eq181-g7-184' transform='scale(1.36)'/>
<use id='eq181-g10-185' xlink:href='#eq181-g7-185' transform='scale(1.36)'/>
<use id='eq181-g10-186' xlink:href='#eq181-g7-186' transform='scale(1.36)'/>
<path id='eq181-g20-48' d='M3.12-2.16C3.12-3.5 2.52-4.43 1.66-4.43C1.3-4.43 1.03-4.32 .79-4.09C.41-3.72 .16-2.97 .16-2.2C.16-1.49 .37-.72 .68-.35C.92-.07 1.26 .09 1.64 .09C1.97 .09 2.25-.02 2.49-.25C2.87-.61 3.12-1.37 3.12-2.16ZM2.49-2.15C2.49-.78 2.2-.08 1.64-.08S.79-.78 .79-2.14C.79-3.53 1.08-4.26 1.64-4.26C2.19-4.26 2.49-3.52 2.49-2.15Z'/>
<path id='eq181-g20-49' d='M2.58 0V-.1C2.06-.1 1.96-.17 1.96-.48V-4.42L1.91-4.43L.73-3.83V-3.74C.81-3.77 .88-3.8 .9-3.81C1.02-3.86 1.13-3.88 1.2-3.88C1.34-3.88 1.4-3.79 1.4-3.58V-.61C1.4-.39 1.34-.24 1.24-.18C1.14-.12 1.05-.1 .77-.1V0H2.58Z'/>
<path id='eq181-g20-50' d='M3.11-.9L3.03-.93C2.78-.56 2.7-.5 2.4-.5H.84L1.94-1.65C2.52-2.26 2.78-2.76 2.78-3.27C2.78-3.92 2.25-4.43 1.57-4.43C1.21-4.43 .86-4.28 .62-4.02C.41-3.8 .31-3.59 .2-3.12L.34-3.09C.6-3.73 .84-3.94 1.29-3.94C1.84-3.94 2.21-3.57 2.21-3.02C2.21-2.51 1.91-1.9 1.36-1.32L.2-.08V0H2.75L3.11-.9Z'/>
<path id='eq181-g20-101' d='M2.78-1.03L2.67-1.07C2.36-.58 2.08-.39 1.66-.39C1.3-.39 1.02-.56 .83-.91C.7-1.17 .65-1.4 .64-1.81H2.65C2.6-2.24 2.54-2.43 2.37-2.64C2.17-2.88 1.87-3.01 1.53-3.01C.72-3.01 .16-2.36 .16-1.4C.16-.5 .64 .07 1.39 .07C2.02 .07 2.5-.32 2.78-1.03ZM1.98-2.02H.65C.72-2.54 .94-2.78 1.34-2.78S1.9-2.59 1.98-2.02Z'/>
<path id='eq181-g20-112' d='M3.08-1.62C3.08-2.43 2.62-3.01 1.98-3.01C1.62-3.01 1.33-2.85 1.04-2.5V-3L1-3.01C.65-2.88 .42-2.79 .06-2.68V-2.57C.12-2.58 .16-2.58 .22-2.58C.45-2.58 .49-2.52 .49-2.21V.86C.49 1.2 .42 1.27 .03 1.31V1.42H1.62V1.3C1.13 1.3 1.04 1.22 1.04 .81V-.22C1.27 0 1.43 .07 1.7 .07C2.48 .07 3.08-.67 3.08-1.62ZM2.52-1.36C2.52-.64 2.19-.14 1.72-.14C1.41-.14 1.04-.38 1.04-.58V-2.19C1.04-2.38 1.41-2.62 1.71-2.62C2.19-2.62 2.52-2.12 2.52-1.36Z'/>
<path id='eq181-g20-120' d='M3.14 0V-.1C2.93-.1 2.8-.2 2.6-.49L1.76-1.78L2.31-2.56C2.43-2.74 2.63-2.84 2.84-2.85V-2.95H1.8V-2.85C2-2.84 2.06-2.8 2.06-2.71C2.06-2.63 1.98-2.48 1.82-2.28C1.79-2.24 1.71-2.12 1.62-1.99L1.53-2.12C1.35-2.4 1.23-2.62 1.23-2.71C1.23-2.8 1.32-2.84 1.51-2.85V-2.95H.16V-2.85H.22C.41-2.85 .52-2.76 .72-2.46L1.34-1.51L.59-.43C.39-.16 .33-.12 .11-.1V0H1.06V-.1C.88-.1 .8-.13 .8-.22C.8-.26 .85-.35 .93-.48L1.45-1.29L2.04-.37C2.07-.33 2.08-.29 2.08-.26C2.08-.14 2.04-.11 1.82-.1V0H3.14Z'/>
<path id='eq181-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<use id='eq181-g23-49' xlink:href='#eq181-g20-49' transform='scale(1.33)'/>
<use id='eq181-g23-50' xlink:href='#eq181-g20-50' transform='scale(1.33)'/>
<path id='eq181-g4-16' d='M3.88 20.41C2.17 18.38 1.69 13.35 1.69 10.05S2.17 1.74 3.88-.3L3.73-.67C2.43 .81 .6 4.13 .6 10.05S2.36 19.3 3.73 20.77L3.88 20.41Z'/>
<path id='eq181-g4-17' d='M.36 20.41L.51 20.77C1.88 19.3 3.64 15.97 3.64 10.05S1.81 .81 .51-.67L.36-.3C2.07 1.74 2.55 6.75 2.55 10.05S2.07 18.38 .36 20.41Z'/>
<path id='eq181-g4-40' d='M6.12 35.06C6.12 34.95 5.93 34.85 5.79 34.77C4.38 34 3.87 31.94 3.87 29.53V21C3.87 19.97 3.63 18.06 1.66 17.2C3.63 16.34 3.87 14.42 3.87 13.4V4.92C3.87 2.5 4.38 .44 5.79-.32C5.93-.4 6.12-.5 6.12-.62C6.12-.66 6.09-.67 6.04-.67C5.97-.67 5.86-.64 5.81-.62C5.01-.37 2.88 .74 2.88 4.94V13.4C2.88 16.45 .58 17.2 .57 17.2C.58 17.2 2.88 17.95 2.88 21V29.5C2.88 33.71 5.01 34.81 5.81 35.06C5.86 35.09 5.97 35.11 6.04 35.11C6.09 35.11 6.12 35.1 6.12 35.06Z'/>
<use id='eq181-g16-51' xlink:href='#eq181-g13-51' transform='scale(1.36)'/>
<use id='eq181-g16-85' xlink:href='#eq181-g13-85' transform='scale(1.36)'/>
<use id='eq181-g16-149' xlink:href='#eq181-g13-149' transform='scale(1.36)'/>
<use id='eq181-g16-150' xlink:href='#eq181-g13-150' transform='scale(1.36)'/>
<use id='eq181-g16-161' xlink:href='#eq181-g13-161' transform='scale(1.36)'/>
</defs>
<g id='eq181-page1'>
<use x='22.52' y='-44.73' xlink:href='#eq181-g16-51'/>
<use x='28.79' y='-42.93' xlink:href='#eq181-g23-49'/>
<use x='43.63' y='-44.73' xlink:href='#eq181-g1-61'/>
<use x='60.76' y='-44.73' xlink:href='#eq181-g16-85'/>
<use x='22.52' y='-16.4' xlink:href='#eq181-g16-51'/>
<use x='28.79' y='-14.61' xlink:href='#eq181-g23-50'/>
<use x='43.63' y='-16.4' xlink:href='#eq181-g1-61'/>
<use x='61.27' y='-36.79' xlink:href='#eq181-g4-40'/>
<use x='68.31' y='-25.07' xlink:href='#eq181-g16-85'/>
<use x='78.35' y='-25.07' xlink:href='#eq181-g10-184'/>
<use x='88.34' y='-25.07' xlink:href='#eq181-g10-185'/>
<use x='92.8' y='-25.07' xlink:href='#eq181-g26-49'/>
<use x='98.97' y='-25.07' xlink:href='#eq181-g16-149'/>
<use x='102.16' y='-25.07' xlink:href='#eq181-g26-48'/>
<use x='110.8' y='-25.07' xlink:href='#eq181-g10-0'/>
<use x='121.14' y='-25.07' xlink:href='#eq181-g16-85'/>
<use x='128.52' y='-25.07' xlink:href='#eq181-g10-186'/>
<use x='135.09' y='-25.07' xlink:href='#eq181-g26-101'/>
<use x='139.98' y='-25.07' xlink:href='#eq181-g26-120'/>
<use x='145.96' y='-25.07' xlink:href='#eq181-g26-112'/>
<use x='154.88' y='-38.28' xlink:href='#eq181-g4-16'/>
<use x='172.95' y='-29.78' xlink:href='#eq181-g7-0'/>
<use x='178.62' y='-29.78' xlink:href='#eq181-g13-50'/>
<rect x='160.57' y='-28.48' height='.67' width='34.57'/>
<use x='161.01' y='-20.17' xlink:href='#eq181-g7-185'/>
<use x='164.7' y='-20.17' xlink:href='#eq181-g13-96'/>
<use x='169.57' y='-18.82' xlink:href='#eq181-g20-49'/>
<use x='173.35' y='-20.17' xlink:href='#eq181-g7-0'/>
<use x='179.35' y='-20.17' xlink:href='#eq181-g13-96'/>
<use x='184.22' y='-18.82' xlink:href='#eq181-g20-50'/>
<use x='188' y='-20.17' xlink:href='#eq181-g7-186'/>
<use x='191.36' y='-22.7' xlink:href='#eq181-g20-50'/>
<use x='196.58' y='-38.28' xlink:href='#eq181-g4-17'/>
<use x='205.78' y='-25.07' xlink:href='#eq181-g16-150'/>
<use x='220.85' y='-25.07' xlink:href='#eq181-g27-105'/>
<use x='224.18' y='-25.07' xlink:href='#eq181-g27-102'/>
<use x='232.76' y='-30.97' xlink:href='#eq181-g13-96'/>
<use x='237.63' y='-29.62' xlink:href='#eq181-g20-49'/>
<use x='241.41' y='-30.97' xlink:href='#eq181-g7-0'/>
<use x='247.41' y='-30.97' xlink:href='#eq181-g13-96'/>
<use x='252.28' y='-29.62' xlink:href='#eq181-g20-50'/>
<rect x='232.34' y='-28.48' height='.67' width='23.72'/>
<use x='233.08' y='-20.95' xlink:href='#eq181-g13-96'/>
<use x='237.94' y='-19.6' xlink:href='#eq181-g20-49'/>
<use x='241.73' y='-20.95' xlink:href='#eq181-g7-184'/>
<use x='247.1' y='-20.95' xlink:href='#eq181-g13-96'/>
<use x='251.96' y='-19.6' xlink:href='#eq181-g20-50'/>
<use x='260.83' y='-25.07' xlink:href='#eq181-g16-161'/>
<use x='272.1' y='-25.07' xlink:href='#eq181-g16-85'/>
<use x='282.8' y='-25.07' xlink:href='#eq181-g27-40'/>
<use x='286.78' y='-25.07' xlink:href='#eq181-g27-104'/>
<use x='292.76' y='-25.07' xlink:href='#eq181-g27-105'/>
<use x='296.08' y='-25.07' xlink:href='#eq181-g27-103'/>
<use x='302.06' y='-25.07' xlink:href='#eq181-g27-104'/>
<use x='311.02' y='-25.07' xlink:href='#eq181-g27-97'/>
<use x='316.33' y='-25.07' xlink:href='#eq181-g27-110'/>
<use x='322.31' y='-25.07' xlink:href='#eq181-g27-105'/>
<use x='325.63' y='-25.07' xlink:href='#eq181-g27-115'/>
<use x='330.28' y='-25.07' xlink:href='#eq181-g27-111'/>
<use x='336.26' y='-25.07' xlink:href='#eq181-g27-116'/>
<use x='339.59' y='-25.07' xlink:href='#eq181-g27-114'/>
<use x='343.57' y='-25.07' xlink:href='#eq181-g27-111'/>
<use x='349.54' y='-25.07' xlink:href='#eq181-g27-112'/>
<use x='355.16' y='-25.07' xlink:href='#eq181-g27-121'/>
<use x='361.14' y='-25.07' xlink:href='#eq181-g27-41'/>
<use x='68.31' y='-5.2' xlink:href='#eq181-g16-85'/>
<use x='77.68' y='-5.2' xlink:href='#eq181-g16-150'/>
<use x='220.85' y='-5.2' xlink:href='#eq181-g27-111'/>
<use x='226.83' y='-5.2' xlink:href='#eq181-g27-116'/>
<use x='230.15' y='-5.2' xlink:href='#eq181-g27-104'/>
<use x='236.13' y='-5.2' xlink:href='#eq181-g27-101'/>
<use x='241.44' y='-5.2' xlink:href='#eq181-g27-114'/>
<use x='245.66' y='-5.2' xlink:href='#eq181-g27-119'/>
<use x='254.29' y='-5.2' xlink:href='#eq181-g27-105'/>
<use x='257.62' y='-5.2' xlink:href='#eq181-g27-115'/>
<use x='262.27' y='-5.2' xlink:href='#eq181-g27-101'/>
</g>
</svg></div>
<p><span class="m-math"><svg style="width: 0.696em; height: 0.538em;" viewBox=".08 -5.25 6.96 5.38">
<title>
\(\alpha\)
</title>
<defs>
<path id='eq192-g1-85' d='M6.96-4.9L6.13-4.78C5.81-3.86 4.87-2.45 4.87-2.44H4.86C4.86-2.45 5.06-2.97 5.06-3.6C5.06-4.38 4.79-5.25 3.51-5.25C1.51-5.25 .29-3.14 .29-1.7C.29-.69 .82 .13 2.06 .13C3 .13 3.72-.6 3.72-.61H3.73C3.73-.51 3.75 .11 4.62 .11C5.57 .11 6.13-.96 6.13-1.24C6.13-1.27 6.12-1.3 6.1-1.3C5.94-1.3 5.66-.32 4.97-.32C4.7-.32 4.63-.62 4.63-.93C4.63-1.19 4.68-1.46 4.73-1.58C4.9-1.81 6.96-4.88 6.96-4.9ZM4.19-3.51C4.19-2.38 3.75-1.08 3.75-1.07S3.14-.17 2.24-.17C1.98-.17 1.33-.25 1.33-1.77C1.33-2.38 1.64-4.95 3.31-4.95C4.12-4.95 4.19-3.94 4.19-3.51Z'/>
</defs>
<g id='eq192-page1'>
<use x='.08' y='0' xlink:href='#eq192-g1-85'/>
</g>
</svg></span> is a magic number set to 0.01, and <span class="m-math"><svg style="width: 0.506em; height: 0.538em;" viewBox=".13 -5.25 5.06 5.38">
<title>
\(c\)
</title>
<defs>
<path id='eq193-g1-50' d='M4.36-1.14L4.17-1.26C3.51-.56 3.05-.3 2.47-.3C1.79-.3 1.38-.8 1.38-1.66C1.38-2.67 1.8-3.73 2.47-4.43C2.81-4.79 3.29-5 3.76-5C4.04-5 4.2-4.91 4.2-4.76C4.2-4.7 4.19-4.65 4.13-4.54C4.05-4.38 4.03-4.31 4.03-4.19C4.03-3.91 4.2-3.74 4.49-3.74C4.82-3.74 5.06-3.97 5.06-4.29C5.06-4.85 4.54-5.25 3.81-5.25C2.02-5.25 .36-3.51 .36-1.66C.36-.52 1 .13 2.11 .13C3 .13 3.63-.23 4.36-1.14Z'/>
</defs>
<g id='eq193-page1'>
<use x='.13' y='0' xlink:href='#eq193-g1-50'/>
</g>
</svg></span> is set to the median of all <span class="m-math"><svg style="width: 1.143em; height: 1.450em;" viewBox="-.01 -10.24 11.43 14.5">
<title>
\(\mu_2^2\)
</title>
<defs>
<path id='eq194-g5-50' d='M4.15-1.2L4.04-1.24C3.71-.74 3.6-.66 3.21-.66H1.12L2.59-2.2C3.36-3.01 3.7-3.68 3.7-4.36C3.7-5.23 3-5.9 2.09-5.9C1.61-5.9 1.15-5.71 .83-5.36C.55-5.07 .42-4.79 .27-4.17L.45-4.12C.8-4.98 1.12-5.26 1.72-5.26C2.45-5.26 2.95-4.76 2.95-4.03C2.95-3.35 2.55-2.53 1.82-1.76L.26-.1V0H3.67L4.15-1.2Z'/>
<path id='eq194-g1-96' d='M5.9-.92C5.9-.99 5.88-1.02 5.85-1.02C5.67-1.02 5.68-.32 5.04-.32C4.86-.32 4.79-.48 4.79-.7C4.79-1.01 4.91-1.46 5.03-1.94L5.86-5.25L4.82-5.07L3.87-1.49C3.85-1.43 3.14-.44 2.42-.44C1.74-.44 1.52-1.06 1.52-1.52C1.52-1.67 1.55-1.8 1.57-1.91L2.42-5.25L1.54-5.1L.24 0C-.01 .96-.49 2.25-.58 2.47H.46L1.23-.51H1.24C1.24-.5 1.29 .13 2.14 .13C3.1 .13 3.68-.81 3.8-.95C3.79-.86 3.78-.77 3.78-.69C3.78 .1 4.5 .13 4.7 .13H4.74C5.56 .13 5.9-.64 5.9-.92Z'/>
</defs>
<g id='eq194-page1'>
<use x='.57' y='0' xlink:href='#eq194-g1-96'/>
<use x='7.27' y='-4.34' xlink:href='#eq194-g5-50'/>
<use x='7.21' y='4.26' xlink:href='#eq194-g5-50'/>
</g>
</svg></span>
values across the image (as proposed by Lucas van Vliet).</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>J. Weickert, &ldquo;Anisotropic diffusion in image processing&rdquo;, Teubner (Stuttgart), pages 95 and 127, 1998.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-AdaptiveGauss-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-AdaptiveGauss-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL" class="m-doc-self">dip::<wbr />AdaptiveGauss</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html#dip-ImageConstRefArray" class="m-doc">dip::ImageConstRefArray</a> const&amp; params,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; sigmas = {5.0,1.0},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> const&amp; orders = {0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> const&amp; exponents = {0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; interpolationMethod = S::LINEAR,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; boundaryCondition = S::SYMMETRIC_MIRROR)</span></span>
            </h3>
            <p>Adaptive Gaussian filtering.</p>
<p>One or more parameter images in the <code>params</code> array control the size and orientation of the Gaussian kernel.
These images should have the same size as <code>in</code>, or be singleton-expandable to that size.
The meaning of the parameter images depend on the dimensionality of the input image.
The current implementation only supports 2D and 3D images.</p>
<ul>
<li>
<p>2D:</p>
<ul>
<li><code>params[0]</code> is the angle of the first kernel axis.</li>
<li><code>params[1]</code> (optional) is a tensor image with the local kernel scale.</li>
</ul>
</li>
<li>
<p>3D (with 1D structures):</p>
<ul>
<li><code>params[0]</code> is the polar coordinate phi of the first kernel axis.</li>
<li><code>params[1]</code> is the polar coordinate theta of the first kernel axis.</li>
<li><code>params[2]</code> (optional) is a tensor image with the local kernel scale.</li>
</ul>
</li>
<li>
<p>3D (with 2D structures):</p>
<ul>
<li><code>params[0]</code> is the polar coordinate phi of the first kernel axis.</li>
<li><code>params[1]</code> is the polar coordinate theta of the first kernel axis.</li>
<li><code>params[2]</code> is the polar coordinate phi of the second kernel axis.</li>
<li><code>params[3]</code> is the polar coordinate theta of the second kernel axis.</li>
<li><code>params[4]</code> (optional) is a tensor image with the local kernel scale.</li>
</ul>
</li>
</ul>
<p>For intrinsic 1D structures, pass one set of polar coordinates. For intrinsic 2d structures, pass two.</p>
<p>The local kernel scale parameter image is interpreted as follows.
Each row of the tensor corresponds to one tensor element of <code>in</code>, so that the kernel scaling can be
different for each channel; if there is a single row, it is applied to all tensor elements equally.
The tensor has one column per image dimension, or a single column applied
to all dimensions equally. The <code>sigmas</code> parameter (see below) will be scaled by these values.
As an example, consider a 2D RGB image. The scale tensor is then interpreted as:</p>
<div class="m-math"><svg style="width: 4.879em; height: 4.173em;" viewBox="169.57 -42.47 48.79 41.73">
<title>
\[ \begin{pmatrix}
    R_{x} &amp; R_{y}
 \\ G_{x} &amp; G_{y}
 \\ B_{x} &amp; B_{y}
\end{pmatrix} \]
</title>
<defs>
<use id='eq200-g7-23' xlink:href='#eq200-g4-23' transform='scale(1.36)'/>
<use id='eq200-g7-28' xlink:href='#eq200-g4-28' transform='scale(1.36)'/>
<use id='eq200-g7-39' xlink:href='#eq200-g4-39' transform='scale(1.36)'/>
<path id='eq200-g4-23' d='M4.71-1.75C4.71-2.38 4.44-2.71 3.61-3.07C4.23-3.21 4.48-3.32 4.76-3.56C5-3.77 5.14-4.06 5.14-4.42C5.14-5.25 4.52-5.7 3.39-5.7H1.14V-5.56C1.69-5.52 1.81-5.46 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.39C3.76 0 4.71-.71 4.71-1.75ZM3.76-1.78C3.76-.84 3.12-.26 2.05-.26C1.69-.26 1.49-.38 1.49-.63C1.49-.74 1.6-1.15 1.8-1.85L2.08-2.89C2.63-2.89 3-2.86 3.18-2.79C3.55-2.65 3.76-2.26 3.76-1.78ZM4.25-4.5C4.25-3.6 3.67-3.17 2.46-3.17H2.17L2.73-5.2C2.79-5.39 2.89-5.44 3.23-5.44C3.94-5.44 4.25-5.14 4.25-4.5Z'/>
<path id='eq200-g4-28' d='M6.31-2.65V-2.79H3.98V-2.65L4.24-2.62C4.52-2.59 4.66-2.51 4.66-2.35C4.66-2.16 4.61-1.93 4.44-1.35C4.24-.67 4.2-.57 4.1-.46C3.9-.27 3.57-.17 3.18-.17C2.05-.17 1.41-.81 1.41-1.96C1.41-3.03 1.84-4.15 2.53-4.87C2.93-5.28 3.47-5.52 4.04-5.52C4.6-5.52 5.07-5.29 5.35-4.9C5.49-4.67 5.56-4.48 5.6-4.09L5.76-4.06L6.18-5.78L6.05-5.82C5.9-5.61 5.76-5.52 5.53-5.52C5.43-5.52 5.35-5.54 5.14-5.61C4.72-5.75 4.33-5.82 3.97-5.82C2.13-5.82 .45-4.07 .45-2.15C.45-1.55 .71-.94 1.12-.52C1.56-.08 2.2 .16 2.96 .16C3.73 .16 4.36-.01 5.03-.38L5.46-2.02C5.6-2.51 5.74-2.61 6.31-2.65Z'/>
<path id='eq200-g4-39' d='M4.95 0V-.14C4.57-.17 4.39-.31 4.23-.77L3.42-2.91C4.09-3.06 4.38-3.18 4.69-3.46C4.98-3.71 5.14-4.05 5.14-4.45C5.14-5.26 4.5-5.7 3.32-5.7H1.15V-5.56C1.52-5.51 1.56-5.5 1.66-5.44C1.72-5.4 1.77-5.29 1.77-5.2C1.77-5.09 1.74-4.88 1.67-4.65L.59-.79C.44-.27 .38-.22-.11-.14V0H2.02V-.14C1.48-.21 1.42-.24 1.42-.55C1.42-.64 1.44-.72 1.53-1.05L2.02-2.87L2.59-2.83L3.66 0H4.95ZM4.22-4.46C4.22-3.6 3.66-3.15 2.57-3.15C2.41-3.15 2.34-3.16 2.12-3.2L2.69-5.2C2.74-5.38 2.86-5.44 3.14-5.44C3.86-5.44 4.22-5.12 4.22-4.46Z'/>
<path id='eq200-g4-71' d='M3.63-.9L3.51-.97C3.44-.88 3.4-.84 3.32-.73C3.12-.47 3.02-.38 2.91-.38C2.79-.38 2.71-.5 2.65-.74C2.63-.82 2.62-.86 2.61-.88C2.4-1.7 2.3-2.17 2.3-2.31C2.68-2.98 3-3.36 3.15-3.36C3.21-3.36 3.28-3.34 3.36-3.29C3.47-3.23 3.53-3.21 3.61-3.21C3.78-3.21 3.9-3.35 3.9-3.53C3.9-3.72 3.76-3.85 3.55-3.85C3.16-3.85 2.84-3.54 2.23-2.6L2.13-3.08C2.01-3.68 1.91-3.85 1.68-3.85C1.48-3.85 1.2-3.78 .66-3.6L.56-3.56L.59-3.43L.74-3.47C.91-3.51 1.01-3.53 1.08-3.53C1.3-3.53 1.35-3.45 1.48-2.93L1.73-1.85L1.01-.83C.83-.57 .66-.41 .57-.41C.52-.41 .43-.44 .34-.49C.23-.55 .14-.58 .06-.58C-.11-.58-.24-.45-.24-.27C-.24-.04-.07 .1 .2 .1S.58 .02 1.01-.51L1.8-1.54L2.06-.49C2.17-.03 2.29 .1 2.57 .1C2.9 .1 3.13-.11 3.63-.9Z'/>
<path id='eq200-g4-72' d='M3.72-3.37C3.72-3.63 3.5-3.85 3.24-3.85C3.04-3.85 2.9-3.72 2.9-3.53C2.9-3.39 2.97-3.3 3.14-3.19C3.31-3.09 3.37-3.01 3.37-2.89C3.37-2.54 3.06-1.87 2.31-.63L2.13-1.64C2-2.42 1.51-3.85 1.38-3.85H1.35L1.27-3.84L.41-3.69L.13-3.64V-3.49C.24-3.52 .31-3.53 .4-3.53C.75-3.53 .91-3.4 1.07-2.97C1.31-2.38 1.79-.42 1.79-.07C1.79 .03 1.76 .13 1.7 .24C1.63 .35 1.24 .86 1.08 1.03C.88 1.25 .78 1.32 .66 1.32C.6 1.32 .55 1.29 .45 1.22C.32 1.12 .24 1.07 .13 1.07C-.06 1.07-.21 1.22-.21 1.41C-.21 1.64-.03 1.8 .24 1.8C.73 1.8 1.68 .79 2.58-.71C3.31-1.91 3.72-2.87 3.72-3.37Z'/>
<path id='eq200-g1-169' d='M5-16.89C5-16.94 4.97-16.96 4.93-16.96C4.91-16.96 4.87-16.96 4.86-16.94C1.04-12.67 .6-1.56 .6-.3V.24H1.72V-.3C1.72-1.26 2.35-12.27 4.9-16.6C4.95-16.71 5-16.79 5-16.89Z'/>
<path id='eq200-g1-170' d='M.36-16.89C.36-16.79 .4-16.71 .46-16.6C3.01-12.27 3.64-1.26 3.64-.3V.24H4.76V-.3C4.76-1.56 4.32-12.67 .5-16.94C.49-16.96 .45-16.96 .43-16.96C.39-16.96 .36-16.94 .36-16.89Z'/>
<path id='eq200-g1-171' d='M5 0C5-.1 4.95-.18 4.9-.29C2.35-4.62 1.72-15.63 1.72-16.59V-17.13H.6V-16.59C.6-15.33 1.04-4.22 4.86 .05C4.87 .07 4.91 .07 4.93 .07C4.97 .07 5 .05 5 0Z'/>
<path id='eq200-g1-172' d='M.36-.07C.36-.02 .39 0 .43 0C.45 0 .49 0 .5-.02C4.32-4.29 4.76-15.4 4.76-16.66V-17.2H3.64V-16.66C3.64-15.7 3.01-4.69 .46-.36C.4-.25 .36-.17 .36-.07Z'/>
<path id='eq200-g1-173' d='M1.72 .25V-7.44H.6V.25H1.72Z'/>
<path id='eq200-g1-174' d='M4.76 .25V-7.44H3.64V.25H4.76Z'/>
</defs>
<g id='eq200-page1'>
<use x='169.57' y='-25.51' xlink:href='#eq200-g1-169'/>
<use x='169.57' y='-18.18' xlink:href='#eq200-g1-173'/>
<use x='169.57' y='-.96' xlink:href='#eq200-g1-171'/>
<use x='176.19' y='-33.23' xlink:href='#eq200-g7-39'/>
<use x='183.62' y='-31.43' xlink:href='#eq200-g4-71'/>
<use x='200.37' y='-33.23' xlink:href='#eq200-g7-39'/>
<use x='208.14' y='-31.43' xlink:href='#eq200-g4-72'/>
<use x='174.92' y='-18.78' xlink:href='#eq200-g7-28'/>
<use x='184.34' y='-16.99' xlink:href='#eq200-g4-71'/>
<use x='199.1' y='-18.78' xlink:href='#eq200-g7-28'/>
<use x='208.87' y='-16.99' xlink:href='#eq200-g4-72'/>
<use x='176.14' y='-4.33' xlink:href='#eq200-g7-23'/>
<use x='183.62' y='-2.54' xlink:href='#eq200-g4-71'/>
<use x='200.31' y='-4.33' xlink:href='#eq200-g7-23'/>
<use x='208.15' y='-2.54' xlink:href='#eq200-g4-72'/>
<use x='213.59' y='-25.43' xlink:href='#eq200-g1-170'/>
<use x='213.59' y='-18.11' xlink:href='#eq200-g1-174'/>
<use x='213.59' y='-.88' xlink:href='#eq200-g1-172'/>
</g>
</svg></div>
<p>The kernel is first scaled and then rotated before it is applied.
For more information on scaling, see the section &ldquo;Structure-adaptive applicability function&rdquo; in Pham et al.</p>
<p>The sigma for each kernel dimension is passed by <code>sigmas</code>.
For intrinsic 1D structures, the first value is along the contour, the second perpendicular to it.
For intrinsic 2D structures, the first two are in the plane, whereas the other is perpendicular to them.
If a value is zero, no convolution is done is this direction.</p>
<p>Together with <code>sigmas</code>, the <code>orders</code>, <code>truncation</code> and <code>exponents</code> parameters define the gaussian kernel,
see <a href="linear.html#dip-Gauss-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-UnsignedArray--dip-String-CL-dip-StringArray-CL-dip-dfloat-"><code>dip::Gauss</code></a> for details.
<code>interpolationMethod</code> can be <code>"linear"</code> (default) or <code>"zero order"</code> (faster).
Currently <code>boundaryCondition</code> can only be <code>"mirror"</code> (default) or <code>"add zeros"</code>.</p>
<h2>Example:</h2>
<div class="m-code"><pre><span></span><span class="n">dip</span><span class="o">::</span><span class="n">Image</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">ImageReadTIFF</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;erika.tif&quot;</span><span class="w"> </span><span class="p">);</span><span class="w">             </span><span class="c1">// Defined in &quot;diplib/file_io.h&quot;</span>
<span class="n">dip</span><span class="o">::</span><span class="n">Image</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">StructureTensor</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// Defined in &quot;diplib/analysis.h&quot;</span>
<span class="n">dip</span><span class="o">::</span><span class="n">ImageArray</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">StructureTensorAnalysis</span><span class="p">(</span><span class="w"> </span><span class="n">st</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;orientation&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">dip</span><span class="o">::</span><span class="n">Image</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">AdaptiveGauss</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">params</span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>

<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="nonlinear.html#dip-AdaptiveBanana-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL"><code>dip::AdaptiveBanana</code></a>, <a href="analysis.html#dip-StructureTensorAnalysis2D-dip-Image-CL-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P"><code>dip::StructureTensorAnalysis2D</code></a>, <a href="analysis.html#dip-StructureTensorAnalysis3D-dip-Image-CL-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P"><code>dip::StructureTensorAnalysis3D</code></a></p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>T.Q. Pham, L.J. van Vliet and K. Schutte, &ldquo;Robust fusion of irregularly sampled data using adaptive normalized
  convolution&rdquo;, EURASIP Journal on Applied Signal Processing, article ID 83268, 2006.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-AdaptiveBanana-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-AdaptiveBanana-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL" class="m-doc-self">dip::<wbr />AdaptiveBanana</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html#dip-ImageConstRefArray" class="m-doc">dip::ImageConstRefArray</a> const&amp; params,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; sigmas = {5.0,1.0},
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> const&amp; orders = {0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-UnsignedArray" class="m-doc">dip::UnsignedArray</a> const&amp; exponents = {0},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; interpolationMethod = S::LINEAR,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; boundaryCondition = S::SYMMETRIC_MIRROR)</span></span>
            </h3>
            <p>Adaptive Gaussian filtering using curvature.</p>
<p>One or more parameter images in the <code>params</code> array control the size, orientation and curvature of the Gaussian kernel.
These images should have the same size as <code>in</code>, or be singleton-expandable to that size.
The current implementation only supports 2D images.</p>
<ul>
<li><code>params[0]</code> is the angle of the first kernel axis.</li>
<li><code>params[1]</code> is the curvature of the first kernel axis.</li>
<li><code>params[2]</code> (optional) is a tensor image with the local kernel scale.</li>
</ul>
<p>See <a href="nonlinear.html#dip-AdaptiveGauss-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL"><code>dip::AdaptiveGauss</code></a> for details on how the local kernel scale image is interpreted.</p>
<p>The sigma for each kernel dimension is passed by <code>sigmas</code>. The first value is along the contour,
the second perpendicular to it. If a value is zero, no convolution is done is this direction.</p>
<p>Together with <code>sigmas</code>, the <code>orders</code>, <code>truncation</code> and <code>exponents</code> parameters define the gaussian kernel,
see <a href="linear.html#dip-GaussFIR-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-UnsignedArray--dip-StringArray-CL-dip-dfloat-"><code>dip::GaussFIR</code></a> for details.
<code>interpolationMethod</code> can be <code>"linear"</code> (default) or <code>"zero order"</code> (faster).
Currently <code>boundaryCondition</code> can only be <code>"mirror"</code> (default) or <code>"add zeros"</code>.</p>
<h2>Example:</h2>
<div class="m-code"><pre><span></span><span class="n">dip</span><span class="o">::</span><span class="n">Image</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">ImageReadTIFF</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;erika.tif&quot;</span><span class="w"> </span><span class="p">);</span><span class="w">     </span><span class="c1">// Defined in &quot;diplib/file_io.h&quot;</span>
<span class="n">dip</span><span class="o">::</span><span class="n">Image</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">StructureTensor</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// Defined in &quot;diplib/analysis.h&quot;</span>
<span class="n">dip</span><span class="o">::</span><span class="n">ImageArray</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">StructureTensorAnalysis</span><span class="p">(</span><span class="w"> </span><span class="n">st</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;orientation&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;curvature&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">dip</span><span class="o">::</span><span class="n">Image</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">AdaptiveBanana</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">dip</span><span class="o">::</span><span class="n">CreateImageConstRefArray</span><span class="p">(</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>

<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="nonlinear.html#dip-AdaptiveGauss-dip-Image-CL-dip-ImageConstRefArray-CL-dip-Image-L-dip-FloatArray-CL-dip-UnsignedArray-CL-dip-dfloat--dip-UnsignedArray-CL-dip-String-CL-dip-String-CL"><code>dip::AdaptiveGauss</code></a>, <a href="analysis.html#dip-StructureTensorAnalysis2D-dip-Image-CL-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P-dip-Image-P"><code>dip::StructureTensorAnalysis2D</code></a></p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>T.Q. Pham, L.J. van Vliet and K. Schutte, &ldquo;Robust fusion of irregularly sampled data using adaptive normalized
  convolution&rdquo;, EURASIP Journal on Applied Signal Processing, article ID 83268, 2006.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-FullBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-dfloat--dip-dfloat--dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-FullBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-dfloat--dip-dfloat--dip-StringArray-CL" class="m-doc-self">dip::<wbr />FullBilateralFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; estimate,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> spatialSigmas = {2.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tonalSigma = 30.0,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Bilateral filter, brute-force full kernel implementation</p>
<p>The bilateral filter is a non-linear edge-preserving smoothing filter. It locally averages input pixels,
weighting them with both the spatial distance to the origin as well as the intensity difference with the
pixel at the origin. The weights are Gaussian, and therefore there are two sigmas as parameters. The
spatial sigma can be defined differently for each image dimension in <code>spatialSigma</code>. <code>tonalSigma</code> determines
what similar intensities are. <code>truncation</code> applies to the spatial dimension only, and determines, together
with <code>spatialSigma</code>, the size of the neighborhood and thus its computational cost.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>If <code>in</code> is not scalar, each tensor element will be filtered independently. For color images, this leads to
false colors at edges.</p>
<p>The optional image <code>estimate</code>, if forged, is used as the tonal center when computing the kernel at each pixel.
That is, each point in the kernel is computed based on the distance of the corresponding pixel value in <code>in</code>
to the value of the pixel at the origin of the kernel in <code>estimate</code>. If not forged, <code>in</code> is used for <code>estimate</code>.
<code>estimate</code> must be real-valued and have the same sizes and number of tensor elements as <code>in</code>.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>C. Tomasi and R. Manduchi, &ldquo;Bilateral filtering for gray and color images&rdquo;, Proceedings of the 1998 IEEE
  International Conference on Computer Vision, Bombay, India.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-QuantizedBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-dfloat--dip-FloatArray--dip-dfloat--dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-QuantizedBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-dfloat--dip-FloatArray--dip-dfloat--dip-StringArray-CL" class="m-doc-self">dip::<wbr />QuantizedBilateralFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; estimate,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> spatialSigmas = {2.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tonalSigma = 30.0,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> tonalBins = {},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Quantized (piecewise linear) bilateral filter</p>
<p>The bilateral filter is a non-linear edge-preserving smoothing filter. It locally averages input pixels,
weighting them with both the spatial distance to the origin as well as the intensity difference with the
pixel at the origin. The weights are Gaussian, and therefore there are two sigmas as parameters. The
spatial sigma can be defined differently for each image dimension in <code>spatialSigma</code>. <code>tonalSigma</code> determines
what similar intensities are. <code>truncation</code> applies to the spatial dimension only, and determines, together
with <code>spatialSigma</code>, the size of the neighborhood and thus its computational cost.</p>
<p>This version of the filter applies a piece-wise linear approximation as described by Durand and Dorsey,
but without subsampling. This requires a significant amount of memory, and is efficient only for larger
spatial sigmas.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p><code>in</code> must be scalar and real-valued.</p>
<p>The optional image <code>estimate</code>, if forged, is used as the tonal center when computing the kernel at each pixel.
That is, each point in the kernel is computed based on the distance of the corresponding pixel value in <code>in</code>
to the value of the pixel at the origin of the kernel in <code>estimate</code>. If not forged, <code>in</code> is used for <code>estimate</code>.
<code>estimate</code> must be real-valued and have the same sizes and number of tensor elements as <code>in</code>.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>F. Durand and J. Dorsey, &ldquo;Fast bilateral filtering for the display of high-dynamic-range images&rdquo;,
  ACM Transactions on Graphics 21(3), 2002.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-SeparableBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-BooleanArray-CL-dip-FloatArray--dip-dfloat--dip-dfloat--dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-SeparableBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-BooleanArray-CL-dip-FloatArray--dip-dfloat--dip-dfloat--dip-StringArray-CL" class="m-doc-self">dip::<wbr />SeparableBilateralFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; estimate,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-BooleanArray" class="m-doc">dip::BooleanArray</a> const&amp; process = {},
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> spatialSigmas = {2.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tonalSigma = 30.0,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Separable bilateral filter, a very fast approximation</p>
<p>The bilateral filter is a non-linear edge-preserving smoothing filter. It locally averages input pixels,
weighting them with both the spatial distance to the origin as well as the intensity difference with the
pixel at the origin. The weights are Gaussian, and therefore there are two sigmas as parameters. The
spatial sigma can be defined differently for each image dimension in <code>spatialSigma</code>. <code>tonalSigma</code> determines
what similar intensities are. <code>truncation</code> applies to the spatial dimension only, and determines, together
with <code>spatialSigma</code>, the size of the neighborhood and thus its computational cost.</p>
<p>This version of the filter applies a 1D bilateral filter along each of the image dimensions, approximating
the result of the bilateral filter with a much reduced computational cost.</p>
<p><code>boundaryCondition</code> indicates how the boundary should be expanded in each dimension. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.</p>
<p>If <code>in</code> is not scalar, each tensor element will be filtered independently. For color images, this leads to
false colors at edges.</p>
<p>The optional image <code>estimate</code>, if forged, is used as the tonal center when computing the kernel at each pixel.
That is, each point in the kernel is computed based on the distance of the corresponding pixel value in <code>in</code>
to the value of the pixel at the origin of the kernel in <code>estimate</code>. If not forged, <code>in</code> is used for <code>estimate</code>.
<code>estimate</code> must be real-valued and have the same sizes and number of tensor elements as <code>in</code>.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>T.Q. Pham and L.J. van Vliet, &ldquo;Separable bilateral filter for fast video processing&rdquo;, IEEE International
  Conference on Multimedia and Expo, 2005.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-BilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray-CL-dip-dfloat--dip-dfloat--dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-BilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray-CL-dip-dfloat--dip-dfloat--dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />BilateralFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; estimate,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-FloatArray" class="m-doc">dip::FloatArray</a> const&amp; spatialSigmas = {2.0},
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> tonalSigma = 30.0,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> truncation = 2.0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; method = "xysep",
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Bilateral filter, convenience function that allows selecting an implementation</p>
<p>The <code>method</code> can be set to one of the following:</p>
<ul>
<li><code>"full"</code>: the brute-force implementation, using the full kernel, calls <a href="nonlinear.html#dip-FullBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-dfloat--dip-dfloat--dip-StringArray-CL"><code>dip::FullBilateralFilter</code></a>.</li>
<li><code>"xysep"</code> (default): xy-separable approximation, calls <a href="nonlinear.html#dip-SeparableBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-BooleanArray-CL-dip-FloatArray--dip-dfloat--dip-dfloat--dip-StringArray-CL"><code>dip::SeparableBilateralFilter</code></a>.</li>
<li><code>"pwlinear"</code>: piecewise linear approximation (quantized), calls <a href="nonlinear.html#dip-QuantizedBilateralFilter-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-FloatArray--dip-dfloat--dip-FloatArray--dip-dfloat--dip-StringArray-CL"><code>dip::QuantizedBilateralFilter</code></a>.
  The bins are automatically computed.</li>
</ul>
<p>See the linked functions for details on the other parameters.</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form action="https://diplib.org/diplib-docs/#search">
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript. Enable it or <a href="https://google.com/search?q=site:diplib.org+">use an external search engine</a>.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or modules.
              You can omit any prefix from the symbol or file path; adding a <code>:</code> or
              <code>/</code> suffix lists all members of given symbol or directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span> / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
              <span class="m-label m-dim">Enter</span> to go.
              <span class="m-label m-dim">Tab</span> autocompletes common prefix.
              You can copy a link to the result using <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">L</span>,
              or <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">M</span> to copy a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.<br />Maybe try a full-text <a href="#" id="search-external" data-search-engine="https://google.com/search?q=site:diplib.org+{query}">search with external engine</a>?</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>DIPlib, a library for quantitative image analysis. Documentation compiled with <a href="https://crisluengo.github.io/doxpp/">dox++</a> and styled with <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>