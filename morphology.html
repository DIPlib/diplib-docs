<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Filtering &raquo; Morphological filtering module | DIPlib | a library for quantitative image analysis</title>
  <link rel="stylesheet" href="m-dip+documentation.compiled.css" />
  <link rel="icon" href="DIP_logo_32.png" type="image/png" />
  <link rel="search" type="application/opensearchdescription+xml" href="opensearch.xml" title="Search DIPlib documentation" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#ffffff" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://diplib.org"><img src="DIP_logo.svg" alt="" />DIPlib</a><span class="m-breadcrumb">┃</span><a href="index.html" class="m-thin">a library for quantitative image analysis</a><span class="m-breadcrumb">┃</span><a href="https://github.com/DIPlib/diplib/releases/tag/3.1.0" class="m-thin">version 3.1.0</a>      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="modules.html">Modules</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="classes.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="filtering.html">Filtering</a> &raquo;</span>
          Morphological filtering <span class="m-thin">module</span>          <div class="m-doc-include m-code m-inverted m-text-right"><span class="cp">#include</span> <a class="cpf" href="file--diplib--morphology-h.html">"diplib/morphology.h"</a></div>
        </h1>
        <p>Morphological filters for smoothing, sharpening, detection and more.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#nested-classes">Classes</a></li>
                <li><a href="#function-members">Functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
        <section id="nested-classes">
          <h2>Classes</h2>
          <dl class="m-doc">
            <dt>
              class <a href="dip-StructuringElement.html" class="m-doc">dip::<wbr />StructuringElement</a>
            </dt>
            <dd>Represents the shape and size of a structuring element.</dd>
          </dl>
        </section>
        <section id="function-members">
          <h2>Functions</h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />Dilation</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies the dilation.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Erosion-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />Erosion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies the erosion with a standard structuring element.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Closing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />Closing</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies the closing with a standard structuring element.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />Opening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies the opening with a standard structuring element.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Tophat-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />Tophat</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::WHITE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>The Top-hat operator and its variants</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MorphologicalThreshold-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MorphologicalThreshold</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>A morphological smoothing filter</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MorphologicalGist-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MorphologicalGist</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Morphological gist operator and its variants</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MorphologicalRange-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MorphologicalRange</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>A morphological edge detector</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MorphologicalGradientMagnitude-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MorphologicalGradientMagnitude</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>The morphological version of the gradient magnitude</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Lee-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />Lee</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; sign = S::UNSIGNED,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>A morphological edge detector</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MorphologicalSmoothing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MorphologicalSmoothing</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::AVERAGE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>A morphological smoothing filter</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MorphologicalSharpening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MorphologicalSharpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>A morphological sharpening filter</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MultiScaleMorphologicalGradient-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MultiScaleMorphologicalGradient</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> upperSize = 9,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> lowerSize = 3,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; filterShape = S::ELLIPTIC,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>A morphological edge detector</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MorphologicalLaplace-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />MorphologicalLaplace</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>The morphological version of the Laplace operator</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-RankFilter-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />RankFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> rank = 2,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; order = S::INCREASING,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies the rank-order filter.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-RankMinClosing-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL" class="m-doc">dip::<wbr />RankMinClosing</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> rank = 2,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies the rank-min closing, a closing that is somewhat robust to noise.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-RankMaxOpening-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL" class="m-doc">dip::<wbr />RankMaxOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> rank = 2,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Applies the rank-max opening, an opening that is somewhat robust to noise.</dd>
            <dt id="dip-StochasticWatershed-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-dfloat--dip-String-CL">
              <span class="m-doc-wrap-bumper">void <a href="#dip-StochasticWatershed-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-dfloat--dip-String-CL" class="m-doc-self">dip::<wbr />StochasticWatershed</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> nSeeds = 100,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> nIterations = 50,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> noise = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; seeds = S::HEXAGONAL)</span>
            </dt>
            <dd>Like above, using a default-initialized <a href="dip-Random.html"><code>dip::Random</code></a> object.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-UpperSkeleton2D-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-String-CL" class="m-doc">dip::<wbr />UpperSkeleton2D</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; endPixelCondition = S::NATURAL)</span>
            </dt>
            <dd>Grey-value skeleton (2D only).</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL" class="m-doc">dip::<wbr />MorphologicalReconstruction</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; marker,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; direction = S::DILATION)</span>
            </dt>
            <dd>Reconstruction by dilation or erosion, also known as inf-reconstruction and sup-reconstruction</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-LimitedMorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL" class="m-doc">dip::<wbr />LimitedMorphologicalReconstruction</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; marker,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> maxDistance = 20,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; direction = S::DILATION)</span>
            </dt>
            <dd>Reconstruction by dilation or erosion, but with a limited reach.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-HMinima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-" class="m-doc">dip::<wbr />HMinima</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> h,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span>
            </dt>
            <dd>Computes the H-Minima filtered image</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-HMaxima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-" class="m-doc">dip::<wbr />HMaxima</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> h,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span>
            </dt>
            <dd>Computes the H-Maxima filtered image</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-ImposeMinima-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint-" class="m-doc">dip::<wbr />ImposeMinima</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; marker,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span>
            </dt>
            <dd>Impose minima.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-Leveling-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint-" class="m-doc">dip::<wbr />Leveling</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; marker,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span>
            </dt>
            <dd>The leveling of <code>in</code> imposed by <code>marker</code>.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-AreaOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL" class="m-doc">dip::<wbr />AreaOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> filterSize,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENING)</span>
            </dt>
            <dd>Computes the area opening or closing. This is a parametric opening.</dd>
            <dt id="dip-AreaClosing-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-AreaClosing-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint-" class="m-doc-self">dip::<wbr />AreaClosing</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> filterSize,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span>
            </dt>
            <dd>Computes the area closing, calling <a href="morphology.html#dip-AreaOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL"><code>dip::AreaOpening</code></a> with <code>polarity="closing"</code>.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-VolumeOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL" class="m-doc">dip::<wbr />VolumeOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> filterSize,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENING)</span>
            </dt>
            <dd>Computes the volume opening or closing. This is a parametric opening.</dd>
            <dt id="dip-VolumeClosing-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-">
              <span class="m-doc-wrap-bumper">void <a href="#dip-VolumeClosing-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-" class="m-doc-self">dip::<wbr />VolumeClosing</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> filterSize,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span>
            </dt>
            <dd>Computes the area closing, calling <a href="morphology.html#dip-VolumeOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL"><code>dip::VolumeOpening</code></a> with <code>polarity="closing"</code>.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-PathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL-dip-StringSet-CL" class="m-doc">dip::<wbr />PathOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> length = 7,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENING,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; mode = {})</span>
            </dt>
            <dd>Applies a path opening or closing in all possible directions</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-DirectedPathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-IntegerArray--dip-String-CL-dip-StringSet-CL" class="m-doc">dip::<wbr />DirectedPathOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-IntegerArray" class="m-doc">dip::IntegerArray</a> filterParam,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENING,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; mode = {})</span>
            </dt>
            <dd>Applies a path opening or closing in a specific direction.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-OpeningByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL" class="m-doc">dip::<wbr />OpeningByReconstruction</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Opening by reconstruction</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-ClosingByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL" class="m-doc">dip::<wbr />ClosingByReconstruction</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Closing by reconstruction</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-AlternatingSequentialFilter-dip-Image-CL-dip-Image-L-dip-Range-CL-dip-String-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />AlternatingSequentialFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Range.html" class="m-doc">dip::Range</a> const&amp; sizes = {3,7,2},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; shape = S::ELLIPTIC,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::STRUCTURAL,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENCLOSE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>Alternating sequential filters for smoothing</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-HitAndMiss-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />HitAndMiss</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; hit,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; miss,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::UNCONSTRAINED,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>The Hit-and-Miss transform, uses two structuring elements, <code>hit</code> must be within the structures,
<code>miss</code> must be without.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#dip-HitAndMiss-dip-Image-CL-dip-Image-L-dip-Image-CL-dip-String-CL-dip-StringArray-CL" class="m-doc">dip::<wbr />HitAndMiss</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; se,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::UNCONSTRAINED,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span>
            </dt>
            <dd>The Hit-and-Miss transform, uses a single structuring element in the form of a small image that
has &ldquo;hit&rdquo;, &ldquo;miss&rdquo; and &ldquo;don&rsquo;t care&rdquo; values.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />Dilation</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Applies the dilation.</p>
<p><code>se</code> defines the structuring element, see <a href="dip-StructuringElement.html"><code>dip::StructuringElement</code></a> for options and details.</p>
<p><code>boundaryCondition</code> determines the boundary conditions. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
The default value, and most meaningful one, is <code>"add min"</code>, but any value can be used.
For the rectangular, diamond, fast line and periodic line structuring elements, no boundary condition
causes the filter to not read outside the image bounds. This is equivalent to <code>"add min"</code>.</p>
<p><code>in</code> must be a scalar image, and not complex-valued. In particular, <code>in</code> can be binary; this function
is more efficient than <a href="binary.html#dip-BinaryDilation-dip-Image-CL-dip-Image-L-dip-sint--dip-uint--dip-String-CL"><code>dip::BinaryDilation</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-Erosion-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Erosion</code></a>, <a href="morphology.html#dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Opening</code></a>, <a href="morphology.html#dip-Closing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Closing</code></a>, <a href="morphology.html#dip-RankFilter-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-String-CL-dip-StringArray-CL"><code>dip::RankFilter</code></a>, <a href="binary.html#dip-IsotropicDilation-dip-Image-CL-dip-Image-L-dip-dfloat-"><code>dip::IsotropicDilation</code></a></p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-Erosion-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-Erosion-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />Erosion</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Applies the erosion with a standard structuring element.</p>
<p><code>se</code> defines the structuring element. See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for details and warnings.</p>
<p><code>boundaryCondition</code> determines the boundary conditions. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
The default value, and most meaningful one, is <code>"add max"</code>, but any value can be used.
For the rectangular, diamond, fast line and periodic line structuring elements, no boundary condition
causes the filter to not read outside the image bounds. This is equivalent to <code>"add max"</code>.</p>
<p><code>in</code> must be a scalar image, and not complex-valued. In particular, <code>in</code> can be binary; this function
is more efficient than <a href="binary.html#dip-BinaryErosion-dip-Image-CL-dip-Image-L-dip-sint--dip-uint--dip-String-CL"><code>dip::BinaryErosion</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a>, <a href="morphology.html#dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Opening</code></a>, <a href="morphology.html#dip-Closing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Closing</code></a>, <a href="morphology.html#dip-RankFilter-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-String-CL-dip-StringArray-CL"><code>dip::RankFilter</code></a>, <a href="binary.html#dip-IsotropicErosion-dip-Image-CL-dip-Image-L-dip-dfloat-"><code>dip::IsotropicErosion</code></a></p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-Closing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-Closing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />Closing</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Applies the closing with a standard structuring element.</p>
<p><code>se</code> defines the structuring element. See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for details and warnings.</p>
<p><code>boundaryCondition</code> determines the boundary conditions. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
Meaningful values for the closing are <code>"add max"</code> and <code>"add min"</code>, but any value can
be used. The default empty array causes the function to use <code>"add min"</code> with the dilation
and <code>"add max"</code> with the erosion, equivalent to ignoring what&rsquo;s outside the image.
For the rectangular, diamond, fast line and periodic line structuring elements, no boundary condition
causes the filter to not read outside the image bounds.</p>
<p><code>in</code> must be a scalar image, and not complex-valued. In particular, <code>in</code> can be binary; this function
is more efficient than <a href="binary.html#dip-BinaryClosing-dip-Image-CL-dip-Image-L-dip-sint--dip-uint--dip-String-CL"><code>dip::BinaryClosing</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a>, <a href="morphology.html#dip-Erosion-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Erosion</code></a>, <a href="morphology.html#dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Opening</code></a>, <a href="morphology.html#dip-RankMinClosing-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL"><code>dip::RankMinClosing</code></a>, <a href="binary.html#dip-IsotropicClosing-dip-Image-CL-dip-Image-L-dip-dfloat-"><code>dip::IsotropicClosing</code></a></p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />Opening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Applies the opening with a standard structuring element.</p>
<p><code>se</code> defines the structuring element. See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for details and warnings.</p>
<p><code>boundaryCondition</code> determines the boundary conditions. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
Meaningful values for the opening are <code>"add max"</code> and <code>"add min"</code>, but any value can
be used. The default empty array causes the function to use <code>"add min"</code> with the dilation
and <code>"add max"</code> with the erosion, equivalent to ignoring what&rsquo;s outside the image.
For the rectangular, diamond, fast line and periodic line structuring elements, no boundary condition
causes the filter to not read outside the image bounds.</p>
<p><code>in</code> must be a scalar image, and not complex-valued. In particular, <code>in</code> can be binary; this function
is more efficient than <a href="binary.html#dip-BinaryOpening-dip-Image-CL-dip-Image-L-dip-sint--dip-uint--dip-String-CL"><code>dip::BinaryOpening</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a>, <a href="morphology.html#dip-Erosion-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Erosion</code></a>, <a href="morphology.html#dip-Closing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Closing</code></a>, <a href="morphology.html#dip-RankMaxOpening-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL"><code>dip::RankMaxOpening</code></a>, <a href="binary.html#dip-IsotropicOpening-dip-Image-CL-dip-Image-L-dip-dfloat-"><code>dip::IsotropicOpening</code></a></p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-Tophat-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-Tophat-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />Tophat</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::WHITE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>The Top-hat operator and its variants</p>
<p>The top-hat is the difference between a morphological operation and the original image,
comparable to a high-pass filter. The flags <code>edgeType</code> and <code>polarity</code> define which
operation is applied.</p>
<p><code>edgeType</code> can be one of:</p>
<ul>
<li><code>"texture"</code>: response is limited to edges in texture (i.e. scales smaller than the structuring element).</li>
<li><code>"object"</code>: response is limited to object edges (i.e. scales larger than the structuring element).</li>
<li><code>"both"</code> or <code>"dynamic"</code>: all edges produce equal response.</li>
</ul>
<p><code>polarity</code> can be either <code>"white"</code> to indicate objects are brighter than the background, or <code>"black"</code> to
indicate objects are darker than the background.</p>
<p>The standard top-hat is defined as the <code>Opening( in ) - in</code>. This is the operation obtained
with the default values.</p>
<p><code>se</code> defines the structuring element, and <code>boundaryCondition</code> the boundary conditions.
See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for a description of these parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-MorphologicalThreshold-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MorphologicalThreshold-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MorphologicalThreshold</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>A morphological smoothing filter</p>
<p>Implements a morphological smoothing based on the average of two complementary morphological operations.
These can be chosen through the <code>edgeType</code> parameter.</p>
<p><code>edgeType</code> can be one of:</p>
<ul>
<li><code>"texture"</code>: response is limited to edges in texture (i.e. scales smaller than the structuring element).</li>
<li><code>"object"</code>: response is limited to object edges (i.e. scales larger than the structuring element).</li>
<li><code>"both"</code> or <code>"dynamic"</code>: all edges produce equal response.</li>
</ul>
<p><code>se</code> defines the structuring element, and <code>boundaryCondition</code> the boundary conditions.
See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for a description of these parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-MorphologicalGist-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MorphologicalGist-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MorphologicalGist</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Morphological gist operator and its variants</p>
<p>Similar to the top-hat operator, it computes the difference between the average of
two complementary morphological operators and the original image.</p>
<p>The flags <code>edgeType</code> defines which operation is applied:</p>
<ul>
<li><code>"texture"</code>: response is limited to edges in texture (i.e. scales smaller than the structuring element).</li>
<li><code>"object"</code>: response is limited to object edges (i.e. scales larger than the structuring element).</li>
<li><code>"both"</code> or <code>"dynamic"</code>: all edges produce equal response.</li>
</ul>
<p><code>se</code> defines the structuring element, and <code>boundaryCondition</code> the boundary conditions.
See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for a description of these parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-MorphologicalRange-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MorphologicalRange-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MorphologicalRange</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>A morphological edge detector</p>
<p>Implements a morphological edge detector based on the difference of two complementary morphological
operations. These can be chosen through the <code>edgeType</code> parameter.</p>
<p><code>edgeType</code> can be one of:</p>
<ul>
<li><code>"texture"</code>: response is limited to edges in texture (i.e. scales smaller than the structuring element).</li>
<li><code>"object"</code>: response is limited to object edges (i.e. scales larger than the structuring element).</li>
<li><code>"both"</code> or <code>"dynamic"</code>: all edges produce equal response.</li>
</ul>
<p><code>se</code> defines the structuring element, and <code>boundaryCondition</code> the boundary conditions.
See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for a description of these parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-MorphologicalGradientMagnitude-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MorphologicalGradientMagnitude-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MorphologicalGradientMagnitude</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>The morphological version of the gradient magnitude</p>
<p>The morphological gradient magnitude is defined as <code>Dilation( in ) - Erosion( in )</code>.</p>
<p>This function is implemented by a call to <a href="morphology.html#dip-MorphologicalRange-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL"><code>dip::MorphologicalRange</code></a> with <code>edgeType</code> set to <code>"both"</code>.</p>
          </div></section>
          <section class="m-doc-details" id="dip-Lee-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-Lee-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />Lee</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; edgeType = S::TEXTURE,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; sign = S::UNSIGNED,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>A morphological edge detector</p>
<p>Implements a morphological edge detector based on the minimum of two complementary morphological
operations. These can be chosen through the <code>edgeType</code> parameter.</p>
<p><code>edgeType</code> can be one of:</p>
<ul>
<li><code>"texture"</code>: response is limited to edges in texture (i.e. scales smaller than the structuring element).</li>
<li><code>"object"</code>: response is limited to object edges (i.e. scales larger than the structuring element).</li>
<li><code>"both"</code> or <code>"dynamic"</code>: all edges produce equal response.</li>
</ul>
<p>If <code>sign</code> is <code>"unsigned"</code>, <code>Lee</code> computes the absolute edge strength. <code>sign</code> can also be <code>"signed"</code>
to compute the signed edge strength.</p>
<p><code>se</code> defines the structuring element, and <code>boundaryCondition</code> the boundary conditions.
See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for a description of these parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-MorphologicalSmoothing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MorphologicalSmoothing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MorphologicalSmoothing</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::AVERAGE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>A morphological smoothing filter</p>
<p>Implements a morphological smoothing based on the sequence of an opening and a closing. Their order
can be chosen through the <code>polarity</code> parameter.</p>
<p><code>polarity</code> can be one of:</p>
<ul>
<li><code>"open-close"</code>: applies the opening first, then the closing.</li>
<li><code>"close-open"</code>: applies the closing first, then the opening.</li>
<li><code>"average"</code>: computes the average of the result of the first two modes.</li>
</ul>
<p><code>se</code> defines the structuring element, and <code>boundaryCondition</code> the boundary conditions.
See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for a description of these parameters..</p>
          </div></section>
          <section class="m-doc-details" id="dip-MorphologicalSharpening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MorphologicalSharpening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MorphologicalSharpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>A morphological sharpening filter</p>
<p>Implements a morphological sharpening based on selecting per pixel the result of the dilation or erosion,
whichever is closest to the input image.</p>
<p><code>se</code> defines the structuring element, and <code>boundaryCondition</code> the boundary conditions.
See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for a description of these parameters..</p>
          </div></section>
          <section class="m-doc-details" id="dip-MultiScaleMorphologicalGradient-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MultiScaleMorphologicalGradient-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MultiScaleMorphologicalGradient</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> upperSize = 9,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> lowerSize = 3,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; filterShape = S::ELLIPTIC,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>A morphological edge detector</p>
<p>This function computes the average morphological gradient over a range of scales bounded by <code>upperSize</code>
and <code>lowerSize</code>. The morphological gradient is computed as the difference of the dilation and erosion
of the input image at a particular scale, eroded by an erosion of one size smaller. At the lowest scale,
the diameter of the structuring element is <code>2 * lowerSize + 1</code>.</p>
<p><code>filterShape</code> can be either <code>"rectangular"</code>, <code>"elliptic"</code>, and <code>"diamond"</code>, as described in
<a href="dip-StructuringElement.html"><code>dip::StructuringElement</code></a>.</p>
<p><code>boundaryCondition</code> determines the boundary conditions. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
The default empty array causes the function to use <code>"add min"</code> with the dilation
and <code>"add max"</code> with the erosion, equivalent to ignoring what&rsquo;s outside the image.</p>
          </div></section>
          <section class="m-doc-details" id="dip-MorphologicalLaplace-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MorphologicalLaplace-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />MorphologicalLaplace</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>The morphological version of the Laplace operator</p>
<p>This function computes:</p>
<div class="m-code"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="p">(</span> <span class="n">Dilation</span><span class="p">(</span> <span class="n">in</span> <span class="p">)</span> <span class="o">+</span> <span class="n">Erosion</span><span class="p">(</span> <span class="n">in</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">in</span><span class="p">;</span>
</pre></div>

<p><code>se</code> defines the structuring element, and <code>boundaryCondition</code> the boundary conditions.
See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> for a description of these parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-RankFilter-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-RankFilter-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />RankFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> rank = 2,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; order = S::INCREASING,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Applies the rank-order filter.</p>
<p><code>se</code> defines the structuring element. <code>rank</code> determines which of the sorted values within
the SE should be written to the output. A rank of 1 leads to an erosion, and a rank equal
to the number of pixels within the SE leads to a dilation. If <code>order</code> is <code>"decreasing"</code> (instead
of the default <code>"increasing"</code>), then <code>rank</code> is interpreted in the opposite direction, it
counts elements starting at the largest value. In this case, a rank of 1 is equal to a dilation.</p>
<p>Thus, a small non-zero rank with increasing order leads to an approximation to the dilation
that is less sensitive to noise, and a small non-zero rank with decreasing order leads to an
approximation of the erosion.</p>
<p>See also <a href="nonlinear.html#dip-PercentileFilter-dip-Image-CL-dip-Image-L-dip-dfloat--dip-Kernel-CL-dip-StringArray-CL"><code>dip::PercentileFilter</code></a>, which does the same thing but uses a percentile instead of
a rank as input argument.</p>
<p><code>boundary</code> determines the boundary conditions. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
The default value is the most meaningful one, but any value can be used. By default it is
<code>"add max"</code> if <code>rank</code> is lower than half of the pixels in the SE, or <code>"add min"</code> otherwise.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-Erosion-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Erosion</code></a>, <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a>, <a href="morphology.html#dip-RankMinClosing-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL"><code>dip::RankMinClosing</code></a>, <a href="morphology.html#dip-RankMaxOpening-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL"><code>dip::RankMaxOpening</code></a>, <a href="nonlinear.html#dip-PercentileFilter-dip-Image-CL-dip-Image-L-dip-dfloat--dip-Kernel-CL-dip-StringArray-CL"><code>dip::PercentileFilter</code></a></p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-RankMinClosing-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-RankMinClosing-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL" class="m-doc-self">dip::<wbr />RankMinClosing</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> rank = 2,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Applies the rank-min closing, a closing that is somewhat robust to noise.</p>
<p><code>se</code> defines the structuring element. <code>rank</code> determines how many pixels in the SE
are ignored. That is, if the SE has <code>n</code> pixels, then a rank filter with rank equal
to <code>n - rank</code> is applied instead of a dilation.</p>
<p>This function uses the definition of Soille:</p>
<div class="m-math"><svg style="width: 23.056em; height: 2.597em;" viewBox="78.74 -27.15 230.56 25.97">
<title>
\[ \phi_{B,\text{rank}} = \bigwedge_i \{ \phi_{B_i} | B_i \subseteq B, \text{card}(B_i) = n-\text{rank} \} \; , \]
</title>
<defs>
<use id='eq129-g19-97' xlink:href='#eq129-g0-97' transform='scale(1.36)'/>
<use id='eq129-g19-99' xlink:href='#eq129-g0-99' transform='scale(1.36)'/>
<use id='eq129-g19-100' xlink:href='#eq129-g0-100' transform='scale(1.36)'/>
<use id='eq129-g19-107' xlink:href='#eq129-g0-107' transform='scale(1.36)'/>
<use id='eq129-g19-110' xlink:href='#eq129-g0-110' transform='scale(1.36)'/>
<use id='eq129-g19-114' xlink:href='#eq129-g0-114' transform='scale(1.36)'/>
<path id='eq129-g8-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq129-g8-18' d='M6.96-.88V-1.48H3.5C2.35-1.48 1.21-2.51 1.21-3.85C1.21-5.11 2.2-6.22 3.5-6.22H6.96V-6.81H3.55C1.89-6.81 .62-5.42 .62-3.84S1.89-.87 3.55-.87L6.96-.88ZM6.96 .69V.06H.92V.69H6.96Z'/>
<path id='eq129-g8-102' d='M2.91-6.68C2.91-7.12 3.26-8 4.22-8.24C4.28-8.27 4.32-8.3 4.32-8.36C4.32-8.48 4.23-8.5 4.1-8.48C3.17-8.34 2.06-7.58 2.05-6.78V-4.66C2.05-4.24 1.98-3.64 1.81-3.54C1.38-3.24 .94-3.22 .68-3.22C.62-3.2 .57-3.13 .57-3.07C.57-2.95 .64-2.93 .76-2.92C1.55-2.88 1.88-2.51 2.01-1.98C2.05-1.86 2.05-1.85 2.05-1.45V.45C2.05 .91 1.93 1.44 2.5 1.85C2.97 2.17 3.63 2.36 4.1 2.36C4.23 2.36 4.32 2.36 4.32 2.23C4.32 2.12 4.25 2.14 4.13 2.11C3.33 1.91 3.1 1.49 2.94 .93C2.91 .83 2.91 .81 2.91 .43V-1.62C2.91-2.11 2.81-2.3 2.43-2.64C2.18-2.87 2.07-2.98 1.74-3.07C2.72-3.31 2.91-3.81 2.91-4.44V-6.68Z'/>
<path id='eq129-g8-103' d='M1.99-6.68V-4.44C1.99-3.81 2.18-3.31 3.16-3.07C2.82-2.98 2.72-2.87 2.47-2.64C2.08-2.3 1.99-2.11 1.99-1.62V.43C1.99 .81 1.99 .83 1.95 .93C1.8 1.49 1.56 1.91 .76 2.11C.64 2.14 .57 2.12 .57 2.23C.57 2.36 .67 2.36 .8 2.36C1.26 2.36 1.93 2.17 2.39 1.85C2.97 1.44 2.85 .91 2.85 .45V-1.45C2.85-1.85 2.85-1.86 2.88-1.98C3.01-2.51 3.35-2.88 4.13-2.92C4.25-2.93 4.32-2.95 4.32-3.07C4.32-3.13 4.28-3.2 4.22-3.22C3.95-3.22 3.51-3.24 3.08-3.54C2.92-3.64 2.85-4.24 2.85-4.66V-6.78C2.83-7.58 1.73-8.34 .8-8.48C.67-8.5 .57-8.48 .57-8.36C.57-8.3 .62-8.27 .68-8.24C1.63-8 1.99-7.12 1.99-6.68Z'/>
<path id='eq129-g8-106' d='M1.52 2.3V-8.42H.86V2.3H1.52Z'/>
<path id='eq129-g8-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq129-g8-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq129-g14-23' d='M4.71-1.75C4.71-2.38 4.44-2.71 3.61-3.07C4.23-3.21 4.48-3.32 4.76-3.56C5-3.77 5.14-4.06 5.14-4.42C5.14-5.25 4.52-5.7 3.39-5.7H1.14V-5.56C1.69-5.52 1.81-5.46 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.39C3.76 0 4.71-.71 4.71-1.75ZM3.76-1.78C3.76-.84 3.12-.26 2.05-.26C1.69-.26 1.49-.38 1.49-.63C1.49-.74 1.6-1.15 1.8-1.85L2.08-2.89C2.63-2.89 3-2.86 3.18-2.79C3.55-2.65 3.76-2.26 3.76-1.78ZM4.25-4.5C4.25-3.6 3.67-3.17 2.46-3.17H2.17L2.73-5.2C2.79-5.39 2.89-5.44 3.23-5.44C3.94-5.44 4.25-5.14 4.25-4.5Z'/>
<path id='eq129-g14-56' d='M2.05-.9L1.94-1C1.56-.5 1.37-.31 1.22-.31C1.15-.31 1.08-.38 1.08-.45C1.08-.59 1.17-.85 1.22-1.02L1.99-3.83L1.97-3.85C1.08-3.69 .91-3.66 .57-3.63V-3.49C1.04-3.49 1.12-3.46 1.12-3.28C1.12-3.21 1.09-3.07 1.04-2.9L.62-1.35C.48-.83 .43-.58 .43-.4C.43-.08 .57 .1 .83 .1C1.24 .1 1.55-.17 2.05-.9ZM2.41-5.14C2.41-5.39 2.21-5.62 1.97-5.62S1.56-5.42 1.56-5.15C1.56-4.87 1.73-4.69 1.98-4.69C2.21-4.69 2.41-4.89 2.41-5.14Z'/>
<path id='eq129-g14-61' d='M4.14-.91L4.02-1.02C3.96-.94 3.9-.86 3.83-.79C3.58-.47 3.42-.33 3.3-.33C3.22-.33 3.16-.39 3.16-.47C3.16-.54 3.2-.71 3.28-1.02L3.78-2.82C3.83-3 3.86-3.2 3.86-3.32C3.86-3.63 3.62-3.85 3.28-3.85C2.73-3.85 2.17-3.32 1.28-1.93L1.86-3.83L1.83-3.85L.42-3.58V-3.44C.86-3.43 .98-3.38 .98-3.21C.98-3.15 .97-3.1 .96-3.06L.12 0H.78C1.19-1.38 1.27-1.57 1.65-2.17C2.17-2.98 2.62-3.41 2.94-3.41C3.07-3.41 3.15-3.31 3.15-3.15C3.15-3.05 3.1-2.76 3.03-2.49L2.65-1.05C2.53-.59 2.51-.48 2.51-.39C2.51-.06 2.63 .08 2.92 .08C3.31 .08 3.53-.1 4.14-.91Z'/>
<path id='eq129-g14-113' d='M4.59-2.54C4.59-3.18 4.12-3.72 3.25-3.83L3.76-5.5L3.04-5.39L2.65-3.83C1.28-3.69 .21-2.55 .21-1.26C.21-.61 .56 .03 1.68 .1L1.27 1.81H1.48L2.03 .09C3.46-.03 4.59-1.25 4.59-2.54ZM3.89-2.61C3.89-1.13 2.96-.23 2.1-.15L3.16-3.56C3.76-3.35 3.89-2.83 3.89-2.61ZM2.59-3.59L1.74-.17C1.15-.33 .94-.86 .94-1.23C.94-2.58 1.68-3.47 2.59-3.59Z'/>
<path id='eq129-g14-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<use id='eq129-g17-23' xlink:href='#eq129-g14-23' transform='scale(1.36)'/>
<use id='eq129-g17-61' xlink:href='#eq129-g14-61' transform='scale(1.36)'/>
<use id='eq129-g17-113' xlink:href='#eq129-g14-113' transform='scale(1.36)'/>
<use id='eq129-g17-150' xlink:href='#eq129-g14-150' transform='scale(1.36)'/>
<path id='eq129-g5-219' d='M13.97 18.34L7.55 0H7.38L.98 18.34H1.69L7.48 1.86L13.26 18.34H13.97Z'/>
<path id='eq129-g11-56' d='M1.75-.67L1.65-.75C1.34-.37 1.18-.24 1.05-.24C.99-.24 .93-.28 .92-.33C.92-.44 1-.64 1.04-.77L1.57-2.88L1.6-2.89C.83-2.76 .67-2.74 .37-2.73V-2.62C.78-2.61 .84-2.59 .85-2.46C.85-2.41 .83-2.3 .79-2.17L.5-1.02C.39-.62 .35-.43 .35-.3C.37-.06 .49 .07 .71 .07C1.07 .07 1.34-.12 1.75-.67ZM1.95-3.86C1.94-4.05 1.77-4.21 1.57-4.21S1.21-4.07 1.22-3.86C1.22-3.66 1.38-3.52 1.6-3.52C1.79-3.52 1.95-3.67 1.95-3.86Z'/>
<path id='eq129-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq129-g0-97' d='M3.88-.35V-.58C3.73-.46 3.62-.41 3.49-.41C3.29-.41 3.23-.53 3.23-.92V-2.63C3.23-3.08 3.18-3.32 3.06-3.52C2.88-3.86 2.5-4.03 1.96-4.03C1.52-4.03 1.1-3.91 .85-3.71C.63-3.52 .49-3.27 .49-3.05C.49-2.85 .66-2.67 .87-2.67S1.26-2.85 1.26-3.04C1.26-3.08 1.25-3.12 1.24-3.18C1.23-3.26 1.22-3.33 1.22-3.39C1.22-3.63 1.5-3.82 1.85-3.82C2.28-3.82 2.52-3.57 2.52-3.09V-2.56C1.17-2.02 1.02-1.95 .64-1.61C.45-1.44 .32-1.14 .32-.85C.32-.3 .7 .09 1.24 .09C1.63 .09 1.99-.1 2.52-.55C2.57-.09 2.73 .09 3.09 .09C3.38 .09 3.57-.02 3.88-.35ZM2.52-1.08C2.52-.81 2.47-.73 2.29-.61C2.08-.49 1.83-.42 1.65-.42C1.34-.42 1.1-.72 1.1-1.1V-1.13C1.1-1.65 1.46-1.96 2.52-2.35V-1.08Z'/>
<path id='eq129-g0-99' d='M3.61-1.29L3.49-1.37C3.07-.75 2.75-.54 2.25-.54C1.45-.54 .89-1.24 .89-2.25C.89-3.16 1.38-3.78 2.09-3.78C2.4-3.78 2.52-3.68 2.6-3.36L2.66-3.16C2.73-2.91 2.88-2.76 3.08-2.76C3.31-2.76 3.49-2.93 3.49-3.13C3.49-3.62 2.88-4.03 2.14-4.03C1.73-4.03 1.31-3.88 .96-3.59C.48-3.19 .22-2.59 .22-1.86C.22-.73 .91 .09 1.88 .09C2.26 .09 2.6-.04 2.89-.28C3.16-.49 3.33-.75 3.61-1.29Z'/>
<path id='eq129-g0-100' d='M4.3-.37V-.51C4.15-.5 4.13-.5 4.1-.5C3.79-.5 3.72-.6 3.72-1V-5.97L3.67-5.99C3.25-5.84 2.95-5.75 2.38-5.6V-5.46C2.45-5.47 2.51-5.47 2.58-5.47C2.9-5.47 2.98-5.38 2.98-5.02V-3.66C2.65-3.94 2.41-4.03 2.06-4.03C1.05-4.03 .24-3.04 .24-1.8C.24-.68 .89 .09 1.86 .09C2.35 .09 2.68-.09 2.98-.5V.06L3.02 .09L4.3-.37ZM2.98-.89C2.98-.83 2.92-.73 2.83-.63C2.67-.46 2.45-.37 2.2-.37C1.47-.37 .99-1.07 .99-2.15C.99-3.14 1.42-3.79 2.09-3.79C2.55-3.79 2.98-3.38 2.98-2.91V-.89Z'/>
<path id='eq129-g0-107' d='M4.43 0V-.13C4.04-.16 3.77-.32 3.4-.77L2.06-2.47L2.31-2.71C2.94-3.29 3.48-3.69 3.73-3.76C3.87-3.8 3.99-3.81 4.14-3.81H4.21V-3.95H2.42V-3.82C2.76-3.81 2.86-3.78 2.86-3.66C2.86-3.59 2.78-3.46 2.66-3.36L1.46-2.29V-5.97L1.42-5.99L.32-5.67L.06-5.6V-5.46C.18-5.47 .25-5.48 .34-5.48C.63-5.48 .72-5.37 .72-4.94V-.72C.72-.26 .69-.24 .06-.13V0H2.11V-.13L1.94-.14C1.59-.16 1.46-.28 1.46-.59V-2.2L2.68-.56L2.71-.53C2.73-.5 2.74-.47 2.77-.45C2.84-.36 2.87-.31 2.87-.26C2.87-.18 2.79-.13 2.68-.13H2.52V0H4.43Z'/>
<path id='eq129-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq129-g0-114' d='M2.94-3.57C2.94-3.86 2.75-4.03 2.45-4.03C2.09-4.03 1.83-3.83 1.4-3.21V-4.02L1.36-4.03C.89-3.84 .58-3.73 .06-3.56V-3.42C.18-3.45 .26-3.45 .37-3.45C.59-3.45 .67-3.31 .67-2.93V-.74C.67-.3 .6-.24 .04-.13V0H2.15V-.13C1.55-.16 1.4-.29 1.4-.79V-2.76C1.4-3.04 1.78-3.48 2.02-3.48C2.07-3.48 2.15-3.44 2.24-3.35C2.38-3.23 2.48-3.17 2.6-3.17C2.81-3.17 2.94-3.32 2.94-3.57Z'/>
</defs>
<g id='eq129-page1'>
<use x='78.74' y='-14.92' xlink:href='#eq129-g17-113'/>
<use x='85.9' y='-13.13' xlink:href='#eq129-g14-23'/>
<use x='91.43' y='-13.13' xlink:href='#eq129-g14-150'/>
<use x='93.72' y='-13.13' xlink:href='#eq129-g0-114'/>
<use x='96.64' y='-13.13' xlink:href='#eq129-g0-97'/>
<use x='100.53' y='-13.13' xlink:href='#eq129-g0-110'/>
<use x='104.92' y='-13.13' xlink:href='#eq129-g0-107'/>
<use x='113.12' y='-14.92' xlink:href='#eq129-g2-61'/>
<use x='123.52' y='-27.15' xlink:href='#eq129-g5-219'/>
<use x='129.55' y='-1.28' xlink:href='#eq129-g14-56'/>
<use x='138.82' y='-14.92' xlink:href='#eq129-g8-102'/>
<use x='144.33' y='-14.92' xlink:href='#eq129-g17-113'/>
<use x='151.49' y='-13.13' xlink:href='#eq129-g14-23'/>
<use x='156.98' y='-11.81' xlink:href='#eq129-g11-56'/>
<use x='160.82' y='-14.92' xlink:href='#eq129-g8-106'/>
<use x='164.16' y='-14.92' xlink:href='#eq129-g17-23'/>
<use x='171.46' y='-13.13' xlink:href='#eq129-g14-56'/>
<use x='178.41' y='-14.92' xlink:href='#eq129-g8-18'/>
<use x='190.16' y='-14.92' xlink:href='#eq129-g17-23'/>
<use x='197.71' y='-14.92' xlink:href='#eq129-g17-150'/>
<use x='202.82' y='-14.92' xlink:href='#eq129-g19-99'/>
<use x='208.13' y='-14.92' xlink:href='#eq129-g19-97'/>
<use x='213.43' y='-14.92' xlink:href='#eq129-g19-114'/>
<use x='217.42' y='-14.92' xlink:href='#eq129-g19-100'/>
<use x='223.99' y='-14.92' xlink:href='#eq129-g8-185'/>
<use x='228.92' y='-14.92' xlink:href='#eq129-g17-23'/>
<use x='236.22' y='-13.13' xlink:href='#eq129-g14-56'/>
<use x='239.49' y='-14.92' xlink:href='#eq129-g8-186'/>
<use x='247.39' y='-14.92' xlink:href='#eq129-g2-61'/>
<use x='257.85' y='-14.92' xlink:href='#eq129-g17-61'/>
<use x='266.64' y='-14.92' xlink:href='#eq129-g8-0'/>
<use x='276.9' y='-14.92' xlink:href='#eq129-g19-114'/>
<use x='280.88' y='-14.92' xlink:href='#eq129-g19-97'/>
<use x='286.19' y='-14.92' xlink:href='#eq129-g19-110'/>
<use x='292.17' y='-14.92' xlink:href='#eq129-g19-107'/>
<use x='298.44' y='-14.92' xlink:href='#eq129-g8-103'/>
<use x='306.98' y='-14.92' xlink:href='#eq129-g17-150'/>
</g>
</svg></div>
<p>which is identical to</p>
<div class="m-math"><svg style="width: 12.029em; height: 1.127em;" viewBox="133.76 -11.27 120.29 11.27">
<title>
\[ \phi_{B,\text{rank}} = I \vee \epsilon_{\check{B}} \xi_{B,n-\text{rank}} \; . \]
</title>
<defs>
<path id='eq130-g5-0' d='M5.01-2V-2.49H.54V-2H5.01Z'/>
<path id='eq130-g5-95' d='M5.17-4.86H4.67L2.86-.87L1.04-4.86H.54L2.79 0H2.93L5.17-4.86Z'/>
<path id='eq130-g11-23' d='M4.71-1.75C4.71-2.38 4.44-2.71 3.61-3.07C4.23-3.21 4.48-3.32 4.76-3.56C5-3.77 5.14-4.06 5.14-4.42C5.14-5.25 4.52-5.7 3.39-5.7H1.14V-5.56C1.69-5.52 1.81-5.46 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.39C3.76 0 4.71-.71 4.71-1.75ZM3.76-1.78C3.76-.84 3.12-.26 2.05-.26C1.69-.26 1.49-.38 1.49-.63C1.49-.74 1.6-1.15 1.8-1.85L2.08-2.89C2.63-2.89 3-2.86 3.18-2.79C3.55-2.65 3.76-2.26 3.76-1.78ZM4.25-4.5C4.25-3.6 3.67-3.17 2.46-3.17H2.17L2.73-5.2C2.79-5.39 2.89-5.44 3.23-5.44C3.94-5.44 4.25-5.14 4.25-4.5Z'/>
<path id='eq130-g11-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq130-g11-61' d='M4.14-.91L4.02-1.02C3.96-.94 3.9-.86 3.83-.79C3.58-.47 3.42-.33 3.3-.33C3.22-.33 3.16-.39 3.16-.47C3.16-.54 3.2-.71 3.28-1.02L3.78-2.82C3.83-3 3.86-3.2 3.86-3.32C3.86-3.63 3.62-3.85 3.28-3.85C2.73-3.85 2.17-3.32 1.28-1.93L1.86-3.83L1.83-3.85L.42-3.58V-3.44C.86-3.43 .98-3.38 .98-3.21C.98-3.15 .97-3.1 .96-3.06L.12 0H.78C1.19-1.38 1.27-1.57 1.65-2.17C2.17-2.98 2.62-3.41 2.94-3.41C3.07-3.41 3.15-3.31 3.15-3.15C3.15-3.05 3.1-2.76 3.03-2.49L2.65-1.05C2.53-.59 2.51-.48 2.51-.39C2.51-.06 2.63 .08 2.92 .08C3.31 .08 3.53-.1 4.14-.91Z'/>
<path id='eq130-g11-98' d='M4.07-5.18C4.07-5.3 4.03-5.38 3.88-5.38C3.28-5.38 2.96-4.82 2.62-4.82C2.38-4.82 2.31-5.05 2.31-5.22C2.31-5.46 2.6-5.64 2.73-5.71H2.28C2.27-5.71 1.97-5.53 1.97-5.23C1.97-4.85 2.19-4.79 2.38-4.69V-4.68C2.37-4.68 .91-4.31 .91-3.4C.91-2.66 1.8-2.62 1.81-2.62V-2.59C1.8-2.59-.06-2.21-.06-.86C-.06-.04 .59 .18 1.28 .18C1.9 .18 2.47 .2 2.47 .64C2.47 1.2 1.82 1.6 1.36 1.6C1.03 1.6 1.01 1.31 1.01 1.21C.92 1.25 .59 1.4 .59 1.59C.59 1.74 .82 1.81 .97 1.81C2.01 1.81 2.8 1.28 2.8 .33C2.8-.28 2.16-.34 1.76-.34C1.14-.34 .8-.61 .8-1.07C.8-2.01 1.73-2.45 2.28-2.45C2.77-2.45 2.99-2.35 3.13-2.35C3.35-2.35 3.56-2.47 3.56-2.76C3.56-2.92 3.54-3 3.35-3C3.1-3 2.84-2.78 2.23-2.78C1.71-2.78 1.66-3.13 1.66-3.36C1.66-4.18 2.55-4.59 2.56-4.59C2.83-4.53 3.05-4.52 3.23-4.52C3.94-4.52 4.07-4.87 4.07-5.18Z'/>
<path id='eq130-g11-110' d='M3.93-3.8C3.75-3.83 3.55-3.85 3.35-3.85C1.84-3.85 .68-3.13 .46-1.62C.3-.52 .89 .1 2.03 .1C2.39 .1 2.82 .07 3.21-.03L3.29-.33C2.96-.28 2.64-.24 2.31-.24C1.55-.24 1.12-.7 1.22-1.45C1.24-1.55 1.26-1.66 1.3-1.76L3.29-1.82L3.4-2.18L1.43-2.26C1.65-3.09 2.57-3.53 3.35-3.53C3.51-3.53 3.67-3.53 3.82-3.5L3.93-3.8Z'/>
<path id='eq130-g11-113' d='M4.59-2.54C4.59-3.18 4.12-3.72 3.25-3.83L3.76-5.5L3.04-5.39L2.65-3.83C1.28-3.69 .21-2.55 .21-1.26C.21-.61 .56 .03 1.68 .1L1.27 1.81H1.48L2.03 .09C3.46-.03 4.59-1.25 4.59-2.54ZM3.89-2.61C3.89-1.13 2.96-.23 2.1-.15L3.16-3.56C3.76-3.35 3.89-2.83 3.89-2.61ZM2.59-3.59L1.74-.17C1.15-.33 .94-.86 .94-1.23C.94-2.58 1.68-3.47 2.59-3.59Z'/>
<path id='eq130-g11-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
<path id='eq130-g11-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<use id='eq130-g8-95' xlink:href='#eq130-g5-95' transform='scale(1.36)'/>
<path id='eq130-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq130-g18-20' d='M2.81-5.89H2.52L1.45-4.99L.39-5.89H.1L1.18-4.43H1.72L2.81-5.89Z'/>
<path id='eq130-g0-97' d='M3.88-.35V-.58C3.73-.46 3.62-.41 3.49-.41C3.29-.41 3.23-.53 3.23-.92V-2.63C3.23-3.08 3.18-3.32 3.06-3.52C2.88-3.86 2.5-4.03 1.96-4.03C1.52-4.03 1.1-3.91 .85-3.71C.63-3.52 .49-3.27 .49-3.05C.49-2.85 .66-2.67 .87-2.67S1.26-2.85 1.26-3.04C1.26-3.08 1.25-3.12 1.24-3.18C1.23-3.26 1.22-3.33 1.22-3.39C1.22-3.63 1.5-3.82 1.85-3.82C2.28-3.82 2.52-3.57 2.52-3.09V-2.56C1.17-2.02 1.02-1.95 .64-1.61C.45-1.44 .32-1.14 .32-.85C.32-.3 .7 .09 1.24 .09C1.63 .09 1.99-.1 2.52-.55C2.57-.09 2.73 .09 3.09 .09C3.38 .09 3.57-.02 3.88-.35ZM2.52-1.08C2.52-.81 2.47-.73 2.29-.61C2.08-.49 1.83-.42 1.65-.42C1.34-.42 1.1-.72 1.1-1.1V-1.13C1.1-1.65 1.46-1.96 2.52-2.35V-1.08Z'/>
<path id='eq130-g0-107' d='M4.43 0V-.13C4.04-.16 3.77-.32 3.4-.77L2.06-2.47L2.31-2.71C2.94-3.29 3.48-3.69 3.73-3.76C3.87-3.8 3.99-3.81 4.14-3.81H4.21V-3.95H2.42V-3.82C2.76-3.81 2.86-3.78 2.86-3.66C2.86-3.59 2.78-3.46 2.66-3.36L1.46-2.29V-5.97L1.42-5.99L.32-5.67L.06-5.6V-5.46C.18-5.47 .25-5.48 .34-5.48C.63-5.48 .72-5.37 .72-4.94V-.72C.72-.26 .69-.24 .06-.13V0H2.11V-.13L1.94-.14C1.59-.16 1.46-.28 1.46-.59V-2.2L2.68-.56L2.71-.53C2.73-.5 2.74-.47 2.77-.45C2.84-.36 2.87-.31 2.87-.26C2.87-.18 2.79-.13 2.68-.13H2.52V0H4.43Z'/>
<path id='eq130-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq130-g0-114' d='M2.94-3.57C2.94-3.86 2.75-4.03 2.45-4.03C2.09-4.03 1.83-3.83 1.4-3.21V-4.02L1.36-4.03C.89-3.84 .58-3.73 .06-3.56V-3.42C.18-3.45 .26-3.45 .37-3.45C.59-3.45 .67-3.31 .67-2.93V-.74C.67-.3 .6-.24 .04-.13V0H2.15V-.13C1.55-.16 1.4-.29 1.4-.79V-2.76C1.4-3.04 1.78-3.48 2.02-3.48C2.07-3.48 2.15-3.44 2.24-3.35C2.38-3.23 2.48-3.17 2.6-3.17C2.81-3.17 2.94-3.32 2.94-3.57Z'/>
<use id='eq130-g14-30' xlink:href='#eq130-g11-30' transform='scale(1.36)'/>
<use id='eq130-g14-98' xlink:href='#eq130-g11-98' transform='scale(1.36)'/>
<use id='eq130-g14-110' xlink:href='#eq130-g11-110' transform='scale(1.36)'/>
<use id='eq130-g14-113' xlink:href='#eq130-g11-113' transform='scale(1.36)'/>
<use id='eq130-g14-149' xlink:href='#eq130-g11-149' transform='scale(1.36)'/>
</defs>
<g id='eq130-page1'>
<use x='133.76' y='-3.48' xlink:href='#eq130-g14-113'/>
<use x='140.92' y='-1.69' xlink:href='#eq130-g11-23'/>
<use x='146.45' y='-1.69' xlink:href='#eq130-g11-150'/>
<use x='148.74' y='-1.69' xlink:href='#eq130-g0-114'/>
<use x='151.66' y='-1.69' xlink:href='#eq130-g0-97'/>
<use x='155.55' y='-1.69' xlink:href='#eq130-g0-110'/>
<use x='159.93' y='-1.69' xlink:href='#eq130-g0-107'/>
<use x='168.13' y='-3.48' xlink:href='#eq130-g2-61'/>
<use x='179.02' y='-3.48' xlink:href='#eq130-g14-30'/>
<use x='186.53' y='-3.48' xlink:href='#eq130-g8-95'/>
<use x='197.04' y='-3.48' xlink:href='#eq130-g14-110'/>
<use x='204.5' y='-1.78' xlink:href='#eq130-g18-20'/>
<use x='202.41' y='0' xlink:href='#eq130-g11-23'/>
<use x='208.56' y='-3.48' xlink:href='#eq130-g14-98'/>
<use x='214.36' y='-1.69' xlink:href='#eq130-g11-23'/>
<use x='219.9' y='-1.69' xlink:href='#eq130-g11-150'/>
<use x='222.23' y='-1.69' xlink:href='#eq130-g11-61'/>
<use x='226.72' y='-1.69' xlink:href='#eq130-g5-0'/>
<use x='232.3' y='-1.69' xlink:href='#eq130-g0-114'/>
<use x='235.22' y='-1.69' xlink:href='#eq130-g0-97'/>
<use x='239.11' y='-1.69' xlink:href='#eq130-g0-110'/>
<use x='243.5' y='-1.69' xlink:href='#eq130-g0-107'/>
<use x='251.89' y='-3.48' xlink:href='#eq130-g14-149'/>
</g>
</svg></div>
<p><code>boundary</code> determines the boundary conditions. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
The default empty array causes the function to use <code>"add min"</code> with the rank filter,
and <code>"add max"</code> with the erosion, equivalent to ignoring what&rsquo;s outside the image.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>P. Soille, &ldquo;Morphological Image Analysis&rdquo;, 2<sup>nd</sup> Edition, section 4.4.3. Springer, 2002.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-RankMaxOpening-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-RankMaxOpening-dip-Image-CL-dip-Image-L-dip-StructuringElement--dip-uint--dip-StringArray-CL" class="m-doc-self">dip::<wbr />RankMaxOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> rank = 2,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Applies the rank-max opening, an opening that is somewhat robust to noise.</p>
<p><code>se</code> defines the structuring element. <code>rank</code> determines how many pixels in the SE
are ignored. That is, a rank filter with rank equal <code>rank + 1</code> is applied instead of an
erosion.</p>
<p>This function uses the definition of Soille (ref!):</p>
<div class="m-math"><svg style="width: 22.942em; height: 2.597em;" viewBox="79.25 -27.15 229.42 25.97">
<title>
\[ \gamma_{B,\text{rank}} = \bigvee_i \{ \gamma_{B_i} | B_i \subseteq B, \text{card}(B_i) = n-\text{rank} \} \; , \]
</title>
<defs>
<path id='eq131-g11-56' d='M1.75-.67L1.65-.75C1.34-.37 1.18-.24 1.05-.24C.99-.24 .93-.28 .92-.33C.92-.44 1-.64 1.04-.77L1.57-2.88L1.6-2.89C.83-2.76 .67-2.74 .37-2.73V-2.62C.78-2.61 .84-2.59 .85-2.46C.85-2.41 .83-2.3 .79-2.17L.5-1.02C.39-.62 .35-.43 .35-.3C.37-.06 .49 .07 .71 .07C1.07 .07 1.34-.12 1.75-.67ZM1.95-3.86C1.94-4.05 1.77-4.21 1.57-4.21S1.21-4.07 1.22-3.86C1.22-3.66 1.38-3.52 1.6-3.52C1.79-3.52 1.95-3.67 1.95-3.86Z'/>
<path id='eq131-g8-0' d='M6.84-2.73V-3.39H.74V-2.73H6.84Z'/>
<path id='eq131-g8-18' d='M6.96-.88V-1.48H3.5C2.35-1.48 1.21-2.51 1.21-3.85C1.21-5.11 2.2-6.22 3.5-6.22H6.96V-6.81H3.55C1.89-6.81 .62-5.42 .62-3.84S1.89-.87 3.55-.87L6.96-.88ZM6.96 .69V.06H.92V.69H6.96Z'/>
<path id='eq131-g8-102' d='M2.91-6.68C2.91-7.12 3.26-8 4.22-8.24C4.28-8.27 4.32-8.3 4.32-8.36C4.32-8.48 4.23-8.5 4.1-8.48C3.17-8.34 2.06-7.58 2.05-6.78V-4.66C2.05-4.24 1.98-3.64 1.81-3.54C1.38-3.24 .94-3.22 .68-3.22C.62-3.2 .57-3.13 .57-3.07C.57-2.95 .64-2.93 .76-2.92C1.55-2.88 1.88-2.51 2.01-1.98C2.05-1.86 2.05-1.85 2.05-1.45V.45C2.05 .91 1.93 1.44 2.5 1.85C2.97 2.17 3.63 2.36 4.1 2.36C4.23 2.36 4.32 2.36 4.32 2.23C4.32 2.12 4.25 2.14 4.13 2.11C3.33 1.91 3.1 1.49 2.94 .93C2.91 .83 2.91 .81 2.91 .43V-1.62C2.91-2.11 2.81-2.3 2.43-2.64C2.18-2.87 2.07-2.98 1.74-3.07C2.72-3.31 2.91-3.81 2.91-4.44V-6.68Z'/>
<path id='eq131-g8-103' d='M1.99-6.68V-4.44C1.99-3.81 2.18-3.31 3.16-3.07C2.82-2.98 2.72-2.87 2.47-2.64C2.08-2.3 1.99-2.11 1.99-1.62V.43C1.99 .81 1.99 .83 1.95 .93C1.8 1.49 1.56 1.91 .76 2.11C.64 2.14 .57 2.12 .57 2.23C.57 2.36 .67 2.36 .8 2.36C1.26 2.36 1.93 2.17 2.39 1.85C2.97 1.44 2.85 .91 2.85 .45V-1.45C2.85-1.85 2.85-1.86 2.88-1.98C3.01-2.51 3.35-2.88 4.13-2.92C4.25-2.93 4.32-2.95 4.32-3.07C4.32-3.13 4.28-3.2 4.22-3.22C3.95-3.22 3.51-3.24 3.08-3.54C2.92-3.64 2.85-4.24 2.85-4.66V-6.78C2.83-7.58 1.73-8.34 .8-8.48C.67-8.5 .57-8.48 .57-8.36C.57-8.3 .62-8.27 .68-8.24C1.63-8 1.99-7.12 1.99-6.68Z'/>
<path id='eq131-g8-106' d='M1.52 2.3V-8.42H.86V2.3H1.52Z'/>
<path id='eq131-g8-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq131-g8-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<use id='eq131-g19-97' xlink:href='#eq131-g0-97' transform='scale(1.36)'/>
<use id='eq131-g19-99' xlink:href='#eq131-g0-99' transform='scale(1.36)'/>
<use id='eq131-g19-100' xlink:href='#eq131-g0-100' transform='scale(1.36)'/>
<use id='eq131-g19-107' xlink:href='#eq131-g0-107' transform='scale(1.36)'/>
<use id='eq131-g19-110' xlink:href='#eq131-g0-110' transform='scale(1.36)'/>
<use id='eq131-g19-114' xlink:href='#eq131-g0-114' transform='scale(1.36)'/>
<path id='eq131-g5-220' d='M13.97 0H13.26L7.47 16.48L1.69 0H.98L7.4 18.34H7.56L13.97 0Z'/>
<path id='eq131-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq131-g0-97' d='M3.88-.35V-.58C3.73-.46 3.62-.41 3.49-.41C3.29-.41 3.23-.53 3.23-.92V-2.63C3.23-3.08 3.18-3.32 3.06-3.52C2.88-3.86 2.5-4.03 1.96-4.03C1.52-4.03 1.1-3.91 .85-3.71C.63-3.52 .49-3.27 .49-3.05C.49-2.85 .66-2.67 .87-2.67S1.26-2.85 1.26-3.04C1.26-3.08 1.25-3.12 1.24-3.18C1.23-3.26 1.22-3.33 1.22-3.39C1.22-3.63 1.5-3.82 1.85-3.82C2.28-3.82 2.52-3.57 2.52-3.09V-2.56C1.17-2.02 1.02-1.95 .64-1.61C.45-1.44 .32-1.14 .32-.85C.32-.3 .7 .09 1.24 .09C1.63 .09 1.99-.1 2.52-.55C2.57-.09 2.73 .09 3.09 .09C3.38 .09 3.57-.02 3.88-.35ZM2.52-1.08C2.52-.81 2.47-.73 2.29-.61C2.08-.49 1.83-.42 1.65-.42C1.34-.42 1.1-.72 1.1-1.1V-1.13C1.1-1.65 1.46-1.96 2.52-2.35V-1.08Z'/>
<path id='eq131-g0-99' d='M3.61-1.29L3.49-1.37C3.07-.75 2.75-.54 2.25-.54C1.45-.54 .89-1.24 .89-2.25C.89-3.16 1.38-3.78 2.09-3.78C2.4-3.78 2.52-3.68 2.6-3.36L2.66-3.16C2.73-2.91 2.88-2.76 3.08-2.76C3.31-2.76 3.49-2.93 3.49-3.13C3.49-3.62 2.88-4.03 2.14-4.03C1.73-4.03 1.31-3.88 .96-3.59C.48-3.19 .22-2.59 .22-1.86C.22-.73 .91 .09 1.88 .09C2.26 .09 2.6-.04 2.89-.28C3.16-.49 3.33-.75 3.61-1.29Z'/>
<path id='eq131-g0-100' d='M4.3-.37V-.51C4.15-.5 4.13-.5 4.1-.5C3.79-.5 3.72-.6 3.72-1V-5.97L3.67-5.99C3.25-5.84 2.95-5.75 2.38-5.6V-5.46C2.45-5.47 2.51-5.47 2.58-5.47C2.9-5.47 2.98-5.38 2.98-5.02V-3.66C2.65-3.94 2.41-4.03 2.06-4.03C1.05-4.03 .24-3.04 .24-1.8C.24-.68 .89 .09 1.86 .09C2.35 .09 2.68-.09 2.98-.5V.06L3.02 .09L4.3-.37ZM2.98-.89C2.98-.83 2.92-.73 2.83-.63C2.67-.46 2.45-.37 2.2-.37C1.47-.37 .99-1.07 .99-2.15C.99-3.14 1.42-3.79 2.09-3.79C2.55-3.79 2.98-3.38 2.98-2.91V-.89Z'/>
<path id='eq131-g0-107' d='M4.43 0V-.13C4.04-.16 3.77-.32 3.4-.77L2.06-2.47L2.31-2.71C2.94-3.29 3.48-3.69 3.73-3.76C3.87-3.8 3.99-3.81 4.14-3.81H4.21V-3.95H2.42V-3.82C2.76-3.81 2.86-3.78 2.86-3.66C2.86-3.59 2.78-3.46 2.66-3.36L1.46-2.29V-5.97L1.42-5.99L.32-5.67L.06-5.6V-5.46C.18-5.47 .25-5.48 .34-5.48C.63-5.48 .72-5.37 .72-4.94V-.72C.72-.26 .69-.24 .06-.13V0H2.11V-.13L1.94-.14C1.59-.16 1.46-.28 1.46-.59V-2.2L2.68-.56L2.71-.53C2.73-.5 2.74-.47 2.77-.45C2.84-.36 2.87-.31 2.87-.26C2.87-.18 2.79-.13 2.68-.13H2.52V0H4.43Z'/>
<path id='eq131-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq131-g0-114' d='M2.94-3.57C2.94-3.86 2.75-4.03 2.45-4.03C2.09-4.03 1.83-3.83 1.4-3.21V-4.02L1.36-4.03C.89-3.84 .58-3.73 .06-3.56V-3.42C.18-3.45 .26-3.45 .37-3.45C.59-3.45 .67-3.31 .67-2.93V-.74C.67-.3 .6-.24 .04-.13V0H2.15V-.13C1.55-.16 1.4-.29 1.4-.79V-2.76C1.4-3.04 1.78-3.48 2.02-3.48C2.07-3.48 2.15-3.44 2.24-3.35C2.38-3.23 2.48-3.17 2.6-3.17C2.81-3.17 2.94-3.32 2.94-3.57Z'/>
<path id='eq131-g14-23' d='M4.71-1.75C4.71-2.38 4.44-2.71 3.61-3.07C4.23-3.21 4.48-3.32 4.76-3.56C5-3.77 5.14-4.06 5.14-4.42C5.14-5.25 4.52-5.7 3.39-5.7H1.14V-5.56C1.69-5.52 1.81-5.46 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.39C3.76 0 4.71-.71 4.71-1.75ZM3.76-1.78C3.76-.84 3.12-.26 2.05-.26C1.69-.26 1.49-.38 1.49-.63C1.49-.74 1.6-1.15 1.8-1.85L2.08-2.89C2.63-2.89 3-2.86 3.18-2.79C3.55-2.65 3.76-2.26 3.76-1.78ZM4.25-4.5C4.25-3.6 3.67-3.17 2.46-3.17H2.17L2.73-5.2C2.79-5.39 2.89-5.44 3.23-5.44C3.94-5.44 4.25-5.14 4.25-4.5Z'/>
<path id='eq131-g14-56' d='M2.05-.9L1.94-1C1.56-.5 1.37-.31 1.22-.31C1.15-.31 1.08-.38 1.08-.45C1.08-.59 1.17-.85 1.22-1.02L1.99-3.83L1.97-3.85C1.08-3.69 .91-3.66 .57-3.63V-3.49C1.04-3.49 1.12-3.46 1.12-3.28C1.12-3.21 1.09-3.07 1.04-2.9L.62-1.35C.48-.83 .43-.58 .43-.4C.43-.08 .57 .1 .83 .1C1.24 .1 1.55-.17 2.05-.9ZM2.41-5.14C2.41-5.39 2.21-5.62 1.97-5.62S1.56-5.42 1.56-5.15C1.56-4.87 1.73-4.69 1.98-4.69C2.21-4.69 2.41-4.89 2.41-5.14Z'/>
<path id='eq131-g14-61' d='M4.14-.91L4.02-1.02C3.96-.94 3.9-.86 3.83-.79C3.58-.47 3.42-.33 3.3-.33C3.22-.33 3.16-.39 3.16-.47C3.16-.54 3.2-.71 3.28-1.02L3.78-2.82C3.83-3 3.86-3.2 3.86-3.32C3.86-3.63 3.62-3.85 3.28-3.85C2.73-3.85 2.17-3.32 1.28-1.93L1.86-3.83L1.83-3.85L.42-3.58V-3.44C.86-3.43 .98-3.38 .98-3.21C.98-3.15 .97-3.1 .96-3.06L.12 0H.78C1.19-1.38 1.27-1.57 1.65-2.17C2.17-2.98 2.62-3.41 2.94-3.41C3.07-3.41 3.15-3.31 3.15-3.15C3.15-3.05 3.1-2.76 3.03-2.49L2.65-1.05C2.53-.59 2.51-.48 2.51-.39C2.51-.06 2.63 .08 2.92 .08C3.31 .08 3.53-.1 4.14-.91Z'/>
<path id='eq131-g14-87' d='M4.64-3.83L4-3.71C3.6-2.77 3.13-1.84 2.52-1.01C2.55-1.87 2.61-3.85 1.36-3.85C.78-3.85 .03-3.07 .03-2.55C.03-2.52 .03-2.49 .07-2.49C.26-2.49 .24-3.23 1.1-3.23C2.01-3.23 2.05-1.45 2.05-.81C2.05-.59 2.04-.38 2.04-.17C1.75 .22 1.04 1.1 1.04 1.58C1.04 1.74 1.11 1.81 1.28 1.81C2 1.81 2.13 .32 2.37-.17C2.52-.48 2.88-.92 3.08-1.21C3.66-2.03 4.29-2.89 4.64-3.83Z'/>
<path id='eq131-g14-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<use id='eq131-g17-23' xlink:href='#eq131-g14-23' transform='scale(1.36)'/>
<use id='eq131-g17-61' xlink:href='#eq131-g14-61' transform='scale(1.36)'/>
<use id='eq131-g17-87' xlink:href='#eq131-g14-87' transform='scale(1.36)'/>
<use id='eq131-g17-150' xlink:href='#eq131-g14-150' transform='scale(1.36)'/>
</defs>
<g id='eq131-page1'>
<use x='79.25' y='-14.92' xlink:href='#eq131-g17-87'/>
<use x='85.9' y='-13.13' xlink:href='#eq131-g14-23'/>
<use x='91.43' y='-13.13' xlink:href='#eq131-g14-150'/>
<use x='93.72' y='-13.13' xlink:href='#eq131-g0-114'/>
<use x='96.64' y='-13.13' xlink:href='#eq131-g0-97'/>
<use x='100.53' y='-13.13' xlink:href='#eq131-g0-110'/>
<use x='104.92' y='-13.13' xlink:href='#eq131-g0-107'/>
<use x='113.12' y='-14.92' xlink:href='#eq131-g2-61'/>
<use x='123.52' y='-27.15' xlink:href='#eq131-g5-220'/>
<use x='129.55' y='-1.28' xlink:href='#eq131-g14-56'/>
<use x='138.82' y='-14.92' xlink:href='#eq131-g8-102'/>
<use x='144.2' y='-14.92' xlink:href='#eq131-g17-87'/>
<use x='150.85' y='-13.13' xlink:href='#eq131-g14-23'/>
<use x='156.34' y='-11.81' xlink:href='#eq131-g11-56'/>
<use x='160.19' y='-14.92' xlink:href='#eq131-g8-106'/>
<use x='163.52' y='-14.92' xlink:href='#eq131-g17-23'/>
<use x='170.83' y='-13.13' xlink:href='#eq131-g14-56'/>
<use x='177.78' y='-14.92' xlink:href='#eq131-g8-18'/>
<use x='189.53' y='-14.92' xlink:href='#eq131-g17-23'/>
<use x='197.07' y='-14.92' xlink:href='#eq131-g17-150'/>
<use x='202.18' y='-14.92' xlink:href='#eq131-g19-99'/>
<use x='207.49' y='-14.92' xlink:href='#eq131-g19-97'/>
<use x='212.8' y='-14.92' xlink:href='#eq131-g19-114'/>
<use x='216.78' y='-14.92' xlink:href='#eq131-g19-100'/>
<use x='223.36' y='-14.92' xlink:href='#eq131-g8-185'/>
<use x='228.28' y='-14.92' xlink:href='#eq131-g17-23'/>
<use x='235.59' y='-13.13' xlink:href='#eq131-g14-56'/>
<use x='238.86' y='-14.92' xlink:href='#eq131-g8-186'/>
<use x='246.76' y='-14.92' xlink:href='#eq131-g2-61'/>
<use x='257.22' y='-14.92' xlink:href='#eq131-g17-61'/>
<use x='266.01' y='-14.92' xlink:href='#eq131-g8-0'/>
<use x='276.27' y='-14.92' xlink:href='#eq131-g19-114'/>
<use x='280.25' y='-14.92' xlink:href='#eq131-g19-97'/>
<use x='285.56' y='-14.92' xlink:href='#eq131-g19-110'/>
<use x='291.53' y='-14.92' xlink:href='#eq131-g19-107'/>
<use x='297.81' y='-14.92' xlink:href='#eq131-g8-103'/>
<use x='306.34' y='-14.92' xlink:href='#eq131-g17-150'/>
</g>
</svg></div>
<p>which is identical to</p>
<div class="m-math"><svg style="width: 11.990em; height: 1.131em;" viewBox="133.89 -11.31 119.9 11.31">
<title>
\[ \gamma_{B,\text{rank}} = I \wedge \delta_{\check{B}} \xi_{B,\text{rank}+1} \; . \]
</title>
<defs>
<use id='eq132-g14-30' xlink:href='#eq132-g11-30' transform='scale(1.36)'/>
<use id='eq132-g14-87' xlink:href='#eq132-g11-87' transform='scale(1.36)'/>
<use id='eq132-g14-88' xlink:href='#eq132-g11-88' transform='scale(1.36)'/>
<use id='eq132-g14-98' xlink:href='#eq132-g11-98' transform='scale(1.36)'/>
<use id='eq132-g14-149' xlink:href='#eq132-g11-149' transform='scale(1.36)'/>
<use id='eq132-g8-94' xlink:href='#eq132-g5-94' transform='scale(1.36)'/>
<path id='eq132-g2-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq132-g5-94' d='M5.17 0L2.93-4.86H2.79L.54 0H1.04L2.86-3.98L4.67 0H5.17Z'/>
<path id='eq132-g5-184' d='M2.17-2.5H.26V-1.92H2.17V0H2.75V-1.92H4.66V-2.5H2.75V-4.42H2.17V-2.5Z'/>
<path id='eq132-g11-23' d='M4.71-1.75C4.71-2.38 4.44-2.71 3.61-3.07C4.23-3.21 4.48-3.32 4.76-3.56C5-3.77 5.14-4.06 5.14-4.42C5.14-5.25 4.52-5.7 3.39-5.7H1.14V-5.56C1.69-5.52 1.81-5.46 1.81-5.21C1.81-5.07 1.77-4.87 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.39C3.76 0 4.71-.71 4.71-1.75ZM3.76-1.78C3.76-.84 3.12-.26 2.05-.26C1.69-.26 1.49-.38 1.49-.63C1.49-.74 1.6-1.15 1.8-1.85L2.08-2.89C2.63-2.89 3-2.86 3.18-2.79C3.55-2.65 3.76-2.26 3.76-1.78ZM4.25-4.5C4.25-3.6 3.67-3.17 2.46-3.17H2.17L2.73-5.2C2.79-5.39 2.89-5.44 3.23-5.44C3.94-5.44 4.25-5.14 4.25-4.5Z'/>
<path id='eq132-g11-30' d='M2.06 0V-.14C1.56-.2 1.47-.25 1.47-.5C1.47-.67 1.48-.76 1.56-1.05L2.64-4.92C2.79-5.42 2.85-5.48 3.35-5.56V-5.7H1.2V-5.56C1.7-5.5 1.81-5.44 1.81-5.19C1.81-5.06 1.78-4.88 1.71-4.65L.64-.79C.48-.28 .42-.23-.07-.14V0H2.06Z'/>
<path id='eq132-g11-87' d='M4.64-3.83L4-3.71C3.6-2.77 3.13-1.84 2.52-1.01C2.55-1.87 2.61-3.85 1.36-3.85C.78-3.85 .03-3.07 .03-2.55C.03-2.52 .03-2.49 .07-2.49C.26-2.49 .24-3.23 1.1-3.23C2.01-3.23 2.05-1.45 2.05-.81C2.05-.59 2.04-.38 2.04-.17C1.75 .22 1.04 1.1 1.04 1.58C1.04 1.74 1.11 1.81 1.28 1.81C2 1.81 2.13 .32 2.37-.17C2.52-.48 2.88-.92 3.08-1.21C3.66-2.03 4.29-2.89 4.64-3.83Z'/>
<path id='eq132-g11-88' d='M4.04-5.24C4.04-5.51 3.63-5.74 2.92-5.74C2.22-5.74 1.65-5.35 1.65-4.81C1.65-4.24 2.25-3.61 2.25-3.6C2.24-3.6 .16-3.26 .16-1.28C.16-.68 .46 .13 1.35 .13C2.59 .13 3.57-1 3.57-2.43C3.57-3.88 1.98-4.06 1.98-4.91C1.98-5.3 2.45-5.47 2.73-5.47C3.55-5.47 3.36-4.97 3.73-4.97C3.91-4.97 4.04-5.09 4.04-5.24ZM2.87-2.14C2.87-1.01 2.15-.1 1.55-.1C1.07-.1 .89-.76 .89-1.25C.89-3.27 2.41-3.42 2.42-3.42C2.42-3.41 2.87-2.85 2.87-2.14Z'/>
<path id='eq132-g11-98' d='M4.07-5.18C4.07-5.3 4.03-5.38 3.88-5.38C3.28-5.38 2.96-4.82 2.62-4.82C2.38-4.82 2.31-5.05 2.31-5.22C2.31-5.46 2.6-5.64 2.73-5.71H2.28C2.27-5.71 1.97-5.53 1.97-5.23C1.97-4.85 2.19-4.79 2.38-4.69V-4.68C2.37-4.68 .91-4.31 .91-3.4C.91-2.66 1.8-2.62 1.81-2.62V-2.59C1.8-2.59-.06-2.21-.06-.86C-.06-.04 .59 .18 1.28 .18C1.9 .18 2.47 .2 2.47 .64C2.47 1.2 1.82 1.6 1.36 1.6C1.03 1.6 1.01 1.31 1.01 1.21C.92 1.25 .59 1.4 .59 1.59C.59 1.74 .82 1.81 .97 1.81C2.01 1.81 2.8 1.28 2.8 .33C2.8-.28 2.16-.34 1.76-.34C1.14-.34 .8-.61 .8-1.07C.8-2.01 1.73-2.45 2.28-2.45C2.77-2.45 2.99-2.35 3.13-2.35C3.35-2.35 3.56-2.47 3.56-2.76C3.56-2.92 3.54-3 3.35-3C3.1-3 2.84-2.78 2.23-2.78C1.71-2.78 1.66-3.13 1.66-3.36C1.66-4.18 2.55-4.59 2.56-4.59C2.83-4.53 3.05-4.52 3.23-4.52C3.94-4.52 4.07-4.87 4.07-5.18Z'/>
<path id='eq132-g11-149' d='M1.58-.38C1.58-.65 1.35-.87 1.09-.87S.61-.66 .61-.38C.61-.04 .91 .1 1.09 .1S1.58-.05 1.58-.38Z'/>
<path id='eq132-g11-150' d='M1.7-.05C1.7-.78 1.2-.89 1-.89C.78-.89 .49-.76 .49-.38C.49-.03 .8 .05 1.03 .05C1.09 .05 1.14 .04 1.16 .03C1.2 .03 1.22 .02 1.24 .02C1.3 .02 1.36 .06 1.36 .14C1.36 .31 1.22 .7 .65 1.07L.72 1.23C.99 1.14 1.7 .57 1.7-.05Z'/>
<path id='eq132-g18-20' d='M2.81-5.89H2.52L1.45-4.99L.39-5.89H.1L1.18-4.43H1.72L2.81-5.89Z'/>
<path id='eq132-g18-49' d='M3.44 0V-.13C2.75-.14 2.61-.23 2.61-.65V-5.89L2.54-5.9L.97-5.11V-4.99C1.07-5.03 1.17-5.07 1.21-5.08C1.36-5.14 1.51-5.18 1.6-5.18C1.78-5.18 1.86-5.05 1.86-4.77V-.81C1.86-.52 1.79-.32 1.65-.24C1.52-.17 1.4-.14 1.03-.13V0H3.44Z'/>
<path id='eq132-g0-97' d='M3.88-.35V-.58C3.73-.46 3.62-.41 3.49-.41C3.29-.41 3.23-.53 3.23-.92V-2.63C3.23-3.08 3.18-3.32 3.06-3.52C2.88-3.86 2.5-4.03 1.96-4.03C1.52-4.03 1.1-3.91 .85-3.71C.63-3.52 .49-3.27 .49-3.05C.49-2.85 .66-2.67 .87-2.67S1.26-2.85 1.26-3.04C1.26-3.08 1.25-3.12 1.24-3.18C1.23-3.26 1.22-3.33 1.22-3.39C1.22-3.63 1.5-3.82 1.85-3.82C2.28-3.82 2.52-3.57 2.52-3.09V-2.56C1.17-2.02 1.02-1.95 .64-1.61C.45-1.44 .32-1.14 .32-.85C.32-.3 .7 .09 1.24 .09C1.63 .09 1.99-.1 2.52-.55C2.57-.09 2.73 .09 3.09 .09C3.38 .09 3.57-.02 3.88-.35ZM2.52-1.08C2.52-.81 2.47-.73 2.29-.61C2.08-.49 1.83-.42 1.65-.42C1.34-.42 1.1-.72 1.1-1.1V-1.13C1.1-1.65 1.46-1.96 2.52-2.35V-1.08Z'/>
<path id='eq132-g0-107' d='M4.43 0V-.13C4.04-.16 3.77-.32 3.4-.77L2.06-2.47L2.31-2.71C2.94-3.29 3.48-3.69 3.73-3.76C3.87-3.8 3.99-3.81 4.14-3.81H4.21V-3.95H2.42V-3.82C2.76-3.81 2.86-3.78 2.86-3.66C2.86-3.59 2.78-3.46 2.66-3.36L1.46-2.29V-5.97L1.42-5.99L.32-5.67L.06-5.6V-5.46C.18-5.47 .25-5.48 .34-5.48C.63-5.48 .72-5.37 .72-4.94V-.72C.72-.26 .69-.24 .06-.13V0H2.11V-.13L1.94-.14C1.59-.16 1.46-.28 1.46-.59V-2.2L2.68-.56L2.71-.53C2.73-.5 2.74-.47 2.77-.45C2.84-.36 2.87-.31 2.87-.26C2.87-.18 2.79-.13 2.68-.13H2.52V0H4.43Z'/>
<path id='eq132-g0-110' d='M4.25 0V-.13C3.82-.18 3.72-.28 3.72-.71V-2.72C3.72-3.54 3.33-4.03 2.68-4.03C2.28-4.03 2.01-3.88 1.41-3.32V-4.02L1.35-4.03C.92-3.88 .62-3.78 .14-3.64V-3.49C.19-3.52 .28-3.52 .38-3.52C.62-3.52 .7-3.39 .7-2.96V-.79C.7-.29 .6-.17 .16-.13V0H2.02V-.13C1.57-.17 1.44-.27 1.44-.59V-3.05C1.86-3.45 2.05-3.55 2.34-3.55C2.77-3.55 2.98-3.28 2.98-2.7V-.87C2.98-.32 2.87-.17 2.43-.13V0H4.25Z'/>
<path id='eq132-g0-114' d='M2.94-3.57C2.94-3.86 2.75-4.03 2.45-4.03C2.09-4.03 1.83-3.83 1.4-3.21V-4.02L1.36-4.03C.89-3.84 .58-3.73 .06-3.56V-3.42C.18-3.45 .26-3.45 .37-3.45C.59-3.45 .67-3.31 .67-2.93V-.74C.67-.3 .6-.24 .04-.13V0H2.15V-.13C1.55-.16 1.4-.29 1.4-.79V-2.76C1.4-3.04 1.78-3.48 2.02-3.48C2.07-3.48 2.15-3.44 2.24-3.35C2.38-3.23 2.48-3.17 2.6-3.17C2.81-3.17 2.94-3.32 2.94-3.57Z'/>
</defs>
<g id='eq132-page1'>
<use x='133.89' y='-3.48' xlink:href='#eq132-g14-87'/>
<use x='140.54' y='-1.69' xlink:href='#eq132-g11-23'/>
<use x='146.07' y='-1.69' xlink:href='#eq132-g11-150'/>
<use x='148.36' y='-1.69' xlink:href='#eq132-g0-114'/>
<use x='151.28' y='-1.69' xlink:href='#eq132-g0-97'/>
<use x='155.17' y='-1.69' xlink:href='#eq132-g0-110'/>
<use x='159.56' y='-1.69' xlink:href='#eq132-g0-107'/>
<use x='167.76' y='-3.48' xlink:href='#eq132-g2-61'/>
<use x='178.65' y='-3.48' xlink:href='#eq132-g14-30'/>
<use x='186.16' y='-3.48' xlink:href='#eq132-g8-94'/>
<use x='196.8' y='-3.48' xlink:href='#eq132-g14-88'/>
<use x='205.03' y='-1.78' xlink:href='#eq132-g18-20'/>
<use x='202.94' y='0' xlink:href='#eq132-g11-23'/>
<use x='209.09' y='-3.48' xlink:href='#eq132-g14-98'/>
<use x='214.9' y='-1.69' xlink:href='#eq132-g11-23'/>
<use x='220.43' y='-1.69' xlink:href='#eq132-g11-150'/>
<use x='222.72' y='-1.69' xlink:href='#eq132-g0-114'/>
<use x='225.63' y='-1.69' xlink:href='#eq132-g0-97'/>
<use x='229.53' y='-1.69' xlink:href='#eq132-g0-110'/>
<use x='233.91' y='-1.69' xlink:href='#eq132-g0-107'/>
<use x='238.29' y='-1.69' xlink:href='#eq132-g5-184'/>
<use x='243.24' y='-1.69' xlink:href='#eq132-g18-49'/>
<use x='251.63' y='-3.48' xlink:href='#eq132-g14-149'/>
</g>
</svg></div>
<p><code>boundary</code> determines the boundary conditions. See <a href="boundary.html#dip-BoundaryCondition"><code>dip::BoundaryCondition</code></a>.
The default empty array causes the function to use <code>"add min"</code> with the dilation,
and <code>"add max"</code> with the rank filter, equivalent to ignoring what&rsquo;s outside the image.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>P. Soille, &ldquo;Morphological Image Analysis&rdquo;, 2<sup>nd</sup> Edition, section 4.4.3. Springer, 2002.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-UpperSkeleton2D-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-UpperSkeleton2D-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-String-CL" class="m-doc-self">dip::<wbr />UpperSkeleton2D</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; endPixelCondition = S::NATURAL)</span></span>
            </h3>
            <p>Grey-value skeleton (2D only).</p>
<p>This algorithm finds ridges in the image by, starting at the lowest values, setting values to the minimum possible
value for the given data type if that doesn&rsquo;t change the topology of the higher-valued pixels.
It uses Hilditch conditions to preserve topology. The unmodified pixels are the grey-value equivalent to a binary
skeleton. Note that the minimum possible value is minus infinity for floating-point types.</p>
<p>The <code>mask</code> image optionally restricts the region of the image processed. Pixels not selected by the mask will
retain their original value.</p>
<p>The <code>endPixelCondition</code> parameter determines what is considered an &ldquo;end pixel&rdquo; in the skeleton, and thus affects
how many branches are generated. It is one of the following strings:</p>
<ul>
<li><code>"natural"</code>: &ldquo;natural&rdquo; end pixel condition of this algorithm.</li>
<li><code>"one neighbor"</code>: Keep endpoint if it has one neighbor.</li>
<li><code>"two neighbors"</code>: Keep endpoint if it has two neighbors.</li>
<li><code>"three neighbors"</code>: Keep endpoint if it has three neighbors.</li>
</ul>
<p>To generate skeletons without end pixels (the equivalent of <code>"loose ends away"</code> in <a href="binary.html#dip-EuclideanSkeleton-dip-Image-CL-dip-Image-L-dip-String-CL-dip-String-CL"><code>dip::EuclideanSkeleton</code></a>),
use <a href="segmentation.html#dip-Watershed-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-uint--dip-StringSet-"><code>dip::Watershed</code></a> instead.</p>
<p><code>in</code> must be a real-valued, scalar image. <code>out</code> will have the same type.</p>
<aside class="m-note m-info">
<h4>Attention</h4>
<p>Pixels in a 1-pixel border around the edge are not processed, and set to the non-skeleton value.
If this is an issue, consider adding one pixel on each side of your image.</p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL" class="m-doc-self">dip::<wbr />MorphologicalReconstruction</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; marker,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; direction = S::DILATION)</span></span>
            </h3>
            <p>Reconstruction by dilation or erosion, also known as inf-reconstruction and sup-reconstruction</p>
<p>This function has the same effect as iteratively dilating (eroding) the image <code>marker</code> such that it remains lower
(higher) than <code>in</code> everywhere, until stability. However, this is implemented with a much more efficiently.
<code>direction</code> indicates which of the two operations to apply (<code>"dilation"</code> or <code>"erosion"</code>).</p>
<p><code>out</code> will have the data type of <code>in</code>, and <code>marker</code> will be cast to that same type (with clamping to the target
range, see <a href="dip-Image.html#dip-Convert-dip-Image-CL-dip-Image-L-dip-DataType-"><code>dip::Convert</code></a>).</p>
<p>See <a href="concepts.html#connectivity">Connectivity</a> for information on the connectivity parameter.</p>
<p>The algorithm implemented is a hybrid between the method proposed by Vincent (a forward raster scan, followed
by a backward raster scan, followed by a LIFO queue propagation method), and that proposed by Robinson and Whelan
(a priority queue method). We implement the forward and backward scan, and follow it by a priority queue propagation.
The priority queue method has the advantage of visiting each pixels exactly once.</p>
<p>For binary images, <a href="binary.html#dip-BinaryPropagation-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-sint--dip-uint--dip-String-CL"><code>dip::BinaryPropagation</code></a> is more flexible. That function additionally allows choosing a
boundary condition, allows limiting the number of reconstruction steps, and supports alternating connectivity,
which yields a more isotropic result when limiting the number of reconstruction steps.
However, this function is faster.</p>
<p>This functions is used by <a href="morphology.html#dip-LimitedMorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL"><code>dip::LimitedMorphologicalReconstruction</code></a>, <a href="morphology.html#dip-HMinima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-"><code>dip::HMinima</code></a>, <a href="morphology.html#dip-HMaxima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-"><code>dip::HMaxima</code></a>,
<a href="morphology.html#dip-Leveling-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint-"><code>dip::Leveling</code></a>, <a href="morphology.html#dip-OpeningByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL"><code>dip::OpeningByReconstruction</code></a>, <a href="morphology.html#dip-ClosingByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL"><code>dip::ClosingByReconstruction</code></a></p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>L. Vincent, &ldquo;Morphological grayscale reconstruction in image analysis: applications and efficient algorithms&rdquo;,
  IEEE Transactions on Image Processing 2(2):176-201, 1993.</li>
<li>K. Robinson and P.F. Whelan, &ldquo;Efficient morphological reconstruction: a downhill filter&rdquo;, Pattern Recognition
  Letters 25:1759-1767, 2004.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-LimitedMorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-LimitedMorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL" class="m-doc-self">dip::<wbr />LimitedMorphologicalReconstruction</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; marker,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> maxDistance = 20,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; direction = S::DILATION)</span></span>
            </h3>
            <p>Reconstruction by dilation or erosion, but with a limited reach.</p>
<p>Performs the same function as <a href="morphology.html#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::MorphologicalReconstruction</code></a>, but limiting the
reach of the operation to <code>maxDistance</code> pixels. This is an Euclidean distance, and
determines the zone of influence of each value in <code>marker</code>. The limited reach is
accomplished by updating <code>in</code>, rather than counting propagation steps.</p>
<p>See <a href="morphology.html#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::MorphologicalReconstruction</code></a> for the meaning of the rest of the parameters,
and more information about the algorithm.</p>
          </div></section>
          <section class="m-doc-details" id="dip-HMinima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-HMinima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-" class="m-doc-self">dip::<wbr />HMinima</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> h,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span></span>
            </h3>
            <p>Computes the H-Minima filtered image</p>
<p>The H-Minima filtered image has all local minima with a depth less than <code>h</code> removed:</p>
<div class="m-code"><pre><span></span><span class="n">HMinima</span> <span class="o">=</span> <span class="n">dip</span><span class="o">::</span><span class="n">MorphologicalReconstruction</span><span class="p">(</span> <span class="n">in</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">in</span><span class="p">,</span> <span class="n">connectivity</span><span class="p">,</span> <span class="s">&quot;erosion&quot;</span> <span class="p">);</span>
</pre></div>

<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::MorphologicalReconstruction</code></a>, <a href="segmentation.html#dip-Minima-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::Minima</code></a>, <a href="morphology.html#dip-HMaxima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-"><code>dip::HMaxima</code></a></p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-HMaxima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-HMaxima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-" class="m-doc-self">dip::<wbr />HMaxima</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> h,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span></span>
            </h3>
            <p>Computes the H-Maxima filtered image</p>
<p>The H-Maxima filtered image has all local maxima with a height less than <code>h</code> removed:</p>
<div class="m-code"><pre><span></span><span class="n">HMaxima</span> <span class="o">=</span> <span class="n">dip</span><span class="o">::</span><span class="n">MorphologicalReconstruction</span><span class="p">(</span> <span class="n">in</span> <span class="o">-</span> <span class="n">h</span><span class="p">,</span> <span class="n">in</span><span class="p">,</span> <span class="n">connectivity</span><span class="p">,</span> <span class="s">&quot;dilation&quot;</span> <span class="p">);</span>
</pre></div>

<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::MorphologicalReconstruction</code></a>, <a href="segmentation.html#dip-Maxima-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::Maxima</code></a>, <a href="morphology.html#dip-HMinima-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-"><code>dip::HMinima</code></a></p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-ImposeMinima-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint-"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-ImposeMinima-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint-" class="m-doc-self">dip::<wbr />ImposeMinima</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; marker,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span></span>
            </h3>
            <p>Impose minima.</p>
<p>Regions in <code>marker</code> will be the only local minima in <code>in</code>: <code>dip::Minima( dip::ImposeMinima( a, b )) == b</code>, for any <code>a</code>.</p>
<p>The image <code>in</code> will be modified such that the regions marked by <code>marker</code> obtain the lowest possible value for the
given data type, and any other local minima in <code>in</code> are filled in to become plateaus. Minimum imposition is typically
applied in conjunction with the watershed to reduce the number of regions created. The function <a href="segmentation.html#dip-SeededWatershed-dip-Image-CL-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-uint--dip-StringSet-CL"><code>dip::SeededWatershed</code></a>
has a similar result, but obtained in a different way, to applying <code>dip::Watershed</code> to the output of <code>ImposeMinima</code>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::MorphologicalReconstruction</code></a>, <a href="segmentation.html#dip-Minima-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::Minima</code></a>, <a href="segmentation.html#dip-Watershed-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-uint--dip-StringSet-"><code>dip::Watershed</code></a>, <a href="segmentation.html#dip-SeededWatershed-dip-Image-CL-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-uint--dip-StringSet-CL"><code>dip::SeededWatershed</code></a></p>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-Leveling-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint-"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-Leveling-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint-" class="m-doc-self">dip::<wbr />Leveling</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; marker,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0)</span></span>
            </h3>
            <p>The leveling of <code>in</code> imposed by <code>marker</code>.</p>
<p>The leveling introduces flat zones in the image, in such a way that, if <span class="m-math"><svg style="width: 3.725em; height: 0.963em; vertical-align: -0.360em;" viewBox=".07 -6.05 37.25 9.63">
<title>
\(g_p &gt; g_q\)
</title>
<defs>
<path id='eq134-g1-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq134-g1-63' d='M4.1-2.76C4.1-3.44 3.72-3.85 3.09-3.85C2.52-3.85 2.1-3.57 1.6-2.86L1.87-3.82C1.87-3.82 1.85-3.85 1.83-3.85H1.82L.47-3.66L.49-3.53C.75-3.53 1.06-3.53 1.06-3.29C1.06-3.19 .75-1.98 .44-.82L-.07 1.14C-.16 1.54-.28 1.64-.66 1.65V1.79H1.14V1.66C.72 1.66 .58 1.59 .58 1.4C.58 1.28 .72 .62 .9-.05C1.12 .06 1.28 .1 1.48 .1C2.75 .1 4.1-1.36 4.1-2.76ZM3.31-2.73C3.31-2.16 3.07-1.43 2.71-.9C2.33-.35 1.9-.07 1.44-.07C1.2-.07 1.02-.2 1.02-.39C1.02-.69 1.33-1.83 1.59-2.48C1.82-3.06 2.31-3.48 2.73-3.48C2.74-3.48 2.76-3.48 2.77-3.48C3.14-3.46 3.31-3.23 3.31-2.73Z'/>
<path id='eq134-g1-64' d='M3.43 1.79V1.63H3.28C2.96 1.63 2.79 1.55 2.77 1.41C2.77 1.39 2.78 1.35 2.8 1.28L4.22-3.72H3.58L3.45-3.31C3.31-3.71 3.14-3.85 2.78-3.85C1.62-3.85 .22-2.24 .22-.92C.22-.3 .56 .1 1.11 .1C1.73 .1 2.13-.22 2.91-1.34L2.15 1.19C2.04 1.54 1.9 1.62 1.33 1.65V1.79H3.43ZM3.32-3.14C3.32-2.41 2.74-1.2 2.15-.68C1.92-.48 1.68-.37 1.46-.37C1.15-.37 .97-.63 .97-1.04C.97-1.69 1.42-2.65 1.99-3.23C2.26-3.5 2.55-3.66 2.8-3.66C3.09-3.66 3.32-3.42 3.32-3.14Z'/>
<path id='eq134-g1-161' d='M5.01-2.16V-2.33L.54-4.44V-3.95L4.18-2.24L.54-.54V-.05L5.01-2.16Z'/>
<use id='eq134-g4-54' xlink:href='#eq134-g1-54' transform='scale(1.36)'/>
<use id='eq134-g4-161' xlink:href='#eq134-g1-161' transform='scale(1.36)'/>
</defs>
<g id='eq134-page1'>
<use x='.07' y='0' xlink:href='#eq134-g4-54'/>
<use x='6.81' y='1.79' xlink:href='#eq134-g1-63'/>
<use x='15.61' y='0' xlink:href='#eq134-g4-161'/>
<use x='26.87' y='0' xlink:href='#eq134-g4-54'/>
<use x='33.1' y='1.79' xlink:href='#eq134-g1-64'/>
</g>
</svg></span>, then <span class="m-math"><svg style="width: 3.693em; height: 1.166em; vertical-align: -0.360em;" viewBox=".33 -8.08 36.93 11.66">
<title>
\(f_p \geq g_p\)
</title>
<defs>
<path id='eq135-g1-21' d='M6.84-3.73V-3.97L.74-6.84V-6.16L5.69-3.84L.74-1.51V-.85L6.84-3.73ZM6.84 .69V.06H.74V.69H6.84Z'/>
<path id='eq135-g4-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq135-g4-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq135-g4-63' d='M4.1-2.76C4.1-3.44 3.72-3.85 3.09-3.85C2.52-3.85 2.1-3.57 1.6-2.86L1.87-3.82C1.87-3.82 1.85-3.85 1.83-3.85H1.82L.47-3.66L.49-3.53C.75-3.53 1.06-3.53 1.06-3.29C1.06-3.19 .75-1.98 .44-.82L-.07 1.14C-.16 1.54-.28 1.64-.66 1.65V1.79H1.14V1.66C.72 1.66 .58 1.59 .58 1.4C.58 1.28 .72 .62 .9-.05C1.12 .06 1.28 .1 1.48 .1C2.75 .1 4.1-1.36 4.1-2.76ZM3.31-2.73C3.31-2.16 3.07-1.43 2.71-.9C2.33-.35 1.9-.07 1.44-.07C1.2-.07 1.02-.2 1.02-.39C1.02-.69 1.33-1.83 1.59-2.48C1.82-3.06 2.31-3.48 2.73-3.48C2.74-3.48 2.76-3.48 2.77-3.48C3.14-3.46 3.31-3.23 3.31-2.73Z'/>
<use id='eq135-g7-53' xlink:href='#eq135-g4-53' transform='scale(1.36)'/>
<use id='eq135-g7-54' xlink:href='#eq135-g4-54' transform='scale(1.36)'/>
</defs>
<g id='eq135-page1'>
<use x='2.08' y='0' xlink:href='#eq135-g7-53'/>
<use x='6.16' y='1.79' xlink:href='#eq135-g4-63'/>
<use x='15.08' y='0' xlink:href='#eq135-g1-21'/>
<use x='26.43' y='0' xlink:href='#eq135-g7-54'/>
<use x='33.17' y='1.79' xlink:href='#eq135-g4-63'/>
</g>
</svg></span>
and <span class="m-math"><svg style="width: 3.630em; height: 1.166em; vertical-align: -0.360em;" viewBox=".07 -8.08 36.3 11.66">
<title>
\(g_q \geq f_q\)
</title>
<defs>
<path id='eq136-g1-21' d='M6.84-3.73V-3.97L.74-6.84V-6.16L5.69-3.84L.74-1.51V-.85L6.84-3.73ZM6.84 .69V.06H.74V.69H6.84Z'/>
<path id='eq136-g4-53' d='M3.7-5.35C3.7-5.68 3.38-5.92 2.95-5.92C2.53-5.92 2.2-5.74 1.89-5.35C1.62-5 1.43-4.59 1.17-3.74H.37L.31-3.46H1.09L.32 .21C.12 1.15-.16 1.62-.52 1.62C-.63 1.62-.7 1.56-.7 1.48C-.7 1.45-.69 1.43-.66 1.39C-.63 1.34-.62 1.3-.62 1.25C-.62 1.07-.78 .92-.96 .92S-1.28 1.07-1.28 1.28C-1.28 1.58-.99 1.81-.59 1.81C.18 1.81 .79 .95 1.15-.66L1.78-3.46H2.73L2.79-3.74H1.84C2.1-5.12 2.42-5.73 2.91-5.73C3.03-5.73 3.1-5.69 3.1-5.62C3.1-5.62 3.09-5.57 3.07-5.54C3.02-5.47 3.01-5.42 3.01-5.35C3.01-5.14 3.14-5 3.34-5C3.54-5 3.7-5.16 3.7-5.35Z'/>
<path id='eq136-g4-54' d='M3.37 .52C3.36-.03 2.94-.41 2.1-.63C1.72-.72 1.49-.86 1.49-1S1.69-1.35 1.81-1.35C1.81-1.35 1.84-1.35 1.87-1.35C1.94-1.33 2.06-1.32 2.14-1.32C2.93-1.32 3.74-2.02 3.74-2.7C3.74-2.85 3.71-3.01 3.66-3.2H4.1L4.09-3.54H3.55C3.53-3.54 3.49-3.55 3.42-3.61C3.18-3.76 2.89-3.85 2.56-3.85C1.59-3.85 .81-3.18 .81-2.36C.82-1.9 1.01-1.64 1.51-1.41C1-1.07 .85-.89 .85-.68C.85-.57 .93-.46 1.09-.34C.25 .21 .08 .39 .08 .78C.08 1.41 .65 1.8 1.55 1.8C2.65 1.8 3.37 1.28 3.37 .52ZM2.85 .79C2.85 1.26 2.35 1.61 1.68 1.61C.98 1.61 .56 1.28 .56 .72C.56 .51 .6 .36 .74 .19C.86 .04 1.22-.24 1.29-.24C1.29-.24 1.32-.24 1.34-.23L1.59-.15C2.52 .14 2.84 .38 2.85 .79ZM2.79-2.05C2.59-1.69 2.32-1.5 2.03-1.5C1.69-1.5 1.5-1.76 1.5-2.17C1.5-2.97 1.99-3.66 2.55-3.66C2.87-3.66 3.04-3.45 3.05-3.04C3.05-2.73 2.94-2.35 2.79-2.05Z'/>
<path id='eq136-g4-64' d='M3.43 1.79V1.63H3.28C2.96 1.63 2.79 1.55 2.77 1.41C2.77 1.39 2.78 1.35 2.8 1.28L4.22-3.72H3.58L3.45-3.31C3.31-3.71 3.14-3.85 2.78-3.85C1.62-3.85 .22-2.24 .22-.92C.22-.3 .56 .1 1.11 .1C1.73 .1 2.13-.22 2.91-1.34L2.15 1.19C2.04 1.54 1.9 1.62 1.33 1.65V1.79H3.43ZM3.32-3.14C3.32-2.41 2.74-1.2 2.15-.68C1.92-.48 1.68-.37 1.46-.37C1.15-.37 .97-.63 .97-1.04C.97-1.69 1.42-2.65 1.99-3.23C2.26-3.5 2.55-3.66 2.8-3.66C3.09-3.66 3.32-3.42 3.32-3.14Z'/>
<use id='eq136-g7-53' xlink:href='#eq136-g4-53' transform='scale(1.36)'/>
<use id='eq136-g7-54' xlink:href='#eq136-g4-54' transform='scale(1.36)'/>
</defs>
<g id='eq136-page1'>
<use x='.07' y='0' xlink:href='#eq136-g7-54'/>
<use x='6.3' y='1.79' xlink:href='#eq136-g4-64'/>
<use x='15.21' y='0' xlink:href='#eq136-g1-21'/>
<use x='28.58' y='0' xlink:href='#eq136-g7-53'/>
<use x='32.15' y='1.79' xlink:href='#eq136-g4-64'/>
</g>
</svg></span>, with <span class="m-math"><svg style="width: 0.559em; height: 0.771em; vertical-align: -0.246em;" viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq137-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq137-page1'>
<use x='.07' y='0' xlink:href='#eq137-g1-54'/>
</g>
</svg></span> the leveling of <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.247em;" viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq138-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq138-page1'>
<use x='2.08' y='0' xlink:href='#eq138-g1-53'/>
</g>
</svg></span>, and <span class="m-math"><svg style="width: 0.648em; height: 0.769em; vertical-align: -0.245em;" viewBox="-.02 -5.25 6.48 7.69">
<title>
\(p\)
</title>
<defs>
<path id='eq139-g1-63' d='M5.59-3.76C5.59-4.69 5.07-5.25 4.22-5.25C3.44-5.25 2.87-4.87 2.18-3.91L2.55-5.2C2.55-5.2 2.53-5.25 2.49-5.25H2.48L.64-4.99L.67-4.81C1.02-4.81 1.44-4.81 1.44-4.49C1.44-4.35 1.02-2.7 .6-1.12L-.1 1.55C-.21 2.1-.38 2.24-.89 2.25V2.44H1.55V2.26C.99 2.26 .79 2.17 .79 1.91C.79 1.74 .99 .85 1.23-.07C1.52 .08 1.74 .13 2.01 .13C3.75 .13 5.59-1.86 5.59-3.76ZM4.51-3.73C4.51-2.94 4.19-1.95 3.69-1.23C3.18-.48 2.6-.1 1.97-.1C1.63-.1 1.39-.27 1.39-.54C1.39-.94 1.81-2.49 2.17-3.38C2.48-4.17 3.14-4.74 3.73-4.74C3.74-4.74 3.76-4.74 3.78-4.74C4.29-4.72 4.51-4.41 4.51-3.73Z'/>
</defs>
<g id='eq139-page1'>
<use x='.87' y='0' xlink:href='#eq139-g1-63'/>
</g>
</svg></span>, <span class="m-math"><svg style="width: 0.575em; height: 0.769em; vertical-align: -0.245em;" viewBox=".18 -5.25 5.75 7.69">
<title>
\(q\)
</title>
<defs>
<path id='eq140-g1-64' d='M4.68 2.44V2.23H4.48C4.04 2.23 3.8 2.11 3.78 1.93C3.78 1.89 3.79 1.85 3.82 1.75L5.75-5.07H4.88L4.7-4.51C4.51-5.06 4.28-5.25 3.79-5.25C2.2-5.25 .3-3.06 .3-1.25C.3-.4 .76 .13 1.51 .13C2.36 .13 2.91-.3 3.97-1.82L2.93 1.62C2.78 2.1 2.58 2.2 1.81 2.25V2.44H4.68ZM4.53-4.28C4.53-3.29 3.74-1.63 2.93-.93C2.62-.66 2.29-.5 1.99-.5C1.57-.5 1.32-.86 1.32-1.42C1.32-2.3 1.94-3.61 2.72-4.41C3.08-4.78 3.48-4.99 3.82-4.99C4.22-4.99 4.53-4.67 4.53-4.28Z'/>
</defs>
<g id='eq140-page1'>
<use x='.18' y='0' xlink:href='#eq140-g1-64'/>
</g>
</svg></span> any two locations within the image.
That is, for any edge remaining in <span class="m-math"><svg style="width: 0.559em; height: 0.771em; vertical-align: -0.246em;" viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq141-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq141-page1'>
<use x='.07' y='0' xlink:href='#eq141-g1-54'/>
</g>
</svg></span>, there exists an edge of equal or larger magnitude in <span class="m-math"><svg style="width: 0.680em; height: 1.054em; vertical-align: -0.247em;" viewBox=".33 -8.08 6.8 10.54">
<title>
\(f\)
</title>
<defs>
<path id='eq142-g1-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
</defs>
<g id='eq142-page1'>
<use x='2.08' y='0' xlink:href='#eq142-g1-53'/>
</g>
</svg></span>.</p>
<p>The leveling can be obtained by initializing <span class="m-math"><svg style="width: 0.559em; height: 0.771em; vertical-align: -0.246em;" viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq143-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq143-page1'>
<use x='.07' y='0' xlink:href='#eq143-g1-54'/>
</g>
</svg></span> to the <code>marker</code> image and iteratively applying</p>
<div class="m-math"><svg style="width: 8.739em; height: 1.101em;" viewBox="150.24 -11.02 87.39 11.01">
<title>
\[ g = (f \wedge \delta g) \vee \epsilon g \]
</title>
<defs>
<path id='eq133-g4-94' d='M7.05 0L4-6.62H3.8L.74 0H1.42L3.91-5.43L6.37 0H7.05Z'/>
<path id='eq133-g4-95' d='M7.05-6.62H6.37L3.91-1.19L1.42-6.62H.74L3.8 0H4L7.05-6.62Z'/>
<path id='eq133-g4-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq133-g4-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq133-g1-61' d='M6.57-3.93V-4.6H.48V-3.93H6.57ZM6.57-1.51V-2.18H.48V-1.51H6.57Z'/>
<path id='eq133-g7-53' d='M5.05-7.3C5.05-7.74 4.61-8.08 4.03-8.08C3.45-8.08 3-7.83 2.57-7.3C2.2-6.82 1.95-6.26 1.6-5.1H.5L.42-4.72H1.49L.44 .29C.17 1.57-.21 2.22-.71 2.22C-.86 2.22-.95 2.13-.95 2.02C-.95 1.98-.94 1.95-.91 1.89C-.86 1.82-.85 1.77-.85 1.7C-.85 1.45-1.06 1.25-1.31 1.25S-1.75 1.46-1.75 1.74C-1.75 2.16-1.35 2.47-.81 2.47C.25 2.47 1.07 1.3 1.57-.91L2.43-4.72H3.73L3.8-5.1H2.51C2.86-6.98 3.3-7.81 3.97-7.81C4.13-7.81 4.23-7.75 4.23-7.66C4.23-7.66 4.22-7.6 4.18-7.55C4.12-7.46 4.11-7.4 4.11-7.3C4.11-7.02 4.29-6.82 4.55-6.82C4.82-6.82 5.05-7.04 5.05-7.3Z'/>
<path id='eq133-g7-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
<path id='eq133-g7-88' d='M5.5-7.15C5.5-7.52 4.95-7.83 3.98-7.83C3.03-7.83 2.25-7.29 2.25-6.56C2.25-5.78 3.07-4.92 3.07-4.91C3.06-4.91 .21-4.44 .21-1.74C.21-.93 .63 .18 1.83 .18C3.53 .18 4.87-1.37 4.87-3.31C4.87-5.29 2.7-5.54 2.7-6.69C2.7-7.23 3.33-7.46 3.72-7.46C4.84-7.46 4.59-6.78 5.09-6.78C5.34-6.78 5.5-6.94 5.5-7.15ZM3.92-2.92C3.92-1.38 2.93-.13 2.12-.13C1.45-.13 1.21-1.04 1.21-1.7C1.21-4.45 3.29-4.66 3.3-4.66C3.3-4.65 3.92-3.88 3.92-2.92Z'/>
<path id='eq133-g7-110' d='M5.36-5.18C5.11-5.22 4.84-5.25 4.56-5.25C2.51-5.25 .93-4.26 .63-2.2C.4-.7 1.21 .13 2.76 .13C3.26 .13 3.85 .1 4.37-.04L4.49-.45C4.04-.38 3.6-.32 3.16-.32C2.12-.32 1.52-.95 1.67-1.98C1.69-2.11 1.72-2.26 1.77-2.39L4.49-2.48L4.63-2.98L1.95-3.08C2.25-4.22 3.5-4.81 4.57-4.81C4.79-4.81 5-4.81 5.2-4.78L5.36-5.18Z'/>
</defs>
<g id='eq133-page1'>
<use x='150.24' y='-2.48' xlink:href='#eq133-g7-54'/>
<use x='159.9' y='-2.48' xlink:href='#eq133-g1-61'/>
<use x='170.89' y='-2.48' xlink:href='#eq133-g4-185'/>
<use x='177.43' y='-2.48' xlink:href='#eq133-g7-53'/>
<use x='185.52' y='-2.48' xlink:href='#eq133-g4-94'/>
<use x='196.16' y='-2.48' xlink:href='#eq133-g7-88'/>
<use x='202.13' y='-2.48' xlink:href='#eq133-g7-54'/>
<use x='208.47' y='-2.48' xlink:href='#eq133-g4-186'/>
<use x='215.7' y='-2.48' xlink:href='#eq133-g4-95'/>
<use x='226.22' y='-2.48' xlink:href='#eq133-g7-110'/>
<use x='232.04' y='-2.48' xlink:href='#eq133-g7-54'/>
</g>
</svg></div>
<p>until idempotence (<span class="m-math"><svg style="width: 0.559em; height: 0.771em; vertical-align: -0.246em;" viewBox=".07 -5.25 5.59 7.71">
<title>
\(g\)
</title>
<defs>
<path id='eq144-g1-54' d='M4.6 .71C4.59-.04 4.01-.56 2.87-.86C2.35-.99 2.04-1.18 2.04-1.36S2.31-1.85 2.47-1.85C2.47-1.85 2.51-1.85 2.55-1.83C2.64-1.81 2.81-1.8 2.92-1.8C4-1.8 5.1-2.75 5.1-3.68C5.1-3.88 5.06-4.11 4.99-4.36H5.59L5.57-4.82H4.85C4.81-4.82 4.75-4.85 4.66-4.92C4.34-5.13 3.94-5.25 3.49-5.25C2.17-5.25 1.11-4.34 1.11-3.22C1.12-2.6 1.38-2.24 2.06-1.93C1.37-1.45 1.16-1.21 1.16-.93C1.16-.77 1.26-.63 1.49-.46C.35 .29 .11 .54 .11 1.06C.11 1.92 .88 2.45 2.11 2.45C3.61 2.45 4.6 1.75 4.6 .71ZM3.88 1.07C3.88 1.72 3.2 2.19 2.29 2.19C1.33 2.19 .76 1.74 .76 .98C.76 .69 .82 .49 1.01 .26C1.17 .06 1.67-.33 1.76-.33C1.76-.33 1.8-.32 1.82-.31L2.17-.2C3.43 .19 3.87 .52 3.88 1.07ZM3.8-2.8C3.54-2.31 3.17-2.05 2.76-2.05C2.3-2.05 2.05-2.39 2.05-2.97C2.05-4.05 2.72-4.99 3.48-4.99C3.92-4.99 4.14-4.7 4.16-4.14C4.16-3.73 4.01-3.2 3.8-2.8Z'/>
</defs>
<g id='eq144-page1'>
<use x='.07' y='0' xlink:href='#eq144-g1-54'/>
</g>
</svg></span> doesn&rsquo;t change any further). However, here it is implemented more efficiently
using <a href="morphology.html#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::MorphologicalReconstruction</code></a>.</p>
<p>The <code>marker</code> image can be a smoothed version of <code>in</code>, then the leveling yields a similar simplification as
the smoothing, but preserving sharp edges.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>F. Meyer, &ldquo;The levelings&rdquo;, Mathematical Morphology and its Applications to Image and Signal Processing
  (proceedings of ISSM&lsquo;98), pp. 199-206, 1998.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-AreaOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-AreaOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL" class="m-doc-self">dip::<wbr />AreaOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> filterSize,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENING)</span></span>
            </h3>
            <p>Computes the area opening or closing. This is a parametric opening.</p>
<p>The area opening removes all local maxima that have an area smaller than the given parameter <code>filterSize</code>,
and is equivalent to the supremum of openings with all possible connected flat structuring elements of that area.
The output has all maxima being connected components with a size of at least <code>filterSize</code>. The area closing is the
dual operation.</p>
<p>Note that we refer to &ldquo;area&rdquo; here as the number of pixels, which readily extends to any number of dimensions.</p>
<p><code>in</code> must be scalar and real-valued or binary.</p>
<p><code>mask</code> restricts the image regions used for the operation.</p>
<p><code>connectivity</code> determines what a connected component is. See <a href="concepts.html#connectivity">Connectivity</a> for information on the
connectivity parameter.</p>
<p><code>polarity</code> can be <code>"opening"</code> (the default) or <code>"closing"</code>, to compute the area opening or area closing, respectively.</p>
<p>We use a union-find implementation similar to that described my Meijster and Wilkinson (2002), and is based on
the algorithm for our fast watershed (<code>"fast"</code> mode to <a href="segmentation.html#dip-Watershed-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-uint--dip-StringSet-"><code>dip::Watershed</code></a>). For binary images, this function calls
<a href="binary.html#dip-BinaryAreaOpening-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL"><code>dip::BinaryAreaOpening</code></a> or <a href="binary.html#dip-BinaryAreaClosing-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL"><code>dip::BinaryAreaClosing</code></a>.</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-AreaClosing-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint-"><code>dip::AreaClosing</code></a>, <a href="morphology.html#dip-VolumeOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL"><code>dip::VolumeOpening</code></a>, <a href="morphology.html#dip-VolumeClosing-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-"><code>dip::VolumeClosing</code></a>, <a href="morphology.html#dip-PathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL-dip-StringSet-CL"><code>dip::PathOpening</code></a>, <a href="morphology.html#dip-DirectedPathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-IntegerArray--dip-String-CL-dip-StringSet-CL"><code>dip::DirectedPathOpening</code></a>, <a href="morphology.html#dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Opening</code></a>, <a href="morphology.html#dip-Closing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Closing</code></a>, <a href="segmentation.html#dip-Maxima-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::Maxima</code></a>, <a href="segmentation.html#dip-Minima-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::Minima</code></a>, <a href="regions.html#dip-SmallObjectsRemove-dip-Image-CL-dip-Image-L-dip-uint--dip-uint-"><code>dip::SmallObjectsRemove</code></a></p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>L. Vincent, &ldquo;Grayscale area openings and closings, their efficient implementation and applications&rdquo;,
  Mathematical Morphology and Its Applications to Signal Processing, pp. 22-27, 1993.</li>
<li>A. Meijster and M.H.F. Wilkinson, &ldquo;A Comparison of Algorithms for Connected Set Openings and Closings&rdquo;,
  IEEE Transactions on Pattern Analysis and Machine Intelligence 24(4):484-494, 2002.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-VolumeOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-VolumeOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint--dip-String-CL" class="m-doc-self">dip::<wbr />VolumeOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="pixeltypes.html#dip-dfloat" class="m-doc">dip::dfloat</a> filterSize,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENING)</span></span>
            </h3>
            <p>Computes the volume opening or closing. This is a parametric opening.</p>
<p>The volume opening removes all local maxima that have a volume smaller than the given parameter <code>filterSize</code>. The
&ldquo;volume&rdquo; is the integral over the pixel values, offset by the graylevel at which the maximum is cut.
The volume closing is the dual operation.</p>
<p>Comparing to the area opening, which removes peaks by the area of their support, this function removes peaks by
the volume being removed. The difference of the opening with the input image, in the case of the area opening,
is a series of peaks, each of which less than <code>filterSize</code> pixels, surrounded by zero-valued pixels.
In the case of the volume opening, these peaks all have an integral (sum of pixel values) of less than <code>filterSize</code>.</p>
<p><code>in</code> must be scalar and real-valued. Binary images are not allowed.</p>
<p><code>mask</code> restricts the image regions used for the operation.</p>
<p><code>connectivity</code> determines what a connected component is. See <a href="concepts.html#connectivity">Connectivity</a> for information on the
connectivity parameter.</p>
<p><code>polarity</code> can be <code>"opening"</code> (the default) or <code>"closing"</code>, to compute the area opening or area closing, respectively.</p>
<p>We use a union-find implementation similar to that described my Meijster and Wilkinson (2002), and is based on
the algorithm for our fast watershed (<code>"fast"</code> mode to <a href="segmentation.html#dip-Watershed-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-dfloat--dip-uint--dip-StringSet-"><code>dip::Watershed</code></a>).</p>
<aside class="m-note m-default">
<h4>See also</h4>
<p><a href="morphology.html#dip-VolumeClosing-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-dfloat--dip-uint-"><code>dip::VolumeClosing</code></a>, <a href="morphology.html#dip-AreaOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL"><code>dip::AreaOpening</code></a>, <a href="morphology.html#dip-AreaClosing-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint-"><code>dip::AreaClosing</code></a>, <a href="morphology.html#dip-PathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL-dip-StringSet-CL"><code>dip::PathOpening</code></a>, <a href="morphology.html#dip-DirectedPathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-IntegerArray--dip-String-CL-dip-StringSet-CL"><code>dip::DirectedPathOpening</code></a>, <a href="morphology.html#dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Opening</code></a>, <a href="morphology.html#dip-Closing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Closing</code></a>, <a href="segmentation.html#dip-Maxima-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::Maxima</code></a>, <a href="segmentation.html#dip-Minima-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::Minima</code></a>, <a href="regions.html#dip-SmallObjectsRemove-dip-Image-CL-dip-Image-L-dip-uint--dip-uint-"><code>dip::SmallObjectsRemove</code></a></p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>L. Vincent, &ldquo;Grayscale area openings and closings, their efficient implementation and applications&rdquo;,
  Mathematical Morphology and Its Applications to Signal Processing, pp. 22-27, 1993.</li>
<li>A. Meijster and M.H.F. Wilkinson, &ldquo;A Comparison of Algorithms for Connected Set Openings and Closings&rdquo;,
  IEEE Transactions on Pattern Analysis and Machine Intelligence 24(4):484-494, 2002.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-PathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL-dip-StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-PathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL-dip-StringSet-CL" class="m-doc-self">dip::<wbr />PathOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> length = 7,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENING,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; mode = {})</span></span>
            </h3>
            <p>Applies a path opening or closing in all possible directions</p>
<p><code>length</code> is the length of the path. All <code>filterParam</code> arguments to <a href="morphology.html#dip-DirectedPathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-IntegerArray--dip-String-CL-dip-StringSet-CL"><code>dip::DirectedPathOpening</code></a> that yield a
length of <code>length</code> pixels and represent unique directions are generated, and the directed path opening or closing
is computed for each of them. The supremum (when <code>polarity</code> is <code>"opening"</code>) or infimum (when it is <code>"closing"</code>) is
computed over all results. See <a href="morphology.html#dip-DirectedPathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-IntegerArray--dip-String-CL-dip-StringSet-CL"><code>dip::DirectedPathOpening</code></a> for a description of the algorithm and the parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-DirectedPathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-IntegerArray--dip-String-CL-dip-StringSet-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-DirectedPathOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-IntegerArray--dip-String-CL-dip-StringSet-CL" class="m-doc-self">dip::<wbr />DirectedPathOpening</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; mask,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="supporttypes.html#dip-IntegerArray" class="m-doc">dip::IntegerArray</a> filterParam,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENING,
              <a href="supporttypes.html#dip-StringSet" class="m-doc">dip::StringSet</a> const&amp; mode = {})</span></span>
            </h3>
            <p>Applies a path opening or closing in a specific direction.</p>
<p>The path opening is an opening over all possible paths of a specific length and general direction. A path
direction represents a 90 degree cone within which paths are generated. The paths are formed by single pixel
steps in one of three directions (in 2D): the main direction, or 45 degrees to the left or right. That is,
if the main direction is [1,0] (to the right), then [1,-1] and [1,1] (diagonal up or down) are also possible
steps. This leads to a number of different paths that is exponential in its lengths. However, the opening over
all these paths can be computed in <span class="m-math"><svg style="width: 5.703em; height: 1.114em; vertical-align: -0.261em;" viewBox="-.13 -8.54 57.03 11.14">
<title>
\(O(n \log(n))\)
</title>
<defs>
<path id='eq145-g1-185' d='M3.51-8.54C1.79-7.42 .57-5.49 .57-3.06C.57-.85 1.83 1.39 3.48 2.41L3.62 2.22C2.05 .98 1.6-.46 1.6-3.1C1.6-5.74 2.08-7.11 3.62-8.35L3.51-8.54Z'/>
<path id='eq145-g1-186' d='M.45-8.54L.35-8.35C1.88-7.11 2.37-5.74 2.37-3.1C2.37-.46 1.92 .98 .35 2.22L.49 2.41C2.13 1.39 3.39-.85 3.39-3.06C3.39-5.49 2.18-7.42 .45-8.54Z'/>
<path id='eq145-g8-103' d='M5.6-4.62V-5.09H4.68C4.44-5.09 4.26-5.12 4.03-5.2L3.76-5.3C3.44-5.42 3.12-5.48 2.81-5.48C1.7-5.48 .82-4.62 .82-3.54C.82-2.79 1.14-2.33 1.93-1.94L1.42-1.46C1.02-1.12 .87-.88 .87-.64C.87-.39 1.01-.25 1.5-.01C.66 .61 .33 1 .33 1.44C.33 2.07 1.26 2.6 2.39 2.6C3.29 2.6 4.22 2.29 4.84 1.79C5.29 1.42 5.49 1.04 5.49 .58C5.49-.15 4.93-.66 4.05-.69L2.51-.76C1.88-.79 1.58-.89 1.58-1.08C1.58-1.32 1.98-1.74 2.3-1.83C2.41-1.82 2.49-1.81 2.53-1.81C2.75-1.79 2.91-1.77 2.98-1.77C3.42-1.77 3.89-1.95 4.26-2.27C4.66-2.61 4.84-3.03 4.84-3.62C4.84-3.97 4.78-4.24 4.61-4.62H5.6ZM5.16 .76C5.16 1.45 4.25 1.92 2.91 1.92C1.86 1.92 1.17 1.57 1.17 1.05C1.17 .77 1.25 .62 1.75 .02C2.14 .11 3.1 .18 3.68 .18C4.76 .18 5.16 .33 5.16 .76ZM3.92-3.16C3.92-2.49 3.57-2.07 3.03-2.07C2.31-2.07 1.81-2.85 1.81-3.99V-4.03C1.81-4.73 2.14-5.15 2.69-5.15C3.06-5.15 3.37-4.94 3.56-4.59C3.78-4.17 3.92-3.62 3.92-3.16Z'/>
<path id='eq145-g8-108' d='M3.06 0V-.18C2.3-.23 2.17-.35 2.17-1V-8.11L2.12-8.13C1.5-7.93 1.05-7.81 .23-7.61V-7.42H.3C.43-7.43 .57-7.44 .67-7.44C1.05-7.44 1.17-7.28 1.17-6.72V-1.04C1.17-.39 1-.24 .25-.18V0H3.06Z'/>
<path id='eq145-g8-111' d='M5.6-2.79C5.6-4.35 4.5-5.48 2.98-5.48C1.43-5.48 .35-4.34 .35-2.69C.35-1.08 1.45 .12 2.95 .12S5.6-1.14 5.6-2.79ZM4.53-2.37C4.53-1.02 3.99-.21 3.1-.21C2.63-.21 2.19-.5 1.94-.98C1.61-1.6 1.42-2.43 1.42-3.28C1.42-4.41 1.98-5.15 2.82-5.15C3.82-5.15 4.53-4 4.53-2.37Z'/>
<path id='eq145-g4-36' d='M8.33-4.98C8.33-5.04 8.33-5.1 8.33-5.15C8.33-6.74 7.19-7.93 5.65-7.93C4.7-7.93 3.72-7.52 2.79-6.73C1.49-5.62 .71-4.1 .71-2.63C.71-.96 1.8 .21 3.31 .21C5.79 .21 8.19-2.29 8.33-4.98ZM7.07-5.73C7.07-4.48 6.54-2.78 5.79-1.66C5.12-.67 4.37-.18 3.51-.18C2.51-.18 1.97-.89 1.97-2.19C1.97-3.29 2.53-5.01 3.23-6.05C3.89-7.06 4.65-7.54 5.54-7.54C6.49-7.54 7.07-6.85 7.07-5.73Z'/>
<path id='eq145-g4-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq145-page1'>
<use x='-.13' y='0' xlink:href='#eq145-g4-36'/>
<use x='9.76' y='0' xlink:href='#eq145-g1-185'/>
<use x='14.27' y='0' xlink:href='#eq145-g4-61'/>
<use x='22.4' y='0' xlink:href='#eq145-g8-108'/>
<use x='25.72' y='0' xlink:href='#eq145-g8-111'/>
<use x='31.7' y='0' xlink:href='#eq145-g8-103'/>
<use x='38.28' y='0' xlink:href='#eq145-g1-185'/>
<use x='42.8' y='0' xlink:href='#eq145-g4-61'/>
<use x='48.93' y='0' xlink:href='#eq145-g1-186'/>
<use x='53.51' y='0' xlink:href='#eq145-g1-186'/>
</g>
</svg></span> time, with <span class="m-math"><svg style="width: 0.565em; height: 0.536em; vertical-align: -0.011em;" viewBox=".06 -5.25 5.65 5.36">
<title>
\(n\)
</title>
<defs>
<path id='eq146-g1-61' d='M5.65-1.24L5.48-1.39C5.4-1.29 5.31-1.18 5.23-1.08C4.88-.64 4.67-.45 4.5-.45C4.39-.45 4.31-.54 4.31-.64C4.31-.74 4.36-.96 4.48-1.39L5.16-3.85C5.23-4.1 5.26-4.36 5.26-4.53C5.26-4.95 4.94-5.25 4.48-5.25C3.72-5.25 2.97-4.53 1.74-2.63L2.54-5.23L2.5-5.25L.57-4.88V-4.69C1.18-4.68 1.33-4.61 1.33-4.37C1.33-4.3 1.32-4.23 1.31-4.17L.17 0H1.06C1.62-1.88 1.73-2.14 2.25-2.95C2.97-4.06 3.57-4.65 4.01-4.65C4.19-4.65 4.3-4.51 4.3-4.3C4.3-4.16 4.23-3.76 4.13-3.39L3.61-1.43C3.45-.81 3.42-.66 3.42-.54C3.42-.08 3.59 .11 3.98 .11C4.51 .11 4.81-.13 5.65-1.24Z'/>
</defs>
<g id='eq146-page1'>
<use x='.06' y='0' xlink:href='#eq146-g1-61'/>
</g>
</svg></span> the path length.</p>
<p>The direction description above can be generalized to any number of dimensions by realizing that the main direction
can be specified by any of the neighbors of a central pixel, and then the other allowed steps are the neighbor
pixels that are also neighbor to the pixel that represents the main direction. In 3D, this leads to 6 or 8 alternate
steps.</p>
<p>There are 4 possible path directions in 2D, and 13 in 3D. Both length and direction are specified through
the <code>filterParam</code> argument, see below. Note that the path length is given by the number of pixels in the path,
not the Euclidean length of the path.</p>
<p>The <code>polarity</code> parameter can be <code>"opening"</code> (the default) or <code>"closing"</code>, to compute the path opening and path
closing, respectively.</p>
<p>When <code>mode</code> contains <code>"constrained"</code>, the path construction described above is modified such that, after every alternate
step, a step in the main direction must be taken. This constraint avoids a zig-zag line that causes the path
opening to yield much shorter lines for the diagonal directions if the lines in the image are thicker than one pixel.
See the paper by Luengo referenced below. It also reduces the cone size from 90 degrees to 45 degrees, making the
algorithm more directionally-selective. The constrained mode increases computation time a little, but is highly
recommended when using the path opening in a granulometry. The alternate flag is <code>"unconstrained"</code>, which is the
default and does not need to be given.</p>
<p>Path openings can be sensitive to noise. If <code>mode</code> contains <code>"robust"</code>, a robust path opening or closing is
obtained. A robust path opening is computed by dilating the image with a 2x2 rectangular structuring element,
applying the path opening, then taking the infimum of the result and the input (Merveille, 2018). For a path
closing, the erosion and the supremum are used instead.</p>
<aside class="m-note m-default">
<h4>Definition of <code>filterSize</code></h4>
<p><code>length = max(abs(filterSize))</code> is the number of pixels in the line.</p>
<p>The path direction is determined by translating <code>filterSize</code> to an array with -1, 0 and 1 values using
<code>direction = round(filterSize/length)</code>.</p>
<p>For example, if <code>filterSize=[7,0]</code>, then <code>length</code> is 7, and
<code>direction</code> is <code>[1,0]</code> (to the right), with <code>[1,1]</code> and <code>[1,-1]</code> as alternate directions.</p>
</aside>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>H. Heijmans, M. Buckley and H. Talbot, &ldquo;Path Openings and Closings&rdquo;, Journal of Mathematical Imaging and Vision 22:107-119, 2005.</li>
<li>H. Talbot and B. Appleton, &ldquo;Efficient complete and incomplete path openings and closings&rdquo;, Image and Vision Computing 25:416-425, 2007.</li>
<li>C.L. Luengo Hendriks, &ldquo;Constrained and dimensionality-independent path openings&rdquo;, IEEE Transactions on Image Processing 19(6):1587–1595, 2010.</li>
<li>O. Merveille, H. Talbot, L. Najman and N. Passat, &ldquo;Curvilinear Structure Analysis by Ranking the Orientation Responses of Path Operators&rdquo;, IEEE Transactions on Pattern Analysis and Machine Intelligence 40(2):304-317, 2018.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-OpeningByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-OpeningByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL" class="m-doc-self">dip::<wbr />OpeningByReconstruction</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Opening by reconstruction</p>
<p>Applies a structural erosion followed by a reconstruction by dilation.</p>
<p>See <a href="morphology.html#dip-Erosion-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Erosion</code></a> and <a href="morphology.html#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::MorphologicalReconstruction</code></a> for a description of the parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-ClosingByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-ClosingByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL" class="m-doc-self">dip::<wbr />ClosingByReconstruction</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; se = {},
              <a href="supporttypes.html#dip-uint" class="m-doc">dip::uint</a> connectivity = 0,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Closing by reconstruction</p>
<p>Applies a structural dilation followed by a reconstruction by erosion.</p>
<p>See <a href="morphology.html#dip-Dilation-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Dilation</code></a> and <a href="morphology.html#dip-MorphologicalReconstruction-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-String-CL"><code>dip::MorphologicalReconstruction</code></a> for a description of the parameters.</p>
          </div></section>
          <section class="m-doc-details" id="dip-AlternatingSequentialFilter-dip-Image-CL-dip-Image-L-dip-Range-CL-dip-String-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-AlternatingSequentialFilter-dip-Image-CL-dip-Image-L-dip-Range-CL-dip-String-CL-dip-String-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />AlternatingSequentialFilter</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Range.html" class="m-doc">dip::Range</a> const&amp; sizes = {3,7,2},
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; shape = S::ELLIPTIC,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::STRUCTURAL,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; polarity = S::OPENCLOSE,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>Alternating sequential filters for smoothing</p>
<p>Applies alternating sequential filters to <code>in</code>, using structuring element sizes given by the range <code>sizes</code>.
Alternating sequential filters are two morphological filters opening and closing, applied in sequence, from
a small size to a larger size. This provides an effective smoothing that is less biased than applying an
opening and closing of a single size (as in <a href="morphology.html#dip-MorphologicalSmoothing-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL"><code>dip::MorphologicalSmoothing</code></a>).
<code>polarity</code> can be <code>"open-close"</code> or <code>"close-open"</code>, and determines which of the operations is applied first.</p>
<p>For example, if <code>sizes</code> is <code>{3,7,2}</code> and <code>polarity</code> is <code>"open-close"</code>, the following operations are applied:</p>
<div class="m-code"><pre><span></span><span class="n">dip</span><span class="o">::</span><span class="n">Opening</span><span class="p">(</span> <span class="n">in</span><span class="p">,</span>  <span class="n">out</span><span class="p">,</span> <span class="p">{</span> <span class="mi">3</span><span class="p">,</span> <span class="n">shape</span> <span class="p">}</span> <span class="p">);</span>
<span class="n">dip</span><span class="o">::</span><span class="n">Closing</span><span class="p">(</span> <span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">{</span> <span class="mi">3</span><span class="p">,</span> <span class="n">shape</span> <span class="p">}</span> <span class="p">);</span>
<span class="n">dip</span><span class="o">::</span><span class="n">Opening</span><span class="p">(</span> <span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">{</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shape</span> <span class="p">}</span> <span class="p">);</span>
<span class="n">dip</span><span class="o">::</span><span class="n">Closing</span><span class="p">(</span> <span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">{</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shape</span> <span class="p">}</span> <span class="p">);</span>
<span class="n">dip</span><span class="o">::</span><span class="n">Opening</span><span class="p">(</span> <span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">{</span> <span class="mi">7</span><span class="p">,</span> <span class="n">shape</span> <span class="p">}</span> <span class="p">);</span>
<span class="n">dip</span><span class="o">::</span><span class="n">Closing</span><span class="p">(</span> <span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">{</span> <span class="mi">7</span><span class="p">,</span> <span class="n">shape</span> <span class="p">}</span> <span class="p">);</span>
</pre></div>

<p><code>mode</code> is one of:</p>
<ul>
<li><code>"structural"</code>: uses structural openings and closings (see <a href="morphology.html#dip-Opening-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StringArray-CL"><code>dip::Opening</code></a>).</li>
<li><code>"reconstruction"</code>: uses openings and closings by reconstruction (see <a href="morphology.html#dip-OpeningByReconstruction-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-uint--dip-StringArray-CL"><code>dip::OpeningByReconstruction</code></a>).</li>
<li><code>"area"</code>: uses area openings and closings (see <a href="morphology.html#dip-AreaOpening-dip-Image-CL-dip-Image-CL-dip-Image-L-dip-uint--dip-uint--dip-String-CL"><code>dip::AreaOpening</code></a>) &ndash; <code>shape</code> is ignored.</li>
</ul>
          </div></section>
          <section class="m-doc-details" id="dip-HitAndMiss-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-HitAndMiss-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />HitAndMiss</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; hit,
              <a href="dip-StructuringElement.html" class="m-doc">dip::StructuringElement</a> const&amp; miss,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::UNCONSTRAINED,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>The Hit-and-Miss transform, uses two structuring elements, <code>hit</code> must be within the structures,
<code>miss</code> must be without.</p>
<p>For a binary image, the result is the intersection of the erosion of the image with <code>hit</code> and the erosion of the
inverted image with <code>miss</code>.</p>
<p>For a grey-value image, there are two definitions of the operator. If <code>mode</code> is <code>"unconstrained"</code>, the output is
the difference of the erosion with <code>hit</code> and the dilation with <code>miss</code>, with any negative values clipped to 0.</p>
<p>If <code>mode</code> is <code>"constrained"</code>, a more restrictive definition is applied (conditions evaluated pixel-wise):</p>
<ul>
<li>If <code>in == erosion(in,hit) &amp;&amp; dilation(in,miss) &lt; in</code>: <code>out = in - dilation(in,miss)</code>.</li>
<li>If <code>in == dilation(in,miss) &amp;&amp; erosion(in,hit) &gt; in</code>: <code>out = erosion(in,hit) - in</code>.</li>
<li>Otherwise: <code>out = 0</code>.</li>
</ul>
<p>Note that the two structuring elements must be disjoint. If one pixel is set in both structuring elements,
the output will be all zeros.</p>
<p>See also <a href="binary.html#dip-SupGenerating-dip-Image-CL-dip-Image-L-dip-Interval-CL-dip-String-CL"><code>dip::SupGenerating</code></a> for a function specific to binary images.</p>
<aside class="m-note m-default">
<h4>Literature</h4>
<ul>
<li>P. Soille, &ldquo;Morphological Image Analysis&rdquo;, 2<sup>nd</sup> Edition, sections 5.1.1 and 5.1.2. Springer, 2002.</li>
</ul>
</aside>
          </div></section>
          <section class="m-doc-details" id="dip-HitAndMiss-dip-Image-CL-dip-Image-L-dip-Image-CL-dip-String-CL-dip-StringArray-CL"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void
                </span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#dip-HitAndMiss-dip-Image-CL-dip-Image-L-dip-Image-CL-dip-String-CL-dip-StringArray-CL" class="m-doc-self">dip::<wbr />HitAndMiss</a>(</span><span class="m-doc-wrap"><a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; in,
              <a href="dip-Image.html" class="m-doc">dip::Image</a>&amp; out,
              <a href="dip-Image.html" class="m-doc">dip::Image</a> const&amp; se,
              <a href="supporttypes.html#dip-String" class="m-doc">dip::String</a> const&amp; mode = S::UNCONSTRAINED,
              <a href="supporttypes.html#dip-StringArray" class="m-doc">dip::StringArray</a> const&amp; boundaryCondition = {})</span></span>
            </h3>
            <p>The Hit-and-Miss transform, uses a single structuring element in the form of a small image that
has &ldquo;hit&rdquo;, &ldquo;miss&rdquo; and &ldquo;don&rsquo;t care&rdquo; values.</p>
<p>The <code>hit</code> SE is <code>se == 1</code>, the <code>miss</code> SE is <code>se == 0</code>. &ldquo;Don&rsquo;t care&rdquo; values are any other value.</p>
<p>See the description for the other <a href="morphology.html#dip-HitAndMiss-dip-Image-CL-dip-Image-L-dip-StructuringElement-CL-dip-StructuringElement-CL-dip-String-CL-dip-StringArray-CL"><code>dip::HitAndMiss</code></a> function for a description of the other parameters.</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form action="https://diplib.org/diplib-docs/#search">
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript. Enable it or <a href="https://google.com/search?q=site:diplib.org+">use an external search engine</a>.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or modules.
              You can omit any prefix from the symbol or file path; adding a <code>:</code> or
              <code>/</code> suffix lists all members of given symbol or directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span> / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
              <span class="m-label m-dim">Enter</span> to go.
              <span class="m-label m-dim">Tab</span> autocompletes common prefix.
              You can copy a link to the result using <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">L</span>,
              or <span class="m-label m-dim">⌘</span> <span class="m-label m-dim">M</span> to copy a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.<br />Maybe try a full-text <a href="#" id="search-external" data-search-engine="https://google.com/search?q=site:diplib.org+{query}">search with external engine</a>?</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>DIPlib, a library for quantitative image analysis. Documentation compiled with <a href="https://crisluengo.github.io/doxpp/">dox++</a> and styled with <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>